<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tensor Library: include/tensor_io.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tensor Library
   </div>
   <div id="projectbrief">High-performance C++ tensor library with GPU, BLAS, autograd, and linear algebra support</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('tensor__io_8h.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">tensor_io.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>I/O operations for tensors (save/load/print).  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="tensor_8h_source.html">tensor.h</a>&quot;</code><br />
<code>#include &lt;fstream&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;iomanip&gt;</code><br />
<code>#include &lt;sstream&gt;</code><br />
<code>#include &lt;cstring&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for tensor_io.h:</div>
<div class="dyncontent">
<div class="center"><img src="tensor__io_8h__incl.png" border="0" usemap="#ainclude_2tensor__io_8h" loading="lazy" alt=""/></div>
<map name="ainclude_2tensor__io_8h" id="ainclude_2tensor__io_8h">
<area shape="rect" title="I/O operations for tensors (save/load/print)." alt="" coords="1364,5,1494,32"/>
<area shape="rect" href="tensor_8h.html" title="High&#45;performance multi&#45;dimensional tensor library with GPU, BLAS, and autograd support." alt="" coords="620,80,689,107"/>
<area shape="poly" title=" " alt="" coords="1364,29,705,90,704,85,1364,23"/>
<area shape="rect" title=" " alt="" coords="1244,229,1305,256"/>
<area shape="poly" title=" " alt="" coords="1404,35,1372,55,1342,82,1320,115,1303,150,1283,215,1278,213,1298,148,1316,112,1338,78,1368,50,1401,30"/>
<area shape="rect" title=" " alt="" coords="1351,80,1416,107"/>
<area shape="poly" title=" " alt="" coords="1424,34,1402,68,1398,65,1419,31"/>
<area shape="rect" title=" " alt="" coords="1440,80,1512,107"/>
<area shape="poly" title=" " alt="" coords="1440,31,1462,66,1457,68,1435,34"/>
<area shape="rect" title=" " alt="" coords="1536,80,1602,107"/>
<area shape="poly" title=" " alt="" coords="1455,30,1532,70,1530,75,1452,35"/>
<area shape="rect" title=" " alt="" coords="1627,80,1695,107"/>
<area shape="poly" title=" " alt="" coords="1470,30,1613,74,1612,79,1469,35"/>
<area shape="rect" title=" " alt="" coords="902,155,967,181"/>
<area shape="poly" title=" " alt="" coords="690,101,888,152,886,157,688,106"/>
<area shape="rect" title=" " alt="" coords="991,155,1065,181"/>
<area shape="poly" title=" " alt="" coords="690,98,976,152,975,157,689,103"/>
<area shape="rect" title=" " alt="" coords="1114,229,1182,256"/>
<area shape="poly" title=" " alt="" coords="689,94,778,100,892,111,1001,128,1046,139,1078,152,1097,165,1112,181,1136,214,1132,217,1108,185,1093,169,1076,157,1044,144,1000,133,891,116,777,105,689,99"/>
<area shape="rect" title=" " alt="" coords="1140,155,1190,181"/>
<area shape="poly" title=" " alt="" coords="690,95,875,114,998,131,1122,152,1126,153,1125,158,1121,157,997,136,874,119,689,100"/>
<area shape="rect" title=" " alt="" coords="1215,155,1275,181"/>
<area shape="poly" title=" " alt="" coords="689,94,901,110,1047,127,1200,152,1199,157,1047,133,900,116,689,99"/>
<area shape="rect" title=" " alt="" coords="5,155,88,181"/>
<area shape="poly" title=" " alt="" coords="620,100,406,118,258,135,103,157,102,152,257,130,405,113,620,94"/>
<area shape="rect" title=" " alt="" coords="112,155,165,181"/>
<area shape="poly" title=" " alt="" coords="620,100,436,117,311,134,181,157,180,152,310,128,436,112,620,94"/>
<area shape="rect" title=" " alt="" coords="189,155,266,181"/>
<area shape="poly" title=" " alt="" coords="621,102,477,123,282,157,281,152,476,118,620,97"/>
<area shape="rect" title=" " alt="" coords="291,155,340,181"/>
<area shape="poly" title=" " alt="" coords="620,103,506,123,356,157,355,151,505,118,619,97"/>
<area shape="rect" title=" " alt="" coords="364,155,425,181"/>
<area shape="poly" title=" " alt="" coords="621,107,440,157,439,152,619,102"/>
<area shape="rect" title=" " alt="" coords="438,229,495,256"/>
<area shape="poly" title=" " alt="" coords="620,100,589,106,553,116,519,133,490,156,475,184,469,214,464,213,470,182,486,153,516,128,551,111,587,101,619,95"/>
<area shape="rect" title=" " alt="" coords="500,155,566,181"/>
<area shape="poly" title=" " alt="" coords="635,110,569,149,566,144,632,105"/>
<area shape="rect" title=" " alt="" coords="524,229,601,256"/>
<area shape="poly" title=" " alt="" coords="649,109,581,217,576,215,644,106"/>
<area shape="rect" title=" " alt="" coords="626,229,683,256"/>
<area shape="poly" title=" " alt="" coords="657,107,657,214,652,214,652,107"/>
<area shape="rect" title=" " alt="" coords="692,155,756,181"/>
<area shape="poly" title=" " alt="" coords="668,105,703,141,699,145,665,109"/>
<area shape="rect" href="tensor__perf_8h.html" title="Performance optimization features for tensor operations." alt="" coords="780,155,878,181"/>
<area shape="poly" title=" " alt="" coords="686,105,786,146,783,151,684,110"/>
<area shape="poly" title=" " alt="" coords="879,177,1099,226,1098,231,878,182"/>
<area shape="poly" title=" " alt="" coords="781,182,768,184,640,207,512,232,511,232,510,227,511,227,639,201,767,179,780,176"/>
<area shape="poly" title=" " alt="" coords="783,184,617,230,615,224,782,179"/>
<area shape="poly" title=" " alt="" coords="800,184,698,226,696,221,798,179"/>
<area shape="rect" title=" " alt="" coords="788,229,846,256"/>
<area shape="poly" title=" " alt="" coords="830,182,824,215,819,214,824,181"/>
<area shape="rect" title=" " alt="" coords="870,229,927,256"/>
<area shape="poly" title=" " alt="" coords="843,180,878,216,874,220,839,184"/>
<area shape="rect" title=" " alt="" coords="951,229,1011,256"/>
<area shape="poly" title=" " alt="" coords="857,179,942,220,940,225,855,184"/>
<area shape="poly" title=" " alt="" coords="878,176,891,179,1230,232,1229,237,890,184,878,182"/>
<area shape="rect" title=" " alt="" coords="1035,229,1090,256"/>
<area shape="poly" title=" " alt="" coords="871,179,1021,226,1020,231,869,185"/>
<area shape="rect" title=" " alt="" coords="708,229,764,256"/>
<area shape="poly" title=" " alt="" coords="815,184,765,222,762,218,811,180"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="tensor__io_8h__dep__incl.png" border="0" usemap="#ainclude_2tensor__io_8hdep" loading="lazy" alt=""/></div>
<map name="ainclude_2tensor__io_8hdep" id="ainclude_2tensor__io_8hdep">
<area shape="rect" title="I/O operations for tensors (save/load/print)." alt="" coords="5,5,136,32"/>
<area shape="rect" href="tensor__c_8cpp.html" title=" " alt="" coords="11,80,130,107"/>
<area shape="poly" title=" " alt="" coords="73,48,73,80,68,80,68,48"/>
</map>
</div>
</div>
<p><a href="tensor__io_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-typedef-members" class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ad5932a41b1e93b5b911a832051f7dc5d" id="r_ad5932a41b1e93b5b911a832051f7dc5d"><td class="memTemplParams" colspan="2">template&lt;typename T, size_t N&gt; </td></tr>
<tr class="memitem:ad5932a41b1e93b5b911a832051f7dc5d template"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad5932a41b1e93b5b911a832051f7dc5d">TensorIOResult</a> = std::variant&lt;<a class="el" href="classTensor.html">Tensor</a>&lt;T, N&gt;, <a class="el" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907">TensorIOError</a>&gt;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-enum-members" class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a599bba1630bf877790fe5fd1bc476f64" id="r_a599bba1630bf877790fe5fd1bc476f64"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a599bba1630bf877790fe5fd1bc476f64">TensorFileFormat</a> { <a class="el" href="#a599bba1630bf877790fe5fd1bc476f64a98ad0e8750ae10ad556ed7a62affb452">BINARY</a>
, <a class="el" href="#a599bba1630bf877790fe5fd1bc476f64a61a96ffcb251bb9bf0abf8fec19d0ea8">TEXT</a>
, <a class="el" href="#a599bba1630bf877790fe5fd1bc476f64a3af71770103369a2c46630b26aa8dcae">NPY</a>
 }</td></tr>
<tr class="memdesc:a599bba1630bf877790fe5fd1bc476f64"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> file format types.  <a href="#a599bba1630bf877790fe5fd1bc476f64">More...</a><br /></td></tr>
<tr class="memitem:a7a7b4b4c9dc2a7acfbcdbb53c08e8907" id="r_a7a7b4b4c9dc2a7acfbcdbb53c08e8907"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907">TensorIOError</a> { <br />
&#160;&#160;<a class="el" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907afb170ffea05221be6d4e256c6a5b0266">FILE_OPEN_FAILED</a>
, <a class="el" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907aa2ad53799b6678410eab18f554e548fc">FILE_READ_FAILED</a>
, <a class="el" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907a94a8336290023b80ea4e41118b98a814">FILE_WRITE_FAILED</a>
, <a class="el" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907a252d8e34178da47f2208605a66051241">INVALID_FORMAT</a>
, <br />
&#160;&#160;<a class="el" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907a1fb38e5a8e38d5c70d448277c3aa6670">DIMENSION_MISMATCH</a>
, <a class="el" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907a2f93918ef99e03b7b8e7230b2a28fb52">TYPE_MISMATCH</a>
<br />
 }</td></tr>
<tr class="memdesc:a7a7b4b4c9dc2a7acfbcdbb53c08e8907"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error types for I/O operations.  <a href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8141782719cc7c7dc60b3043bbbc5366" id="r_a8141782719cc7c7dc60b3043bbbc5366"><td class="memTemplParams" colspan="2">template&lt;typename T, size_t N&gt; </td></tr>
<tr class="memitem:a8141782719cc7c7dc60b3043bbbc5366 template"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8141782719cc7c7dc60b3043bbbc5366">save_binary</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;tensor, const std::string &amp;filename)</td></tr>
<tr class="memdesc:a8141782719cc7c7dc60b3043bbbc5366"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save a tensor to a file in binary format.  <br /></td></tr>
<tr class="memitem:a7e2cae1250696214044c322ac0bd4a1b" id="r_a7e2cae1250696214044c322ac0bd4a1b"><td class="memTemplParams" colspan="2">template&lt;typename T, size_t N&gt; </td></tr>
<tr class="memitem:a7e2cae1250696214044c322ac0bd4a1b template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="#ad5932a41b1e93b5b911a832051f7dc5d">TensorIOResult</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7e2cae1250696214044c322ac0bd4a1b">load_binary</a> (const std::string &amp;filename)</td></tr>
<tr class="memdesc:a7e2cae1250696214044c322ac0bd4a1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a tensor from a binary file.  <br /></td></tr>
<tr class="memitem:add21f5804707b520f88e074026b258b3" id="r_add21f5804707b520f88e074026b258b3"><td class="memTemplParams" colspan="2">template&lt;typename T, size_t N&gt; </td></tr>
<tr class="memitem:add21f5804707b520f88e074026b258b3 template"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#add21f5804707b520f88e074026b258b3">save_text</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;tensor, const std::string &amp;filename, int precision)</td></tr>
<tr class="memdesc:add21f5804707b520f88e074026b258b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save a tensor to a text file (CSV-like format).  <br /></td></tr>
<tr class="memitem:ac622682f190796d532e11f0c7b597aa0" id="r_ac622682f190796d532e11f0c7b597aa0"><td class="memTemplParams" colspan="2">template&lt;typename T, size_t N&gt; </td></tr>
<tr class="memitem:ac622682f190796d532e11f0c7b597aa0 template"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac622682f190796d532e11f0c7b597aa0">save_npy</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;tensor, const std::string &amp;filename)</td></tr>
<tr class="memdesc:ac622682f190796d532e11f0c7b597aa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save a tensor to NumPy .npy format (version 1.0).  <br /></td></tr>
<tr class="memitem:af1dee4960bb4ee62c02499855bb66a2d" id="r_af1dee4960bb4ee62c02499855bb66a2d"><td class="memTemplParams" colspan="2">template&lt;typename T, size_t N&gt; </td></tr>
<tr class="memitem:af1dee4960bb4ee62c02499855bb66a2d template"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af1dee4960bb4ee62c02499855bb66a2d">save</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;tensor, const std::string &amp;filename, <a class="el" href="#a599bba1630bf877790fe5fd1bc476f64">TensorFileFormat</a> format=<a class="el" href="#a599bba1630bf877790fe5fd1bc476f64a98ad0e8750ae10ad556ed7a62affb452">TensorFileFormat::BINARY</a>, int precision=6)</td></tr>
<tr class="memdesc:af1dee4960bb4ee62c02499855bb66a2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save a tensor to a file with specified format.  <br /></td></tr>
<tr class="memitem:ad797300c155fa720a2973a7d8e6d7e6b" id="r_ad797300c155fa720a2973a7d8e6d7e6b"><td class="memTemplParams" colspan="2">template&lt;typename T, size_t N&gt; </td></tr>
<tr class="memitem:ad797300c155fa720a2973a7d8e6d7e6b template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="#ad5932a41b1e93b5b911a832051f7dc5d">TensorIOResult</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad797300c155fa720a2973a7d8e6d7e6b">load</a> (const std::string &amp;filename)</td></tr>
<tr class="memdesc:ad797300c155fa720a2973a7d8e6d7e6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a tensor from a file (auto-detects format).  <br /></td></tr>
<tr class="memitem:ad4f347ce46aff75bdad7db7e7d7eabef" id="r_ad4f347ce46aff75bdad7db7e7d7eabef"><td class="memTemplParams" colspan="2">template&lt;typename T, size_t N&gt; </td></tr>
<tr class="memitem:ad4f347ce46aff75bdad7db7e7d7eabef template"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad4f347ce46aff75bdad7db7e7d7eabef">print</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;tensor, std::ostream &amp;os, int precision, size_t max_items, size_t line_width)</td></tr>
<tr class="memdesc:ad4f347ce46aff75bdad7db7e7d7eabef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pretty print a tensor with formatting options.  <br /></td></tr>
<tr class="memitem:a278d10cd95a2b11a414ecd8eda1b665e" id="r_a278d10cd95a2b11a414ecd8eda1b665e"><td class="memTemplParams" colspan="2">template&lt;typename T, size_t N&gt; </td></tr>
<tr class="memitem:a278d10cd95a2b11a414ecd8eda1b665e template"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a278d10cd95a2b11a414ecd8eda1b665e">to_string</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;tensor, int precision=4, size_t max_items=6)</td></tr>
<tr class="memdesc:a278d10cd95a2b11a414ecd8eda1b665e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert tensor to string representation.  <br /></td></tr>
<tr class="memitem:a9e03fa16492ffad78aee9cc9f84073d9" id="r_a9e03fa16492ffad78aee9cc9f84073d9"><td class="memTemplParams" colspan="2">template&lt;typename T, size_t N&gt; </td></tr>
<tr class="memitem:a9e03fa16492ffad78aee9cc9f84073d9 template"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9e03fa16492ffad78aee9cc9f84073d9">save_text_default</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;tensor, const std::string &amp;filename, int precision=6)</td></tr>
<tr class="memitem:a223dda8ee6a3e3344a59b4f0fe19df42" id="r_a223dda8ee6a3e3344a59b4f0fe19df42"><td class="memTemplParams" colspan="2">template&lt;typename T, size_t N&gt; </td></tr>
<tr class="memitem:a223dda8ee6a3e3344a59b4f0fe19df42 template"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a223dda8ee6a3e3344a59b4f0fe19df42">print_default</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;tensor, std::ostream &amp;os=std::cout, int precision=4, size_t max_items=6, size_t line_width=75)</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>I/O operations for tensors (save/load/print). </p>
<p>Provides functions to save and load tensors in various formats:</p><ul>
<li>Binary format (custom, efficient)</li>
<li>Text format (human-readable)</li>
<li>NPY format (NumPy-compatible)</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="example_io"></a>
Usage Example</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="tensor__io_8h.html">tensor_io.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classTensor.html">Tensor&lt;float, 2&gt;</a> matrix({3, 3});</div>
<div class="line">matrix.<a class="code hl_function" href="classTensor.html#a234f74cd16bd13561f7963ba29efb163">fill</a>(1.0f);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Save in binary format (fast, compact)</span></div>
<div class="line"><a class="code hl_function" href="#a8141782719cc7c7dc60b3043bbbc5366">save_binary</a>(matrix, <span class="stringliteral">&quot;data.tnsr&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Save in text format (human-readable)</span></div>
<div class="line"><a class="code hl_function" href="#add21f5804707b520f88e074026b258b3">save_text</a>(matrix, <span class="stringliteral">&quot;data.txt&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Save in NumPy format (Python interop)</span></div>
<div class="line"><a class="code hl_function" href="#ac622682f190796d532e11f0c7b597aa0">save_npy</a>(matrix, <span class="stringliteral">&quot;data.npy&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Load back</span></div>
<div class="line"><span class="keyword">auto</span> result = <a class="code hl_function" href="#a7e2cae1250696214044c322ac0bd4a1b">load_binary&lt;float, 2&gt;</a>(<span class="stringliteral">&quot;data.tnsr&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (std::holds_alternative&lt;<a class="code hl_class" href="classTensor.html">Tensor&lt;float, 2&gt;</a>&gt;(result)) {</div>
<div class="line">    <span class="keyword">auto</span>&amp; loaded = std::get&lt;Tensor&lt;float, 2&gt;&gt;(result);</div>
<div class="line">    <span class="comment">// Use loaded tensor</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassTensor_html"><div class="ttname"><a href="classTensor.html">Tensor</a></div><div class="ttdoc">Forward declaration for autograd.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00518">tensor.h:518</a></div></div>
<div class="ttc" id="aclassTensor_html_a234f74cd16bd13561f7963ba29efb163"><div class="ttname"><a href="classTensor.html#a234f74cd16bd13561f7963ba29efb163">Tensor::fill</a></div><div class="ttdeci">void fill(const T &amp;value)</div><div class="ttdoc">Fill the tensor with a specified value.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00842">tensor.h:842</a></div></div>
<div class="ttc" id="atensor__io_8h_html"><div class="ttname"><a href="tensor__io_8h.html">tensor_io.h</a></div><div class="ttdoc">I/O operations for tensors (save/load/print).</div></div>
<div class="ttc" id="atensor__io_8h_html_a7e2cae1250696214044c322ac0bd4a1b"><div class="ttname"><a href="#a7e2cae1250696214044c322ac0bd4a1b">load_binary</a></div><div class="ttdeci">TensorIOResult&lt; T, N &gt; load_binary(const std::string &amp;filename)</div><div class="ttdoc">Load a tensor from a binary file.</div><div class="ttdef"><b>Definition</b> <a href="tensor__io_8h_source.html#l00130">tensor_io.h:130</a></div></div>
<div class="ttc" id="atensor__io_8h_html_a8141782719cc7c7dc60b3043bbbc5366"><div class="ttname"><a href="#a8141782719cc7c7dc60b3043bbbc5366">save_binary</a></div><div class="ttdeci">bool save_binary(const Tensor&lt; T, N &gt; &amp;tensor, const std::string &amp;filename)</div><div class="ttdoc">Save a tensor to a file in binary format.</div><div class="ttdef"><b>Definition</b> <a href="tensor__io_8h_source.html#l00085">tensor_io.h:85</a></div></div>
<div class="ttc" id="atensor__io_8h_html_ac622682f190796d532e11f0c7b597aa0"><div class="ttname"><a href="#ac622682f190796d532e11f0c7b597aa0">save_npy</a></div><div class="ttdeci">bool save_npy(const Tensor&lt; T, N &gt; &amp;tensor, const std::string &amp;filename)</div><div class="ttdoc">Save a tensor to NumPy .npy format (version 1.0).</div><div class="ttdef"><b>Definition</b> <a href="tensor__io_8h_source.html#l00275">tensor_io.h:275</a></div></div>
<div class="ttc" id="atensor__io_8h_html_add21f5804707b520f88e074026b258b3"><div class="ttname"><a href="#add21f5804707b520f88e074026b258b3">save_text</a></div><div class="ttdeci">bool save_text(const Tensor&lt; T, N &gt; &amp;tensor, const std::string &amp;filename, int precision)</div><div class="ttdoc">Save a tensor to a text file (CSV-like format).</div><div class="ttdef"><b>Definition</b> <a href="tensor__io_8h_source.html#l00197">tensor_io.h:197</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition in file <a class="el" href="tensor__io_8h_source.html">tensor_io.h</a>.</p>
</div><a name="doc-typedef-members" id="doc-typedef-members"></a><h2 id="header-doc-typedef-members" class="groupheader">Typedef Documentation</h2>
<a id="ad5932a41b1e93b5b911a832051f7dc5d" name="ad5932a41b1e93b5b911a832051f7dc5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5932a41b1e93b5b911a832051f7dc5d">&#9670;&#160;</a></span>TensorIOResult</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="#ad5932a41b1e93b5b911a832051f7dc5d">TensorIOResult</a> = std::variant&lt;<a class="el" href="classTensor.html">Tensor</a>&lt;T, N&gt;, <a class="el" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907">TensorIOError</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor__io_8h_source.html#l00067">67</a> of file <a class="el" href="tensor__io_8h_source.html">tensor_io.h</a>.</p>

</div>
</div>
<a name="doc-enum-members" id="doc-enum-members"></a><h2 id="header-doc-enum-members" class="groupheader">Enumeration Type Documentation</h2>
<a id="a599bba1630bf877790fe5fd1bc476f64" name="a599bba1630bf877790fe5fd1bc476f64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a599bba1630bf877790fe5fd1bc476f64">&#9670;&#160;</a></span>TensorFileFormat</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="#a599bba1630bf877790fe5fd1bc476f64">TensorFileFormat</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel strong">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> file format types. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a599bba1630bf877790fe5fd1bc476f64a98ad0e8750ae10ad556ed7a62affb452" name="a599bba1630bf877790fe5fd1bc476f64a98ad0e8750ae10ad556ed7a62affb452"></a>BINARY&#160;</td><td class="fielddoc"><p>Binary format (raw data with header). </p>
</td></tr>
<tr><td class="fieldname"><a id="a599bba1630bf877790fe5fd1bc476f64a61a96ffcb251bb9bf0abf8fec19d0ea8" name="a599bba1630bf877790fe5fd1bc476f64a61a96ffcb251bb9bf0abf8fec19d0ea8"></a>TEXT&#160;</td><td class="fielddoc"><p>Human-readable text format. </p>
</td></tr>
<tr><td class="fieldname"><a id="a599bba1630bf877790fe5fd1bc476f64a3af71770103369a2c46630b26aa8dcae" name="a599bba1630bf877790fe5fd1bc476f64a3af71770103369a2c46630b26aa8dcae"></a>NPY&#160;</td><td class="fielddoc"><p>NumPy .npy format (compatible with numpy.save/numpy.load). </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="tensor__io_8h_source.html#l00048">48</a> of file <a class="el" href="tensor__io_8h_source.html">tensor_io.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   48</span>                            {</div>
<div class="line"><span class="lineno">   49</span>    <a class="code hl_enumvalue" href="#a599bba1630bf877790fe5fd1bc476f64a98ad0e8750ae10ad556ed7a62affb452">BINARY</a>,     </div>
<div class="line"><span class="lineno">   50</span>    <a class="code hl_enumvalue" href="#a599bba1630bf877790fe5fd1bc476f64a61a96ffcb251bb9bf0abf8fec19d0ea8">TEXT</a>,       </div>
<div class="line"><span class="lineno">   51</span>    <a class="code hl_enumvalue" href="#a599bba1630bf877790fe5fd1bc476f64a3af71770103369a2c46630b26aa8dcae">NPY</a>         </div>
<div class="line"><span class="lineno">   52</span>};</div>
<div class="ttc" id="atensor__io_8h_html_a599bba1630bf877790fe5fd1bc476f64a3af71770103369a2c46630b26aa8dcae"><div class="ttname"><a href="#a599bba1630bf877790fe5fd1bc476f64a3af71770103369a2c46630b26aa8dcae">TensorFileFormat::NPY</a></div><div class="ttdeci">@ NPY</div><div class="ttdoc">NumPy .npy format (compatible with numpy.save/numpy.load).</div><div class="ttdef"><b>Definition</b> <a href="tensor__io_8h_source.html#l00051">tensor_io.h:51</a></div></div>
<div class="ttc" id="atensor__io_8h_html_a599bba1630bf877790fe5fd1bc476f64a61a96ffcb251bb9bf0abf8fec19d0ea8"><div class="ttname"><a href="#a599bba1630bf877790fe5fd1bc476f64a61a96ffcb251bb9bf0abf8fec19d0ea8">TensorFileFormat::TEXT</a></div><div class="ttdeci">@ TEXT</div><div class="ttdoc">Human-readable text format.</div><div class="ttdef"><b>Definition</b> <a href="tensor__io_8h_source.html#l00050">tensor_io.h:50</a></div></div>
<div class="ttc" id="atensor__io_8h_html_a599bba1630bf877790fe5fd1bc476f64a98ad0e8750ae10ad556ed7a62affb452"><div class="ttname"><a href="#a599bba1630bf877790fe5fd1bc476f64a98ad0e8750ae10ad556ed7a62affb452">TensorFileFormat::BINARY</a></div><div class="ttdeci">@ BINARY</div><div class="ttdoc">Binary format (raw data with header).</div><div class="ttdef"><b>Definition</b> <a href="tensor__io_8h_source.html#l00049">tensor_io.h:49</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a7b4b4c9dc2a7acfbcdbb53c08e8907" name="a7a7b4b4c9dc2a7acfbcdbb53c08e8907"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907">&#9670;&#160;</a></span>TensorIOError</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907">TensorIOError</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel strong">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Error types for I/O operations. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a7a7b4b4c9dc2a7acfbcdbb53c08e8907afb170ffea05221be6d4e256c6a5b0266" name="a7a7b4b4c9dc2a7acfbcdbb53c08e8907afb170ffea05221be6d4e256c6a5b0266"></a>FILE_OPEN_FAILED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7a7b4b4c9dc2a7acfbcdbb53c08e8907aa2ad53799b6678410eab18f554e548fc" name="a7a7b4b4c9dc2a7acfbcdbb53c08e8907aa2ad53799b6678410eab18f554e548fc"></a>FILE_READ_FAILED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7a7b4b4c9dc2a7acfbcdbb53c08e8907a94a8336290023b80ea4e41118b98a814" name="a7a7b4b4c9dc2a7acfbcdbb53c08e8907a94a8336290023b80ea4e41118b98a814"></a>FILE_WRITE_FAILED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7a7b4b4c9dc2a7acfbcdbb53c08e8907a252d8e34178da47f2208605a66051241" name="a7a7b4b4c9dc2a7acfbcdbb53c08e8907a252d8e34178da47f2208605a66051241"></a>INVALID_FORMAT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7a7b4b4c9dc2a7acfbcdbb53c08e8907a1fb38e5a8e38d5c70d448277c3aa6670" name="a7a7b4b4c9dc2a7acfbcdbb53c08e8907a1fb38e5a8e38d5c70d448277c3aa6670"></a>DIMENSION_MISMATCH&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a7a7b4b4c9dc2a7acfbcdbb53c08e8907a2f93918ef99e03b7b8e7230b2a28fb52" name="a7a7b4b4c9dc2a7acfbcdbb53c08e8907a2f93918ef99e03b7b8e7230b2a28fb52"></a>TYPE_MISMATCH&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="tensor__io_8h_source.html#l00057">57</a> of file <a class="el" href="tensor__io_8h_source.html">tensor_io.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   57</span>                         {</div>
<div class="line"><span class="lineno">   58</span>    <a class="code hl_enumvalue" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907afb170ffea05221be6d4e256c6a5b0266">FILE_OPEN_FAILED</a>,</div>
<div class="line"><span class="lineno">   59</span>    <a class="code hl_enumvalue" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907aa2ad53799b6678410eab18f554e548fc">FILE_READ_FAILED</a>,</div>
<div class="line"><span class="lineno">   60</span>    <a class="code hl_enumvalue" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907a94a8336290023b80ea4e41118b98a814">FILE_WRITE_FAILED</a>,</div>
<div class="line"><span class="lineno">   61</span>    <a class="code hl_enumvalue" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907a252d8e34178da47f2208605a66051241">INVALID_FORMAT</a>,</div>
<div class="line"><span class="lineno">   62</span>    <a class="code hl_enumvalue" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907a1fb38e5a8e38d5c70d448277c3aa6670">DIMENSION_MISMATCH</a>,</div>
<div class="line"><span class="lineno">   63</span>    <a class="code hl_enumvalue" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907a2f93918ef99e03b7b8e7230b2a28fb52">TYPE_MISMATCH</a></div>
<div class="line"><span class="lineno">   64</span>};</div>
<div class="ttc" id="atensor__io_8h_html_a7a7b4b4c9dc2a7acfbcdbb53c08e8907a1fb38e5a8e38d5c70d448277c3aa6670"><div class="ttname"><a href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907a1fb38e5a8e38d5c70d448277c3aa6670">TensorIOError::DIMENSION_MISMATCH</a></div><div class="ttdeci">@ DIMENSION_MISMATCH</div><div class="ttdef"><b>Definition</b> <a href="tensor__io_8h_source.html#l00062">tensor_io.h:62</a></div></div>
<div class="ttc" id="atensor__io_8h_html_a7a7b4b4c9dc2a7acfbcdbb53c08e8907a252d8e34178da47f2208605a66051241"><div class="ttname"><a href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907a252d8e34178da47f2208605a66051241">TensorIOError::INVALID_FORMAT</a></div><div class="ttdeci">@ INVALID_FORMAT</div><div class="ttdef"><b>Definition</b> <a href="tensor__io_8h_source.html#l00061">tensor_io.h:61</a></div></div>
<div class="ttc" id="atensor__io_8h_html_a7a7b4b4c9dc2a7acfbcdbb53c08e8907a2f93918ef99e03b7b8e7230b2a28fb52"><div class="ttname"><a href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907a2f93918ef99e03b7b8e7230b2a28fb52">TensorIOError::TYPE_MISMATCH</a></div><div class="ttdeci">@ TYPE_MISMATCH</div><div class="ttdef"><b>Definition</b> <a href="tensor__io_8h_source.html#l00063">tensor_io.h:63</a></div></div>
<div class="ttc" id="atensor__io_8h_html_a7a7b4b4c9dc2a7acfbcdbb53c08e8907a94a8336290023b80ea4e41118b98a814"><div class="ttname"><a href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907a94a8336290023b80ea4e41118b98a814">TensorIOError::FILE_WRITE_FAILED</a></div><div class="ttdeci">@ FILE_WRITE_FAILED</div><div class="ttdef"><b>Definition</b> <a href="tensor__io_8h_source.html#l00060">tensor_io.h:60</a></div></div>
<div class="ttc" id="atensor__io_8h_html_a7a7b4b4c9dc2a7acfbcdbb53c08e8907aa2ad53799b6678410eab18f554e548fc"><div class="ttname"><a href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907aa2ad53799b6678410eab18f554e548fc">TensorIOError::FILE_READ_FAILED</a></div><div class="ttdeci">@ FILE_READ_FAILED</div><div class="ttdef"><b>Definition</b> <a href="tensor__io_8h_source.html#l00059">tensor_io.h:59</a></div></div>
<div class="ttc" id="atensor__io_8h_html_a7a7b4b4c9dc2a7acfbcdbb53c08e8907afb170ffea05221be6d4e256c6a5b0266"><div class="ttname"><a href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907afb170ffea05221be6d4e256c6a5b0266">TensorIOError::FILE_OPEN_FAILED</a></div><div class="ttdeci">@ FILE_OPEN_FAILED</div><div class="ttdef"><b>Definition</b> <a href="tensor__io_8h_source.html#l00058">tensor_io.h:58</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="ad797300c155fa720a2973a7d8e6d7e6b" name="ad797300c155fa720a2973a7d8e6d7e6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad797300c155fa720a2973a7d8e6d7e6b">&#9670;&#160;</a></span>load()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#ad5932a41b1e93b5b911a832051f7dc5d">TensorIOResult</a>&lt; T, N &gt; load </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>filename</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load a tensor from a file (auto-detects format). </p>
<p>Attempts to detect file format from magic bytes:</p><ul>
<li>"TNSR" -&gt; Binary format</li>
<li>0x93, "NUMPY" -&gt; NPY format</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>The input file path. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="#ad5932a41b1e93b5b911a832051f7dc5d">TensorIOResult</a> containing the loaded tensor or an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor__io_8h_source.html#l00381">381</a> of file <a class="el" href="tensor__io_8h_source.html">tensor_io.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  381</span>                                                     {</div>
<div class="line"><span class="lineno">  382</span>    std::ifstream file(filename, std::ios::binary);</div>
<div class="line"><span class="lineno">  383</span>    <span class="keywordflow">if</span> (!file.is_open()) {</div>
<div class="line"><span class="lineno">  384</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907afb170ffea05221be6d4e256c6a5b0266">TensorIOError::FILE_OPEN_FAILED</a>;</div>
<div class="line"><span class="lineno">  385</span>    }</div>
<div class="line"><span class="lineno">  386</span>    </div>
<div class="line"><span class="lineno">  387</span>    <span class="comment">// Read first few bytes to detect format</span></div>
<div class="line"><span class="lineno">  388</span>    <span class="keywordtype">char</span> magic[6];</div>
<div class="line"><span class="lineno">  389</span>    file.read(magic, 6);</div>
<div class="line"><span class="lineno">  390</span>    file.close();</div>
<div class="line"><span class="lineno">  391</span>    </div>
<div class="line"><span class="lineno">  392</span>    <span class="comment">// Check for TNSR binary format</span></div>
<div class="line"><span class="lineno">  393</span>    <span class="keywordflow">if</span> (magic[0] == <span class="charliteral">&#39;T&#39;</span> &amp;&amp; magic[1] == <span class="charliteral">&#39;N&#39;</span> &amp;&amp; magic[2] == <span class="charliteral">&#39;S&#39;</span> &amp;&amp; magic[3] == <span class="charliteral">&#39;R&#39;</span>) {</div>
<div class="line"><span class="lineno">  394</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a7e2cae1250696214044c322ac0bd4a1b">load_binary&lt;T, N&gt;</a>(filename);</div>
<div class="line"><span class="lineno">  395</span>    }</div>
<div class="line"><span class="lineno">  396</span>    </div>
<div class="line"><span class="lineno">  397</span>    <span class="comment">// Check for NPY format</span></div>
<div class="line"><span class="lineno">  398</span>    <span class="keywordflow">if</span> (magic[0] == (<span class="keywordtype">char</span>)0x93 &amp;&amp; magic[1] == <span class="charliteral">&#39;N&#39;</span> &amp;&amp; magic[2] == <span class="charliteral">&#39;U&#39;</span> &amp;&amp; </div>
<div class="line"><span class="lineno">  399</span>        magic[3] == <span class="charliteral">&#39;M&#39;</span> &amp;&amp; magic[4] == <span class="charliteral">&#39;P&#39;</span> &amp;&amp; magic[5] == <span class="charliteral">&#39;Y&#39;</span>) {</div>
<div class="line"><span class="lineno">  400</span>        <span class="comment">// NPY loading is complex, for now return error</span></div>
<div class="line"><span class="lineno">  401</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907a252d8e34178da47f2208605a66051241">TensorIOError::INVALID_FORMAT</a>;</div>
<div class="line"><span class="lineno">  402</span>    }</div>
<div class="line"><span class="lineno">  403</span>    </div>
<div class="line"><span class="lineno">  404</span>    <span class="comment">// Unknown format</span></div>
<div class="line"><span class="lineno">  405</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907a252d8e34178da47f2208605a66051241">TensorIOError::INVALID_FORMAT</a>;</div>
<div class="line"><span class="lineno">  406</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tensor__io_8h_ad797300c155fa720a2973a7d8e6d7e6b_cgraph.png" border="0" usemap="#atensor__io_8h_ad797300c155fa720a2973a7d8e6d7e6b_cgraph" loading="lazy" alt=""/></div>
<map name="atensor__io_8h_ad797300c155fa720a2973a7d8e6d7e6b_cgraph" id="atensor__io_8h_ad797300c155fa720a2973a7d8e6d7e6b_cgraph">
<area shape="rect" title="Load a tensor from a file (auto&#45;detects format)." alt="" coords="5,31,51,57"/>
<area shape="rect" href="tensor__io_8h.html#a7e2cae1250696214044c322ac0bd4a1b" title="Load a tensor from a binary file." alt="" coords="99,31,186,57"/>
<area shape="poly" title=" " alt="" coords="51,41,83,41,83,47,51,47"/>
<area shape="rect" href="classTensor.html#a07bf856a863505d2960b0bfad9c3b3f4" title=" " alt="" coords="250,5,343,32"/>
<area shape="poly" title=" " alt="" coords="186,34,234,26,235,31,187,39"/>
<area shape="rect" href="classTensor.html#aad6aeb4859940befd0c46f0b99388bd7" title=" " alt="" coords="234,56,358,83"/>
<area shape="poly" title=" " alt="" coords="187,49,219,54,218,59,186,54"/>
</map>
</div>

</div>
</div>
<a id="a7e2cae1250696214044c322ac0bd4a1b" name="a7e2cae1250696214044c322ac0bd4a1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e2cae1250696214044c322ac0bd4a1b">&#9670;&#160;</a></span>load_binary()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#ad5932a41b1e93b5b911a832051f7dc5d">TensorIOResult</a>&lt; T, N &gt; load_binary </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>filename</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load a tensor from a binary file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>The input file path. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="#ad5932a41b1e93b5b911a832051f7dc5d">TensorIOResult</a> containing the loaded tensor or an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor__io_8h_source.html#l00130">130</a> of file <a class="el" href="tensor__io_8h_source.html">tensor_io.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  130</span>                                                            {</div>
<div class="line"><span class="lineno">  131</span>    std::ifstream file(filename, std::ios::binary);</div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordflow">if</span> (!file.is_open()) {</div>
<div class="line"><span class="lineno">  133</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907afb170ffea05221be6d4e256c6a5b0266">TensorIOError::FILE_OPEN_FAILED</a>;</div>
<div class="line"><span class="lineno">  134</span>    }</div>
<div class="line"><span class="lineno">  135</span>    </div>
<div class="line"><span class="lineno">  136</span>    <span class="comment">// Read and verify magic number</span></div>
<div class="line"><span class="lineno">  137</span>    <span class="keywordtype">char</span> magic[4];</div>
<div class="line"><span class="lineno">  138</span>    file.read(magic, 4);</div>
<div class="line"><span class="lineno">  139</span>    <span class="keywordflow">if</span> (magic[0] != <span class="charliteral">&#39;T&#39;</span> || magic[1] != <span class="charliteral">&#39;N&#39;</span> || magic[2] != <span class="charliteral">&#39;S&#39;</span> || magic[3] != <span class="charliteral">&#39;R&#39;</span>) {</div>
<div class="line"><span class="lineno">  140</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907a252d8e34178da47f2208605a66051241">TensorIOError::INVALID_FORMAT</a>;</div>
<div class="line"><span class="lineno">  141</span>    }</div>
<div class="line"><span class="lineno">  142</span>    </div>
<div class="line"><span class="lineno">  143</span>    <span class="comment">// Read version</span></div>
<div class="line"><span class="lineno">  144</span>    uint32_t version;</div>
<div class="line"><span class="lineno">  145</span>    file.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;version), <span class="keyword">sizeof</span>(version));</div>
<div class="line"><span class="lineno">  146</span>    </div>
<div class="line"><span class="lineno">  147</span>    <span class="comment">// Read and verify type size</span></div>
<div class="line"><span class="lineno">  148</span>    uint32_t type_size;</div>
<div class="line"><span class="lineno">  149</span>    file.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;type_size), <span class="keyword">sizeof</span>(type_size));</div>
<div class="line"><span class="lineno">  150</span>    <span class="keywordflow">if</span> (type_size != <span class="keyword">sizeof</span>(T)) {</div>
<div class="line"><span class="lineno">  151</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907a2f93918ef99e03b7b8e7230b2a28fb52">TensorIOError::TYPE_MISMATCH</a>;</div>
<div class="line"><span class="lineno">  152</span>    }</div>
<div class="line"><span class="lineno">  153</span>    </div>
<div class="line"><span class="lineno">  154</span>    <span class="comment">// Read and verify rank</span></div>
<div class="line"><span class="lineno">  155</span>    uint32_t <a class="code hl_function" href="namespacelinalg.html#ad07d8335c6ed4ffb675492effc453771">rank</a>;</div>
<div class="line"><span class="lineno">  156</span>    file.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;rank), <span class="keyword">sizeof</span>(rank));</div>
<div class="line"><span class="lineno">  157</span>    <span class="keywordflow">if</span> (rank != N) {</div>
<div class="line"><span class="lineno">  158</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907a1fb38e5a8e38d5c70d448277c3aa6670">TensorIOError::DIMENSION_MISMATCH</a>;</div>
<div class="line"><span class="lineno">  159</span>    }</div>
<div class="line"><span class="lineno">  160</span>    </div>
<div class="line"><span class="lineno">  161</span>    <span class="comment">// Read dimensions</span></div>
<div class="line"><span class="lineno">  162</span>    std::array&lt;size_t, N&gt; dims;</div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; N; ++i) {</div>
<div class="line"><span class="lineno">  164</span>        uint64_t dim;</div>
<div class="line"><span class="lineno">  165</span>        file.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;dim), <span class="keyword">sizeof</span>(dim));</div>
<div class="line"><span class="lineno">  166</span>        dims[i] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(dim);</div>
<div class="line"><span class="lineno">  167</span>    }</div>
<div class="line"><span class="lineno">  168</span>    </div>
<div class="line"><span class="lineno">  169</span>    <span class="comment">// Create tensor</span></div>
<div class="line"><span class="lineno">  170</span>    <a class="code hl_class" href="classTensor.html">Tensor&lt;T, N&gt;</a> tensor(dims);</div>
<div class="line"><span class="lineno">  171</span>    </div>
<div class="line"><span class="lineno">  172</span>    <span class="comment">// Read data</span></div>
<div class="line"><span class="lineno">  173</span>    <span class="keywordtype">size_t</span> total = tensor.total_size();</div>
<div class="line"><span class="lineno">  174</span>    file.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(tensor.data()), total * <span class="keyword">sizeof</span>(T));</div>
<div class="line"><span class="lineno">  175</span>    </div>
<div class="line"><span class="lineno">  176</span>    <span class="keywordflow">if</span> (!file) {</div>
<div class="line"><span class="lineno">  177</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a7a7b4b4c9dc2a7acfbcdbb53c08e8907aa2ad53799b6678410eab18f554e548fc">TensorIOError::FILE_READ_FAILED</a>;</div>
<div class="line"><span class="lineno">  178</span>    }</div>
<div class="line"><span class="lineno">  179</span>    </div>
<div class="line"><span class="lineno">  180</span>    file.close();</div>
<div class="line"><span class="lineno">  181</span>    <span class="keywordflow">return</span> tensor;</div>
<div class="line"><span class="lineno">  182</span>}</div>
<div class="ttc" id="anamespacelinalg_html_ad07d8335c6ed4ffb675492effc453771"><div class="ttname"><a href="namespacelinalg.html#ad07d8335c6ed4ffb675492effc453771">linalg::rank</a></div><div class="ttdeci">size_t rank(const Matrix&lt; T &gt; &amp;mat, T tol=T(-1))</div><div class="ttdef"><b>Definition</b> <a href="linalg_8h_source.html#l00528">linalg.h:528</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tensor__io_8h_a7e2cae1250696214044c322ac0bd4a1b_cgraph.png" border="0" usemap="#atensor__io_8h_a7e2cae1250696214044c322ac0bd4a1b_cgraph" loading="lazy" alt=""/></div>
<map name="atensor__io_8h_a7e2cae1250696214044c322ac0bd4a1b_cgraph" id="atensor__io_8h_a7e2cae1250696214044c322ac0bd4a1b_cgraph">
<area shape="rect" title="Load a tensor from a binary file." alt="" coords="5,31,93,57"/>
<area shape="rect" href="classTensor.html#a07bf856a863505d2960b0bfad9c3b3f4" title=" " alt="" coords="156,5,250,32"/>
<area shape="poly" title=" " alt="" coords="93,34,140,26,141,31,94,39"/>
<area shape="rect" href="classTensor.html#aad6aeb4859940befd0c46f0b99388bd7" title=" " alt="" coords="141,56,265,83"/>
<area shape="poly" title=" " alt="" coords="94,49,126,54,125,59,93,54"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tensor__io_8h_a7e2cae1250696214044c322ac0bd4a1b_icgraph.png" border="0" usemap="#atensor__io_8h_a7e2cae1250696214044c322ac0bd4a1b_icgraph" loading="lazy" alt=""/></div>
<map name="atensor__io_8h_a7e2cae1250696214044c322ac0bd4a1b_icgraph" id="atensor__io_8h_a7e2cae1250696214044c322ac0bd4a1b_icgraph">
<area shape="rect" title="Load a tensor from a binary file." alt="" coords="187,107,274,133"/>
<area shape="rect" href="tensor__io_8h.html#ad797300c155fa720a2973a7d8e6d7e6b" title="Load a tensor from a file (auto&#45;detects format)." alt="" coords="49,5,95,32"/>
<area shape="poly" title=" " alt="" coords="203,98,173,71,137,46,94,27,96,23,140,42,176,67,206,94"/>
<area shape="rect" href="tensor__c_8cpp.html#a5593190a30886333c69f5323af1837d7" title=" " alt="" coords="5,56,139,83"/>
<area shape="poly" title=" " alt="" coords="171,104,115,86,117,81,173,99"/>
<area shape="rect" href="tensor__c_8cpp.html#ad4619644bf3a3c6782ca538baf857de2" title=" " alt="" coords="12,107,132,133"/>
<area shape="poly" title=" " alt="" coords="171,123,132,123,132,117,171,117"/>
<area shape="rect" href="tensor__c_8cpp.html#a48336469b05364f186cfb755e9a4b964" title=" " alt="" coords="5,157,139,184"/>
<area shape="poly" title=" " alt="" coords="173,141,117,159,115,154,171,136"/>
<area shape="rect" href="tensor__c_8cpp.html#aeb2b9f618f951ee364a412717a705231" title=" " alt="" coords="12,208,132,235"/>
<area shape="poly" title=" " alt="" coords="206,146,176,173,140,198,117,210,114,205,137,194,173,169,203,142"/>
</map>
</div>

</div>
</div>
<a id="ad4f347ce46aff75bdad7db7e7d7eabef" name="ad4f347ce46aff75bdad7db7e7d7eabef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4f347ce46aff75bdad7db7e7d7eabef">&#9670;&#160;</a></span>print()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void print </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream &amp;</td>          <td class="paramname"><span class="paramname"><em>os</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>precision</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>max_items</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>line_width</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pretty print a tensor with formatting options. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tensor</td><td>The tensor to print. </td></tr>
    <tr><td class="paramname">os</td><td>Output stream (default: std::cout). </td></tr>
    <tr><td class="paramname">precision</td><td>Number of decimal places (default: 4). </td></tr>
    <tr><td class="paramname">max_items</td><td>Maximum items to print per dimension (default: 6, 0 = all). </td></tr>
    <tr><td class="paramname">line_width</td><td>Maximum line width before wrapping (default: 75). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tensor__io_8h_source.html#l00418">418</a> of file <a class="el" href="tensor__io_8h_source.html">tensor_io.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  419</span>                                                               {</div>
<div class="line"><span class="lineno">  420</span>    os &lt;&lt; <span class="stringliteral">&quot;Tensor&lt;&quot;</span> &lt;&lt; <span class="keyword">typeid</span>(T).name() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; N &lt;&lt; <span class="stringliteral">&quot;&gt;(&quot;</span>;</div>
<div class="line"><span class="lineno">  421</span>    </div>
<div class="line"><span class="lineno">  422</span>    <span class="keyword">auto</span> dims = tensor.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  423</span>    os &lt;&lt; <span class="stringliteral">&quot;shape=[&quot;</span>;</div>
<div class="line"><span class="lineno">  424</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; N; ++i) {</div>
<div class="line"><span class="lineno">  425</span>        <span class="keywordflow">if</span> (i &gt; 0) os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><span class="lineno">  426</span>        os &lt;&lt; dims[i];</div>
<div class="line"><span class="lineno">  427</span>    }</div>
<div class="line"><span class="lineno">  428</span>    os &lt;&lt; <span class="stringliteral">&quot;])\n&quot;</span>;</div>
<div class="line"><span class="lineno">  429</span>    </div>
<div class="line"><span class="lineno">  430</span>    os &lt;&lt; std::fixed &lt;&lt; std::setprecision(precision);</div>
<div class="line"><span class="lineno">  431</span>    </div>
<div class="line"><span class="lineno">  432</span>    <span class="keyword">const</span> T* data = tensor.<a class="code hl_function" href="classTensor.html#a07bf856a863505d2960b0bfad9c3b3f4">data</a>();</div>
<div class="line"><span class="lineno">  433</span>    <span class="keywordtype">size_t</span> total = tensor.<a class="code hl_function" href="classTensor.html#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno">  434</span>    </div>
<div class="line"><span class="lineno">  435</span>    <span class="keywordflow">if</span> (N == 1) {</div>
<div class="line"><span class="lineno">  436</span>        <span class="comment">// 1D tensor</span></div>
<div class="line"><span class="lineno">  437</span>        os &lt;&lt; <span class="stringliteral">&quot;[&quot;</span>;</div>
<div class="line"><span class="lineno">  438</span>        <span class="keywordtype">size_t</span> limit = (max_items &gt; 0 &amp;&amp; dims[0] &gt; max_items) ? max_items / 2 : dims[0];</div>
<div class="line"><span class="lineno">  439</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; limit; ++i) {</div>
<div class="line"><span class="lineno">  440</span>            <span class="keywordflow">if</span> (i &gt; 0) os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><span class="lineno">  441</span>            os &lt;&lt; data[i];</div>
<div class="line"><span class="lineno">  442</span>        }</div>
<div class="line"><span class="lineno">  443</span>        <span class="keywordflow">if</span> (max_items &gt; 0 &amp;&amp; dims[0] &gt; max_items) {</div>
<div class="line"><span class="lineno">  444</span>            os &lt;&lt; <span class="stringliteral">&quot;, ..., &quot;</span>;</div>
<div class="line"><span class="lineno">  445</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = dims[0] - max_items / 2; i &lt; dims[0]; ++i) {</div>
<div class="line"><span class="lineno">  446</span>                <span class="keywordflow">if</span> (i &gt; dims[0] - max_items / 2) os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><span class="lineno">  447</span>                os &lt;&lt; data[i];</div>
<div class="line"><span class="lineno">  448</span>            }</div>
<div class="line"><span class="lineno">  449</span>        }</div>
<div class="line"><span class="lineno">  450</span>        os &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>;</div>
<div class="line"><span class="lineno">  451</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N == 2) {</div>
<div class="line"><span class="lineno">  452</span>        <span class="comment">// 2D tensor (matrix)</span></div>
<div class="line"><span class="lineno">  453</span>        os &lt;&lt; <span class="stringliteral">&quot;[&quot;</span>;</div>
<div class="line"><span class="lineno">  454</span>        <span class="keywordtype">size_t</span> row_limit = (max_items &gt; 0 &amp;&amp; dims[0] &gt; max_items) ? max_items / 2 : dims[0];</div>
<div class="line"><span class="lineno">  455</span>        <span class="keywordtype">size_t</span> col_limit = (max_items &gt; 0 &amp;&amp; dims[1] &gt; max_items) ? max_items / 2 : dims[1];</div>
<div class="line"><span class="lineno">  456</span>        </div>
<div class="line"><span class="lineno">  457</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; row_limit; ++i) {</div>
<div class="line"><span class="lineno">  458</span>            <span class="keywordflow">if</span> (i &gt; 0) os &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><span class="lineno">  459</span>            os &lt;&lt; <span class="stringliteral">&quot;[&quot;</span>;</div>
<div class="line"><span class="lineno">  460</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; col_limit; ++j) {</div>
<div class="line"><span class="lineno">  461</span>                <span class="keywordflow">if</span> (j &gt; 0) os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><span class="lineno">  462</span>                os &lt;&lt; std::setw(precision + 3) &lt;&lt; data[i * dims[1] + j];</div>
<div class="line"><span class="lineno">  463</span>            }</div>
<div class="line"><span class="lineno">  464</span>            <span class="keywordflow">if</span> (max_items &gt; 0 &amp;&amp; dims[1] &gt; max_items) {</div>
<div class="line"><span class="lineno">  465</span>                os &lt;&lt; <span class="stringliteral">&quot;, ..., &quot;</span>;</div>
<div class="line"><span class="lineno">  466</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = dims[1] - max_items / 2; j &lt; dims[1]; ++j) {</div>
<div class="line"><span class="lineno">  467</span>                    <span class="keywordflow">if</span> (j &gt; dims[1] - max_items / 2) os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><span class="lineno">  468</span>                    os &lt;&lt; std::setw(precision + 3) &lt;&lt; data[i * dims[1] + j];</div>
<div class="line"><span class="lineno">  469</span>                }</div>
<div class="line"><span class="lineno">  470</span>            }</div>
<div class="line"><span class="lineno">  471</span>            os &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><span class="lineno">  472</span>            <span class="keywordflow">if</span> (i &lt; row_limit - 1 || (max_items &gt; 0 &amp;&amp; dims[0] &gt; max_items)) {</div>
<div class="line"><span class="lineno">  473</span>                os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  474</span>            }</div>
<div class="line"><span class="lineno">  475</span>        }</div>
<div class="line"><span class="lineno">  476</span>        </div>
<div class="line"><span class="lineno">  477</span>        <span class="keywordflow">if</span> (max_items &gt; 0 &amp;&amp; dims[0] &gt; max_items) {</div>
<div class="line"><span class="lineno">  478</span>            os &lt;&lt; <span class="stringliteral">&quot; ...\n&quot;</span>;</div>
<div class="line"><span class="lineno">  479</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = dims[0] - max_items / 2; i &lt; dims[0]; ++i) {</div>
<div class="line"><span class="lineno">  480</span>                os &lt;&lt; <span class="stringliteral">&quot; [&quot;</span>;</div>
<div class="line"><span class="lineno">  481</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; col_limit; ++j) {</div>
<div class="line"><span class="lineno">  482</span>                    <span class="keywordflow">if</span> (j &gt; 0) os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><span class="lineno">  483</span>                    os &lt;&lt; std::setw(precision + 3) &lt;&lt; data[i * dims[1] + j];</div>
<div class="line"><span class="lineno">  484</span>                }</div>
<div class="line"><span class="lineno">  485</span>                <span class="keywordflow">if</span> (max_items &gt; 0 &amp;&amp; dims[1] &gt; max_items) {</div>
<div class="line"><span class="lineno">  486</span>                    os &lt;&lt; <span class="stringliteral">&quot;, ..., &quot;</span>;</div>
<div class="line"><span class="lineno">  487</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = dims[1] - max_items / 2; j &lt; dims[1]; ++j) {</div>
<div class="line"><span class="lineno">  488</span>                        <span class="keywordflow">if</span> (j &gt; dims[1] - max_items / 2) os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><span class="lineno">  489</span>                        os &lt;&lt; std::setw(precision + 3) &lt;&lt; data[i * dims[1] + j];</div>
<div class="line"><span class="lineno">  490</span>                    }</div>
<div class="line"><span class="lineno">  491</span>                }</div>
<div class="line"><span class="lineno">  492</span>                os &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><span class="lineno">  493</span>                <span class="keywordflow">if</span> (i &lt; dims[0] - 1) os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  494</span>            }</div>
<div class="line"><span class="lineno">  495</span>        }</div>
<div class="line"><span class="lineno">  496</span>        os &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>;</div>
<div class="line"><span class="lineno">  497</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  498</span>        <span class="comment">// Higher dimensional tensors: show first and last few elements</span></div>
<div class="line"><span class="lineno">  499</span>        os &lt;&lt; <span class="stringliteral">&quot;[...] (&quot;</span>;</div>
<div class="line"><span class="lineno">  500</span>        <span class="keywordflow">if</span> (max_items &gt; 0 &amp;&amp; total &gt; max_items) {</div>
<div class="line"><span class="lineno">  501</span>            os &lt;&lt; <span class="stringliteral">&quot;showing first &quot;</span> &lt;&lt; max_items / 2 &lt;&lt; <span class="stringliteral">&quot; and last &quot;</span> &lt;&lt; max_items / 2 &lt;&lt; <span class="stringliteral">&quot; of &quot;</span> &lt;&lt; total &lt;&lt; <span class="stringliteral">&quot; elements)\n[&quot;</span>;</div>
<div class="line"><span class="lineno">  502</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; max_items / 2; ++i) {</div>
<div class="line"><span class="lineno">  503</span>                <span class="keywordflow">if</span> (i &gt; 0) os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><span class="lineno">  504</span>                os &lt;&lt; data[i];</div>
<div class="line"><span class="lineno">  505</span>            }</div>
<div class="line"><span class="lineno">  506</span>            os &lt;&lt; <span class="stringliteral">&quot;, ..., &quot;</span>;</div>
<div class="line"><span class="lineno">  507</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = total - max_items / 2; i &lt; total; ++i) {</div>
<div class="line"><span class="lineno">  508</span>                <span class="keywordflow">if</span> (i &gt; total - max_items / 2) os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><span class="lineno">  509</span>                os &lt;&lt; data[i];</div>
<div class="line"><span class="lineno">  510</span>            }</div>
<div class="line"><span class="lineno">  511</span>            os &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>;</div>
<div class="line"><span class="lineno">  512</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  513</span>            os &lt;&lt; <span class="stringliteral">&quot;all &quot;</span> &lt;&lt; total &lt;&lt; <span class="stringliteral">&quot; elements)\n[&quot;</span>;</div>
<div class="line"><span class="lineno">  514</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; total; ++i) {</div>
<div class="line"><span class="lineno">  515</span>                <span class="keywordflow">if</span> (i &gt; 0) os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><span class="lineno">  516</span>                os &lt;&lt; data[i];</div>
<div class="line"><span class="lineno">  517</span>            }</div>
<div class="line"><span class="lineno">  518</span>            os &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>;</div>
<div class="line"><span class="lineno">  519</span>        }</div>
<div class="line"><span class="lineno">  520</span>    }</div>
<div class="line"><span class="lineno">  521</span>}</div>
<div class="ttc" id="aclassTensor_html_a03d314303958ffc5644796d8025cd012"><div class="ttname"><a href="classTensor.html#a03d314303958ffc5644796d8025cd012">Tensor::dims</a></div><div class="ttdeci">TensorIndices&lt; N &gt; dims() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00854">tensor.h:854</a></div></div>
<div class="ttc" id="aclassTensor_html_a07bf856a863505d2960b0bfad9c3b3f4"><div class="ttname"><a href="classTensor.html#a07bf856a863505d2960b0bfad9c3b3f4">Tensor::data</a></div><div class="ttdeci">const T * data() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00665">tensor.h:665</a></div></div>
<div class="ttc" id="aclassTensor_html_aad6aeb4859940befd0c46f0b99388bd7"><div class="ttname"><a href="classTensor.html#aad6aeb4859940befd0c46f0b99388bd7">Tensor::total_size</a></div><div class="ttdeci">size_t total_size() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00653">tensor.h:653</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tensor__io_8h_ad4f347ce46aff75bdad7db7e7d7eabef_cgraph.png" border="0" usemap="#atensor__io_8h_ad4f347ce46aff75bdad7db7e7d7eabef_cgraph" loading="lazy" alt=""/></div>
<map name="atensor__io_8h_ad4f347ce46aff75bdad7db7e7d7eabef_cgraph" id="atensor__io_8h_ad4f347ce46aff75bdad7db7e7d7eabef_cgraph">
<area shape="rect" title="Pretty print a tensor with formatting options." alt="" coords="5,56,52,83"/>
<area shape="rect" href="classTensor.html#a07bf856a863505d2960b0bfad9c3b3f4" title=" " alt="" coords="115,5,208,32"/>
<area shape="poly" title=" " alt="" coords="51,58,110,36,112,40,53,63"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="114,56,210,83"/>
<area shape="poly" title=" " alt="" coords="52,67,98,67,98,72,52,72"/>
<area shape="rect" href="classTensor.html#aad6aeb4859940befd0c46f0b99388bd7" title=" " alt="" coords="100,107,224,133"/>
<area shape="poly" title=" " alt="" coords="53,75,112,98,110,103,51,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tensor__io_8h_ad4f347ce46aff75bdad7db7e7d7eabef_icgraph.png" border="0" usemap="#atensor__io_8h_ad4f347ce46aff75bdad7db7e7d7eabef_icgraph" loading="lazy" alt=""/></div>
<map name="atensor__io_8h_ad4f347ce46aff75bdad7db7e7d7eabef_icgraph" id="atensor__io_8h_ad4f347ce46aff75bdad7db7e7d7eabef_icgraph">
<area shape="rect" title="Pretty print a tensor with formatting options." alt="" coords="146,31,192,57"/>
<area shape="rect" href="tensor__io_8h.html#a223dda8ee6a3e3344a59b4f0fe19df42" title=" " alt="" coords="5,5,98,32"/>
<area shape="poly" title=" " alt="" coords="130,38,98,31,99,26,131,33"/>
<area shape="rect" href="tensor__io_8h.html#a278d10cd95a2b11a414ecd8eda1b665e" title="Convert tensor to string representation." alt="" coords="16,56,87,83"/>
<area shape="poly" title=" " alt="" coords="131,55,88,64,87,59,130,50"/>
</map>
</div>

</div>
</div>
<a id="a223dda8ee6a3e3344a59b4f0fe19df42" name="a223dda8ee6a3e3344a59b4f0fe19df42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a223dda8ee6a3e3344a59b4f0fe19df42">&#9670;&#160;</a></span>print_default()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void print_default </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream &amp;</td>          <td class="paramname"><span class="paramname"><em>os</em></span><span class="paramdefsep"> = </span><span class="paramdefval">std::cout</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>precision</em></span><span class="paramdefsep"> = </span><span class="paramdefval">4</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>max_items</em></span><span class="paramdefsep"> = </span><span class="paramdefval">6</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>line_width</em></span><span class="paramdefsep"> = </span><span class="paramdefval">75</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor__io_8h_source.html#l00545">545</a> of file <a class="el" href="tensor__io_8h_source.html">tensor_io.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  546</span>                                                                                    {</div>
<div class="line"><span class="lineno">  547</span>    <a class="code hl_function" href="#ad4f347ce46aff75bdad7db7e7d7eabef">print</a>(tensor, os, precision, max_items, line_width);</div>
<div class="line"><span class="lineno">  548</span>}</div>
<div class="ttc" id="atensor__io_8h_html_ad4f347ce46aff75bdad7db7e7d7eabef"><div class="ttname"><a href="#ad4f347ce46aff75bdad7db7e7d7eabef">print</a></div><div class="ttdeci">void print(const Tensor&lt; T, N &gt; &amp;tensor, std::ostream &amp;os, int precision, size_t max_items, size_t line_width)</div><div class="ttdoc">Pretty print a tensor with formatting options.</div><div class="ttdef"><b>Definition</b> <a href="tensor__io_8h_source.html#l00418">tensor_io.h:418</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tensor__io_8h_a223dda8ee6a3e3344a59b4f0fe19df42_cgraph.png" border="0" usemap="#atensor__io_8h_a223dda8ee6a3e3344a59b4f0fe19df42_cgraph" loading="lazy" alt=""/></div>
<map name="atensor__io_8h_a223dda8ee6a3e3344a59b4f0fe19df42_cgraph" id="atensor__io_8h_a223dda8ee6a3e3344a59b4f0fe19df42_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,98,83"/>
<area shape="rect" href="tensor__io_8h.html#ad4f347ce46aff75bdad7db7e7d7eabef" title="Pretty print a tensor with formatting options." alt="" coords="146,56,192,83"/>
<area shape="poly" title=" " alt="" coords="98,67,130,67,130,72,98,72"/>
<area shape="rect" href="classTensor.html#a07bf856a863505d2960b0bfad9c3b3f4" title=" " alt="" coords="256,5,349,32"/>
<area shape="poly" title=" " alt="" coords="191,58,250,36,252,40,193,63"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="254,56,350,83"/>
<area shape="poly" title=" " alt="" coords="192,67,239,67,239,72,192,72"/>
<area shape="rect" href="classTensor.html#aad6aeb4859940befd0c46f0b99388bd7" title=" " alt="" coords="240,107,364,133"/>
<area shape="poly" title=" " alt="" coords="193,75,252,98,250,103,191,80"/>
</map>
</div>

</div>
</div>
<a id="af1dee4960bb4ee62c02499855bb66a2d" name="af1dee4960bb4ee62c02499855bb66a2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1dee4960bb4ee62c02499855bb66a2d">&#9670;&#160;</a></span>save()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool save </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>filename</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a599bba1630bf877790fe5fd1bc476f64">TensorFileFormat</a></td>          <td class="paramname"><span class="paramname"><em>format</em></span><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="#a599bba1630bf877790fe5fd1bc476f64a98ad0e8750ae10ad556ed7a62affb452">TensorFileFormat::BINARY</a></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>precision</em></span><span class="paramdefsep"> = </span><span class="paramdefval">6</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save a tensor to a file with specified format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tensor</td><td>The tensor to save. </td></tr>
    <tr><td class="paramname">filename</td><td>The output file path. </td></tr>
    <tr><td class="paramname">format</td><td>The file format (default: BINARY). </td></tr>
    <tr><td class="paramname">precision</td><td>For text format, number of decimal places (default: 6). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true on success, false on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor__io_8h_source.html#l00356">356</a> of file <a class="el" href="tensor__io_8h_source.html">tensor_io.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  357</span>                                                                               {</div>
<div class="line"><span class="lineno">  358</span>    <span class="keywordflow">switch</span> (format) {</div>
<div class="line"><span class="lineno">  359</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a599bba1630bf877790fe5fd1bc476f64a98ad0e8750ae10ad556ed7a62affb452">TensorFileFormat::BINARY</a>:</div>
<div class="line"><span class="lineno">  360</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="#a8141782719cc7c7dc60b3043bbbc5366">save_binary</a>(tensor, filename);</div>
<div class="line"><span class="lineno">  361</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a599bba1630bf877790fe5fd1bc476f64a61a96ffcb251bb9bf0abf8fec19d0ea8">TensorFileFormat::TEXT</a>:</div>
<div class="line"><span class="lineno">  362</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="#add21f5804707b520f88e074026b258b3">save_text</a>(tensor, filename, precision);</div>
<div class="line"><span class="lineno">  363</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a599bba1630bf877790fe5fd1bc476f64a3af71770103369a2c46630b26aa8dcae">TensorFileFormat::NPY</a>:</div>
<div class="line"><span class="lineno">  364</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="#ac622682f190796d532e11f0c7b597aa0">save_npy</a>(tensor, filename);</div>
<div class="line"><span class="lineno">  365</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  366</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  367</span>    }</div>
<div class="line"><span class="lineno">  368</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tensor__io_8h_af1dee4960bb4ee62c02499855bb66a2d_cgraph.png" border="0" usemap="#atensor__io_8h_af1dee4960bb4ee62c02499855bb66a2d_cgraph" loading="lazy" alt=""/></div>
<map name="atensor__io_8h_af1dee4960bb4ee62c02499855bb66a2d_cgraph" id="atensor__io_8h_af1dee4960bb4ee62c02499855bb66a2d_cgraph">
<area shape="rect" title="Save a tensor to a file with specified format." alt="" coords="5,56,55,83"/>
<area shape="rect" href="tensor__io_8h.html#a8141782719cc7c7dc60b3043bbbc5366" title="Save a tensor to a file in binary format." alt="" coords="103,5,194,32"/>
<area shape="poly" title=" " alt="" coords="54,56,100,36,102,41,56,61"/>
<area shape="rect" href="tensor__io_8h.html#ac622682f190796d532e11f0c7b597aa0" title="Save a tensor to NumPy .npy format (version 1.0)." alt="" coords="110,56,187,83"/>
<area shape="poly" title=" " alt="" coords="55,67,94,67,94,72,55,72"/>
<area shape="rect" href="tensor__io_8h.html#add21f5804707b520f88e074026b258b3" title="Save a tensor to a text file (CSV&#45;like format)." alt="" coords="109,107,188,133"/>
<area shape="poly" title=" " alt="" coords="56,77,102,98,100,102,54,82"/>
<area shape="rect" href="classTensor.html#a07bf856a863505d2960b0bfad9c3b3f4" title=" " alt="" coords="258,5,351,32"/>
<area shape="poly" title=" " alt="" coords="194,16,242,16,242,21,194,21"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="256,56,352,83"/>
<area shape="poly" title=" " alt="" coords="193,30,247,48,246,53,191,35"/>
<area shape="rect" href="classTensor.html#aad6aeb4859940befd0c46f0b99388bd7" title=" " alt="" coords="242,107,366,133"/>
<area shape="poly" title=" " alt="" coords="178,30,196,42,220,68,229,80,244,93,251,97,248,102,240,97,225,84,216,72,192,46,175,35"/>
<area shape="poly" title=" " alt="" coords="187,54,245,35,247,40,188,59"/>
<area shape="poly" title=" " alt="" coords="188,67,240,67,240,72,188,72"/>
<area shape="poly" title=" " alt="" coords="188,79,247,99,245,104,187,84"/>
<area shape="poly" title=" " alt="" coords="175,104,192,93,216,67,225,55,240,42,248,37,251,42,244,46,229,59,220,70,196,97,178,108"/>
<area shape="poly" title=" " alt="" coords="187,105,246,85,247,91,189,110"/>
<area shape="poly" title=" " alt="" coords="188,117,227,117,227,123,188,123"/>
</map>
</div>

</div>
</div>
<a id="a8141782719cc7c7dc60b3043bbbc5366" name="a8141782719cc7c7dc60b3043bbbc5366"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8141782719cc7c7dc60b3043bbbc5366">&#9670;&#160;</a></span>save_binary()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool save_binary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>filename</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save a tensor to a file in binary format. </p>
<p>Binary format structure:</p><ul>
<li>Magic number (4 bytes): "TNSR"</li>
<li>Version (4 bytes): format version</li>
<li>Type size (4 bytes): sizeof(T)</li>
<li>Rank (4 bytes): N (number of dimensions)</li>
<li>Dimensions (N * 8 bytes): size_t for each dimension</li>
<li>Data (total_size * sizeof(T) bytes): raw tensor data</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tensor</td><td>The tensor to save. </td></tr>
    <tr><td class="paramname">filename</td><td>The output file path. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true on success, false on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor__io_8h_source.html#l00085">85</a> of file <a class="el" href="tensor__io_8h_source.html">tensor_io.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   85</span>                                                                        {</div>
<div class="line"><span class="lineno">   86</span>    std::ofstream file(filename, std::ios::binary);</div>
<div class="line"><span class="lineno">   87</span>    <span class="keywordflow">if</span> (!file.is_open()) {</div>
<div class="line"><span class="lineno">   88</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   89</span>    }</div>
<div class="line"><span class="lineno">   90</span>    </div>
<div class="line"><span class="lineno">   91</span>    <span class="comment">// Write magic number</span></div>
<div class="line"><span class="lineno">   92</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> magic[4] = {<span class="charliteral">&#39;T&#39;</span>, <span class="charliteral">&#39;N&#39;</span>, <span class="charliteral">&#39;S&#39;</span>, <span class="charliteral">&#39;R&#39;</span>};</div>
<div class="line"><span class="lineno">   93</span>    file.write(magic, 4);</div>
<div class="line"><span class="lineno">   94</span>    </div>
<div class="line"><span class="lineno">   95</span>    <span class="comment">// Write version</span></div>
<div class="line"><span class="lineno">   96</span>    uint32_t version = 1;</div>
<div class="line"><span class="lineno">   97</span>    file.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;version), <span class="keyword">sizeof</span>(version));</div>
<div class="line"><span class="lineno">   98</span>    </div>
<div class="line"><span class="lineno">   99</span>    <span class="comment">// Write type size</span></div>
<div class="line"><span class="lineno">  100</span>    uint32_t type_size = <span class="keyword">sizeof</span>(T);</div>
<div class="line"><span class="lineno">  101</span>    file.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;type_size), <span class="keyword">sizeof</span>(type_size));</div>
<div class="line"><span class="lineno">  102</span>    </div>
<div class="line"><span class="lineno">  103</span>    <span class="comment">// Write rank</span></div>
<div class="line"><span class="lineno">  104</span>    uint32_t <a class="code hl_function" href="namespacelinalg.html#ad07d8335c6ed4ffb675492effc453771">rank</a> = N;</div>
<div class="line"><span class="lineno">  105</span>    file.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;rank), <span class="keyword">sizeof</span>(rank));</div>
<div class="line"><span class="lineno">  106</span>    </div>
<div class="line"><span class="lineno">  107</span>    <span class="comment">// Write dimensions</span></div>
<div class="line"><span class="lineno">  108</span>    <span class="keyword">auto</span> dims = tensor.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  109</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; N; ++i) {</div>
<div class="line"><span class="lineno">  110</span>        uint64_t dim = dims[i];</div>
<div class="line"><span class="lineno">  111</span>        file.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;dim), <span class="keyword">sizeof</span>(dim));</div>
<div class="line"><span class="lineno">  112</span>    }</div>
<div class="line"><span class="lineno">  113</span>    </div>
<div class="line"><span class="lineno">  114</span>    <span class="comment">// Write data</span></div>
<div class="line"><span class="lineno">  115</span>    <span class="keywordtype">size_t</span> total = tensor.<a class="code hl_function" href="classTensor.html#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno">  116</span>    <span class="keyword">const</span> T* data = tensor.<a class="code hl_function" href="classTensor.html#a07bf856a863505d2960b0bfad9c3b3f4">data</a>();</div>
<div class="line"><span class="lineno">  117</span>    file.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(data), total * <span class="keyword">sizeof</span>(T));</div>
<div class="line"><span class="lineno">  118</span>    </div>
<div class="line"><span class="lineno">  119</span>    file.close();</div>
<div class="line"><span class="lineno">  120</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  121</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tensor__io_8h_a8141782719cc7c7dc60b3043bbbc5366_cgraph.png" border="0" usemap="#atensor__io_8h_a8141782719cc7c7dc60b3043bbbc5366_cgraph" loading="lazy" alt=""/></div>
<map name="atensor__io_8h_a8141782719cc7c7dc60b3043bbbc5366_cgraph" id="atensor__io_8h_a8141782719cc7c7dc60b3043bbbc5366_cgraph">
<area shape="rect" title="Save a tensor to a file in binary format." alt="" coords="5,56,97,83"/>
<area shape="rect" href="classTensor.html#a07bf856a863505d2960b0bfad9c3b3f4" title=" " alt="" coords="160,5,254,32"/>
<area shape="poly" title=" " alt="" coords="94,53,148,35,150,40,95,58"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="159,56,255,83"/>
<area shape="poly" title=" " alt="" coords="97,67,143,67,143,72,97,72"/>
<area shape="rect" href="classTensor.html#aad6aeb4859940befd0c46f0b99388bd7" title=" " alt="" coords="145,107,269,133"/>
<area shape="poly" title=" " alt="" coords="95,81,150,99,148,104,94,86"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tensor__io_8h_a8141782719cc7c7dc60b3043bbbc5366_icgraph.png" border="0" usemap="#atensor__io_8h_a8141782719cc7c7dc60b3043bbbc5366_icgraph" loading="lazy" alt=""/></div>
<map name="atensor__io_8h_a8141782719cc7c7dc60b3043bbbc5366_icgraph" id="atensor__io_8h_a8141782719cc7c7dc60b3043bbbc5366_icgraph">
<area shape="rect" title="Save a tensor to a file in binary format." alt="" coords="191,107,282,133"/>
<area shape="rect" href="tensor__c_8cpp.html#a6bcb6552c10a49c900c884bc90502f18" title=" " alt="" coords="5,5,143,32"/>
<area shape="poly" title=" " alt="" coords="208,98,177,71,141,46,118,35,120,30,144,42,181,67,212,94"/>
<area shape="rect" href="tensor__c_8cpp.html#a5f089dd07835b1e12bace4400085be22" title=" " alt="" coords="12,56,136,83"/>
<area shape="poly" title=" " alt="" coords="176,104,118,86,120,81,178,99"/>
<area shape="rect" href="tensor__io_8h.html#af1dee4960bb4ee62c02499855bb66a2d" title="Save a tensor to a file with specified format." alt="" coords="49,107,99,133"/>
<area shape="poly" title=" " alt="" coords="175,123,99,123,99,117,175,117"/>
<area shape="rect" href="tensor__c_8cpp.html#aefb7ebf64853d118255476d31709288c" title=" " alt="" coords="5,157,143,184"/>
<area shape="poly" title=" " alt="" coords="178,141,120,159,118,154,176,136"/>
<area shape="rect" href="tensor__c_8cpp.html#a40689cfb9e9d6f1fa7d9fb5c90c4e41d" title=" " alt="" coords="12,208,136,235"/>
<area shape="poly" title=" " alt="" coords="212,146,181,173,144,198,120,210,118,205,141,194,177,169,208,142"/>
</map>
</div>

</div>
</div>
<a id="ac622682f190796d532e11f0c7b597aa0" name="ac622682f190796d532e11f0c7b597aa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac622682f190796d532e11f0c7b597aa0">&#9670;&#160;</a></span>save_npy()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool save_npy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>filename</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save a tensor to NumPy .npy format (version 1.0). </p>
<p>This creates a file compatible with numpy.load() in Python.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tensor</td><td>The tensor to save. </td></tr>
    <tr><td class="paramname">filename</td><td>The output file path. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true on success, false on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor__io_8h_source.html#l00275">275</a> of file <a class="el" href="tensor__io_8h_source.html">tensor_io.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  275</span>                                                                     {</div>
<div class="line"><span class="lineno">  276</span>    std::ofstream file(filename, std::ios::binary);</div>
<div class="line"><span class="lineno">  277</span>    <span class="keywordflow">if</span> (!file.is_open()) {</div>
<div class="line"><span class="lineno">  278</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  279</span>    }</div>
<div class="line"><span class="lineno">  280</span>    </div>
<div class="line"><span class="lineno">  281</span>    <span class="comment">// NPY format magic number</span></div>
<div class="line"><span class="lineno">  282</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> magic[] = {0x93, <span class="charliteral">&#39;N&#39;</span>, <span class="charliteral">&#39;U&#39;</span>, <span class="charliteral">&#39;M&#39;</span>, <span class="charliteral">&#39;P&#39;</span>, <span class="charliteral">&#39;Y&#39;</span>};</div>
<div class="line"><span class="lineno">  283</span>    file.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(magic), 6);</div>
<div class="line"><span class="lineno">  284</span>    </div>
<div class="line"><span class="lineno">  285</span>    <span class="comment">// Version 1.0</span></div>
<div class="line"><span class="lineno">  286</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> version[2] = {1, 0};</div>
<div class="line"><span class="lineno">  287</span>    file.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(version), 2);</div>
<div class="line"><span class="lineno">  288</span>    </div>
<div class="line"><span class="lineno">  289</span>    <span class="comment">// Build header dictionary</span></div>
<div class="line"><span class="lineno">  290</span>    std::string dtype_str;</div>
<div class="line"><span class="lineno">  291</span>    <span class="keywordflow">if</span> (std::is_same&lt;T, float&gt;::value) {</div>
<div class="line"><span class="lineno">  292</span>        dtype_str = <span class="stringliteral">&quot;&lt;f4&quot;</span>;  <span class="comment">// little-endian float32</span></div>
<div class="line"><span class="lineno">  293</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::is_same&lt;T, double&gt;::value) {</div>
<div class="line"><span class="lineno">  294</span>        dtype_str = <span class="stringliteral">&quot;&lt;f8&quot;</span>;  <span class="comment">// little-endian float64</span></div>
<div class="line"><span class="lineno">  295</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::is_same&lt;T, int32_t&gt;::value) {</div>
<div class="line"><span class="lineno">  296</span>        dtype_str = <span class="stringliteral">&quot;&lt;i4&quot;</span>;  <span class="comment">// little-endian int32</span></div>
<div class="line"><span class="lineno">  297</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::is_same&lt;T, int64_t&gt;::value) {</div>
<div class="line"><span class="lineno">  298</span>        dtype_str = <span class="stringliteral">&quot;&lt;i8&quot;</span>;  <span class="comment">// little-endian int64</span></div>
<div class="line"><span class="lineno">  299</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  300</span>        <span class="comment">// Default to bytes</span></div>
<div class="line"><span class="lineno">  301</span>        dtype_str = <span class="stringliteral">&quot;|u&quot;</span> + std::to_string(<span class="keyword">sizeof</span>(T));</div>
<div class="line"><span class="lineno">  302</span>    }</div>
<div class="line"><span class="lineno">  303</span>    </div>
<div class="line"><span class="lineno">  304</span>    <span class="comment">// Build shape tuple</span></div>
<div class="line"><span class="lineno">  305</span>    std::ostringstream shape_stream;</div>
<div class="line"><span class="lineno">  306</span>    shape_stream &lt;&lt; <span class="stringliteral">&quot;(&quot;</span>;</div>
<div class="line"><span class="lineno">  307</span>    <span class="keyword">auto</span> dims = tensor.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  308</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; N; ++i) {</div>
<div class="line"><span class="lineno">  309</span>        <span class="keywordflow">if</span> (i &gt; 0) shape_stream &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><span class="lineno">  310</span>        shape_stream &lt;&lt; dims[i];</div>
<div class="line"><span class="lineno">  311</span>    }</div>
<div class="line"><span class="lineno">  312</span>    <span class="keywordflow">if</span> (N == 1) shape_stream &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;  <span class="comment">// Python tuple syntax for single element</span></div>
<div class="line"><span class="lineno">  313</span>    shape_stream &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><span class="lineno">  314</span>    </div>
<div class="line"><span class="lineno">  315</span>    <span class="comment">// Build header string</span></div>
<div class="line"><span class="lineno">  316</span>    std::ostringstream header_stream;</div>
<div class="line"><span class="lineno">  317</span>    header_stream &lt;&lt; <span class="stringliteral">&quot;{&#39;descr&#39;: &#39;&quot;</span> &lt;&lt; dtype_str &lt;&lt; <span class="stringliteral">&quot;&#39;, &quot;</span></div>
<div class="line"><span class="lineno">  318</span>                  &lt;&lt; <span class="stringliteral">&quot;&#39;fortran_order&#39;: False, &quot;</span></div>
<div class="line"><span class="lineno">  319</span>                  &lt;&lt; <span class="stringliteral">&quot;&#39;shape&#39;: &quot;</span> &lt;&lt; shape_stream.str() &lt;&lt; <span class="stringliteral">&quot;, }&quot;</span>;</div>
<div class="line"><span class="lineno">  320</span>    </div>
<div class="line"><span class="lineno">  321</span>    std::string header = header_stream.str();</div>
<div class="line"><span class="lineno">  322</span>    </div>
<div class="line"><span class="lineno">  323</span>    <span class="comment">// Pad header to be divisible by 16 (NPY format requirement)</span></div>
<div class="line"><span class="lineno">  324</span>    <span class="comment">// Total header size including length bytes must be divisible by 16</span></div>
<div class="line"><span class="lineno">  325</span>    <span class="keywordtype">size_t</span> header_len = header.size();</div>
<div class="line"><span class="lineno">  326</span>    <span class="keywordtype">size_t</span> padding = (16 - ((10 + header_len) % 16)) % 16;</div>
<div class="line"><span class="lineno">  327</span>    header.append(padding, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><span class="lineno">  328</span>    header.push_back(<span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><span class="lineno">  329</span>    </div>
<div class="line"><span class="lineno">  330</span>    <span class="comment">// Write header length (2 bytes, little-endian)</span></div>
<div class="line"><span class="lineno">  331</span>    uint16_t header_len_total = <span class="keyword">static_cast&lt;</span>uint16_t<span class="keyword">&gt;</span>(header.size());</div>
<div class="line"><span class="lineno">  332</span>    file.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(&amp;header_len_total), 2);</div>
<div class="line"><span class="lineno">  333</span>    </div>
<div class="line"><span class="lineno">  334</span>    <span class="comment">// Write header</span></div>
<div class="line"><span class="lineno">  335</span>    file.write(header.c_str(), header.size());</div>
<div class="line"><span class="lineno">  336</span>    </div>
<div class="line"><span class="lineno">  337</span>    <span class="comment">// Write data</span></div>
<div class="line"><span class="lineno">  338</span>    <span class="keywordtype">size_t</span> total = tensor.<a class="code hl_function" href="classTensor.html#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno">  339</span>    <span class="keyword">const</span> T* data = tensor.<a class="code hl_function" href="classTensor.html#a07bf856a863505d2960b0bfad9c3b3f4">data</a>();</div>
<div class="line"><span class="lineno">  340</span>    file.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(data), total * <span class="keyword">sizeof</span>(T));</div>
<div class="line"><span class="lineno">  341</span>    </div>
<div class="line"><span class="lineno">  342</span>    file.close();</div>
<div class="line"><span class="lineno">  343</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  344</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tensor__io_8h_ac622682f190796d532e11f0c7b597aa0_cgraph.png" border="0" usemap="#atensor__io_8h_ac622682f190796d532e11f0c7b597aa0_cgraph" loading="lazy" alt=""/></div>
<map name="atensor__io_8h_ac622682f190796d532e11f0c7b597aa0_cgraph" id="atensor__io_8h_ac622682f190796d532e11f0c7b597aa0_cgraph">
<area shape="rect" title="Save a tensor to NumPy .npy format (version 1.0)." alt="" coords="5,56,83,83"/>
<area shape="rect" href="classTensor.html#a07bf856a863505d2960b0bfad9c3b3f4" title=" " alt="" coords="146,5,240,32"/>
<area shape="poly" title=" " alt="" coords="82,54,136,35,138,40,84,59"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="145,56,241,83"/>
<area shape="poly" title=" " alt="" coords="83,67,129,67,129,72,83,72"/>
<area shape="rect" href="classTensor.html#aad6aeb4859940befd0c46f0b99388bd7" title=" " alt="" coords="131,107,255,133"/>
<area shape="poly" title=" " alt="" coords="84,80,138,99,136,104,82,85"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tensor__io_8h_ac622682f190796d532e11f0c7b597aa0_icgraph.png" border="0" usemap="#atensor__io_8h_ac622682f190796d532e11f0c7b597aa0_icgraph" loading="lazy" alt=""/></div>
<map name="atensor__io_8h_ac622682f190796d532e11f0c7b597aa0_icgraph" id="atensor__io_8h_ac622682f190796d532e11f0c7b597aa0_icgraph">
<area shape="rect" title="Save a tensor to NumPy .npy format (version 1.0)." alt="" coords="103,5,180,32"/>
<area shape="rect" href="tensor__io_8h.html#af1dee4960bb4ee62c02499855bb66a2d" title="Save a tensor to a file with specified format." alt="" coords="5,5,55,32"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="add21f5804707b520f88e074026b258b3" name="add21f5804707b520f88e074026b258b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add21f5804707b520f88e074026b258b3">&#9670;&#160;</a></span>save_text()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool save_text </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>filename</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>precision</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save a tensor to a text file (CSV-like format). </p>
<p>For 1D tensors: values separated by spaces For 2D tensors: rows separated by newlines, values by spaces For higher dimensions: recursive structure with blank lines</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tensor</td><td>The tensor to save. </td></tr>
    <tr><td class="paramname">filename</td><td>The output file path. </td></tr>
    <tr><td class="paramname">precision</td><td>Number of decimal places (default: 6). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true on success, false on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor__io_8h_source.html#l00197">197</a> of file <a class="el" href="tensor__io_8h_source.html">tensor_io.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  197</span>                                                                                     {</div>
<div class="line"><span class="lineno">  198</span>    std::ofstream file(filename);</div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">if</span> (!file.is_open()) {</div>
<div class="line"><span class="lineno">  200</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  201</span>    }</div>
<div class="line"><span class="lineno">  202</span>    </div>
<div class="line"><span class="lineno">  203</span>    file &lt;&lt; std::fixed &lt;&lt; std::setprecision(precision);</div>
<div class="line"><span class="lineno">  204</span>    </div>
<div class="line"><span class="lineno">  205</span>    <span class="comment">// Write dimensions as comment</span></div>
<div class="line"><span class="lineno">  206</span>    file &lt;&lt; <span class="stringliteral">&quot;# Shape: &quot;</span>;</div>
<div class="line"><span class="lineno">  207</span>    <span class="keyword">auto</span> dims = tensor.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  208</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; N; ++i) {</div>
<div class="line"><span class="lineno">  209</span>        <span class="keywordflow">if</span> (i &gt; 0) file &lt;&lt; <span class="stringliteral">&quot;x&quot;</span>;</div>
<div class="line"><span class="lineno">  210</span>        file &lt;&lt; dims[i];</div>
<div class="line"><span class="lineno">  211</span>    }</div>
<div class="line"><span class="lineno">  212</span>    file &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  213</span>    </div>
<div class="line"><span class="lineno">  214</span>    <span class="comment">// Write data</span></div>
<div class="line"><span class="lineno">  215</span>    <span class="keyword">const</span> T* data = tensor.<a class="code hl_function" href="classTensor.html#a07bf856a863505d2960b0bfad9c3b3f4">data</a>();</div>
<div class="line"><span class="lineno">  216</span>    <span class="keywordtype">size_t</span> total = tensor.<a class="code hl_function" href="classTensor.html#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno">  217</span>    </div>
<div class="line"><span class="lineno">  218</span>    <span class="keywordflow">if</span> (N == 1) {</div>
<div class="line"><span class="lineno">  219</span>        <span class="comment">// 1D: single line</span></div>
<div class="line"><span class="lineno">  220</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; total; ++i) {</div>
<div class="line"><span class="lineno">  221</span>            <span class="keywordflow">if</span> (i &gt; 0) file &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><span class="lineno">  222</span>            file &lt;&lt; data[i];</div>
<div class="line"><span class="lineno">  223</span>        }</div>
<div class="line"><span class="lineno">  224</span>        file &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  225</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N == 2) {</div>
<div class="line"><span class="lineno">  226</span>        <span class="comment">// 2D: matrix format</span></div>
<div class="line"><span class="lineno">  227</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; dims[0]; ++i) {</div>
<div class="line"><span class="lineno">  228</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; dims[1]; ++j) {</div>
<div class="line"><span class="lineno">  229</span>                <span class="keywordflow">if</span> (j &gt; 0) file &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><span class="lineno">  230</span>                file &lt;&lt; data[i * dims[1] + j];</div>
<div class="line"><span class="lineno">  231</span>            }</div>
<div class="line"><span class="lineno">  232</span>            file &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  233</span>        }</div>
<div class="line"><span class="lineno">  234</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  235</span>        <span class="comment">// Higher dimensions: flatten with structure</span></div>
<div class="line"><span class="lineno">  236</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; total; ++i) {</div>
<div class="line"><span class="lineno">  237</span>            file &lt;&lt; data[i];</div>
<div class="line"><span class="lineno">  238</span>            </div>
<div class="line"><span class="lineno">  239</span>            <span class="comment">// Add spacing based on dimension boundaries</span></div>
<div class="line"><span class="lineno">  240</span>            <span class="keywordtype">bool</span> newline = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  241</span>            <span class="keywordtype">size_t</span> stride = 1;</div>
<div class="line"><span class="lineno">  242</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> d = N - 1; d &gt; 0; --d) {</div>
<div class="line"><span class="lineno">  243</span>                stride *= dims[d];</div>
<div class="line"><span class="lineno">  244</span>                <span class="keywordflow">if</span> ((i + 1) % stride == 0) {</div>
<div class="line"><span class="lineno">  245</span>                    newline = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  246</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  247</span>                }</div>
<div class="line"><span class="lineno">  248</span>            }</div>
<div class="line"><span class="lineno">  249</span>            </div>
<div class="line"><span class="lineno">  250</span>            <span class="keywordflow">if</span> (newline) {</div>
<div class="line"><span class="lineno">  251</span>                file &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  252</span>                <span class="keywordflow">if</span> ((i + 1) &lt; total &amp;&amp; (i + 1) % (dims[N - 1] * dims[N - 2]) == 0) {</div>
<div class="line"><span class="lineno">  253</span>                    file &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;  <span class="comment">// Extra newline for higher dimension boundaries</span></div>
<div class="line"><span class="lineno">  254</span>                }</div>
<div class="line"><span class="lineno">  255</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  256</span>                file &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><span class="lineno">  257</span>            }</div>
<div class="line"><span class="lineno">  258</span>        }</div>
<div class="line"><span class="lineno">  259</span>    }</div>
<div class="line"><span class="lineno">  260</span>    </div>
<div class="line"><span class="lineno">  261</span>    file.close();</div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  263</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tensor__io_8h_add21f5804707b520f88e074026b258b3_cgraph.png" border="0" usemap="#atensor__io_8h_add21f5804707b520f88e074026b258b3_cgraph" loading="lazy" alt=""/></div>
<map name="atensor__io_8h_add21f5804707b520f88e074026b258b3_cgraph" id="atensor__io_8h_add21f5804707b520f88e074026b258b3_cgraph">
<area shape="rect" title="Save a tensor to a text file (CSV&#45;like format)." alt="" coords="5,56,84,83"/>
<area shape="rect" href="classTensor.html#a07bf856a863505d2960b0bfad9c3b3f4" title=" " alt="" coords="147,5,240,32"/>
<area shape="poly" title=" " alt="" coords="83,54,138,35,139,40,85,59"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="146,56,242,83"/>
<area shape="poly" title=" " alt="" coords="84,67,130,67,130,72,84,72"/>
<area shape="rect" href="classTensor.html#aad6aeb4859940befd0c46f0b99388bd7" title=" " alt="" coords="132,107,256,133"/>
<area shape="poly" title=" " alt="" coords="85,80,139,99,138,104,83,85"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tensor__io_8h_add21f5804707b520f88e074026b258b3_icgraph.png" border="0" usemap="#atensor__io_8h_add21f5804707b520f88e074026b258b3_icgraph" loading="lazy" alt=""/></div>
<map name="atensor__io_8h_add21f5804707b520f88e074026b258b3_icgraph" id="atensor__io_8h_add21f5804707b520f88e074026b258b3_icgraph">
<area shape="rect" title="Save a tensor to a text file (CSV&#45;like format)." alt="" coords="178,31,256,57"/>
<area shape="rect" href="tensor__io_8h.html#af1dee4960bb4ee62c02499855bb66a2d" title="Save a tensor to a file with specified format." alt="" coords="43,5,92,32"/>
<area shape="poly" title=" " alt="" coords="162,37,92,25,93,20,163,32"/>
<area shape="rect" href="tensor__io_8h.html#a9e03fa16492ffad78aee9cc9f84073d9" title=" " alt="" coords="5,56,130,83"/>
<area shape="poly" title=" " alt="" coords="163,56,131,61,130,56,162,51"/>
</map>
</div>

</div>
</div>
<a id="a9e03fa16492ffad78aee9cc9f84073d9" name="a9e03fa16492ffad78aee9cc9f84073d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e03fa16492ffad78aee9cc9f84073d9">&#9670;&#160;</a></span>save_text_default()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool save_text_default </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>filename</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>precision</em></span><span class="paramdefsep"> = </span><span class="paramdefval">6</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor__io_8h_source.html#l00540">540</a> of file <a class="el" href="tensor__io_8h_source.html">tensor_io.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  540</span>                                                                                                 {</div>
<div class="line"><span class="lineno">  541</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="#add21f5804707b520f88e074026b258b3">save_text</a>(tensor, filename, precision);</div>
<div class="line"><span class="lineno">  542</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tensor__io_8h_a9e03fa16492ffad78aee9cc9f84073d9_cgraph.png" border="0" usemap="#atensor__io_8h_a9e03fa16492ffad78aee9cc9f84073d9_cgraph" loading="lazy" alt=""/></div>
<map name="atensor__io_8h_a9e03fa16492ffad78aee9cc9f84073d9_cgraph" id="atensor__io_8h_a9e03fa16492ffad78aee9cc9f84073d9_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,130,83"/>
<area shape="rect" href="tensor__io_8h.html#add21f5804707b520f88e074026b258b3" title="Save a tensor to a text file (CSV&#45;like format)." alt="" coords="178,56,256,83"/>
<area shape="poly" title=" " alt="" coords="130,67,162,67,162,72,130,72"/>
<area shape="rect" href="classTensor.html#a07bf856a863505d2960b0bfad9c3b3f4" title=" " alt="" coords="320,5,413,32"/>
<area shape="poly" title=" " alt="" coords="255,54,310,35,312,40,257,59"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="318,56,414,83"/>
<area shape="poly" title=" " alt="" coords="256,67,302,67,302,72,256,72"/>
<area shape="rect" href="classTensor.html#aad6aeb4859940befd0c46f0b99388bd7" title=" " alt="" coords="304,107,428,133"/>
<area shape="poly" title=" " alt="" coords="257,80,312,99,310,104,255,85"/>
</map>
</div>

</div>
</div>
<a id="a278d10cd95a2b11a414ecd8eda1b665e" name="a278d10cd95a2b11a414ecd8eda1b665e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a278d10cd95a2b11a414ecd8eda1b665e">&#9670;&#160;</a></span>to_string()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::string to_string </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>precision</em></span><span class="paramdefsep"> = </span><span class="paramdefval">4</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>max_items</em></span><span class="paramdefsep"> = </span><span class="paramdefval">6</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert tensor to string representation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tensor</td><td>The tensor to convert. </td></tr>
    <tr><td class="paramname">precision</td><td>Number of decimal places (default: 4). </td></tr>
    <tr><td class="paramname">max_items</td><td>Maximum items to show (default: 6). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>String representation of the tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor__io_8h_source.html#l00532">532</a> of file <a class="el" href="tensor__io_8h_source.html">tensor_io.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  532</span>                                                                                         {</div>
<div class="line"><span class="lineno">  533</span>    std::ostringstream oss;</div>
<div class="line"><span class="lineno">  534</span>    <a class="code hl_function" href="#ad4f347ce46aff75bdad7db7e7d7eabef">print</a>(tensor, oss, precision, max_items, 75);</div>
<div class="line"><span class="lineno">  535</span>    <span class="keywordflow">return</span> oss.str();</div>
<div class="line"><span class="lineno">  536</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tensor__io_8h_a278d10cd95a2b11a414ecd8eda1b665e_cgraph.png" border="0" usemap="#atensor__io_8h_a278d10cd95a2b11a414ecd8eda1b665e_cgraph" loading="lazy" alt=""/></div>
<map name="atensor__io_8h_a278d10cd95a2b11a414ecd8eda1b665e_cgraph" id="atensor__io_8h_a278d10cd95a2b11a414ecd8eda1b665e_cgraph">
<area shape="rect" title="Convert tensor to string representation." alt="" coords="5,56,77,83"/>
<area shape="rect" href="tensor__io_8h.html#ad4f347ce46aff75bdad7db7e7d7eabef" title="Pretty print a tensor with formatting options." alt="" coords="125,56,171,83"/>
<area shape="poly" title=" " alt="" coords="77,67,109,67,109,72,77,72"/>
<area shape="rect" href="classTensor.html#a07bf856a863505d2960b0bfad9c3b3f4" title=" " alt="" coords="234,5,328,32"/>
<area shape="poly" title=" " alt="" coords="170,58,229,36,231,40,172,63"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="233,56,329,83"/>
<area shape="poly" title=" " alt="" coords="171,67,218,67,218,72,171,72"/>
<area shape="rect" href="classTensor.html#aad6aeb4859940befd0c46f0b99388bd7" title=" " alt="" coords="219,107,343,133"/>
<area shape="poly" title=" " alt="" coords="172,75,231,98,229,103,170,80"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a href="tensor__io_8h.html">tensor_io.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
