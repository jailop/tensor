<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tensor Library: Tensor&lt; T, N &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tensor Library
   </div>
   <div id="projectbrief">High-performance C++ tensor library with GPU, BLAS, autograd, and linear algebra support</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('classTensor.html','','classTensor-members'); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Tensor&lt; T, N &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Forward declaration for autograd.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="tensor_8h_source.html">tensor.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for Tensor&lt; T, N &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor__coll__graph.png" border="0" usemap="#aTensor_3_01T_00_01N_01_4_coll__map" loading="lazy" alt="Collaboration graph"/></div>
<map name="aTensor_3_01T_00_01N_01_4_coll__map" id="aTensor_3_01T_00_01N_01_4_coll__map">
<area shape="rect" title="Forward declaration for autograd." alt="" coords="493,64,601,91"/>
<area shape="rect" title=" " alt="" coords="173,5,315,32"/>
<area shape="poly" title=" " alt="" coords="331,24,399,34,470,48,511,61,510,66,468,53,398,39,330,30"/>
<area shape="rect" title=" " alt="" coords="5,64,44,91"/>
<area shape="poly" title=" " alt="" coords="56,53,67,48,120,32,172,23,173,28,121,37,69,53,58,58"/>
<area shape="rect" title=" " alt="" coords="165,56,323,99"/>
<area shape="poly" title=" " alt="" coords="60,75,165,75,165,80,60,80"/>
<area shape="rect" title=" " alt="" coords="153,123,335,165"/>
<area shape="poly" title=" " alt="" coords="56,97,69,104,110,119,153,129,152,134,109,124,67,109,54,102"/>
<area shape="poly" title=" " alt="" coords="338,75,493,75,493,80,338,80"/>
<area shape="poly" title=" " alt="" coords="350,128,468,104,513,89,515,94,470,109,351,134"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-methods" class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3f3c97d177cb960a4423afc3dafc612a" id="r_a3f3c97d177cb960a4423afc3dafc612a"><td class="memItemLeft" align="right" valign="top">const T *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a> () const</td></tr>
<tr class="memitem:ad74772ea04c239f0878e8ad8653dce5d" id="r_ad74772ea04c239f0878e8ad8653dce5d"><td class="memItemLeft" align="right" valign="top">T *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad74772ea04c239f0878e8ad8653dce5d">data_ptr</a> ()</td></tr>
<tr class="memitem:aad6aeb4859940befd0c46f0b99388bd7" id="r_aad6aeb4859940befd0c46f0b99388bd7"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a> () const</td></tr>
<tr class="memitem:a07bf856a863505d2960b0bfad9c3b3f4" id="r_a07bf856a863505d2960b0bfad9c3b3f4"><td class="memItemLeft" align="right" valign="top">const T *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a> () const</td></tr>
<tr class="memitem:ad8befdfb5ad9c3f2a69f8bdccc9a3787" id="r_ad8befdfb5ad9c3f2a69f8bdccc9a3787"><td class="memItemLeft" align="right" valign="top">T *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad8befdfb5ad9c3f2a69f8bdccc9a3787">data</a> ()</td></tr>
<tr class="memitem:a938d78600782073a1ff2725066b46c85" id="r_a938d78600782073a1ff2725066b46c85"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a938d78600782073a1ff2725066b46c85">strides</a> () const</td></tr>
<tr class="memitem:a8a85c4bf5ad38b0ba4a3d8665dfce486" id="r_a8a85c4bf5ad38b0ba4a3d8665dfce486"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8a85c4bf5ad38b0ba4a3d8665dfce486">Tensor</a> (const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;dimensions, bool use_gpu=true, bool <a class="el" href="#a947326cf96b1bf3423b40861e1213ab8">requires_grad</a>=false)</td></tr>
<tr class="memitem:a905559324e349a17f2530a9b5ce067ee" id="r_a905559324e349a17f2530a9b5ce067ee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a905559324e349a17f2530a9b5ce067ee">Tensor</a> (const <a class="el" href="classTensor.html">Tensor</a> &amp;other)</td></tr>
<tr class="memitem:a129f7f00cdc80a5ad067a8eb3c910290" id="r_a129f7f00cdc80a5ad067a8eb3c910290"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a129f7f00cdc80a5ad067a8eb3c910290">operator=</a> (const <a class="el" href="classTensor.html">Tensor</a> &amp;other)</td></tr>
<tr class="memitem:acd343a064481a9fc4a0c8f3d17fc489c" id="r_acd343a064481a9fc4a0c8f3d17fc489c"><td class="memItemLeft" align="right" valign="top">T &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acd343a064481a9fc4a0c8f3d17fc489c">operator[]</a> (const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;indices)</td></tr>
<tr class="memitem:a9f1420cd0be3272bdb3b9a3f53d58c76" id="r_a9f1420cd0be3272bdb3b9a3f53d58c76"><td class="memItemLeft" align="right" valign="top">const T &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9f1420cd0be3272bdb3b9a3f53d58c76">operator[]</a> (const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;indices) const</td></tr>
<tr class="memitem:a234f74cd16bd13561f7963ba29efb163" id="r_a234f74cd16bd13561f7963ba29efb163"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a234f74cd16bd13561f7963ba29efb163">fill</a> (const T &amp;value)</td></tr>
<tr class="memdesc:a234f74cd16bd13561f7963ba29efb163"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill the tensor with a specified value.  <br /></td></tr>
<tr class="memitem:a03d314303958ffc5644796d8025cd012" id="r_a03d314303958ffc5644796d8025cd012"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a03d314303958ffc5644796d8025cd012">dims</a> () const</td></tr>
<tr class="memitem:a80b3ffaf92ed36f02d6f4d4230b5d2a0" id="r_a80b3ffaf92ed36f02d6f4d4230b5d2a0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a80b3ffaf92ed36f02d6f4d4230b5d2a0">shape</a> () const</td></tr>
<tr class="memitem:a83ae42925e21d2871d755407d7505c10" id="r_a83ae42925e21d2871d755407d7505c10"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a83ae42925e21d2871d755407d7505c10">uses_gpu</a> () const</td></tr>
<tr class="memitem:a498d185ab60ae084a26c848ccdbaab27" id="r_a498d185ab60ae084a26c848ccdbaab27"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#ae4db5848267c1a5a1413b7f87cf6889d">Backend</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a498d185ab60ae084a26c848ccdbaab27">backend</a> () const</td></tr>
<tr class="memitem:aba945884d7b2221e4a6b35e7916ae0d9" id="r_aba945884d7b2221e4a6b35e7916ae0d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aba945884d7b2221e4a6b35e7916ae0d9">set_requires_grad</a> (bool <a class="el" href="#a947326cf96b1bf3423b40861e1213ab8">requires_grad</a>)</td></tr>
<tr class="memitem:a947326cf96b1bf3423b40861e1213ab8" id="r_a947326cf96b1bf3423b40861e1213ab8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a947326cf96b1bf3423b40861e1213ab8">requires_grad</a> () const</td></tr>
<tr class="memitem:aae15047e75bb7e0734b82eceea1cd009" id="r_aae15047e75bb7e0734b82eceea1cd009"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aae15047e75bb7e0734b82eceea1cd009">is_leaf</a> () const</td></tr>
<tr class="memitem:a8c0ac5752345f4abb81ebe4fa78411fd" id="r_a8c0ac5752345f4abb81ebe4fa78411fd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a> ()</td></tr>
<tr class="memitem:ae20c5c5722bd41013f11b326f9e50b2f" id="r_ae20c5c5722bd41013f11b326f9e50b2f"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae20c5c5722bd41013f11b326f9e50b2f">grad</a> () const</td></tr>
<tr class="memitem:a35de015456ce4657b150b3d6add16e3d" id="r_a35de015456ce4657b150b3d6add16e3d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a35de015456ce4657b150b3d6add16e3d">zero_grad</a> ()</td></tr>
<tr class="memitem:ace4d96d1fc0d364577334241662fb60e" id="r_ace4d96d1fc0d364577334241662fb60e"><td class="memItemLeft" align="right" valign="top">std::optional&lt; <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaa">TensorError</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ace4d96d1fc0d364577334241662fb60e">backward</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; *gradient=nullptr)</td></tr>
<tr class="memdesc:ace4d96d1fc0d364577334241662fb60e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform backward pass to compute gradients (autograd).  <br /></td></tr>
<tr class="memitem:ae5b52299c11f3ba81e781cb008542285" id="r_ae5b52299c11f3ba81e781cb008542285"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae5b52299c11f3ba81e781cb008542285">detach</a> () const</td></tr>
<tr class="memitem:af274147e833dd1ab399ce08155ad169b" id="r_af274147e833dd1ab399ce08155ad169b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a> (<a class="el" href="tensor_8h.html#a1e846f46f87b55f57de12d6aa70eda1e">BackwardFunc</a>&lt; T, N &gt; func)</td></tr>
<tr class="memitem:a1947fa453cc8c0a746b26d2481bb6b39" id="r_a1947fa453cc8c0a746b26d2481bb6b39"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1947fa453cc8c0a746b26d2481bb6b39">operator+</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memdesc:a1947fa453cc8c0a746b26d2481bb6b39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Element-wise addition with another tensor (creates new tensor).  <br /></td></tr>
<tr class="memitem:aab73fe3969bc9ab6b35a89c3787f2a22" id="r_aab73fe3969bc9ab6b35a89c3787f2a22"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aab73fe3969bc9ab6b35a89c3787f2a22">operator+</a> (const T &amp;scalar) const</td></tr>
<tr class="memitem:afe3aaaf08972bed6b0ea4b7b0eb03689" id="r_afe3aaaf08972bed6b0ea4b7b0eb03689"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afe3aaaf08972bed6b0ea4b7b0eb03689">operator+=</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other)</td></tr>
<tr class="memitem:a4613cd0a8fdde8d4e067384adcba7015" id="r_a4613cd0a8fdde8d4e067384adcba7015"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4613cd0a8fdde8d4e067384adcba7015">operator+=</a> (const T &amp;scalar)</td></tr>
<tr class="memitem:ad2e51c1fbe247b637e415e60c3993ea9" id="r_ad2e51c1fbe247b637e415e60c3993ea9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad2e51c1fbe247b637e415e60c3993ea9">operator-</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memitem:a0b67c5a06ac74ab08db3f00e400e61af" id="r_a0b67c5a06ac74ab08db3f00e400e61af"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0b67c5a06ac74ab08db3f00e400e61af">operator-</a> (const T &amp;scalar) const</td></tr>
<tr class="memitem:a57e4d2c4f4d08e48b1a1c0abe573c39c" id="r_a57e4d2c4f4d08e48b1a1c0abe573c39c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a57e4d2c4f4d08e48b1a1c0abe573c39c">operator-=</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other)</td></tr>
<tr class="memitem:a42121a48ea8b32bcfb25e3b59834bc5c" id="r_a42121a48ea8b32bcfb25e3b59834bc5c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a42121a48ea8b32bcfb25e3b59834bc5c">operator-=</a> (const T &amp;scalar)</td></tr>
<tr class="memitem:af352346a629f774750b12c97234979a9" id="r_af352346a629f774750b12c97234979a9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af352346a629f774750b12c97234979a9">operator*</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memitem:a808dc758321fc810256e3efd13042c98" id="r_a808dc758321fc810256e3efd13042c98"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a808dc758321fc810256e3efd13042c98">operator*</a> (const T &amp;scalar) const</td></tr>
<tr class="memitem:a4a0f41f0cbce7ad6637c457a68ff3e32" id="r_a4a0f41f0cbce7ad6637c457a68ff3e32"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4a0f41f0cbce7ad6637c457a68ff3e32">operator*=</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other)</td></tr>
<tr class="memitem:a29213c270a7d4b9f44f27f4cec4246bf" id="r_a29213c270a7d4b9f44f27f4cec4246bf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a29213c270a7d4b9f44f27f4cec4246bf">operator*=</a> (const T &amp;scalar)</td></tr>
<tr class="memitem:a0e414490131d73889ccb977cc4ef047b" id="r_a0e414490131d73889ccb977cc4ef047b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0e414490131d73889ccb977cc4ef047b">operator/</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memitem:aecba99a38d50cec2aa5009513481e2d1" id="r_aecba99a38d50cec2aa5009513481e2d1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aecba99a38d50cec2aa5009513481e2d1">operator/</a> (const T &amp;scalar) const</td></tr>
<tr class="memitem:ad83f8e7f5e6a51fe67a6ec3a25662f63" id="r_ad83f8e7f5e6a51fe67a6ec3a25662f63"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad83f8e7f5e6a51fe67a6ec3a25662f63">operator/=</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other)</td></tr>
<tr class="memitem:af5d1375e8ccabc8e28631c6caf597699" id="r_af5d1375e8ccabc8e28631c6caf597699"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af5d1375e8ccabc8e28631c6caf597699">operator/=</a> (const T &amp;scalar)</td></tr>
<tr class="memitem:a79cd53c980f1a1dde80fc6eeba73743a" id="r_a79cd53c980f1a1dde80fc6eeba73743a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a79cd53c980f1a1dde80fc6eeba73743a">operator-</a> () const</td></tr>
<tr class="memitem:a314dfaedc4f6b2dc8e3b44bbc5381eb3" id="r_a314dfaedc4f6b2dc8e3b44bbc5381eb3"><td class="memTemplParams" colspan="2">template&lt;typename Func&gt; </td></tr>
<tr class="memitem:a314dfaedc4f6b2dc8e3b44bbc5381eb3 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a> (Func func) const</td></tr>
<tr class="memdesc:a314dfaedc4f6b2dc8e3b44bbc5381eb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a function to each element of the tensor (creates new tensor).  <br /></td></tr>
<tr class="memitem:a1ee81db1a8ee83fe46fd9af9563812fd" id="r_a1ee81db1a8ee83fe46fd9af9563812fd"><td class="memTemplParams" colspan="2">template&lt;typename Func&gt; </td></tr>
<tr class="memitem:a1ee81db1a8ee83fe46fd9af9563812fd template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1ee81db1a8ee83fe46fd9af9563812fd">map_inplace</a> (Func func)</td></tr>
<tr class="memdesc:a1ee81db1a8ee83fe46fd9af9563812fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a function to each element of the tensor (in-place).  <br /></td></tr>
<tr class="memitem:ae94340cb4134b887428082dc683fe2b2" id="r_ae94340cb4134b887428082dc683fe2b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae94340cb4134b887428082dc683fe2b2">exp</a> () const</td></tr>
<tr class="memdesc:ae94340cb4134b887428082dc683fe2b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply exponential function to all elements (creates new tensor).  <br /></td></tr>
<tr class="memitem:a4ca468e14a70671e0258c613612bc506" id="r_a4ca468e14a70671e0258c613612bc506"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4ca468e14a70671e0258c613612bc506">log</a> () const</td></tr>
<tr class="memdesc:a4ca468e14a70671e0258c613612bc506"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply natural logarithm to all elements (creates new tensor).  <br /></td></tr>
<tr class="memitem:af5c4a58c5b957dcfe32a0e7842520404" id="r_af5c4a58c5b957dcfe32a0e7842520404"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af5c4a58c5b957dcfe32a0e7842520404">sqrt</a> () const</td></tr>
<tr class="memdesc:af5c4a58c5b957dcfe32a0e7842520404"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply square root to all elements (creates new tensor).  <br /></td></tr>
<tr class="memitem:aed782eb734b3ef0dd50e5355e3d883c8" id="r_aed782eb734b3ef0dd50e5355e3d883c8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aed782eb734b3ef0dd50e5355e3d883c8">pow</a> (T exponent) const</td></tr>
<tr class="memdesc:aed782eb734b3ef0dd50e5355e3d883c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply power function to all elements (creates new tensor).  <br /></td></tr>
<tr class="memitem:a694440b236a5cfb314e68adec066a9c6" id="r_a694440b236a5cfb314e68adec066a9c6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a694440b236a5cfb314e68adec066a9c6">abs</a> () const</td></tr>
<tr class="memitem:a9340456b98f6f4da7fad1b80f9f81712" id="r_a9340456b98f6f4da7fad1b80f9f81712"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9340456b98f6f4da7fad1b80f9f81712">sin</a> () const</td></tr>
<tr class="memitem:a6563fb519990f052d63759c50d1febe9" id="r_a6563fb519990f052d63759c50d1febe9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6563fb519990f052d63759c50d1febe9">cos</a> () const</td></tr>
<tr class="memitem:a0ccbe9aa15ebe52d33cb890388bdf1ca" id="r_a0ccbe9aa15ebe52d33cb890388bdf1ca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ccbe9aa15ebe52d33cb890388bdf1ca">tan</a> () const</td></tr>
<tr class="memitem:adcc5341aa2156f24c0f4069543c958e1" id="r_adcc5341aa2156f24c0f4069543c958e1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adcc5341aa2156f24c0f4069543c958e1">tanh</a> () const</td></tr>
<tr class="memdesc:adcc5341aa2156f24c0f4069543c958e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply hyperbolic tangent (tanh) to all elements (creates new tensor).  <br /></td></tr>
<tr class="memitem:afff455663faa35d6cfa72aa03f689e94" id="r_afff455663faa35d6cfa72aa03f689e94"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afff455663faa35d6cfa72aa03f689e94">sigmoid</a> () const</td></tr>
<tr class="memdesc:afff455663faa35d6cfa72aa03f689e94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply sigmoid function to all elements (creates new tensor).  <br /></td></tr>
<tr class="memitem:a74db7588a7150d94b620ad63de1f5980" id="r_a74db7588a7150d94b620ad63de1f5980"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a74db7588a7150d94b620ad63de1f5980">relu</a> () const</td></tr>
<tr class="memdesc:a74db7588a7150d94b620ad63de1f5980"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply ReLU (Rectified Linear Unit) to all elements (creates new tensor).  <br /></td></tr>
<tr class="memitem:a62dff46109e314ef2d44683e3d4d581d" id="r_a62dff46109e314ef2d44683e3d4d581d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a62dff46109e314ef2d44683e3d4d581d">ceil</a> () const</td></tr>
<tr class="memitem:a6047a6a731e93d59e92073e997969cc7" id="r_a6047a6a731e93d59e92073e997969cc7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6047a6a731e93d59e92073e997969cc7">floor</a> () const</td></tr>
<tr class="memitem:a824a51062936324b316f066fdce66f77" id="r_a824a51062936324b316f066fdce66f77"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a824a51062936324b316f066fdce66f77">clamp</a> (T min_val, T max_val) const</td></tr>
<tr class="memitem:a8effb9d585936f292d45c090fa06a96b" id="r_a8effb9d585936f292d45c090fa06a96b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8effb9d585936f292d45c090fa06a96b">sign</a> () const</td></tr>
<tr class="memitem:a2daa379012cbb23c00fe3ac60bde0122" id="r_a2daa379012cbb23c00fe3ac60bde0122"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2daa379012cbb23c00fe3ac60bde0122">round</a> () const</td></tr>
<tr class="memitem:afa7d4923af4f40166ac5dec4a893b74e" id="r_afa7d4923af4f40166ac5dec4a893b74e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afa7d4923af4f40166ac5dec4a893b74e">erf</a> () const</td></tr>
<tr class="memitem:a7375a160ffb9b310d78c1f7f5a44c956" id="r_a7375a160ffb9b310d78c1f7f5a44c956"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7375a160ffb9b310d78c1f7f5a44c956">log1p</a> () const</td></tr>
<tr class="memitem:ab64cb0dcc82a371720c3bfc7f2265ece" id="r_ab64cb0dcc82a371720c3bfc7f2265ece"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab64cb0dcc82a371720c3bfc7f2265ece">expm1</a> () const</td></tr>
<tr class="memitem:a703855e2cfaff43769ef254a3dbce50c" id="r_a703855e2cfaff43769ef254a3dbce50c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a703855e2cfaff43769ef254a3dbce50c">isnan</a> () const</td></tr>
<tr class="memitem:ac56c689ad6c5077e9cb9792a552a8d38" id="r_ac56c689ad6c5077e9cb9792a552a8d38"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac56c689ad6c5077e9cb9792a552a8d38">isinf</a> () const</td></tr>
<tr class="memitem:a5aac0c5222fc09da3327d08ee2c3a2ed" id="r_a5aac0c5222fc09da3327d08ee2c3a2ed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5aac0c5222fc09da3327d08ee2c3a2ed">isfinite</a> () const</td></tr>
<tr class="memitem:a5e477d9be3b8b907cbcc34efe73e31bc" id="r_a5e477d9be3b8b907cbcc34efe73e31bc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5e477d9be3b8b907cbcc34efe73e31bc">clip_min</a> (T min_val) const</td></tr>
<tr class="memitem:a1dafe6c812c9cd6d5f34a31ffdad59bb" id="r_a1dafe6c812c9cd6d5f34a31ffdad59bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1dafe6c812c9cd6d5f34a31ffdad59bb">clip_max</a> (T max_val) const</td></tr>
<tr class="memitem:aa711e60597e988054c669e131ddce774" id="r_aa711e60597e988054c669e131ddce774"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa711e60597e988054c669e131ddce774">sigmoid_derivative</a> () const</td></tr>
<tr class="memitem:a369fb30e582324d1331132a5b29884b9" id="r_a369fb30e582324d1331132a5b29884b9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a369fb30e582324d1331132a5b29884b9">sigmoid_derivative_from_input</a> () const</td></tr>
<tr class="memitem:ab400f3516df53eb4e6547a850335571e" id="r_ab400f3516df53eb4e6547a850335571e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab400f3516df53eb4e6547a850335571e">tanh_derivative</a> () const</td></tr>
<tr class="memitem:afa485f1ec713acb3499de0a08659fc4a" id="r_afa485f1ec713acb3499de0a08659fc4a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afa485f1ec713acb3499de0a08659fc4a">tanh_derivative_from_input</a> () const</td></tr>
<tr class="memitem:a780523f1c499b857930f305b22aae9aa" id="r_a780523f1c499b857930f305b22aae9aa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a780523f1c499b857930f305b22aae9aa">relu_derivative</a> () const</td></tr>
<tr class="memitem:aa33851e29d0df735e3fab0002a119602" id="r_aa33851e29d0df735e3fab0002a119602"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa33851e29d0df735e3fab0002a119602">leaky_relu_derivative</a> (T alpha=T(0.01)) const</td></tr>
<tr class="memitem:aadc56fba91e522ff5de95202106be9db" id="r_aadc56fba91e522ff5de95202106be9db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aadc56fba91e522ff5de95202106be9db">exp_derivative</a> () const</td></tr>
<tr class="memitem:a1c578c4b3e0f4a8d2fc16b67e84815b5" id="r_a1c578c4b3e0f4a8d2fc16b67e84815b5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1c578c4b3e0f4a8d2fc16b67e84815b5">log_derivative</a> () const</td></tr>
<tr class="memitem:a958bad1db0d0a6867d12c75957d2de17" id="r_a958bad1db0d0a6867d12c75957d2de17"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a958bad1db0d0a6867d12c75957d2de17">sqrt_derivative</a> () const</td></tr>
<tr class="memitem:acf750ad4eaebe934c9422566ccb63081" id="r_acf750ad4eaebe934c9422566ccb63081"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acf750ad4eaebe934c9422566ccb63081">pow_derivative</a> (T exponent) const</td></tr>
<tr class="memitem:aeb435c4d428047076a5b3c3dd5ba7114" id="r_aeb435c4d428047076a5b3c3dd5ba7114"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeb435c4d428047076a5b3c3dd5ba7114">sin_derivative</a> () const</td></tr>
<tr class="memitem:a0ee894165491bb19bf33d8282a166fde" id="r_a0ee894165491bb19bf33d8282a166fde"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ee894165491bb19bf33d8282a166fde">cos_derivative</a> () const</td></tr>
<tr class="memitem:a7cc09049ddf2fb131becaefe19b7725a" id="r_a7cc09049ddf2fb131becaefe19b7725a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7cc09049ddf2fb131becaefe19b7725a">tan_derivative</a> () const</td></tr>
<tr class="memitem:ae0c783450c731955dab75dcb1e697319" id="r_ae0c783450c731955dab75dcb1e697319"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae0c783450c731955dab75dcb1e697319">softmax_gradient_diagonal</a> () const</td></tr>
<tr class="memitem:a4eb83e4f5d720db5858585ff199d789e" id="r_a4eb83e4f5d720db5858585ff199d789e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4eb83e4f5d720db5858585ff199d789e">chain_rule</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;upstream_grad) const</td></tr>
<tr class="memitem:a3d279878b61732de2f1986dfc7de8400" id="r_a3d279878b61732de2f1986dfc7de8400"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> () const</td></tr>
<tr class="memdesc:a3d279878b61732de2f1986dfc7de8400"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute sum reduction along all dimensions.  <br /></td></tr>
<tr class="memitem:a84b27bf0213ab3f228c2efe5ca31eaec" id="r_a84b27bf0213ab3f228c2efe5ca31eaec"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a84b27bf0213ab3f228c2efe5ca31eaec">mean</a> () const</td></tr>
<tr class="memdesc:a84b27bf0213ab3f228c2efe5ca31eaec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute mean of all elements.  <br /></td></tr>
<tr class="memitem:ac24ac40382bfcce441f59645c4b73257" id="r_ac24ac40382bfcce441f59645c4b73257"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac24ac40382bfcce441f59645c4b73257">variance</a> (size_t ddof=0) const</td></tr>
<tr class="memdesc:ac24ac40382bfcce441f59645c4b73257"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute variance of all elements.  <br /></td></tr>
<tr class="memitem:a0cda55fce732dcb563b598ff636d8758" id="r_a0cda55fce732dcb563b598ff636d8758"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0cda55fce732dcb563b598ff636d8758">std</a> (size_t ddof=0) const</td></tr>
<tr class="memitem:a36b35209e077e06698d7b0cb5e687b95" id="r_a36b35209e077e06698d7b0cb5e687b95"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a36b35209e077e06698d7b0cb5e687b95">covariance</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other, size_t ddof=0) const</td></tr>
<tr class="memitem:a2b57a0f04d06e24633c240fe7b007b4a" id="r_a2b57a0f04d06e24633c240fe7b007b4a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2b57a0f04d06e24633c240fe7b007b4a">correlation</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memitem:a1704d259280947373cbcbe3d1ca14854" id="r_a1704d259280947373cbcbe3d1ca14854"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1704d259280947373cbcbe3d1ca14854">median</a> () const</td></tr>
<tr class="memitem:a33b18c3717d32fa9bf3bc40a988523fe" id="r_a33b18c3717d32fa9bf3bc40a988523fe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a33b18c3717d32fa9bf3bc40a988523fe">quantile</a> (T q) const</td></tr>
<tr class="memitem:a20cb276f18c104077f75c6f712e4107b" id="r_a20cb276f18c104077f75c6f712e4107b"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a20cb276f18c104077f75c6f712e4107b">min</a> () const</td></tr>
<tr class="memitem:a421ff1c638234245b00425702d3f23aa" id="r_a421ff1c638234245b00425702d3f23aa"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a421ff1c638234245b00425702d3f23aa">max</a> () const</td></tr>
<tr class="memitem:a71992cdc0fae28d4c1947d7ebc3b85f3" id="r_a71992cdc0fae28d4c1947d7ebc3b85f3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a71992cdc0fae28d4c1947d7ebc3b85f3">spearman_correlation</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memitem:ab319628634a6c30afddd1a331d9c22e8" id="r_ab319628634a6c30afddd1a331d9c22e8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab319628634a6c30afddd1a331d9c22e8">normalize</a> (size_t ddof=0) const</td></tr>
<tr class="memitem:a06eeff8ce7f54262b935b324bcb6833e" id="r_a06eeff8ce7f54262b935b324bcb6833e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a06eeff8ce7f54262b935b324bcb6833e">standardize</a> () const</td></tr>
<tr class="memitem:aeede6504125b5aeff52c1a56dfbee125" id="r_aeede6504125b5aeff52c1a56dfbee125"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeede6504125b5aeff52c1a56dfbee125">square</a> () const</td></tr>
<tr class="memitem:a26deab87b696076f055af17f4386b4d0" id="r_a26deab87b696076f055af17f4386b4d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a26deab87b696076f055af17f4386b4d0">operator&gt;</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memitem:a214d0fc69786dddb10d1b334845b29f9" id="r_a214d0fc69786dddb10d1b334845b29f9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a214d0fc69786dddb10d1b334845b29f9">operator&gt;</a> (const T &amp;scalar) const</td></tr>
<tr class="memitem:a4a37be92854759ae7891294f57666127" id="r_a4a37be92854759ae7891294f57666127"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4a37be92854759ae7891294f57666127">operator&lt;</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memitem:acaa2ad71d3cd141fd3f0a506e492d56c" id="r_acaa2ad71d3cd141fd3f0a506e492d56c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acaa2ad71d3cd141fd3f0a506e492d56c">operator&lt;</a> (const T &amp;scalar) const</td></tr>
<tr class="memitem:a2cab1fc8ca70e8d2fa4bce5ff88fabe1" id="r_a2cab1fc8ca70e8d2fa4bce5ff88fabe1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2cab1fc8ca70e8d2fa4bce5ff88fabe1">operator&gt;=</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memitem:ac107bd4eaca6b12fe51303a692e9ea81" id="r_ac107bd4eaca6b12fe51303a692e9ea81"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac107bd4eaca6b12fe51303a692e9ea81">operator&gt;=</a> (const T &amp;scalar) const</td></tr>
<tr class="memitem:a563d023db0ab1338f2831ba24813f835" id="r_a563d023db0ab1338f2831ba24813f835"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a563d023db0ab1338f2831ba24813f835">operator&lt;=</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memitem:af1bf02c8d1a0a04ded404de0493982f2" id="r_af1bf02c8d1a0a04ded404de0493982f2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af1bf02c8d1a0a04ded404de0493982f2">operator&lt;=</a> (const T &amp;scalar) const</td></tr>
<tr class="memitem:a452fb091d4b50605c931485385d29aac" id="r_a452fb091d4b50605c931485385d29aac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a452fb091d4b50605c931485385d29aac">eq</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other, T epsilon=std::numeric_limits&lt; T &gt;::epsilon()) const</td></tr>
<tr class="memitem:aab0bca33fa0dbe68308c0a828cec9f44" id="r_aab0bca33fa0dbe68308c0a828cec9f44"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aab0bca33fa0dbe68308c0a828cec9f44">ne</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other, T epsilon=std::numeric_limits&lt; T &gt;::epsilon()) const</td></tr>
<tr class="memitem:a265342749ca5f239466cb467bbf73277" id="r_a265342749ca5f239466cb467bbf73277"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a265342749ca5f239466cb467bbf73277">clip</a> (T min_val, T max_val) const</td></tr>
<tr class="memitem:a754cdcbf16b91d5621e7405a2aa68f68" id="r_a754cdcbf16b91d5621e7405a2aa68f68"><td class="memTemplParams" colspan="2">template&lt;typename M&gt; </td></tr>
<tr class="memitem:a754cdcbf16b91d5621e7405a2aa68f68 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a754cdcbf16b91d5621e7405a2aa68f68">masked_fill</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; M, N &gt; &amp;mask, T fill_value) const</td></tr>
<tr class="memitem:a4773678cdfb3526a2bdb1079ef68b87e" id="r_a4773678cdfb3526a2bdb1079ef68b87e"><td class="memTemplParams" colspan="2">template&lt;typename M&gt; </td></tr>
<tr class="memitem:a4773678cdfb3526a2bdb1079ef68b87e template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4773678cdfb3526a2bdb1079ef68b87e">masked_select</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; M, N &gt; &amp;mask) const</td></tr>
<tr class="memitem:a4029fcf1a134dc6add543b9bdd1c045b" id="r_a4029fcf1a134dc6add543b9bdd1c045b"><td class="memTemplParams" colspan="2">template&lt;typename U&gt; </td></tr>
<tr class="memitem:a4029fcf1a134dc6add543b9bdd1c045b template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4029fcf1a134dc6add543b9bdd1c045b">astype</a> () const</td></tr>
<tr class="memdesc:a4029fcf1a134dc6add543b9bdd1c045b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cast tensor to a different data type (NumPy-compatible astype).  <br /></td></tr>
<tr class="memitem:aebe2b244763904422344add448a0c597" id="r_aebe2b244763904422344add448a0c597"><td class="memTemplParams" colspan="2">template&lt;size_t M&gt; </td></tr>
<tr class="memitem:aebe2b244763904422344add448a0c597 template"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aebe2b244763904422344add448a0c597">broadcast_to</a> (const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; M &gt; &amp;target_shape) const -&gt; std::variant&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, M &gt;, <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaa">TensorError</a> &gt;</td></tr>
<tr class="memdesc:aebe2b244763904422344add448a0c597"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broadcast this tensor to a new shape.  <br /></td></tr>
<tr class="memitem:a415f8016d31d376bb769402ce2ab5393" id="r_a415f8016d31d376bb769402ce2ab5393"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a415f8016d31d376bb769402ce2ab5393">uniform</a> (T low=T(0), T high=T(1))</td></tr>
<tr class="memitem:a1ec080d57f42d7c582be27d51c9fd440" id="r_a1ec080d57f42d7c582be27d51c9fd440"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1ec080d57f42d7c582be27d51c9fd440">bernoulli</a> (T p=T(0.5))</td></tr>
<tr class="memitem:a3091aa5abf57a0e2a900a25443f50dd8" id="r_a3091aa5abf57a0e2a900a25443f50dd8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3091aa5abf57a0e2a900a25443f50dd8">mse_loss</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;target) const</td></tr>
<tr class="memitem:a06009b18adaea5bd8fa428a5ccbef2d2" id="r_a06009b18adaea5bd8fa428a5ccbef2d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a06009b18adaea5bd8fa428a5ccbef2d2">mse_loss_gradient</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;target) const</td></tr>
<tr class="memitem:a0f221b4aea323b94ac40cc76513fe1e4" id="r_a0f221b4aea323b94ac40cc76513fe1e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0f221b4aea323b94ac40cc76513fe1e4">binary_crossentropy_loss</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;target, T epsilon=T(1e-7)) const</td></tr>
<tr class="memitem:a41b1a12b948c41c4b159fbccc278d630" id="r_a41b1a12b948c41c4b159fbccc278d630"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a41b1a12b948c41c4b159fbccc278d630">binary_crossentropy_gradient</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;target, T epsilon=T(1e-7)) const</td></tr>
<tr class="memitem:adfb14d7fcd29dddd0d1a790719f57b6d" id="r_adfb14d7fcd29dddd0d1a790719f57b6d"><td class="memTemplParams" colspan="2">template&lt;size_t M = N&gt; </td></tr>
<tr class="memitem:adfb14d7fcd29dddd0d1a790719f57b6d template"><td class="memItemLeft" align="right" valign="top">std::enable_if&lt; M==1, <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt; &gt;::type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adfb14d7fcd29dddd0d1a790719f57b6d">dot</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; &amp;other) const</td></tr>
<tr class="memitem:a2f852881c836e20e6a16469980d7f9b0" id="r_a2f852881c836e20e6a16469980d7f9b0"><td class="memTemplParams" colspan="2">template&lt;size_t M = N&gt; </td></tr>
<tr class="memitem:a2f852881c836e20e6a16469980d7f9b0 template"><td class="memItemLeft" align="right" valign="top">std::enable_if&lt; M==2, <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; &gt; &gt;::type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2f852881c836e20e6a16469980d7f9b0">dot</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; &amp;other) const</td></tr>
<tr class="memitem:ae29eec9ab673b7d33a191f9e18b57f6b" id="r_ae29eec9ab673b7d33a191f9e18b57f6b"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, size_t P&gt; </td></tr>
<tr class="memitem:ae29eec9ab673b7d33a191f9e18b57f6b template"><td class="memItemLeft" align="right" valign="top">std::enable_if&lt;(M &gt;=3), <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N+P-2 &gt; &gt; &gt;::type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae29eec9ab673b7d33a191f9e18b57f6b">dot</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, P &gt; &amp;other) const</td></tr>
<tr class="memitem:a95ef6a804e30e0c4d1b26e8a784223c4" id="r_a95ef6a804e30e0c4d1b26e8a784223c4"><td class="memTemplParams" colspan="2">template&lt;size_t M = N&gt; </td></tr>
<tr class="memitem:a95ef6a804e30e0c4d1b26e8a784223c4 template"><td class="memItemLeft" align="right" valign="top">std::enable_if&lt; M==1, <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; &gt; &gt;::type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a95ef6a804e30e0c4d1b26e8a784223c4">cross</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; &amp;other) const</td></tr>
<tr class="memitem:a88d5a081d321cbd88ca46ed42ca1112c" id="r_a88d5a081d321cbd88ca46ed42ca1112c"><td class="memTemplParams" colspan="2">template&lt;size_t M = N&gt; </td></tr>
<tr class="memitem:a88d5a081d321cbd88ca46ed42ca1112c template"><td class="memItemLeft" align="right" valign="top">std::enable_if&lt; M==2, <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; &gt; &gt;::type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a88d5a081d321cbd88ca46ed42ca1112c">matmul</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; &amp;other) const</td></tr>
<tr class="memdesc:a88d5a081d321cbd88ca46ed42ca1112c"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc" title="Type alias for 2D matrices.">Matrix</a> multiplication with autograd support (matmul).  <br /></td></tr>
<tr class="memitem:ac20a4679e14de6f68e148b447496adfc" id="r_ac20a4679e14de6f68e148b447496adfc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac20a4679e14de6f68e148b447496adfc">sum_axis</a> (int axis, bool keepdims=false) const</td></tr>
<tr class="memitem:adf1fcb0ddd0ef2db3003401db519ec1c" id="r_adf1fcb0ddd0ef2db3003401db519ec1c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adf1fcb0ddd0ef2db3003401db519ec1c">mean_axis</a> (int axis, bool keepdims=false) const</td></tr>
<tr class="memitem:a4ae322784a9d62e8db2c073f5e2395f7" id="r_a4ae322784a9d62e8db2c073f5e2395f7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4ae322784a9d62e8db2c073f5e2395f7">softmax</a> (int axis=-1) const</td></tr>
<tr class="memdesc:a4ae322784a9d62e8db2c073f5e2395f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Softmax operation with autograd support.  <br /></td></tr>
<tr class="memitem:a834720ab65874a6c5503f7670c4f22fe" id="r_a834720ab65874a6c5503f7670c4f22fe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a834720ab65874a6c5503f7670c4f22fe">log_softmax</a> (int axis=-1) const</td></tr>
<tr class="memitem:af7f0645bcaf472ac0f6214d2b1effd40" id="r_af7f0645bcaf472ac0f6214d2b1effd40"><td class="memTemplParams" colspan="2">template&lt;size_t M&gt; </td></tr>
<tr class="memitem:af7f0645bcaf472ac0f6214d2b1effd40 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, M &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af7f0645bcaf472ac0f6214d2b1effd40">reshape</a> (const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; M &gt; &amp;new_dims) const</td></tr>
<tr class="memitem:aed9419fabd015e2c1c35ff6723c1600a" id="r_aed9419fabd015e2c1c35ff6723c1600a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aed9419fabd015e2c1c35ff6723c1600a">transpose</a> () const</td></tr>
<tr class="memitem:a2429005aeaabb920c7cc943f044dd9d8" id="r_a2429005aeaabb920c7cc943f044dd9d8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2429005aeaabb920c7cc943f044dd9d8">permute</a> (const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;axes) const</td></tr>
<tr class="memitem:a46d44bb69fc3f0b7376ea35e21903b97" id="r_a46d44bb69fc3f0b7376ea35e21903b97"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a46d44bb69fc3f0b7376ea35e21903b97">squeeze</a> (int axis=-1) const</td></tr>
<tr class="memitem:ac953ca944380b138ad1e524a1124070f" id="r_ac953ca944380b138ad1e524a1124070f"><td class="memTemplParams" colspan="2">template&lt;size_t M = N + 1&gt; </td></tr>
<tr class="memitem:ac953ca944380b138ad1e524a1124070f template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, M &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac953ca944380b138ad1e524a1124070f">unsqueeze</a> (size_t axis) const</td></tr>
<tr class="memitem:a7a0af0b59b00d2f2623609ff3562f087" id="r_a7a0af0b59b00d2f2623609ff3562f087"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7a0af0b59b00d2f2623609ff3562f087">concatenate</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other, size_t axis) const</td></tr>
<tr class="memitem:ab71358eec191f202a2e95ce375133c28" id="r_ab71358eec191f202a2e95ce375133c28"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab71358eec191f202a2e95ce375133c28">take</a> (const std::vector&lt; size_t &gt; &amp;indices) const</td></tr>
<tr class="memitem:aedbf41ac61911d6ac3dcd6fc32b89f2c" id="r_aedbf41ac61911d6ac3dcd6fc32b89f2c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aedbf41ac61911d6ac3dcd6fc32b89f2c">put</a> (const std::vector&lt; size_t &gt; &amp;indices, const std::vector&lt; T &gt; &amp;values)</td></tr>
<tr class="memitem:a3090598433576f68f34f340cd6a18089" id="r_a3090598433576f68f34f340cd6a18089"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3090598433576f68f34f340cd6a18089">index_select</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;mask) const</td></tr>
<tr class="memitem:a54c613dc9fe3b552a5e9de8966408fd9" id="r_a54c613dc9fe3b552a5e9de8966408fd9"><td class="memTemplParams" colspan="2">template&lt;size_t M = (N &gt; 1 ? N - 1 : 1)&gt; </td></tr>
<tr class="memitem:a54c613dc9fe3b552a5e9de8966408fd9 template"><td class="memItemLeft" align="right" valign="top">std::enable_if_t&lt;(N &gt; 1), <a class="el" href="classTensor.html">Tensor</a>&lt; T, M &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a54c613dc9fe3b552a5e9de8966408fd9">select</a> (size_t dim, size_t index) const</td></tr>
<tr class="memitem:ac15f7a77f31ef7862dd9909c9ad97160" id="r_ac15f7a77f31ef7862dd9909c9ad97160"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac15f7a77f31ef7862dd9909c9ad97160">sum_axis</a> (size_t axis, bool keepdims=false) const</td></tr>
<tr class="memitem:aeb3f6a9bf8ee28d46a887238a9d3d460" id="r_aeb3f6a9bf8ee28d46a887238a9d3d460"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeb3f6a9bf8ee28d46a887238a9d3d460">mean_axis</a> (size_t axis, bool keepdims=false) const</td></tr>
<tr class="memitem:addc6badb03ce57d1191f2d834169c30a" id="r_addc6badb03ce57d1191f2d834169c30a"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#addc6badb03ce57d1191f2d834169c30a">argmax</a> () const</td></tr>
<tr class="memitem:acb8cb7b5b60996adfc098a5f280aff72" id="r_acb8cb7b5b60996adfc098a5f280aff72"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acb8cb7b5b60996adfc098a5f280aff72">argmin</a> () const</td></tr>
<tr class="memitem:ae5260fcc92739949dd584a0b931d1853" id="r_ae5260fcc92739949dd584a0b931d1853"><td class="memTemplParams" colspan="2">template&lt;size_t M = (N &gt; 1 ? N - 1 : 1)&gt; </td></tr>
<tr class="memitem:ae5260fcc92739949dd584a0b931d1853 template"><td class="memItemLeft" align="right" valign="top">std::enable_if_t&lt;(N &gt; 1), <a class="el" href="classTensor.html">Tensor</a>&lt; size_t, M &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae5260fcc92739949dd584a0b931d1853">argmax_axis</a> (size_t axis) const</td></tr>
<tr class="memitem:a76c7896d6d3ec3066bfd12dbeca73f9e" id="r_a76c7896d6d3ec3066bfd12dbeca73f9e"><td class="memTemplParams" colspan="2">template&lt;size_t M = (N &gt; 1 ? N - 1 : 1)&gt; </td></tr>
<tr class="memitem:a76c7896d6d3ec3066bfd12dbeca73f9e template"><td class="memItemLeft" align="right" valign="top">std::enable_if_t&lt;(N &gt; 1), <a class="el" href="classTensor.html">Tensor</a>&lt; size_t, M &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a76c7896d6d3ec3066bfd12dbeca73f9e">argmin_axis</a> (size_t axis) const</td></tr>
<tr class="memitem:a5784e1627743c06127dbaa1b744cba8e" id="r_a5784e1627743c06127dbaa1b744cba8e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5784e1627743c06127dbaa1b744cba8e">cumsum</a> () const</td></tr>
<tr class="memitem:aead4907bc4e5e749a1dc4e535e9e33f1" id="r_aead4907bc4e5e749a1dc4e535e9e33f1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aead4907bc4e5e749a1dc4e535e9e33f1">cumprod</a> () const</td></tr>
<tr class="memitem:ad19397de13c742b72cd0829b01090dd9" id="r_ad19397de13c742b72cd0829b01090dd9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad19397de13c742b72cd0829b01090dd9">cumsum_axis</a> (size_t axis) const</td></tr>
<tr class="memitem:a885a53dcbb0408b74958517747cf3868" id="r_a885a53dcbb0408b74958517747cf3868"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a885a53dcbb0408b74958517747cf3868">cumprod_axis</a> (size_t axis) const</td></tr>
<tr class="memitem:afc82c153b9df7088bd28dedb89cf7855" id="r_afc82c153b9df7088bd28dedb89cf7855"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afc82c153b9df7088bd28dedb89cf7855">prod</a> () const</td></tr>
<tr class="memitem:a487bc4f354d9fb0dd9f1b4dc2c3c40c8" id="r_a487bc4f354d9fb0dd9f1b4dc2c3c40c8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a487bc4f354d9fb0dd9f1b4dc2c3c40c8">any</a> () const</td></tr>
<tr class="memitem:a2dc155b6d76e3ec3492e4693c59bc8c4" id="r_a2dc155b6d76e3ec3492e4693c59bc8c4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2dc155b6d76e3ec3492e4693c59bc8c4">all</a> () const</td></tr>
<tr class="memitem:a5a354f1c9709ae8089a859608564fc4f" id="r_a5a354f1c9709ae8089a859608564fc4f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a354f1c9709ae8089a859608564fc4f">flatten</a> () const</td></tr>
<tr class="memitem:a9905069af5b17d1a5d1c16ec6f0a80fa" id="r_a9905069af5b17d1a5d1c16ec6f0a80fa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9905069af5b17d1a5d1c16ec6f0a80fa">repeat</a> (const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;repeats) const</td></tr>
<tr class="memitem:a84007917e116ae1e79622ca804360146" id="r_a84007917e116ae1e79622ca804360146"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a84007917e116ae1e79622ca804360146">tile</a> (const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;reps) const</td></tr>
<tr class="memitem:a4ff4d01c7fdd48791ebe12a02dbeb655" id="r_a4ff4d01c7fdd48791ebe12a02dbeb655"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:a4ff4d01c7fdd48791ebe12a02dbeb655 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4ff4d01c7fdd48791ebe12a02dbeb655">row</a> (size_t row_idx) const</td></tr>
<tr class="memdesc:a4ff4d01c7fdd48791ebe12a02dbeb655"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract a single row (only for 2D tensors).  <br /></td></tr>
<tr class="memitem:a42cef0c31a6dcf0846d2c6e2d24e7240" id="r_a42cef0c31a6dcf0846d2c6e2d24e7240"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:a42cef0c31a6dcf0846d2c6e2d24e7240 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a42cef0c31a6dcf0846d2c6e2d24e7240">col</a> (size_t col_idx) const</td></tr>
<tr class="memdesc:a42cef0c31a6dcf0846d2c6e2d24e7240"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract a single column (only for 2D tensors).  <br /></td></tr>
<tr class="memitem:af46e252ac24e0557b28c177bd9070596" id="r_af46e252ac24e0557b28c177bd9070596"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:af46e252ac24e0557b28c177bd9070596 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af46e252ac24e0557b28c177bd9070596">diag</a> () const</td></tr>
<tr class="memdesc:af46e252ac24e0557b28c177bd9070596"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract diagonal elements (only for 2D tensors).  <br /></td></tr>
<tr class="memitem:a77397ac152988d5ed90941bac5a96c28" id="r_a77397ac152988d5ed90941bac5a96c28"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:a77397ac152988d5ed90941bac5a96c28 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a77397ac152988d5ed90941bac5a96c28">block</a> (size_t start_row, size_t start_col, size_t num_rows, size_t num_cols) const</td></tr>
<tr class="memdesc:a77397ac152988d5ed90941bac5a96c28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract a rectangular block (only for 2D tensors).  <br /></td></tr>
<tr class="memitem:a89cf45ee5d7ddfdf69a387c2345039c7" id="r_a89cf45ee5d7ddfdf69a387c2345039c7"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 1&gt;&gt; </td></tr>
<tr class="memitem:a89cf45ee5d7ddfdf69a387c2345039c7 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a89cf45ee5d7ddfdf69a387c2345039c7">head</a> (size_t n) const</td></tr>
<tr class="memdesc:a89cf45ee5d7ddfdf69a387c2345039c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract first n elements (only for 1D tensors).  <br /></td></tr>
<tr class="memitem:a44953b617ae85b4e9cc7906454bee59d" id="r_a44953b617ae85b4e9cc7906454bee59d"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 1&gt;&gt; </td></tr>
<tr class="memitem:a44953b617ae85b4e9cc7906454bee59d template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a44953b617ae85b4e9cc7906454bee59d">tail</a> (size_t n) const</td></tr>
<tr class="memdesc:a44953b617ae85b4e9cc7906454bee59d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract last n elements (only for 1D tensors).  <br /></td></tr>
<tr class="memitem:af09f3224c551629f43c48c18a1fe87ee" id="r_af09f3224c551629f43c48c18a1fe87ee"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:af09f3224c551629f43c48c18a1fe87ee template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af09f3224c551629f43c48c18a1fe87ee">topRows</a> (size_t n) const</td></tr>
<tr class="memdesc:af09f3224c551629f43c48c18a1fe87ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract top n rows (only for 2D tensors).  <br /></td></tr>
<tr class="memitem:a8ecd760521443aca3613911d9af40d5a" id="r_a8ecd760521443aca3613911d9af40d5a"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:a8ecd760521443aca3613911d9af40d5a template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8ecd760521443aca3613911d9af40d5a">bottomRows</a> (size_t n) const</td></tr>
<tr class="memdesc:a8ecd760521443aca3613911d9af40d5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract bottom n rows (only for 2D tensors).  <br /></td></tr>
<tr class="memitem:aff781405a45c8ec01fde149ecba560b6" id="r_aff781405a45c8ec01fde149ecba560b6"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:aff781405a45c8ec01fde149ecba560b6 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aff781405a45c8ec01fde149ecba560b6">leftCols</a> (size_t n) const</td></tr>
<tr class="memdesc:aff781405a45c8ec01fde149ecba560b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract leftmost n columns (only for 2D tensors).  <br /></td></tr>
<tr class="memitem:aa25623075f40e0244dd4c2a649e2b3d5" id="r_aa25623075f40e0244dd4c2a649e2b3d5"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:aa25623075f40e0244dd4c2a649e2b3d5 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa25623075f40e0244dd4c2a649e2b3d5">rightCols</a> (size_t n) const</td></tr>
<tr class="memdesc:aa25623075f40e0244dd4c2a649e2b3d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract rightmost n columns (only for 2D tensors).  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-static-methods" class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ab35759b8f0cec852e27c31cf339737b8" id="r_ab35759b8f0cec852e27c31cf339737b8"><td class="memTemplParams" colspan="2">template&lt;typename C&gt; </td></tr>
<tr class="memitem:ab35759b8f0cec852e27c31cf339737b8 template"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab35759b8f0cec852e27c31cf339737b8">where</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; C, N &gt; &amp;condition, const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;x, const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;y)</td></tr>
<tr class="memitem:a9583b3dbaa99f4251d08085617f1b858" id="r_a9583b3dbaa99f4251d08085617f1b858"><td class="memTemplParams" colspan="2">template&lt;size_t... Dims&gt; </td></tr>
<tr class="memitem:a9583b3dbaa99f4251d08085617f1b858 template"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classTensor.html">Tensor</a>&lt; T, N+1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9583b3dbaa99f4251d08085617f1b858">stack</a> (const std::vector&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; &amp;tensors, size_t dim=0)</td></tr>
<tr class="memitem:a0fc4cc0c22be7a233b9c64c6677d54d5" id="r_a0fc4cc0c22be7a233b9c64c6677d54d5"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0fc4cc0c22be7a233b9c64c6677d54d5">vstack</a> (const std::vector&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; &amp;tensors)</td></tr>
<tr class="memitem:aed3511f1720813839550315f701cb516" id="r_aed3511f1720813839550315f701cb516"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aed3511f1720813839550315f701cb516">hstack</a> (const std::vector&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; &amp;tensors)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pri-methods" class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:acfd498e431d2689e191c1e9cb8d600fb" id="r_acfd498e431d2689e191c1e9cb8d600fb"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acfd498e431d2689e191c1e9cb8d600fb">offset</a> (const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;indices) const</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pri-attribs" class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:acf7ced620891506216fc0112a743e04b" id="r_acf7ced620891506216fc0112a743e04b"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; T[]&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acf7ced620891506216fc0112a743e04b">data_</a></td></tr>
<tr class="memdesc:acf7ced620891506216fc0112a743e04b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flat data storage in row-major order.  <br /></td></tr>
<tr class="memitem:a43fadce1ce3dd9ddb47c8b82168edb52" id="r_a43fadce1ce3dd9ddb47c8b82168edb52"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a></td></tr>
<tr class="memdesc:a43fadce1ce3dd9ddb47c8b82168edb52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dimensions of the tensor.  <br /></td></tr>
<tr class="memitem:af6821d656bfc94c60fe4cd256c1d7402" id="r_af6821d656bfc94c60fe4cd256c1d7402"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af6821d656bfc94c60fe4cd256c1d7402">strides_</a></td></tr>
<tr class="memdesc:af6821d656bfc94c60fe4cd256c1d7402"><td class="mdescLeft">&#160;</td><td class="mdescRight">Strides for each dimension.  <br /></td></tr>
<tr class="memitem:aa3214ec02474d17494e1eb95d5006262" id="r_aa3214ec02474d17494e1eb95d5006262"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a></td></tr>
<tr class="memdesc:aa3214ec02474d17494e1eb95d5006262"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to indicate if GPU should be used.  <br /></td></tr>
<tr id="pri-attribs-0" class="groupHeader"><td colspan="2"><div class="groupHeader">Autograd Support</div></td></tr>
<tr class="memitem:ac6b266b9e3b51d9da88b35eea30a92ec" id="r_ac6b266b9e3b51d9da88b35eea30a92ec"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a></td></tr>
<tr class="memdesc:ac6b266b9e3b51d9da88b35eea30a92ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether to track gradients.  <br /></td></tr>
<tr class="memitem:a4d61cfe1428b0302cd1683dc1e6fd733" id="r_a4d61cfe1428b0302cd1683dc1e6fd733"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a></td></tr>
<tr class="memdesc:a4d61cfe1428b0302cd1683dc1e6fd733"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gradient tensor.  <br /></td></tr>
<tr class="memitem:a89d50a2ba15e719d4bf025178150d308" id="r_a89d50a2ba15e719d4bf025178150d308"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="tensor_8h.html#a1e846f46f87b55f57de12d6aa70eda1e">BackwardFunc</a>&lt; T, N &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a></td></tr>
<tr class="memdesc:a89d50a2ba15e719d4bf025178150d308"><td class="mdescLeft">&#160;</td><td class="mdescRight">Functions to compute gradients.  <br /></td></tr>
<tr class="memitem:abf7257d130e6bc46f6d2cd7de4ea2909" id="r_abf7257d130e6bc46f6d2cd7de4ea2909"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a></td></tr>
<tr class="memdesc:abf7257d130e6bc46f6d2cd7de4ea2909"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether this is a leaf node in the graph.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-friends" class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:af4a07134de1525172d3c60c57e8f1496" id="r_af4a07134de1525172d3c60c57e8f1496"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:af4a07134de1525172d3c60c57e8f1496 template"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af4a07134de1525172d3c60c57e8f1496">Tensor</a></td></tr>
<tr class="memitem:a22260556618c0a39e3ff6824e778fdb3" id="r_a22260556618c0a39e3ff6824e778fdb3"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a22260556618c0a39e3ff6824e778fdb3 template"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a22260556618c0a39e3ff6824e778fdb3">TensorView</a></td></tr>
<tr class="memitem:acff32a26ad67634e185bf3be335d8f45" id="r_acff32a26ad67634e185bf3be335d8f45"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:acff32a26ad67634e185bf3be335d8f45 template"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acff32a26ad67634e185bf3be335d8f45">TensorSlice</a></td></tr>
<tr class="memitem:a7dfa2de684ae22342afca259156bc646" id="r_a7dfa2de684ae22342afca259156bc646"><td class="memTemplParams" colspan="2">template&lt;typename U&gt; </td></tr>
<tr class="memitem:a7dfa2de684ae22342afca259156bc646 template"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7dfa2de684ae22342afca259156bc646">Optimizer</a></td></tr>
<tr class="memitem:abd938abc7dd75aa658a2f68507d27e0c" id="r_abd938abc7dd75aa658a2f68507d27e0c"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:abd938abc7dd75aa658a2f68507d27e0c template"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abd938abc7dd75aa658a2f68507d27e0c">SGD</a></td></tr>
<tr class="memitem:af7fd1e562b92d7f3302fc10d83effcb1" id="r_af7fd1e562b92d7f3302fc10d83effcb1"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:af7fd1e562b92d7f3302fc10d83effcb1 template"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af7fd1e562b92d7f3302fc10d83effcb1">Adam</a></td></tr>
<tr class="memitem:abaf62b111934cc2f3ca92641c4f0d6e4" id="r_abaf62b111934cc2f3ca92641c4f0d6e4"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:abaf62b111934cc2f3ca92641c4f0d6e4 template"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abaf62b111934cc2f3ca92641c4f0d6e4">RMSprop</a></td></tr>
<tr class="memitem:a5d13a99740a5300be84dda1088ba7090" id="r_a5d13a99740a5300be84dda1088ba7090"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a5d13a99740a5300be84dda1088ba7090 template"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5d13a99740a5300be84dda1088ba7090">save_binary</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const std::string &amp;)</td></tr>
<tr class="memitem:a9a5b8df7f4954ba2fb1f867a57d760dc" id="r_a9a5b8df7f4954ba2fb1f867a57d760dc"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a9a5b8df7f4954ba2fb1f867a57d760dc template"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9a5b8df7f4954ba2fb1f867a57d760dc">save_text</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const std::string &amp;, int)</td></tr>
<tr class="memitem:a38b040592e2971efef12ec68d71ab18b" id="r_a38b040592e2971efef12ec68d71ab18b"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a38b040592e2971efef12ec68d71ab18b template"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a38b040592e2971efef12ec68d71ab18b">save_npy</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const std::string &amp;)</td></tr>
<tr class="memitem:a41c9488576fa08bf4f2140fa944babcb" id="r_a41c9488576fa08bf4f2140fa944babcb"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a41c9488576fa08bf4f2140fa944babcb template"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a41c9488576fa08bf4f2140fa944babcb">print</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, std::ostream &amp;, int, size_t, size_t)</td></tr>
<tr class="memitem:a2cb4bd9887892f4061bcc4dca0b73bea" id="r_a2cb4bd9887892f4061bcc4dca0b73bea"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a2cb4bd9887892f4061bcc4dca0b73bea template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2cb4bd9887892f4061bcc4dca0b73bea">operator+</a> (const U &amp;scalar, const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;tensor)</td></tr>
<tr class="memitem:aac6ea4a3d1a17a2636be1ebfe4980aca" id="r_aac6ea4a3d1a17a2636be1ebfe4980aca"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:aac6ea4a3d1a17a2636be1ebfe4980aca template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aac6ea4a3d1a17a2636be1ebfe4980aca">operator-</a> (const U &amp;scalar, const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;tensor)</td></tr>
<tr class="memitem:a8f3108b5c57f4335e97b21b78b42330d" id="r_a8f3108b5c57f4335e97b21b78b42330d"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a8f3108b5c57f4335e97b21b78b42330d template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8f3108b5c57f4335e97b21b78b42330d">operator*</a> (const U &amp;scalar, const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;tensor)</td></tr>
<tr class="memitem:a0720e918044cb7c8c9246a04605bc3dc" id="r_a0720e918044cb7c8c9246a04605bc3dc"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a0720e918044cb7c8c9246a04605bc3dc template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0720e918044cb7c8c9246a04605bc3dc">operator/</a> (const U &amp;scalar, const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;tensor)</td></tr>
<tr class="memitem:a73e9357327da350df1da748ebeeefdaf" id="r_a73e9357327da350df1da748ebeeefdaf"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a73e9357327da350df1da748ebeeefdaf template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a73e9357327da350df1da748ebeeefdaf">loss::mse_loss</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const std::string &amp;)</td></tr>
<tr class="memitem:a683473b73d31abc59759419a3214cc0a" id="r_a683473b73d31abc59759419a3214cc0a"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a683473b73d31abc59759419a3214cc0a template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a683473b73d31abc59759419a3214cc0a">loss::cross_entropy_loss</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const std::string &amp;)</td></tr>
<tr class="memitem:a90bb53720dd3d4ba6e6bdacd786a7eaa" id="r_a90bb53720dd3d4ba6e6bdacd786a7eaa"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a90bb53720dd3d4ba6e6bdacd786a7eaa template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a90bb53720dd3d4ba6e6bdacd786a7eaa">loss::binary_cross_entropy</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const std::string &amp;)</td></tr>
<tr class="memitem:a0cda1cdc9cb6e34768415968395336e6" id="r_a0cda1cdc9cb6e34768415968395336e6"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a0cda1cdc9cb6e34768415968395336e6 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0cda1cdc9cb6e34768415968395336e6">loss::l1_loss</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const std::string &amp;)</td></tr>
<tr class="memitem:a9893818a67f313b613d96073a7e499ba" id="r_a9893818a67f313b613d96073a7e499ba"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a9893818a67f313b613d96073a7e499ba template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9893818a67f313b613d96073a7e499ba">loss::smooth_l1_loss</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, U, const std::string &amp;)</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename T, size_t N&gt;<br />
class Tensor&lt; T, N &gt;</div><p>Forward declaration for autograd. </p>
<p>Multi-dimensional array with GPU, BLAS, and autograd support.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Data type (float, double, int, etc.) </td></tr>
    <tr><td class="paramname">N</td><td>Number of dimensions</td></tr>
  </table>
  </dd>
</dl>
<p>A powerful tensor class supporting:</p><ul>
<li>Arbitrary dimensions (compile-time fixed)</li>
<li>GPU acceleration (CUDA)</li>
<li>Optimized BLAS operations</li>
<li>Automatic differentiation (autograd)</li>
<li>Element-wise operations with broadcasting</li>
<li>Mathematical functions (exp, log, sin, etc.)</li>
<li>Statistical operations (mean, variance, correlation)</li>
<li>Linear algebra operations</li>
<li><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> views and slicing</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="memory"></a>
Memory Layout</h1>
<p>Data is stored in row-major order in a flat array. Strides are computed automatically to enable efficient multi-dimensional indexing.</p>
<h1 class="doxsection"><a class="anchor" id="autograd"></a>
Automatic Differentiation</h1>
<p>When <span class="tt"><a class="el" href="#a947326cf96b1bf3423b40861e1213ab8">requires_grad</a></span> is true, the tensor participates in gradient computation. Operations build a computational graph that can be traversed via <a class="el" href="#ace4d96d1fc0d364577334241662fb60e" title="Perform backward pass to compute gradients (autograd).">backward()</a>.</p>
<h1 class="doxsection"><a class="anchor" id="example"></a>
Example Usage</h1>
<div class="fragment"><div class="line"><span class="comment">// Create a 2x3 matrix</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> A({2, 3});</div>
<div class="line">A.fill(1.0f);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Element-wise operations</span></div>
<div class="line"><span class="keyword">auto</span> B = A + 2.0f;</div>
<div class="line"><span class="keyword">auto</span> C = A * B;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// With autograd</span></div>
<div class="line"><a class="code hl_class" href="classTensor.html">Tensor&lt;float, 1&gt;</a> x({10}, <span class="keyword">true</span>, <span class="keyword">true</span>);  <span class="comment">// GPU=true, requires_grad=true</span></div>
<div class="line"><span class="keyword">auto</span> y = x.<a class="code hl_function" href="#ae94340cb4134b887428082dc683fe2b2">exp</a>().sum();</div>
<div class="line">y.<a class="code hl_function" href="#ace4d96d1fc0d364577334241662fb60e">backward</a>();</div>
<div class="line"><span class="keyword">auto</span> gradients = x.grad();  <span class="comment">// Get computed gradients</span></div>
<div class="ttc" id="aclassTensor_html"><div class="ttname"><a href="classTensor.html">Tensor</a></div><div class="ttdoc">Forward declaration for autograd.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00444">tensor.h:444</a></div></div>
<div class="ttc" id="aclassTensor_html_ace4d96d1fc0d364577334241662fb60e"><div class="ttname"><a href="#ace4d96d1fc0d364577334241662fb60e">Tensor::backward</a></div><div class="ttdeci">std::optional&lt; TensorError &gt; backward(const Tensor&lt; T, N &gt; *gradient=nullptr)</div><div class="ttdoc">Perform backward pass to compute gradients (autograd).</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00783">tensor.h:783</a></div></div>
<div class="ttc" id="aclassTensor_html_ae94340cb4134b887428082dc683fe2b2"><div class="ttname"><a href="#ae94340cb4134b887428082dc683fe2b2">Tensor::exp</a></div><div class="ttdeci">Tensor&lt; T, N &gt; exp() const</div><div class="ttdoc">Apply exponential function to all elements (creates new tensor).</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l01512">tensor.h:1512</a></div></div>
<div class="ttc" id="aclassTensor_html_af4a07134de1525172d3c60c57e8f1496"><div class="ttname"><a href="#af4a07134de1525172d3c60c57e8f1496">Tensor::Tensor</a></div><div class="ttdeci">friend class Tensor</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00474">tensor.h:474</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00444">444</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
</div><a name="doc-constructors" id="doc-constructors"></a><h2 id="header-doc-constructors" class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a8a85c4bf5ad38b0ba4a3d8665dfce486" name="a8a85c4bf5ad38b0ba4a3d8665dfce486"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a85c4bf5ad38b0ba4a3d8665dfce486">&#9670;&#160;</a></span>Tensor() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::Tensor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>dimensions</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>use_gpu</em></span><span class="paramdefsep"> = </span><span class="paramdefval">true</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>requires_grad</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor to initialize the tensor with given dimensions. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dimensions</td><td>An array specifying the size of each dimension. </td></tr>
    <tr><td class="paramname">use_gpu</td><td>Whether to use GPU acceleration when available (default: true). </td></tr>
    <tr><td class="paramname">requires_grad</td><td>Whether to track gradients for this tensor (default: false). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00540">540</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  541</span>        : <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>(<a class="code hl_class" href="classTensor.html">dimensions</a>), <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>(<a class="code hl_function" href="#a947326cf96b1bf3423b40861e1213ab8">requires_grad</a>), <a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a>(<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  542</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = 1;</div>
<div class="line"><span class="lineno">  543</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">N</a>; <a class="code hl_class" href="classTensor.html">i</a>-- &gt; 0;) {</div>
<div class="line"><span class="lineno">  544</span>            <a class="code hl_variable" href="#af6821d656bfc94c60fe4cd256c1d7402">strides_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">total</a>;</div>
<div class="line"><span class="lineno">  545</span>            <a class="code hl_class" href="classTensor.html">total</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno">  546</span>        }</div>
<div class="line"><span class="lineno">  547</span>        <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;T[]&gt;</a>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno">  548</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  549</span>        <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> = <a class="code hl_class" href="classTensor.html">use_gpu</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">TensorGPU::is_gpu_available</a>();</div>
<div class="line"><span class="lineno">  550</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  551</span>        <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  552</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  553</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno">  554</span>            <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  555</span>            <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno">  556</span>        }</div>
<div class="line"><span class="lineno">  557</span>    }</div>
<div class="ttc" id="aclassTensor_html_a43fadce1ce3dd9ddb47c8b82168edb52"><div class="ttname"><a href="#a43fadce1ce3dd9ddb47c8b82168edb52">Tensor::dims_</a></div><div class="ttdeci">TensorIndices&lt; N &gt; dims_</div><div class="ttdoc">Dimensions of the tensor.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00447">tensor.h:447</a></div></div>
<div class="ttc" id="aclassTensor_html_a4d61cfe1428b0302cd1683dc1e6fd733"><div class="ttname"><a href="#a4d61cfe1428b0302cd1683dc1e6fd733">Tensor::grad_</a></div><div class="ttdeci">std::unique_ptr&lt; Tensor&lt; T, N &gt; &gt; grad_</div><div class="ttdoc">Gradient tensor.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00454">tensor.h:454</a></div></div>
<div class="ttc" id="aclassTensor_html_a947326cf96b1bf3423b40861e1213ab8"><div class="ttname"><a href="#a947326cf96b1bf3423b40861e1213ab8">Tensor::requires_grad</a></div><div class="ttdeci">bool requires_grad() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00728">tensor.h:728</a></div></div>
<div class="ttc" id="aclassTensor_html_aa3214ec02474d17494e1eb95d5006262"><div class="ttname"><a href="#aa3214ec02474d17494e1eb95d5006262">Tensor::use_gpu_</a></div><div class="ttdeci">bool use_gpu_</div><div class="ttdoc">Flag to indicate if GPU should be used.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00449">tensor.h:449</a></div></div>
<div class="ttc" id="aclassTensor_html_abf7257d130e6bc46f6d2cd7de4ea2909"><div class="ttname"><a href="#abf7257d130e6bc46f6d2cd7de4ea2909">Tensor::is_leaf_</a></div><div class="ttdeci">bool is_leaf_</div><div class="ttdoc">Whether this is a leaf node in the graph.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00456">tensor.h:456</a></div></div>
<div class="ttc" id="aclassTensor_html_ac6b266b9e3b51d9da88b35eea30a92ec"><div class="ttname"><a href="#ac6b266b9e3b51d9da88b35eea30a92ec">Tensor::requires_grad_</a></div><div class="ttdeci">bool requires_grad_</div><div class="ttdoc">Whether to track gradients.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00453">tensor.h:453</a></div></div>
<div class="ttc" id="aclassTensor_html_acf7ced620891506216fc0112a743e04b"><div class="ttname"><a href="#acf7ced620891506216fc0112a743e04b">Tensor::data_</a></div><div class="ttdeci">std::unique_ptr&lt; T[]&gt; data_</div><div class="ttdoc">Flat data storage in row-major order.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00446">tensor.h:446</a></div></div>
<div class="ttc" id="aclassTensor_html_af6821d656bfc94c60fe4cd256c1d7402"><div class="ttname"><a href="#af6821d656bfc94c60fe4cd256c1d7402">Tensor::strides_</a></div><div class="ttdeci">TensorIndices&lt; N &gt; strides_</div><div class="ttdoc">Strides for each dimension.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00448">tensor.h:448</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a905559324e349a17f2530a9b5ce067ee" name="a905559324e349a17f2530a9b5ce067ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a905559324e349a17f2530a9b5ce067ee">&#9670;&#160;</a></span>Tensor() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::Tensor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Copy constructor for deep copying the tensor. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to copy from. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00563">563</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  564</span>        : <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>), <a class="code hl_variable" href="#af6821d656bfc94c60fe4cd256c1d7402">strides_</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#af6821d656bfc94c60fe4cd256c1d7402">strides_</a>), <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>),</div>
<div class="line"><span class="lineno">  565</span>          <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>), <a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a>),</div>
<div class="line"><span class="lineno">  566</span>          <a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno">  567</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno">  568</span>        <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;T[]&gt;</a>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno">  569</span>        <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_class" href="classTensor.html">total</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno">  570</span>        </div>
<div class="line"><span class="lineno">  571</span>        <span class="comment">// Copy gradient if it exists</span></div>
<div class="line"><span class="lineno">  572</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno">  573</span>            <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(*<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno">  574</span>        }</div>
<div class="line"><span class="lineno">  575</span>    }</div>
<div class="ttc" id="aclassTensor_html_a89d50a2ba15e719d4bf025178150d308"><div class="ttname"><a href="#a89d50a2ba15e719d4bf025178150d308">Tensor::backward_funcs_</a></div><div class="ttdeci">std::vector&lt; BackwardFunc&lt; T, N &gt; &gt; backward_funcs_</div><div class="ttdoc">Functions to compute gradients.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00455">tensor.h:455</a></div></div>
<div class="ttc" id="aclassTensor_html_aad6aeb4859940befd0c46f0b99388bd7"><div class="ttname"><a href="#aad6aeb4859940befd0c46f0b99388bd7">Tensor::total_size</a></div><div class="ttdeci">size_t total_size() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00511">tensor.h:511</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Member Function Documentation</h2>
<a id="a694440b236a5cfb314e68adec066a9c6" name="a694440b236a5cfb314e68adec066a9c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a694440b236a5cfb314e68adec066a9c6">&#9670;&#160;</a></span>abs()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::abs </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply absolute value to all elements (creates new tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with abs(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01653">1653</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1653</span>                             {</div>
<div class="line"><span class="lineno"> 1654</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::abs</a>(<a class="code hl_class" href="classTensor.html">x</a>); });</div>
<div class="line"><span class="lineno"> 1655</span>    }</div>
<div class="ttc" id="aclassTensor_html_a314dfaedc4f6b2dc8e3b44bbc5381eb3"><div class="ttname"><a href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">Tensor::map</a></div><div class="ttdeci">Tensor&lt; T, N &gt; map(Func func) const</div><div class="ttdoc">Apply a function to each element of the tensor (creates new tensor).</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l01443">tensor.h:1443</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2dc155b6d76e3ec3492e4693c59bc8c4" name="a2dc155b6d76e3ec3492e4693c59bc8c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dc155b6d76e3ec3492e4693c59bc8c4">&#9670;&#160;</a></span>all()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::all </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if all elements are non-zero (boolean reduction). </p><dl class="section return"><dt>Returns</dt><dd>true if all elements are non-zero, false otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04929">4929</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4929</span>                     {</div>
<div class="line"><span class="lineno"> 4930</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4931</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4932</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] == <a class="code hl_class" href="classTensor.html">T</a>(0)) {</div>
<div class="line"><span class="lineno"> 4933</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4934</span>            }</div>
<div class="line"><span class="lineno"> 4935</span>        }</div>
<div class="line"><span class="lineno"> 4936</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4937</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a487bc4f354d9fb0dd9f1b4dc2c3c40c8" name="a487bc4f354d9fb0dd9f1b4dc2c3c40c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a487bc4f354d9fb0dd9f1b4dc2c3c40c8">&#9670;&#160;</a></span>any()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::any </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if any element is non-zero (boolean reduction). </p><dl class="section return"><dt>Returns</dt><dd>true if any element is non-zero, false otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04915">4915</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4915</span>                     {</div>
<div class="line"><span class="lineno"> 4916</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4917</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4918</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] != <a class="code hl_class" href="classTensor.html">T</a>(0)) {</div>
<div class="line"><span class="lineno"> 4919</span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4920</span>            }</div>
<div class="line"><span class="lineno"> 4921</span>        }</div>
<div class="line"><span class="lineno"> 4922</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4923</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="addc6badb03ce57d1191f2d834169c30a" name="addc6badb03ce57d1191f2d834169c30a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addc6badb03ce57d1191f2d834169c30a">&#9670;&#160;</a></span>argmax()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::argmax </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Find index of maximum element (argmax). For multi-dimensional tensors, returns flattened index. </p><dl class="section return"><dt>Returns</dt><dd>The index of the maximum element. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04621">4621</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4621</span>                          {</div>
<div class="line"><span class="lineno"> 4622</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4623</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">max_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 4624</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0];</div>
<div class="line"><span class="lineno"> 4625</span>        </div>
<div class="line"><span class="lineno"> 4626</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4627</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt; <a class="code hl_class" href="classTensor.html">max_val</a>) {</div>
<div class="line"><span class="lineno"> 4628</span>                <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4629</span>                <a class="code hl_class" href="classTensor.html">max_idx</a> = <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4630</span>            }</div>
<div class="line"><span class="lineno"> 4631</span>        }</div>
<div class="line"><span class="lineno"> 4632</span>        </div>
<div class="line"><span class="lineno"> 4633</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">max_idx</a>;</div>
<div class="line"><span class="lineno"> 4634</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5260fcc92739949dd584a0b931d1853" name="ae5260fcc92739949dd584a0b931d1853"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5260fcc92739949dd584a0b931d1853">&#9670;&#160;</a></span>argmax_axis()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = (N &gt; 1 ? N - 1 : 1)&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if_t&lt;(N &gt; 1), <a class="el" href="classTensor.html">Tensor</a>&lt; size_t, M &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::argmax_axis </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>axis</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Find indices of maximum elements along an axis. Only available for tensors with N &gt; 1. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The dimension along which to find argmax. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with one less dimension containing indices. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04663">4663</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4663</span>                                                                              {</div>
<div class="line"><span class="lineno"> 4664</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &gt;= <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 4665</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;M&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 4666</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;size_t, M&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4667</span>        }</div>
<div class="line"><span class="lineno"> 4668</span>        </div>
<div class="line"><span class="lineno"> 4669</span>        <span class="comment">// Calculate new dimensions (removing the axis dimension)</span></div>
<div class="line"><span class="lineno"> 4670</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;M&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a>;</div>
<div class="line"><span class="lineno"> 4671</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">new_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 4672</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4673</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">i</a> != <a class="code hl_class" href="classTensor.html">axis</a>) {</div>
<div class="line"><span class="lineno"> 4674</span>                <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">new_idx</a>++] = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4675</span>            }</div>
<div class="line"><span class="lineno"> 4676</span>        }</div>
<div class="line"><span class="lineno"> 4677</span>        </div>
<div class="line"><span class="lineno"> 4678</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;size_t, M&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4679</span>        </div>
<div class="line"><span class="lineno"> 4680</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 4681</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">axis</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4682</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4683</span>        }</div>
<div class="line"><span class="lineno"> 4684</span>        </div>
<div class="line"><span class="lineno"> 4685</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 4686</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">axis</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4687</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4688</span>        }</div>
<div class="line"><span class="lineno"> 4689</span>        </div>
<div class="line"><span class="lineno"> 4690</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">axis_size</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>];</div>
<div class="line"><span class="lineno"> 4691</span>        </div>
<div class="line"><span class="lineno"> 4692</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4693</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4694</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">max_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 4695</span>                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4696</span>                </div>
<div class="line"><span class="lineno"> 4697</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 1; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 4698</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4699</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">src_idx</a>] &gt; <a class="code hl_class" href="classTensor.html">max_val</a>) {</div>
<div class="line"><span class="lineno"> 4700</span>                        <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 4701</span>                        <a class="code hl_class" href="classTensor.html">max_idx</a> = <a class="code hl_class" href="classTensor.html">a</a>;</div>
<div class="line"><span class="lineno"> 4702</span>                    }</div>
<div class="line"><span class="lineno"> 4703</span>                }</div>
<div class="line"><span class="lineno"> 4704</span>                </div>
<div class="line"><span class="lineno"> 4705</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dst_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4706</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>()[<a class="code hl_class" href="classTensor.html">dst_idx</a>] = <a class="code hl_class" href="classTensor.html">max_idx</a>;</div>
<div class="line"><span class="lineno"> 4707</span>            }</div>
<div class="line"><span class="lineno"> 4708</span>        }</div>
<div class="line"><span class="lineno"> 4709</span>        </div>
<div class="line"><span class="lineno"> 4710</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4711</span>    }</div>
<div class="ttc" id="aclassTensor_html_a07bf856a863505d2960b0bfad9c3b3f4"><div class="ttname"><a href="#a07bf856a863505d2960b0bfad9c3b3f4">Tensor::data</a></div><div class="ttdeci">const T * data() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00523">tensor.h:523</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acb8cb7b5b60996adfc098a5f280aff72" name="acb8cb7b5b60996adfc098a5f280aff72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb8cb7b5b60996adfc098a5f280aff72">&#9670;&#160;</a></span>argmin()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::argmin </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Find index of minimum element (argmin). For multi-dimensional tensors, returns flattened index. </p><dl class="section return"><dt>Returns</dt><dd>The index of the minimum element. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04641">4641</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4641</span>                          {</div>
<div class="line"><span class="lineno"> 4642</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4643</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">min_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 4644</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">min_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0];</div>
<div class="line"><span class="lineno"> 4645</span>        </div>
<div class="line"><span class="lineno"> 4646</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4647</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &lt; <a class="code hl_class" href="classTensor.html">min_val</a>) {</div>
<div class="line"><span class="lineno"> 4648</span>                <a class="code hl_class" href="classTensor.html">min_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4649</span>                <a class="code hl_class" href="classTensor.html">min_idx</a> = <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4650</span>            }</div>
<div class="line"><span class="lineno"> 4651</span>        }</div>
<div class="line"><span class="lineno"> 4652</span>        </div>
<div class="line"><span class="lineno"> 4653</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">min_idx</a>;</div>
<div class="line"><span class="lineno"> 4654</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a76c7896d6d3ec3066bfd12dbeca73f9e" name="a76c7896d6d3ec3066bfd12dbeca73f9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76c7896d6d3ec3066bfd12dbeca73f9e">&#9670;&#160;</a></span>argmin_axis()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = (N &gt; 1 ? N - 1 : 1)&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if_t&lt;(N &gt; 1), <a class="el" href="classTensor.html">Tensor</a>&lt; size_t, M &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::argmin_axis </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>axis</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Find indices of minimum elements along an axis. Only available for tensors with N &gt; 1. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The dimension along which to find argmin. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with one less dimension containing indices. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04720">4720</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4720</span>                                                                              {</div>
<div class="line"><span class="lineno"> 4721</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &gt;= <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 4722</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;M&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 4723</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;size_t, M&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4724</span>        }</div>
<div class="line"><span class="lineno"> 4725</span>        </div>
<div class="line"><span class="lineno"> 4726</span>        <span class="comment">// Calculate new dimensions (removing the axis dimension)</span></div>
<div class="line"><span class="lineno"> 4727</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;M&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a>;</div>
<div class="line"><span class="lineno"> 4728</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">new_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 4729</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4730</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">i</a> != <a class="code hl_class" href="classTensor.html">axis</a>) {</div>
<div class="line"><span class="lineno"> 4731</span>                <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">new_idx</a>++] = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4732</span>            }</div>
<div class="line"><span class="lineno"> 4733</span>        }</div>
<div class="line"><span class="lineno"> 4734</span>        </div>
<div class="line"><span class="lineno"> 4735</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;size_t, M&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4736</span>        </div>
<div class="line"><span class="lineno"> 4737</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 4738</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">axis</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4739</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4740</span>        }</div>
<div class="line"><span class="lineno"> 4741</span>        </div>
<div class="line"><span class="lineno"> 4742</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 4743</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">axis</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4744</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4745</span>        }</div>
<div class="line"><span class="lineno"> 4746</span>        </div>
<div class="line"><span class="lineno"> 4747</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">axis_size</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>];</div>
<div class="line"><span class="lineno"> 4748</span>        </div>
<div class="line"><span class="lineno"> 4749</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4750</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4751</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">min_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 4752</span>                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">min_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4753</span>                </div>
<div class="line"><span class="lineno"> 4754</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 1; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 4755</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4756</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">src_idx</a>] &lt; <a class="code hl_class" href="classTensor.html">min_val</a>) {</div>
<div class="line"><span class="lineno"> 4757</span>                        <a class="code hl_class" href="classTensor.html">min_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 4758</span>                        <a class="code hl_class" href="classTensor.html">min_idx</a> = <a class="code hl_class" href="classTensor.html">a</a>;</div>
<div class="line"><span class="lineno"> 4759</span>                    }</div>
<div class="line"><span class="lineno"> 4760</span>                }</div>
<div class="line"><span class="lineno"> 4761</span>                </div>
<div class="line"><span class="lineno"> 4762</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dst_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4763</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>()[<a class="code hl_class" href="classTensor.html">dst_idx</a>] = <a class="code hl_class" href="classTensor.html">min_idx</a>;</div>
<div class="line"><span class="lineno"> 4764</span>            }</div>
<div class="line"><span class="lineno"> 4765</span>        }</div>
<div class="line"><span class="lineno"> 4766</span>        </div>
<div class="line"><span class="lineno"> 4767</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4768</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4029fcf1a134dc6add543b9bdd1c045b" name="a4029fcf1a134dc6add543b9bdd1c045b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4029fcf1a134dc6add543b9bdd1c045b">&#9670;&#160;</a></span>astype()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::astype </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cast tensor to a different data type (NumPy-compatible astype). </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">U</td><td>Target data type </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with the target data type</dd></dl>
<p>This method allows casting tensors between different types, similar to NumPy's astype.</p>
<p>Example: </p><div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;int, 2&gt;</a> x({2, 3});</div>
<div class="line"><span class="keyword">auto</span> y = x.astype&lt;<span class="keywordtype">float</span>&gt;();  <span class="comment">// Convert int tensor to float</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02866">2866</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2866</span>                                {</div>
<div class="line"><span class="lineno"> 2867</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;U, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2868</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2869</span>        </div>
<div class="line"><span class="lineno"> 2870</span>        <span class="keyword">const</span> <a class="code hl_class" href="classTensor.html">T</a>* <a class="code hl_class" href="classTensor.html">src_data</a> = <a class="code hl_function" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>();</div>
<div class="line"><span class="lineno"> 2871</span>        <a class="code hl_class" href="classTensor.html">U</a>* <a class="code hl_class" href="classTensor.html">dst_data</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>();</div>
<div class="line"><span class="lineno"> 2872</span>        </div>
<div class="line"><span class="lineno"> 2873</span><span class="preprocessor">        #pragma omp parallel for if(total &gt; 10000)</span></div>
<div class="line"><span class="lineno"> 2874</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2875</span>            <a class="code hl_class" href="classTensor.html">dst_data</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">U</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">src_data</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 2876</span>        }</div>
<div class="line"><span class="lineno"> 2877</span>        </div>
<div class="line"><span class="lineno"> 2878</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2879</span>    }</div>
<div class="ttc" id="aclassTensor_html_a3f3c97d177cb960a4423afc3dafc612a"><div class="ttname"><a href="#a3f3c97d177cb960a4423afc3dafc612a">Tensor::data_ptr</a></div><div class="ttdeci">const T * data_ptr() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00504">tensor.h:504</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a498d185ab60ae084a26c848ccdbaab27" name="a498d185ab60ae084a26c848ccdbaab27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a498d185ab60ae084a26c848ccdbaab27">&#9670;&#160;</a></span>backend()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#ae4db5848267c1a5a1413b7f87cf6889d">Backend</a> <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::backend </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the backend being used by this tensor. </p><dl class="section return"><dt>Returns</dt><dd>The computational backend (GPU, BLAS, or CPU)</dd></dl>
<p>Returns the actual backend that will be used for operations on this tensor. The backend is selected at tensor creation time based on availability:</p><ul>
<li>GPU: if compiled with USE_GPU, GPU is available, and use_gpu flag is true</li>
<li>BLAS: if compiled with USE_BLAS and GPU is not used</li>
<li>CPU: fallback when neither GPU nor BLAS is available </li>
</ul>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00668">668</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  668</span>                            {</div>
<div class="line"><span class="lineno">  669</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno">  670</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">Backend::GPU</a>;</div>
<div class="line"><span class="lineno">  671</span>        }</div>
<div class="line"><span class="lineno">  672</span><span class="preprocessor">#ifdef USE_BLAS</span></div>
<div class="line"><span class="lineno">  673</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">Backend::BLAS</a>;</div>
<div class="line"><span class="lineno">  674</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  675</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">Backend::CPU</a>;</div>
<div class="line"><span class="lineno">  676</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  677</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ace4d96d1fc0d364577334241662fb60e" name="ace4d96d1fc0d364577334241662fb60e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace4d96d1fc0d364577334241662fb60e">&#9670;&#160;</a></span>backward()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::optional&lt; <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaa">TensorError</a> &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::backward </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; *</td>          <td class="paramname"><span class="paramname"><em>gradient</em></span><span class="paramdefsep"> = </span><span class="paramdefval">nullptr</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform backward pass to compute gradients (autograd). </p>
<p>Computes gradients of this tensor with respect to leaf tensors by traversing the computational graph backwards.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gradient</td><td>Optional gradient tensor to start backpropagation. If nullptr, assumes this is a scalar with gradient 1.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::nullopt on success, <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa253ca7dd096ee0956cccee4d376cab8b" title="Invalid argument provided to a function.">TensorError::InvalidArgument</a> on error</dd></dl>
<dl class="section note"><dt>Note</dt><dd>For scalar tensors (<a class="el" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size()</a> == 1), can be called without arguments. </dd>
<dd>
For non-scalar tensors, must provide a gradient tensor. </dd>
<dd>
Returns error if tensor doesn't require gradients </dd>
<dd>
Returns error if called on non-scalar without gradient argument</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_autograd"></a>
Usage Example</h1>
<div class="fragment"><div class="line"><span class="comment">// Scalar loss - no gradient needed</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> <a class="code hl_namespace" href="namespaceloss.html">loss</a>({1}, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a class="code hl_namespace" href="namespaceloss.html">loss</a>.backward();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Non-scalar - gradient required</span></div>
<div class="line"><a class="code hl_class" href="classTensor.html">Tensor&lt;float, 2&gt;</a> output({3, 4}, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>({3, 4});</div>
<div class="line"><a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.fill(1.0f);</div>
<div class="line">output.backward(&amp;<a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>);</div>
<div class="ttc" id="aclassTensor_html_a8c0ac5752345f4abb81ebe4fa78411fd"><div class="ttname"><a href="#a8c0ac5752345f4abb81ebe4fa78411fd">Tensor::grad</a></div><div class="ttdeci">Tensor&lt; T, N &gt; * grad()</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00740">tensor.h:740</a></div></div>
<div class="ttc" id="anamespaceloss_html"><div class="ttname"><a href="namespaceloss.html">loss</a></div><div class="ttdoc">Loss functions for neural network training.</div></div>
</div><!-- fragment --> <dl class="section return"><dt>Returns</dt><dd>std::nullopt on success, or <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaa" title="Error codes for tensor operations.">TensorError</a> on failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00783">783</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  783</span>                                                                              {</div>
<div class="line"><span class="lineno">  784</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno">  785</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::InvalidArgument</a>;</div>
<div class="line"><span class="lineno">  786</span>        }</div>
<div class="line"><span class="lineno">  787</span>        </div>
<div class="line"><span class="lineno">  788</span>        <span class="comment">// If this is not a scalar and no gradient provided, error</span></div>
<div class="line"><span class="lineno">  789</span>        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">gradient</a> &amp;&amp; <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>() != 1) {</div>
<div class="line"><span class="lineno">  790</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::InvalidArgument</a>;</div>
<div class="line"><span class="lineno">  791</span>        }</div>
<div class="line"><span class="lineno">  792</span>        </div>
<div class="line"><span class="lineno">  793</span>        <span class="comment">// Initialize gradient</span></div>
<div class="line"><span class="lineno">  794</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno">  795</span>            <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  796</span>            <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno">  797</span>        }</div>
<div class="line"><span class="lineno">  798</span>        </div>
<div class="line"><span class="lineno">  799</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">gradient</a>) {</div>
<div class="line"><span class="lineno">  800</span>            <span class="comment">// Accumulate provided gradient</span></div>
<div class="line"><span class="lineno">  801</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno">  802</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno">  803</span>                <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_class" href="classTensor.html">gradient</a>-&gt;<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno">  804</span>            }</div>
<div class="line"><span class="lineno">  805</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  806</span>            <span class="comment">// For scalar, start with gradient of 1</span></div>
<div class="line"><span class="lineno">  807</span>            <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[0] = <a class="code hl_class" href="classTensor.html">T</a>(1);</div>
<div class="line"><span class="lineno">  808</span>        }</div>
<div class="line"><span class="lineno">  809</span>        </div>
<div class="line"><span class="lineno">  810</span>        <span class="comment">// Call all backward functions to propagate gradients</span></div>
<div class="line"><span class="lineno">  811</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno">  812</span>            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno">  813</span>        }</div>
<div class="line"><span class="lineno">  814</span>        </div>
<div class="line"><span class="lineno">  815</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::nullopt</a>;</div>
<div class="line"><span class="lineno">  816</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1ec080d57f42d7c582be27d51c9fd440" name="a1ec080d57f42d7c582be27d51c9fd440"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ec080d57f42d7c582be27d51c9fd440">&#9670;&#160;</a></span>bernoulli()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::bernoulli </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>p</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(0.5)</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sample from Bernoulli distribution. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Probability of success (value 1), default 0.5. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02924">2924</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2924</span>                                 {</div>
<div class="line"><span class="lineno"> 2925</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2926</span>        <a class="code hl_class" href="classTensor.html">std::random_device</a> <a class="code hl_class" href="classTensor.html">rd</a>;</div>
<div class="line"><span class="lineno"> 2927</span>        <a class="code hl_class" href="classTensor.html">std::mt19937</a> <a class="code hl_class" href="classTensor.html">gen</a>(<a class="code hl_class" href="classTensor.html">rd</a>());</div>
<div class="line"><span class="lineno"> 2928</span>        <a class="code hl_class" href="classTensor.html">std::bernoulli_distribution</a> <a class="code hl_class" href="classTensor.html">dis</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">p</a>));</div>
<div class="line"><span class="lineno"> 2929</span>        </div>
<div class="line"><span class="lineno"> 2930</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2931</span>            <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">dis</a>(<a class="code hl_class" href="classTensor.html">gen</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2932</span>        }</div>
<div class="line"><span class="lineno"> 2933</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a41b1a12b948c41c4b159fbccc278d630" name="a41b1a12b948c41c4b159fbccc278d630"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41b1a12b948c41c4b159fbccc278d630">&#9670;&#160;</a></span>binary_crossentropy_gradient()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::binary_crossentropy_gradient </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>target</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>epsilon</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(1e-7)</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute gradient of binary cross-entropy loss. d/dx[BCE] = -(target/pred - (1-target)/(1-pred)) / n </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target</td><td>The target tensor. </td></tr>
    <tr><td class="paramname">epsilon</td><td>Small value to avoid division by zero. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The gradient tensor or error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03112">3112</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3113</span>                                                                                         {</div>
<div class="line"><span class="lineno"> 3114</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">target</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 3115</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3116</span>        }</div>
<div class="line"><span class="lineno"> 3117</span>        </div>
<div class="line"><span class="lineno"> 3118</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3119</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3120</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">scale</a> = <a class="code hl_class" href="classTensor.html">T</a>(1) / <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 3121</span>        </div>
<div class="line"><span class="lineno"> 3122</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3123</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">pred</a> = <a class="code hl_class" href="classTensor.html">std::max</a>(<a class="code hl_class" href="classTensor.html">epsilon</a>, <a class="code hl_class" href="classTensor.html">std::min</a>(<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">epsilon</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]));</div>
<div class="line"><span class="lineno"> 3124</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">scale</a> * (-(<a class="code hl_class" href="classTensor.html">target</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] / <a class="code hl_class" href="classTensor.html">pred</a>) + </div>
<div class="line"><span class="lineno"> 3125</span>                                       ((<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">target</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]) / (<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">pred</a>)));</div>
<div class="line"><span class="lineno"> 3126</span>        }</div>
<div class="line"><span class="lineno"> 3127</span>        </div>
<div class="line"><span class="lineno"> 3128</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3129</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0f221b4aea323b94ac40cc76513fe1e4" name="a0f221b4aea323b94ac40cc76513fe1e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f221b4aea323b94ac40cc76513fe1e4">&#9670;&#160;</a></span>binary_crossentropy_loss()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::binary_crossentropy_loss </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>target</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>epsilon</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(1e-7)</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute binary cross-entropy loss. Loss = -[target * log(pred) + (1-target) * log(1-pred)] </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target</td><td>The target tensor (values should be 0 or 1). </td></tr>
    <tr><td class="paramname">epsilon</td><td>Small value to avoid log(0) (default 1e-7). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The BCE loss value or error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03088">3088</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3088</span>                                                                                                    {</div>
<div class="line"><span class="lineno"> 3089</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">target</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 3090</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3091</span>        }</div>
<div class="line"><span class="lineno"> 3092</span>        </div>
<div class="line"><span class="lineno"> 3093</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">loss</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3094</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3095</span>        </div>
<div class="line"><span class="lineno"> 3096</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3097</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">pred</a> = <a class="code hl_class" href="classTensor.html">std::max</a>(<a class="code hl_class" href="classTensor.html">epsilon</a>, <a class="code hl_class" href="classTensor.html">std::min</a>(<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">epsilon</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]));</div>
<div class="line"><span class="lineno"> 3098</span>            <a class="code hl_class" href="classTensor.html">loss</a> += -(<a class="code hl_class" href="classTensor.html">target</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">std::log</a>(<a class="code hl_class" href="classTensor.html">pred</a>) + </div>
<div class="line"><span class="lineno"> 3099</span>                     (<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">target</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]) * <a class="code hl_class" href="classTensor.html">std::log</a>(<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">pred</a>));</div>
<div class="line"><span class="lineno"> 3100</span>        }</div>
<div class="line"><span class="lineno"> 3101</span>        </div>
<div class="line"><span class="lineno"> 3102</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">loss</a> / <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 3103</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a77397ac152988d5ed90941bac5a96c28" name="a77397ac152988d5ed90941bac5a96c28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77397ac152988d5ed90941bac5a96c28">&#9670;&#160;</a></span>block()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::block </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>start_row</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>start_col</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>num_rows</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>num_cols</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract a rectangular block (only for 2D tensors). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start_row</td><td>Starting row index </td></tr>
    <tr><td class="paramname">start_col</td><td>Starting column index </td></tr>
    <tr><td class="paramname">num_rows</td><td>Number of rows to extract </td></tr>
    <tr><td class="paramname">num_cols</td><td>Number of columns to extract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>2D tensor containing the block </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05072">5072</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5072</span>                                                                                                   {</div>
<div class="line"><span class="lineno"> 5073</span>        <a class="code hl_class" href="classTensor.html">return ::block</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)), </div>
<div class="line"><span class="lineno"> 5074</span>                       <a class="code hl_class" href="classTensor.html">start_row</a>, <a class="code hl_class" href="classTensor.html">start_col</a>, <a class="code hl_class" href="classTensor.html">num_rows</a>, <a class="code hl_class" href="classTensor.html">num_cols</a>);</div>
<div class="line"><span class="lineno"> 5075</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ecd760521443aca3613911d9af40d5a" name="a8ecd760521443aca3613911d9af40d5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ecd760521443aca3613911d9af40d5a">&#9670;&#160;</a></span>bottomRows()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::bottomRows </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract bottom n rows (only for 2D tensors). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of rows to extract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>2D tensor containing bottom n rows </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05113">5113</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5113</span>                                            {</div>
<div class="line"><span class="lineno"> 5114</span>        <a class="code hl_class" href="classTensor.html">return ::bottomRows</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)), <a class="code hl_class" href="classTensor.html">n</a>);</div>
<div class="line"><span class="lineno"> 5115</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aebe2b244763904422344add448a0c597" name="aebe2b244763904422344add448a0c597"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebe2b244763904422344add448a0c597">&#9670;&#160;</a></span>broadcast_to()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::broadcast_to </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>target_shape</em></span></td><td>)</td>
          <td> const-&gt;std::variant&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, M &gt;, <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaa">TensorError</a> &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Broadcast this tensor to a new shape. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">M</td><td>The number of dimensions in target shape </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target_shape</td><td>The target shape to broadcast to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing the broadcast tensor or an error</dd></dl>
<p>Broadcasting rules (NumPy-compatible):</p><ul>
<li>Prepend dimensions of size 1 if needed</li>
<li>For each dimension, sizes must either match or one must be 1</li>
<li>Dimensions of size 1 are "stretched" to match the target</li>
</ul>
<p>Example: </p><div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> x({3});</div>
<div class="line"><span class="keyword">auto</span> result = x.broadcast_to&lt;2&gt;({4, 3});  <span class="comment">// Shape (3,) -&gt; (4, 3)</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02899">2899</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2900</span>                                                 {</div>
<div class="line"><span class="lineno"> 2901</span>        <a class="code hl_class" href="classTensor.html">return ::broadcast_to</a>(*<span class="keyword">this</span>, <a class="code hl_class" href="classTensor.html">target_shape</a>);</div>
<div class="line"><span class="lineno"> 2902</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a62dff46109e314ef2d44683e3d4d581d" name="a62dff46109e314ef2d44683e3d4d581d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62dff46109e314ef2d44683e3d4d581d">&#9670;&#160;</a></span>ceil()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::ceil </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply ceiling function to all elements (creates new tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with ceil(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01902">1902</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1902</span>                              {</div>
<div class="line"><span class="lineno"> 1903</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::ceil</a>(<a class="code hl_class" href="classTensor.html">x</a>); });</div>
<div class="line"><span class="lineno"> 1904</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4eb83e4f5d720db5858585ff199d789e" name="a4eb83e4f5d720db5858585ff199d789e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4eb83e4f5d720db5858585ff199d789e">&#9670;&#160;</a></span>chain_rule()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::chain_rule </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>upstream_grad</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply chain rule for backpropagation. Given upstream gradient and local derivative, compute gradient for this layer. gradient = upstream_grad * local_derivative </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">upstream_grad</td><td>The gradient flowing from the next layer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing the computed gradient or an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02194">2194</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2194</span>                                                                                   {</div>
<div class="line"><span class="lineno"> 2195</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">upstream_grad</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 2196</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 2197</span>        }</div>
<div class="line"><span class="lineno"> 2198</span>        </div>
<div class="line"><span class="lineno"> 2199</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2200</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2201</span>        </div>
<div class="line"><span class="lineno"> 2202</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2203</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">upstream_grad</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 2204</span>        }</div>
<div class="line"><span class="lineno"> 2205</span>        </div>
<div class="line"><span class="lineno"> 2206</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2207</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a824a51062936324b316f066fdce66f77" name="a824a51062936324b316f066fdce66f77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a824a51062936324b316f066fdce66f77">&#9670;&#160;</a></span>clamp()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::clamp </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>min_val</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>max_val</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Clamp all elements to a range (creates new tensor). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">min_val</td><td>The minimum value. </td></tr>
    <tr><td class="paramname">max_val</td><td>The maximum value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with all elements clamped to [min_val, max_val]. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01920">1920</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1920</span>                                                   {</div>
<div class="line"><span class="lineno"> 1921</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([<a class="code hl_class" href="classTensor.html">min_val</a>, <a class="code hl_class" href="classTensor.html">max_val</a>](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { </div>
<div class="line"><span class="lineno"> 1922</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">x</a> &lt; <a class="code hl_class" href="classTensor.html">min_val</a> ? <a class="code hl_class" href="classTensor.html">min_val</a> : (<a class="code hl_class" href="classTensor.html">x</a> &gt; <a class="code hl_class" href="classTensor.html">max_val</a> ? <a class="code hl_class" href="classTensor.html">max_val</a> : <a class="code hl_class" href="classTensor.html">x</a>); </div>
<div class="line"><span class="lineno"> 1923</span>        });</div>
<div class="line"><span class="lineno"> 1924</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a265342749ca5f239466cb467bbf73277" name="a265342749ca5f239466cb467bbf73277"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a265342749ca5f239466cb467bbf73277">&#9670;&#160;</a></span>clip()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::clip </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>min_val</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>max_val</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Clip (clamp) tensor values to a specified range. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">min_val</td><td>Minimum value. </td></tr>
    <tr><td class="paramname">max_val</td><td>Maximum value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with clipped values. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02756">2756</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2756</span>                                                  {</div>
<div class="line"><span class="lineno"> 2757</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 2758</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2759</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2760</span>        </div>
<div class="line"><span class="lineno"> 2761</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2762</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::max</a>(<a class="code hl_class" href="classTensor.html">min_val</a>, <a class="code hl_class" href="classTensor.html">std::min</a>(<a class="code hl_class" href="classTensor.html">max_val</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]));</div>
<div class="line"><span class="lineno"> 2763</span>        }</div>
<div class="line"><span class="lineno"> 2764</span>        </div>
<div class="line"><span class="lineno"> 2765</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 2766</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 2767</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2768</span>            </div>
<div class="line"><span class="lineno"> 2769</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">min_val</a>, <a class="code hl_class" href="classTensor.html">max_val</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 2770</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 2771</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 2772</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>,</div>
<div class="line"><span class="lineno"> 2773</span>                                                                          <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2774</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 2775</span>                    }</div>
<div class="line"><span class="lineno"> 2776</span>                    </div>
<div class="line"><span class="lineno"> 2777</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2778</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2779</span>                        <span class="comment">// Gradient passes through only if value is within range</span></div>
<div class="line"><span class="lineno"> 2780</span>                        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt; <a class="code hl_class" href="classTensor.html">min_val</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &lt; <a class="code hl_class" href="classTensor.html">max_val</a>) {</div>
<div class="line"><span class="lineno"> 2781</span>                            <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 2782</span>                        }</div>
<div class="line"><span class="lineno"> 2783</span>                    }</div>
<div class="line"><span class="lineno"> 2784</span>                    </div>
<div class="line"><span class="lineno"> 2785</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 2786</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 2787</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 2788</span>                        }</div>
<div class="line"><span class="lineno"> 2789</span>                    }</div>
<div class="line"><span class="lineno"> 2790</span>                }</div>
<div class="line"><span class="lineno"> 2791</span>            });</div>
<div class="line"><span class="lineno"> 2792</span>        }</div>
<div class="line"><span class="lineno"> 2793</span>        </div>
<div class="line"><span class="lineno"> 2794</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2795</span>    }</div>
<div class="ttc" id="aclassTensor_html_af274147e833dd1ab399ce08155ad169b"><div class="ttname"><a href="#af274147e833dd1ab399ce08155ad169b">Tensor::register_backward</a></div><div class="ttdeci">void register_backward(BackwardFunc&lt; T, N &gt; func)</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00833">tensor.h:833</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1dafe6c812c9cd6d5f34a31ffdad59bb" name="a1dafe6c812c9cd6d5f34a31ffdad59bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dafe6c812c9cd6d5f34a31ffdad59bb">&#9670;&#160;</a></span>clip_max()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::clip_max </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>max_val</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Clip values to a maximum threshold (creates new tensor). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">max_val</td><td>The maximum value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with all elements &lt;= max_val. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02011">2011</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2011</span>                                           {</div>
<div class="line"><span class="lineno"> 2012</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([<a class="code hl_class" href="classTensor.html">max_val</a>](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">x</a> &gt; <a class="code hl_class" href="classTensor.html">max_val</a> ? <a class="code hl_class" href="classTensor.html">max_val</a> : <a class="code hl_class" href="classTensor.html">x</a>; });</div>
<div class="line"><span class="lineno"> 2013</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5e477d9be3b8b907cbcc34efe73e31bc" name="a5e477d9be3b8b907cbcc34efe73e31bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e477d9be3b8b907cbcc34efe73e31bc">&#9670;&#160;</a></span>clip_min()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::clip_min </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>min_val</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Clip values to a minimum threshold (creates new tensor). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">min_val</td><td>The minimum value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with all elements &gt;= min_val. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02002">2002</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2002</span>                                           {</div>
<div class="line"><span class="lineno"> 2003</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([<a class="code hl_class" href="classTensor.html">min_val</a>](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">x</a> &lt; <a class="code hl_class" href="classTensor.html">min_val</a> ? <a class="code hl_class" href="classTensor.html">min_val</a> : <a class="code hl_class" href="classTensor.html">x</a>; });</div>
<div class="line"><span class="lineno"> 2004</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a42cef0c31a6dcf0846d2c6e2d24e7240" name="a42cef0c31a6dcf0846d2c6e2d24e7240"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42cef0c31a6dcf0846d2c6e2d24e7240">&#9670;&#160;</a></span>col()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::col </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>col_idx</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract a single column (only for 2D tensors). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col_idx</td><td>Column index to extract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1D tensor containing the column </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05050">5050</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5050</span>                                           {</div>
<div class="line"><span class="lineno"> 5051</span>        <a class="code hl_class" href="classTensor.html">return ::col</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)), <a class="code hl_class" href="classTensor.html">col_idx</a>);</div>
<div class="line"><span class="lineno"> 5052</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a0af0b59b00d2f2623609ff3562f087" name="a7a0af0b59b00d2f2623609ff3562f087"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a0af0b59b00d2f2623609ff3562f087">&#9670;&#160;</a></span>concatenate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::concatenate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>axis</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Concatenate tensors along a specific axis. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to concatenate with </td></tr>
    <tr><td class="paramname">axis</td><td>The axis along which to concatenate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Concatenated tensor, or zero tensor if dimensions don't match </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04275">4275</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4275</span>                                                                           {</div>
<div class="line"><span class="lineno"> 4276</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &gt;= <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 4277</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 4278</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4279</span>        }</div>
<div class="line"><span class="lineno"> 4280</span>        </div>
<div class="line"><span class="lineno"> 4281</span>        <span class="comment">// Check that all dimensions match except the concat axis</span></div>
<div class="line"><span class="lineno"> 4282</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4283</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">i</a> != <a class="code hl_class" href="classTensor.html">axis</a> &amp;&amp; <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>] != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>]) {</div>
<div class="line"><span class="lineno"> 4284</span>                <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 4285</span>                <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4286</span>            }</div>
<div class="line"><span class="lineno"> 4287</span>        }</div>
<div class="line"><span class="lineno"> 4288</span>        </div>
<div class="line"><span class="lineno"> 4289</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 4290</span>        <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">axis</a>] = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>] + <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>];</div>
<div class="line"><span class="lineno"> 4291</span>        </div>
<div class="line"><span class="lineno"> 4292</span>        <span class="keywordtype">bool</span> <a class="code hl_class" href="classTensor.html">track_grad</a> = <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a> || <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>;</div>
<div class="line"><span class="lineno"> 4293</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_class" href="classTensor.html">track_grad</a>);</div>
<div class="line"><span class="lineno"> 4294</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4295</span>        </div>
<div class="line"><span class="lineno"> 4296</span>        <span class="comment">// Copy data from first tensor</span></div>
<div class="line"><span class="lineno"> 4297</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 4298</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">axis</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4299</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4300</span>        }</div>
<div class="line"><span class="lineno"> 4301</span>        </div>
<div class="line"><span class="lineno"> 4302</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 4303</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">axis</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4304</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4305</span>        }</div>
<div class="line"><span class="lineno"> 4306</span>        </div>
<div class="line"><span class="lineno"> 4307</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">this_axis_size</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>];</div>
<div class="line"><span class="lineno"> 4308</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">other_axis_size</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>];</div>
<div class="line"><span class="lineno"> 4309</span>        </div>
<div class="line"><span class="lineno"> 4310</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4311</span>            <span class="comment">// Copy from first tensor</span></div>
<div class="line"><span class="lineno"> 4312</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 0; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">this_axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 4313</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4314</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">this_axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4315</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dst_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * (<a class="code hl_class" href="classTensor.html">this_axis_size</a> + <a class="code hl_class" href="classTensor.html">other_axis_size</a>) * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4316</span>                    <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">dst_idx</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 4317</span>                }</div>
<div class="line"><span class="lineno"> 4318</span>            }</div>
<div class="line"><span class="lineno"> 4319</span>            </div>
<div class="line"><span class="lineno"> 4320</span>            <span class="comment">// Copy from second tensor</span></div>
<div class="line"><span class="lineno"> 4321</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 0; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">other_axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 4322</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4323</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">other_axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4324</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dst_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * (<a class="code hl_class" href="classTensor.html">this_axis_size</a> + <a class="code hl_class" href="classTensor.html">other_axis_size</a>) * <a class="code hl_class" href="classTensor.html">inner</a> + </div>
<div class="line"><span class="lineno"> 4325</span>                                    (<a class="code hl_class" href="classTensor.html">this_axis_size</a> + <a class="code hl_class" href="classTensor.html">a</a>) * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4326</span>                    <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">dst_idx</a>] = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 4327</span>                }</div>
<div class="line"><span class="lineno"> 4328</span>            }</div>
<div class="line"><span class="lineno"> 4329</span>        }</div>
<div class="line"><span class="lineno"> 4330</span>        </div>
<div class="line"><span class="lineno"> 4331</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 4332</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">track_grad</a>) {</div>
<div class="line"><span class="lineno"> 4333</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4334</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">other_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_class" href="classTensor.html">other</a>);</div>
<div class="line"><span class="lineno"> 4335</span>            </div>
<div class="line"><span class="lineno"> 4336</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">other_ptr</a>, <a class="code hl_class" href="classTensor.html">axis</a>, <a class="code hl_class" href="classTensor.html">outer</a>, <a class="code hl_class" href="classTensor.html">inner</a>, </div>
<div class="line"><span class="lineno"> 4337</span>                                     <a class="code hl_class" href="classTensor.html">this_axis_size</a>, <a class="code hl_class" href="classTensor.html">other_axis_size</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 4338</span>                <span class="comment">// Split gradient back to both tensors</span></div>
<div class="line"><span class="lineno"> 4339</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4340</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4341</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, </div>
<div class="line"><span class="lineno"> 4342</span>                                                                          <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4343</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4344</span>                    }</div>
<div class="line"><span class="lineno"> 4345</span>                    </div>
<div class="line"><span class="lineno"> 4346</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4347</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 0; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">this_axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 4348</span>                            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4349</span>                                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dst_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">this_axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4350</span>                                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * (<a class="code hl_class" href="classTensor.html">this_axis_size</a> + <a class="code hl_class" href="classTensor.html">other_axis_size</a>) * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4351</span>                                <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">dst_idx</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 4352</span>                            }</div>
<div class="line"><span class="lineno"> 4353</span>                        }</div>
<div class="line"><span class="lineno"> 4354</span>                    }</div>
<div class="line"><span class="lineno"> 4355</span>                    </div>
<div class="line"><span class="lineno"> 4356</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4357</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4358</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4359</span>                        }</div>
<div class="line"><span class="lineno"> 4360</span>                    }</div>
<div class="line"><span class="lineno"> 4361</span>                }</div>
<div class="line"><span class="lineno"> 4362</span>                </div>
<div class="line"><span class="lineno"> 4363</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4364</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4365</span>                        <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, </div>
<div class="line"><span class="lineno"> 4366</span>                                                                           <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4367</span>                        <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4368</span>                    }</div>
<div class="line"><span class="lineno"> 4369</span>                    </div>
<div class="line"><span class="lineno"> 4370</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4371</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 0; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">other_axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 4372</span>                            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4373</span>                                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dst_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">other_axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4374</span>                                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * (<a class="code hl_class" href="classTensor.html">this_axis_size</a> + <a class="code hl_class" href="classTensor.html">other_axis_size</a>) * <a class="code hl_class" href="classTensor.html">inner</a> + </div>
<div class="line"><span class="lineno"> 4375</span>                                                (<a class="code hl_class" href="classTensor.html">this_axis_size</a> + <a class="code hl_class" href="classTensor.html">a</a>) * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4376</span>                                <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">dst_idx</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 4377</span>                            }</div>
<div class="line"><span class="lineno"> 4378</span>                        }</div>
<div class="line"><span class="lineno"> 4379</span>                    }</div>
<div class="line"><span class="lineno"> 4380</span>                    </div>
<div class="line"><span class="lineno"> 4381</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4382</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4383</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4384</span>                        }</div>
<div class="line"><span class="lineno"> 4385</span>                    }</div>
<div class="line"><span class="lineno"> 4386</span>                }</div>
<div class="line"><span class="lineno"> 4387</span>            });</div>
<div class="line"><span class="lineno"> 4388</span>        }</div>
<div class="line"><span class="lineno"> 4389</span>        </div>
<div class="line"><span class="lineno"> 4390</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4391</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a7a0af0b59b00d2f2623609ff3562f087_icgraph.png" border="0" usemap="#aclassTensor_a7a0af0b59b00d2f2623609ff3562f087_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a7a0af0b59b00d2f2623609ff3562f087_icgraph" id="aclassTensor_a7a0af0b59b00d2f2623609ff3562f087_icgraph">
<area shape="rect" title=" " alt="" coords="206,31,345,57"/>
<area shape="rect" href="classTensor.html#aed3511f1720813839550315f701cb516" title=" " alt="" coords="5,5,158,32"/>
<area shape="poly" title=" " alt="" coords="190,36,158,31,158,26,191,30"/>
<area shape="rect" href="classTensor.html#a0fc4cc0c22be7a233b9c64c6677d54d5" title=" " alt="" coords="5,56,158,83"/>
<area shape="poly" title=" " alt="" coords="191,58,158,62,158,57,190,52"/>
</map>
</div>

</div>
</div>
<a id="a2b57a0f04d06e24633c240fe7b007b4a" name="a2b57a0f04d06e24633c240fe7b007b4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b57a0f04d06e24633c240fe7b007b4a">&#9670;&#160;</a></span>correlation()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::correlation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute Pearson correlation coefficient with another tensor. Treats tensors as flattened vectors. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The other tensor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The correlation coefficient [-1, 1] or error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02356">2356</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2356</span>                                                                 {</div>
<div class="line"><span class="lineno"> 2357</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>() != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>()) {</div>
<div class="line"><span class="lineno"> 2358</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 2359</span>        }</div>
<div class="line"><span class="lineno"> 2360</span>        </div>
<div class="line"><span class="lineno"> 2361</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2362</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">mean1</a> = <a class="code hl_function" href="#a84b27bf0213ab3f228c2efe5ca31eaec">mean</a>();</div>
<div class="line"><span class="lineno"> 2363</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">mean2</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_function" href="#a84b27bf0213ab3f228c2efe5ca31eaec">mean</a>();</div>
<div class="line"><span class="lineno"> 2364</span>        </div>
<div class="line"><span class="lineno"> 2365</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">cov</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2366</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">var1</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2367</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">var2</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2368</span>        </div>
<div class="line"><span class="lineno"> 2369</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2370</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">diff1</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] - <a class="code hl_class" href="classTensor.html">mean1</a>;</div>
<div class="line"><span class="lineno"> 2371</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">diff2</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] - <a class="code hl_class" href="classTensor.html">mean2</a>;</div>
<div class="line"><span class="lineno"> 2372</span>            <a class="code hl_class" href="classTensor.html">cov</a> += <a class="code hl_class" href="classTensor.html">diff1</a> * <a class="code hl_class" href="classTensor.html">diff2</a>;</div>
<div class="line"><span class="lineno"> 2373</span>            <a class="code hl_class" href="classTensor.html">var1</a> += <a class="code hl_class" href="classTensor.html">diff1</a> * <a class="code hl_class" href="classTensor.html">diff1</a>;</div>
<div class="line"><span class="lineno"> 2374</span>            <a class="code hl_class" href="classTensor.html">var2</a> += <a class="code hl_class" href="classTensor.html">diff2</a> * <a class="code hl_class" href="classTensor.html">diff2</a>;</div>
<div class="line"><span class="lineno"> 2375</span>        }</div>
<div class="line"><span class="lineno"> 2376</span>        </div>
<div class="line"><span class="lineno"> 2377</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">denom</a> = <a class="code hl_class" href="classTensor.html">std::sqrt</a>(<a class="code hl_class" href="classTensor.html">var1</a> * <a class="code hl_class" href="classTensor.html">var2</a>);</div>
<div class="line"><span class="lineno"> 2378</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">denom</a> &lt; <a class="code hl_class" href="classTensor.html">std::numeric_limits&lt;T&gt;::epsilon</a>()) {</div>
<div class="line"><span class="lineno"> 2379</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::InvalidArgument</a>;</div>
<div class="line"><span class="lineno"> 2380</span>        }</div>
<div class="line"><span class="lineno"> 2381</span>        </div>
<div class="line"><span class="lineno"> 2382</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">cov</a> / <a class="code hl_class" href="classTensor.html">denom</a>;</div>
<div class="line"><span class="lineno"> 2383</span>    }</div>
<div class="ttc" id="aclassTensor_html_a84b27bf0213ab3f228c2efe5ca31eaec"><div class="ttname"><a href="#a84b27bf0213ab3f228c2efe5ca31eaec">Tensor::mean</a></div><div class="ttdeci">T mean() const</div><div class="ttdoc">Compute mean of all elements.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l02268">tensor.h:2268</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6563fb519990f052d63759c50d1febe9" name="a6563fb519990f052d63759c50d1febe9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6563fb519990f052d63759c50d1febe9">&#9670;&#160;</a></span>cos()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::cos </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply cosine function to all elements (creates new tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with cos(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01683">1683</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1683</span>                             {</div>
<div class="line"><span class="lineno"> 1684</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1685</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1686</span>        </div>
<div class="line"><span class="lineno"> 1687</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1688</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1689</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::cos_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1690</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1691</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1692</span>        {</div>
<div class="line"><span class="lineno"> 1693</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1694</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::cos</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 1695</span>            }</div>
<div class="line"><span class="lineno"> 1696</span>        }</div>
<div class="line"><span class="lineno"> 1697</span>        </div>
<div class="line"><span class="lineno"> 1698</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1699</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a6563fb519990f052d63759c50d1febe9_icgraph.png" border="0" usemap="#aclassTensor_a6563fb519990f052d63759c50d1febe9_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a6563fb519990f052d63759c50d1febe9_icgraph" id="aclassTensor_a6563fb519990f052d63759c50d1febe9_icgraph">
<area shape="rect" title=" " alt="" coords="184,13,273,40"/>
<area shape="rect" href="classTensor.html#aeb435c4d428047076a5b3c3dd5ba7114" title=" " alt="" coords="5,5,136,48"/>
<area shape="poly" title=" " alt="" coords="168,29,136,29,136,24,168,24"/>
</map>
</div>

</div>
</div>
<a id="a0ee894165491bb19bf33d8282a166fde" name="a0ee894165491bb19bf33d8282a166fde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ee894165491bb19bf33d8282a166fde">&#9670;&#160;</a></span>cos_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::cos_derivative </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of cosine function. d/dx[cos(x)] = -sin(x) </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with cos derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02160">2160</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2160</span>                                        {</div>
<div class="line"><span class="lineno"> 2161</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> -<a class="code hl_class" href="classTensor.html">std::sin</a>(<a class="code hl_class" href="classTensor.html">x</a>); });</div>
<div class="line"><span class="lineno"> 2162</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a36b35209e077e06698d7b0cb5e687b95" name="a36b35209e077e06698d7b0cb5e687b95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36b35209e077e06698d7b0cb5e687b95">&#9670;&#160;</a></span>covariance()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::covariance </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>ddof</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute covariance with another tensor. Treats tensors as flattened vectors. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The other tensor. </td></tr>
    <tr><td class="paramname">ddof</td><td>Delta degrees of freedom (default 0). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The covariance or error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02329">2329</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2329</span>                                                                                 {</div>
<div class="line"><span class="lineno"> 2330</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>() != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>()) {</div>
<div class="line"><span class="lineno"> 2331</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 2332</span>        }</div>
<div class="line"><span class="lineno"> 2333</span>        </div>
<div class="line"><span class="lineno"> 2334</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2335</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">total</a> &lt;= <a class="code hl_class" href="classTensor.html">ddof</a>) {</div>
<div class="line"><span class="lineno"> 2336</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::InvalidArgument</a>;</div>
<div class="line"><span class="lineno"> 2337</span>        }</div>
<div class="line"><span class="lineno"> 2338</span>        </div>
<div class="line"><span class="lineno"> 2339</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">mean1</a> = <a class="code hl_function" href="#a84b27bf0213ab3f228c2efe5ca31eaec">mean</a>();</div>
<div class="line"><span class="lineno"> 2340</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">mean2</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_function" href="#a84b27bf0213ab3f228c2efe5ca31eaec">mean</a>();</div>
<div class="line"><span class="lineno"> 2341</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">cov</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2342</span>        </div>
<div class="line"><span class="lineno"> 2343</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2344</span>            <a class="code hl_class" href="classTensor.html">cov</a> += (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] - <a class="code hl_class" href="classTensor.html">mean1</a>) * (<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] - <a class="code hl_class" href="classTensor.html">mean2</a>);</div>
<div class="line"><span class="lineno"> 2345</span>        }</div>
<div class="line"><span class="lineno"> 2346</span>        </div>
<div class="line"><span class="lineno"> 2347</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">cov</a> / <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">total</a> - <a class="code hl_class" href="classTensor.html">ddof</a>);</div>
<div class="line"><span class="lineno"> 2348</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a95ef6a804e30e0c4d1b26e8a784223c4" name="a95ef6a804e30e0c4d1b26e8a784223c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95ef6a804e30e0c4d1b26e8a784223c4">&#9670;&#160;</a></span>cross()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if&lt; M==1, <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; &gt; &gt;::type <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::cross </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Cross product for 3D vectors. Computes the cross product of two 3D vectors: result = this  other. The cross product is perpendicular to both input vectors and follows the right-hand rule.</p>
<p>Formula: If a = [a1, a2, a3] and b = [b1, b2, b3], then a  b = [a2*b3 - a3*b2, a3*b1 - a1*b3, a1*b2 - a2*b1]</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The other 3D vector to compute cross product with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing either a new 3D tensor with the result or an error.</dd></dl>
<div class="fragment"><div class="line"><span class="comment">// Create two 3D vectors</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> a({3});</div>
<div class="line">a[{0}] = 1.0f; a[{1}] = 0.0f; a[{2}] = 0.0f;  <span class="comment">// [1, 0, 0]</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> b({3});</div>
<div class="line">b[{0}] = 0.0f; b[{1}] = 1.0f; b[{2}] = 0.0f;  <span class="comment">// [0, 1, 0]</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Compute cross product</span></div>
<div class="line"><span class="keyword">auto</span> result_var = a.<a class="code hl_function" href="#a95ef6a804e30e0c4d1b26e8a784223c4">cross</a>(b);</div>
<div class="line"><span class="keywordflow">if</span> (std::holds_alternative&lt;<a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a>&gt;(result_var)) {</div>
<div class="line">    <span class="keyword">auto</span>&amp; result = std::get&lt;Tensor&lt;float, 1&gt;&gt;(result_var);</div>
<div class="line">    <span class="comment">// result = [0, 0, 1] (perpendicular to both a and b)</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassTensor_html_a95ef6a804e30e0c4d1b26e8a784223c4"><div class="ttname"><a href="#a95ef6a804e30e0c4d1b26e8a784223c4">Tensor::cross</a></div><div class="ttdeci">std::enable_if&lt; M==1, TensorResult&lt; Tensor&lt; T, 1 &gt; &gt; &gt;::type cross(const Tensor&lt; T, 1 &gt; &amp;other) const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l03328">tensor.h:3328</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03328">3328</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3328</span>                                           {</div>
<div class="line"><span class="lineno"> 3329</span>        <span class="keyword">static_assert</span>(<a class="code hl_class" href="classTensor.html">N</a> == 1, <span class="stringliteral">&quot;Cross product is only for 1D tensors&quot;</span>);</div>
<div class="line"><span class="lineno"> 3330</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0] != 3) {</div>
<div class="line"><span class="lineno"> 3331</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3332</span>        }</div>
<div class="line"><span class="lineno"> 3333</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0] != 3) {</div>
<div class="line"><span class="lineno"> 3334</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3335</span>        }</div>
<div class="line"><span class="lineno"> 3336</span>        </div>
<div class="line"><span class="lineno"> 3337</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 1&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>({3}, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3338</span>        </div>
<div class="line"><span class="lineno"> 3339</span>        <span class="comment">// Cross product formula: a  b = [a2*b3 - a3*b2, a3*b1 - a1*b3, a1*b2 - a2*b1]</span></div>
<div class="line"><span class="lineno"> 3340</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">a1</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0], <a class="code hl_class" href="classTensor.html">a2</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[1], <a class="code hl_class" href="classTensor.html">a3</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[2];</div>
<div class="line"><span class="lineno"> 3341</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">b1</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0], <a class="code hl_class" href="classTensor.html">b2</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[1], <a class="code hl_class" href="classTensor.html">b3</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[2];</div>
<div class="line"><span class="lineno"> 3342</span>        </div>
<div class="line"><span class="lineno"> 3343</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 3344</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 3345</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::cross_3d_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno"> 3346</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3347</span>        }</div>
<div class="line"><span class="lineno"> 3348</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3349</span>        </div>
<div class="line"><span class="lineno"> 3350</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0] = <a class="code hl_class" href="classTensor.html">a2</a> * <a class="code hl_class" href="classTensor.html">b3</a> - <a class="code hl_class" href="classTensor.html">a3</a> * <a class="code hl_class" href="classTensor.html">b2</a>;</div>
<div class="line"><span class="lineno"> 3351</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[1] = <a class="code hl_class" href="classTensor.html">a3</a> * <a class="code hl_class" href="classTensor.html">b1</a> - <a class="code hl_class" href="classTensor.html">a1</a> * <a class="code hl_class" href="classTensor.html">b3</a>;</div>
<div class="line"><span class="lineno"> 3352</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[2] = <a class="code hl_class" href="classTensor.html">a1</a> * <a class="code hl_class" href="classTensor.html">b2</a> - <a class="code hl_class" href="classTensor.html">a2</a> * <a class="code hl_class" href="classTensor.html">b1</a>;</div>
<div class="line"><span class="lineno"> 3353</span>        </div>
<div class="line"><span class="lineno"> 3354</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3355</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aead4907bc4e5e749a1dc4e535e9e33f1" name="aead4907bc4e5e749a1dc4e535e9e33f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aead4907bc4e5e749a1dc4e535e9e33f1">&#9670;&#160;</a></span>cumprod()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::cumprod </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Cumulative product along all elements (flattened view). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with cumulative products. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04792">4792</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4792</span>                                 {</div>
<div class="line"><span class="lineno"> 4793</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 4794</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4795</span>        </div>
<div class="line"><span class="lineno"> 4796</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">total</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 4797</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0];</div>
<div class="line"><span class="lineno"> 4798</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4799</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>-1] * <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4800</span>            }</div>
<div class="line"><span class="lineno"> 4801</span>        }</div>
<div class="line"><span class="lineno"> 4802</span>        </div>
<div class="line"><span class="lineno"> 4803</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4804</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a885a53dcbb0408b74958517747cf3868" name="a885a53dcbb0408b74958517747cf3868"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a885a53dcbb0408b74958517747cf3868">&#9670;&#160;</a></span>cumprod_axis()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::cumprod_axis </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>axis</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Cumulative product along a specific axis. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The dimension along which to compute cumulative product. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with cumulative products along the specified axis. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04856">4856</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4856</span>                                                 {</div>
<div class="line"><span class="lineno"> 4857</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &gt;= <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 4858</span>            <span class="keywordflow">throw</span> <a class="code hl_class" href="classTensor.html">std::out_of_range</a>(<span class="stringliteral">&quot;Axis out of bounds&quot;</span>);</div>
<div class="line"><span class="lineno"> 4859</span>        }</div>
<div class="line"><span class="lineno"> 4860</span>        </div>
<div class="line"><span class="lineno"> 4861</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 4862</span>        </div>
<div class="line"><span class="lineno"> 4863</span>        <span class="comment">// Compute strides</span></div>
<div class="line"><span class="lineno"> 4864</span>        <a class="code hl_class" href="classTensor.html">std::array&lt;size_t, N&gt;</a> <a class="code hl_function" href="#a938d78600782073a1ff2725066b46c85">strides</a>;</div>
<div class="line"><span class="lineno"> 4865</span>        <a class="code hl_function" href="#a938d78600782073a1ff2725066b46c85">strides</a>[<a class="code hl_class" href="classTensor.html">N</a>-1] = 1;</div>
<div class="line"><span class="lineno"> 4866</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">N</a>-1; <a class="code hl_class" href="classTensor.html">i</a>-- &gt; 0;) {</div>
<div class="line"><span class="lineno"> 4867</span>            <a class="code hl_function" href="#a938d78600782073a1ff2725066b46c85">strides</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_function" href="#a938d78600782073a1ff2725066b46c85">strides</a>[<a class="code hl_class" href="classTensor.html">i</a>+1] * <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>+1];</div>
<div class="line"><span class="lineno"> 4868</span>        }</div>
<div class="line"><span class="lineno"> 4869</span>        </div>
<div class="line"><span class="lineno"> 4870</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 4871</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">axis</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4872</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4873</span>        }</div>
<div class="line"><span class="lineno"> 4874</span>        </div>
<div class="line"><span class="lineno"> 4875</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 4876</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">axis</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4877</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4878</span>        }</div>
<div class="line"><span class="lineno"> 4879</span>        </div>
<div class="line"><span class="lineno"> 4880</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">axis_size</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>];</div>
<div class="line"><span class="lineno"> 4881</span>        </div>
<div class="line"><span class="lineno"> 4882</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4883</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4884</span>                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">cumulative</a> = <a class="code hl_class" href="classTensor.html">T</a>(1);</div>
<div class="line"><span class="lineno"> 4885</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 0; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 4886</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4887</span>                    <a class="code hl_class" href="classTensor.html">cumulative</a> *= <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">idx</a>];</div>
<div class="line"><span class="lineno"> 4888</span>                    <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">idx</a>] = <a class="code hl_class" href="classTensor.html">cumulative</a>;</div>
<div class="line"><span class="lineno"> 4889</span>                }</div>
<div class="line"><span class="lineno"> 4890</span>            }</div>
<div class="line"><span class="lineno"> 4891</span>        }</div>
<div class="line"><span class="lineno"> 4892</span>        </div>
<div class="line"><span class="lineno"> 4893</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4894</span>    }</div>
<div class="ttc" id="aclassTensor_html_a938d78600782073a1ff2725066b46c85"><div class="ttname"><a href="#a938d78600782073a1ff2725066b46c85">Tensor::strides</a></div><div class="ttdeci">const TensorIndices&lt; N &gt; &amp; strides() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00530">tensor.h:530</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5784e1627743c06127dbaa1b744cba8e" name="a5784e1627743c06127dbaa1b744cba8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5784e1627743c06127dbaa1b744cba8e">&#9670;&#160;</a></span>cumsum()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::cumsum </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Cumulative sum along all elements (flattened view). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with cumulative sums. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04774">4774</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4774</span>                                {</div>
<div class="line"><span class="lineno"> 4775</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 4776</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4777</span>        </div>
<div class="line"><span class="lineno"> 4778</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">total</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 4779</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0];</div>
<div class="line"><span class="lineno"> 4780</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4781</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>-1] + <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4782</span>            }</div>
<div class="line"><span class="lineno"> 4783</span>        }</div>
<div class="line"><span class="lineno"> 4784</span>        </div>
<div class="line"><span class="lineno"> 4785</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4786</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad19397de13c742b72cd0829b01090dd9" name="ad19397de13c742b72cd0829b01090dd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad19397de13c742b72cd0829b01090dd9">&#9670;&#160;</a></span>cumsum_axis()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::cumsum_axis </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>axis</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Cumulative sum along a specific axis. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The dimension along which to compute cumulative sum. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with cumulative sums along the specified axis. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04811">4811</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4811</span>                                                {</div>
<div class="line"><span class="lineno"> 4812</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &gt;= <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 4813</span>            <span class="keywordflow">throw</span> <a class="code hl_class" href="classTensor.html">std::out_of_range</a>(<span class="stringliteral">&quot;Axis out of bounds&quot;</span>);</div>
<div class="line"><span class="lineno"> 4814</span>        }</div>
<div class="line"><span class="lineno"> 4815</span>        </div>
<div class="line"><span class="lineno"> 4816</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 4817</span>        </div>
<div class="line"><span class="lineno"> 4818</span>        <span class="comment">// Compute strides</span></div>
<div class="line"><span class="lineno"> 4819</span>        <a class="code hl_class" href="classTensor.html">std::array&lt;size_t, N&gt;</a> <a class="code hl_function" href="#a938d78600782073a1ff2725066b46c85">strides</a>;</div>
<div class="line"><span class="lineno"> 4820</span>        <a class="code hl_function" href="#a938d78600782073a1ff2725066b46c85">strides</a>[<a class="code hl_class" href="classTensor.html">N</a>-1] = 1;</div>
<div class="line"><span class="lineno"> 4821</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">N</a>-1; <a class="code hl_class" href="classTensor.html">i</a>-- &gt; 0;) {</div>
<div class="line"><span class="lineno"> 4822</span>            <a class="code hl_function" href="#a938d78600782073a1ff2725066b46c85">strides</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_function" href="#a938d78600782073a1ff2725066b46c85">strides</a>[<a class="code hl_class" href="classTensor.html">i</a>+1] * <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>+1];</div>
<div class="line"><span class="lineno"> 4823</span>        }</div>
<div class="line"><span class="lineno"> 4824</span>        </div>
<div class="line"><span class="lineno"> 4825</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 4826</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">axis</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4827</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4828</span>        }</div>
<div class="line"><span class="lineno"> 4829</span>        </div>
<div class="line"><span class="lineno"> 4830</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 4831</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">axis</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4832</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4833</span>        }</div>
<div class="line"><span class="lineno"> 4834</span>        </div>
<div class="line"><span class="lineno"> 4835</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">axis_size</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>];</div>
<div class="line"><span class="lineno"> 4836</span>        </div>
<div class="line"><span class="lineno"> 4837</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4838</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4839</span>                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">cumulative</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 4840</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 0; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 4841</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4842</span>                    <a class="code hl_class" href="classTensor.html">cumulative</a> += <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">idx</a>];</div>
<div class="line"><span class="lineno"> 4843</span>                    <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">idx</a>] = <a class="code hl_class" href="classTensor.html">cumulative</a>;</div>
<div class="line"><span class="lineno"> 4844</span>                }</div>
<div class="line"><span class="lineno"> 4845</span>            }</div>
<div class="line"><span class="lineno"> 4846</span>        }</div>
<div class="line"><span class="lineno"> 4847</span>        </div>
<div class="line"><span class="lineno"> 4848</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4849</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8befdfb5ad9c3f2a69f8bdccc9a3787" name="ad8befdfb5ad9c3f2a69f8bdccc9a3787"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8befdfb5ad9c3f2a69f8bdccc9a3787">&#9670;&#160;</a></span>data() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T * <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::data </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00524">524</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  524</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a07bf856a863505d2960b0bfad9c3b3f4" name="a07bf856a863505d2960b0bfad9c3b3f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07bf856a863505d2960b0bfad9c3b3f4">&#9670;&#160;</a></span>data() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const T * <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::data </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get raw pointer to data (for internal use and I/O). </p><dl class="section return"><dt>Returns</dt><dd>Pointer to the underlying data array. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00523">523</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  523</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(); }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a07bf856a863505d2960b0bfad9c3b3f4_icgraph.png" border="0" usemap="#aclassTensor_a07bf856a863505d2960b0bfad9c3b3f4_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a07bf856a863505d2960b0bfad9c3b3f4_icgraph" id="aclassTensor_a07bf856a863505d2960b0bfad9c3b3f4_icgraph">
<area shape="rect" title=" " alt="" coords="449,813,542,840"/>
<area shape="rect" href="classTensor.html#ae5260fcc92739949dd584a0b931d1853" title=" " alt="" coords="214,5,401,32"/>
<area shape="poly" title=" " alt="" coords="490,798,480,632,460,393,448,273,433,168,416,88,408,62,399,46,386,35,389,31,403,42,413,60,422,87,438,167,453,272,466,392,485,631,495,798"/>
<area shape="rect" href="classTensor.html#a76c7896d6d3ec3066bfd12dbeca73f9e" title=" " alt="" coords="216,56,399,83"/>
<area shape="poly" title=" " alt="" coords="492,798,491,651,481,441,469,332,453,233,429,152,415,120,399,96,386,85,389,81,403,93,420,118,434,150,458,232,475,332,486,440,496,651,497,798"/>
<area shape="rect" href="tensor_8h.html#a1ce61bbd53890adec19f5b19f946ef26" title="Return indices that would sort the tensor (1D only)." alt="" coords="277,107,338,133"/>
<area shape="poly" title=" " alt="" coords="492,798,488,662,476,470,464,371,448,280,426,205,413,176,399,154,386,142,371,134,338,125,339,120,373,129,389,138,403,150,418,173,431,203,453,279,469,370,481,469,494,662,497,798"/>
<area shape="rect" href="tensor_8h.html#a952343525fb5d9376af0645793e8f1d4" title="Find k largest or smallest elements and their indices (1D only)." alt="" coords="62,132,109,159"/>
<area shape="poly" title=" " alt="" coords="492,798,489,669,477,488,465,395,449,312,427,243,414,217,399,198,378,184,347,173,264,158,176,151,109,148,109,143,177,146,264,153,348,168,381,180,403,194,418,214,432,241,454,310,471,395,482,487,494,669,497,798"/>
<area shape="rect" href="classTensorRandom.html#a4ab3dafd07fad48c51646b18f3941d2d" title=" " alt="" coords="236,208,378,235"/>
<area shape="poly" title=" " alt="" coords="491,798,485,681,470,518,458,436,442,360,423,298,399,255,375,237,378,233,403,252,428,296,447,359,463,435,475,518,490,680,496,798"/>
<area shape="rect" href="classTensorRandom.html#aa1a5064152168f02c6e31f37c7029517" title=" " alt="" coords="5,233,166,260"/>
<area shape="poly" title=" " alt="" coords="491,798,485,688,470,537,458,461,443,392,423,336,412,315,399,299,384,289,361,280,302,266,233,257,166,252,166,247,233,251,303,260,363,274,386,284,403,295,416,312,428,334,448,391,464,460,476,536,490,687,496,798"/>
<area shape="rect" href="namespaceloss.html#a365059b00ea1e6ec1db86710cfcf3b31" title="Binary cross entropy loss for binary classification." alt="" coords="244,309,371,352"/>
<area shape="poly" title=" " alt="" coords="490,798,480,701,463,572,436,448,419,399,399,366,386,354,370,346,373,341,389,350,403,362,423,397,441,446,468,571,485,701,495,798"/>
<area shape="rect" href="classTensorRandom.html#a13c2ca2a4729bd8252f729ca4737b561" title=" " alt="" coords="228,376,387,403"/>
<area shape="poly" title=" " alt="" coords="489,798,479,711,461,596,434,487,418,445,399,416,384,405,388,401,403,413,422,443,439,486,466,595,484,710,494,798"/>
<area shape="rect" href="classTensorRandom.html#a3cb586fc12c2fa7ae9ba9a072c460312" title=" " alt="" coords="214,427,401,453"/>
<area shape="poly" title=" " alt="" coords="488,798,476,720,457,621,431,527,416,491,399,467,384,456,387,452,403,463,420,489,436,526,462,620,481,719,493,797"/>
<area shape="rect" href="tensor_8h.html#a64dfa8c2475ed50ae00ef1d4e1c12fd2" title="Divide tensor into equal&#45;sized chunks (last chunk may be smaller)." alt="" coords="279,501,336,528"/>
<area shape="poly" title=" " alt="" coords="490,798,484,745,469,678,442,609,423,577,399,549,385,538,369,529,335,520,337,515,371,524,388,533,403,545,427,574,447,607,474,677,489,744,496,797"/>
<area shape="rect" href="tensor_8h.html#a139335a446015c5f7ad70fa3d2ccfbec" title="Split tensor into chunks along specified axis." alt="" coords="63,513,108,540"/>
<area shape="poly" title=" " alt="" coords="489,799,481,753,465,697,439,640,421,615,399,593,377,580,345,568,262,550,175,538,109,531,109,526,175,533,262,545,346,563,379,575,403,589,425,611,444,637,470,695,486,751,494,798"/>
<area shape="rect" href="classTensorRandom.html#a0e0fffdaccf3f3ef986a586a70036c46" title=" " alt="" coords="216,603,399,629"/>
<area shape="poly" title=" " alt="" coords="485,799,474,763,457,721,432,679,399,643,381,632,384,628,403,639,436,676,462,719,479,761,490,798"/>
<area shape="rect" href="namespaceloss.html#ab7fbd0200f34e3d12f66d20b681a948f" title="L1 loss (Mean Absolute Error)." alt="" coords="260,653,354,680"/>
<area shape="poly" title=" " alt="" coords="480,800,448,746,426,718,399,694,378,683,354,675,356,670,380,678,403,690,430,714,453,743,485,798"/>
<area shape="rect" href="tensor__io_8h.html#a7e2cae1250696214044c322ac0bd4a1b" title="Load a tensor from a binary file." alt="" coords="264,704,351,731"/>
<area shape="poly" title=" " alt="" coords="471,804,439,773,400,745,351,727,353,722,402,740,443,769,475,800"/>
<area shape="rect" href="classTensor.html#a754cdcbf16b91d5621e7405a2aa68f68" title=" " alt="" coords="218,755,397,781"/>
<area shape="poly" title=" " alt="" coords="442,810,400,796,361,784,363,779,402,791,444,805"/>
<area shape="rect" href="classTensor.html#a4773678cdfb3526a2bdb1079ef68b87e" title=" " alt="" coords="228,805,387,848"/>
<area shape="poly" title=" " alt="" coords="433,829,388,829,388,824,433,824"/>
<area shape="rect" href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7" title="Mean Squared Error (MSE) Loss." alt="" coords="253,872,362,899"/>
<area shape="poly" title=" " alt="" coords="444,848,402,863,363,874,361,869,400,857,442,843"/>
<area shape="rect" href="classTensorRandom.html#a32623f7c051b83056274671f87e7541a" title=" " alt="" coords="229,923,386,949"/>
<area shape="poly" title=" " alt="" coords="475,853,443,884,402,913,375,925,373,920,400,908,439,880,471,849"/>
<area shape="rect" href="tensor__io_8h.html#ad4f347ce46aff75bdad7db7e7d7eabef" title="Pretty print a tensor with formatting options." alt="" coords="284,973,330,1000"/>
<area shape="poly" title=" " alt="" coords="485,856,453,911,430,939,402,964,366,980,332,987,330,982,365,975,400,959,426,936,448,908,480,853"/>
<area shape="rect" href="classTensorRandom.html#adaa260a2571c3009e0f2a527c386b460" title=" " alt="" coords="222,1024,393,1051"/>
<area shape="poly" title=" " alt="" coords="490,856,479,892,462,935,436,977,403,1014,384,1026,381,1021,399,1010,432,974,457,932,474,890,485,854"/>
<area shape="rect" href="tensor_8h.html#ad71687cadd6e7bdae0f2d66fc9f437e1" title="Construct tensor by repeating along specified axis." alt="" coords="244,1075,370,1101"/>
<area shape="poly" title=" " alt="" coords="494,855,486,901,469,957,443,1015,425,1041,403,1065,372,1082,370,1077,399,1061,420,1038,438,1012,464,955,480,900,489,854"/>
<area shape="rect" href="tensor__io_8h.html#a8141782719cc7c7dc60b3043bbbc5366" title="Save a tensor to a file in binary format." alt="" coords="262,1125,353,1152"/>
<area shape="poly" title=" " alt="" coords="496,856,491,911,476,980,464,1017,449,1053,428,1086,403,1115,380,1130,354,1138,353,1133,378,1125,399,1111,424,1083,444,1050,459,1015,471,979,486,910,491,855"/>
<area shape="rect" href="tensor__io_8h.html#ac622682f190796d532e11f0c7b597aa0" title="Save a tensor to NumPy .npy format (version 1.0)." alt="" coords="269,1176,346,1203"/>
<area shape="poly" title=" " alt="" coords="498,856,495,919,483,1002,471,1047,455,1090,432,1130,403,1166,376,1183,347,1190,346,1185,374,1178,399,1162,428,1127,450,1088,466,1045,478,1001,490,919,493,855"/>
<area shape="rect" href="tensor__io_8h.html#add21f5804707b520f88e074026b258b3" title="Save a tensor to a text file (CSV&#45;like format)." alt="" coords="268,1227,346,1253"/>
<area shape="poly" title=" " alt="" coords="494,856,483,938,464,1046,438,1149,421,1189,403,1217,377,1233,348,1241,346,1236,375,1228,399,1213,417,1186,433,1147,459,1045,478,938,489,855"/>
<area shape="rect" href="tensor_8h.html#abcbf52cee83938743ba0195663090841" title="Binary search to find indices where elements should be inserted (1D only)." alt="" coords="259,1277,356,1304"/>
<area shape="poly" title=" " alt="" coords="495,856,485,948,468,1071,455,1133,441,1189,423,1235,403,1267,381,1282,357,1290,355,1285,379,1277,399,1263,419,1233,436,1187,450,1132,462,1070,480,948,489,855"/>
<area shape="rect" href="namespaceloss.html#a2d2c1dacdb37d834f7dc10e85cd1a742" title="Smooth L1 loss (Huber loss)." alt="" coords="235,1328,380,1355"/>
<area shape="poly" title=" " alt="" coords="495,856,487,958,471,1096,459,1166,444,1229,425,1282,403,1318,381,1333,378,1329,399,1314,420,1279,439,1228,454,1165,466,1095,482,957,490,855"/>
<area shape="rect" href="tensor_8h.html#a4bfe3189f926716838813a01b6c37038" title="Sort tensor elements and return sorted tensor (1D only)." alt="" coords="286,1379,329,1405"/>
<area shape="poly" title=" " alt="" coords="496,855,490,967,474,1120,462,1198,447,1269,427,1328,403,1368,387,1381,367,1389,330,1395,329,1390,366,1384,384,1377,399,1365,422,1326,442,1268,457,1197,469,1120,484,966,491,855"/>
<area shape="rect" href="tensor_8h.html#ac2791cd88647d71068c02d8824a38ff2" title="Repeat tensor multiple times along each dimension." alt="" coords="288,1429,327,1456"/>
<area shape="poly" title=" " alt="" coords="496,856,491,977,477,1145,465,1231,450,1310,429,1374,417,1400,403,1419,386,1432,366,1440,327,1446,327,1440,364,1435,383,1428,399,1415,412,1397,424,1372,444,1308,460,1230,472,1145,486,977,491,856"/>
<area shape="rect" href="classTensorRandom.html#a24ba0db3d6b9da25b2e6cfc6b15994b8" title=" " alt="" coords="227,1480,388,1507"/>
<area shape="poly" title=" " alt="" coords="497,856,493,986,481,1170,469,1264,453,1350,431,1421,418,1448,403,1470,389,1482,385,1477,399,1466,413,1446,426,1419,447,1348,464,1263,475,1169,488,986,492,856"/>
<area shape="rect" href="tensor_8h.html#ad136045cd6f420421ea5618b726778f3" title="Find unique elements in tensor (1D only)." alt="" coords="278,1531,337,1557"/>
<area shape="poly" title=" " alt="" coords="497,856,495,995,484,1194,472,1296,455,1390,433,1467,419,1497,403,1520,389,1532,372,1540,338,1547,337,1541,370,1535,386,1528,399,1517,414,1495,428,1465,450,1388,467,1295,478,1193,490,995,492,856"/>
<area shape="rect" href="classTensor.html#ab35759b8f0cec852e27c31cf339737b8" title=" " alt="" coords="233,1581,382,1608"/>
<area shape="poly" title=" " alt="" coords="497,855,497,1004,487,1218,475,1328,458,1430,435,1513,420,1546,403,1571,384,1586,381,1581,399,1567,415,1543,430,1511,453,1428,470,1327,481,1217,491,1003,492,855"/>
<area shape="poly" title=" " alt="" coords="262,128,110,145,109,140,261,123"/>
<area shape="poly" title=" " alt="" coords="221,234,166,240,166,235,221,228"/>
<area shape="poly" title=" " alt="" coords="340,490,330,483,307,480,287,482,277,487,275,493,281,500,277,504,270,494,273,483,286,477,307,475,332,478,343,486"/>
<area shape="poly" title=" " alt="" coords="264,520,109,528,108,523,263,514"/>
<area shape="rect" href="tensor__io_8h.html#ad797300c155fa720a2973a7d8e6d7e6b" title="Load a tensor from a file (auto&#45;detects format)." alt="" coords="63,577,108,604"/>
<area shape="poly" title=" " alt="" coords="247,711,212,694,195,675,187,655,180,636,164,618,136,604,108,596,109,591,138,599,167,614,184,633,192,653,199,672,215,690,249,706"/>
<area shape="rect" href="tensor__c_8cpp.html#a5593190a30886333c69f5323af1837d7" title=" " alt="" coords="19,628,152,655"/>
<area shape="poly" title=" " alt="" coords="248,706,213,694,165,669,134,658,136,653,167,664,215,690,249,701"/>
<area shape="rect" href="tensor__c_8cpp.html#ad4619644bf3a3c6782ca538baf857de2" title=" " alt="" coords="25,679,146,705"/>
<area shape="poly" title=" " alt="" coords="248,713,146,701,146,696,248,708"/>
<area shape="rect" href="tensor__c_8cpp.html#a48336469b05364f186cfb755e9a4b964" title=" " alt="" coords="19,729,152,756"/>
<area shape="poly" title=" " alt="" coords="248,727,153,738,153,732,248,721"/>
<area shape="rect" href="tensor__c_8cpp.html#aeb2b9f618f951ee364a412717a705231" title=" " alt="" coords="25,780,146,807"/>
<area shape="poly" title=" " alt="" coords="249,734,215,745,167,770,136,782,134,777,165,766,213,740,248,728"/>
<area shape="rect" href="classTensor.html#a3090598433576f68f34f340cd6a18089" title=" " alt="" coords="13,831,158,873"/>
<area shape="poly" title=" " alt="" coords="213,840,159,846,158,841,212,835"/>
<area shape="rect" href="tensor__io_8h.html#a223dda8ee6a3e3344a59b4f0fe19df42" title=" " alt="" coords="39,923,132,949"/>
<area shape="poly" title=" " alt="" coords="268,981,132,949,133,944,270,976"/>
<area shape="rect" href="tensor__io_8h.html#a278d10cd95a2b11a414ecd8eda1b665e" title="Convert tensor to string representation." alt="" coords="50,973,121,1000"/>
<area shape="poly" title=" " alt="" coords="269,989,122,989,122,984,269,984"/>
<area shape="rect" href="tensor__c_8cpp.html#a6bcb6552c10a49c900c884bc90502f18" title=" " alt="" coords="17,1024,154,1051"/>
<area shape="poly" title=" " alt="" coords="245,1130,212,1116,197,1103,187,1090,179,1077,164,1065,141,1054,143,1049,167,1060,182,1074,192,1087,201,1099,215,1111,248,1125"/>
<area shape="rect" href="tensor__c_8cpp.html#a5f089dd07835b1e12bace4400085be22" title=" " alt="" coords="23,1075,148,1101"/>
<area shape="poly" title=" " alt="" coords="246,1128,146,1105,148,1099,247,1122"/>
<area shape="rect" href="tensor__io_8h.html#af1dee4960bb4ee62c02499855bb66a2d" title="Save a tensor to a file with specified format." alt="" coords="61,1227,110,1253"/>
<area shape="poly" title=" " alt="" coords="248,1152,215,1166,201,1178,192,1191,182,1204,167,1217,139,1230,111,1238,110,1233,137,1225,164,1212,179,1200,187,1188,197,1175,212,1162,245,1147"/>
<area shape="rect" href="tensor__c_8cpp.html#aefb7ebf64853d118255476d31709288c" title=" " alt="" coords="17,1125,154,1152"/>
<area shape="poly" title=" " alt="" coords="246,1141,155,1141,155,1136,246,1136"/>
<area shape="rect" href="tensor__c_8cpp.html#a40689cfb9e9d6f1fa7d9fb5c90c4e41d" title=" " alt="" coords="23,1176,148,1203"/>
<area shape="poly" title=" " alt="" coords="247,1155,148,1178,146,1173,246,1150"/>
<area shape="poly" title=" " alt="" coords="254,1204,111,1237,110,1232,253,1199"/>
<area shape="poly" title=" " alt="" coords="253,1243,110,1243,110,1237,253,1237"/>
<area shape="rect" href="tensor__io_8h.html#a9e03fa16492ffad78aee9cc9f84073d9" title=" " alt="" coords="23,1277,148,1304"/>
<area shape="poly" title=" " alt="" coords="254,1255,148,1279,147,1274,252,1250"/>
</map>
</div>

</div>
</div>
<a id="ad74772ea04c239f0878e8ad8653dce5d" name="ad74772ea04c239f0878e8ad8653dce5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad74772ea04c239f0878e8ad8653dce5d">&#9670;&#160;</a></span>data_ptr() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T * <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::data_ptr </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00505">505</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  505</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3f3c97d177cb960a4423afc3dafc612a" name="a3f3c97d177cb960a4423afc3dafc612a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f3c97d177cb960a4423afc3dafc612a">&#9670;&#160;</a></span>data_ptr() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const T * <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::data_ptr </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00504">504</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  504</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(); }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a3f3c97d177cb960a4423afc3dafc612a_icgraph.png" border="0" usemap="#aclassTensor_a3f3c97d177cb960a4423afc3dafc612a_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a3f3c97d177cb960a4423afc3dafc612a_icgraph" id="aclassTensor_a3f3c97d177cb960a4423afc3dafc612a_icgraph">
<area shape="rect" title=" " alt="" coords="584,968,700,995"/>
<area shape="rect" href="tensor_8h.html#abee606191f2a9544a7acbbd79094ed5b" title="Create a tensor with values in a range (NumPy arange&#45;compatible)." alt="" coords="424,5,484,32"/>
<area shape="poly" title=" " alt="" coords="637,952,626,757,605,469,590,324,574,196,555,98,545,65,534,46,511,30,484,23,486,18,514,25,538,42,550,63,560,97,579,195,596,323,610,468,631,757,642,952"/>
<area shape="rect" href="tensor_8h.html#a912e291f7a42f325c111def58ac98acf" title="Cast tensor to a different data type (NumPy&#45;compatible astype)." alt="" coords="424,56,484,83"/>
<area shape="poly" title=" " alt="" coords="636,953,625,768,603,495,589,358,572,238,554,146,544,115,534,96,511,80,484,73,486,68,514,76,538,93,549,113,559,144,578,237,594,358,608,495,630,767,642,953"/>
<area shape="rect" href="classTensor.html#a4029fcf1a134dc6add543b9bdd1c045b" title=" " alt="" coords="378,107,530,133"/>
<area shape="poly" title=" " alt="" coords="638,952,637,788,626,547,613,422,595,307,569,212,553,175,534,147,521,136,524,132,538,144,557,172,574,210,600,305,619,421,631,546,643,788,644,952"/>
<area shape="rect" href="tensor_8h.html#adc912199dacbff108e0d2cadfae000df" title="Extract a rectangular block from a 2D tensor." alt="" coords="428,157,480,184"/>
<area shape="poly" title=" " alt="" coords="638,953,636,797,623,571,610,454,592,347,567,258,551,224,534,198,523,188,509,181,480,174,482,169,511,176,526,184,538,194,556,221,572,256,597,345,616,453,628,571,641,797,644,953"/>
<area shape="rect" href="classTensorSlice.html#a1bd9b68295e8796f36452ba27a85e1fb" title=" " alt="" coords="390,208,518,235"/>
<area shape="poly" title=" " alt="" coords="638,952,634,806,620,595,607,486,589,386,565,304,550,273,534,248,517,235,520,231,538,245,555,270,570,302,594,385,612,485,625,594,639,805,643,952"/>
<area shape="rect" href="tensor_8h.html#aa94ca571f8bc2b76cd1bdb6fd851c556" title="Extract bottom n rows from a 2D tensor." alt="" coords="406,259,502,285"/>
<area shape="poly" title=" " alt="" coords="638,953,632,815,617,619,604,519,586,427,563,351,549,321,534,299,519,287,501,280,503,275,522,283,538,296,554,319,568,349,591,425,609,518,622,619,638,815,643,953"/>
<area shape="rect" href="tensor_8h.html#a34fae58316c67748882059be5f1d153c" title="Broadcast a tensor to a new shape." alt="" coords="406,309,502,336"/>
<area shape="poly" title=" " alt="" coords="637,953,631,824,614,643,601,551,583,466,561,397,548,370,534,350,520,338,502,331,504,326,522,334,538,346,553,367,566,395,588,465,606,550,619,643,636,824,642,952"/>
<area shape="rect" href="namespacelinalg.html#a12137fd985ff57d9e9396c8f6919383e" title="Cholesky decomposition: A = L * L^T for symmetric positive definite matrices." alt="" coords="372,360,536,387"/>
<area shape="poly" title=" " alt="" coords="636,953,628,835,609,672,595,589,579,513,558,450,534,407,511,389,514,385,538,404,563,448,584,512,601,588,614,671,633,835,642,952"/>
<area shape="rect" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74" title="Extract a single column from a 2D tensor." alt="" coords="435,1069,473,1096"/>
<area shape="poly" title=" " alt="" coords="612,1006,538,1053,475,1079,473,1074,535,1048,609,1002"/>
<area shape="rect" href="classTensorSlice.html#a2ab23ac1938c1cc469bd2da5eb61d35c" title=" " alt="" coords="397,461,511,488"/>
<area shape="poly" title=" " alt="" coords="636,953,625,852,605,717,591,649,575,587,556,536,534,502,510,486,513,482,538,498,560,534,580,585,596,648,610,716,630,851,641,952"/>
<area shape="rect" href="tensor_8h.html#a3331b6cf4ac182d022336e4d068a0e58" title="Create a copy of a tensor (NumPy&#45;compatible)." alt="" coords="430,512,479,539"/>
<area shape="poly" title=" " alt="" coords="635,953,622,862,601,742,572,627,554,583,534,552,522,543,508,536,479,529,480,524,510,531,525,538,538,549,559,580,577,626,606,741,628,861,640,952"/>
<area shape="rect" href="tensor_8h.html#a43014e3309494c3851da86be3a162194" title="Extract the diagonal of a 2D tensor." alt="" coords="432,563,477,589"/>
<area shape="poly" title=" " alt="" coords="639,953,636,883,623,789,610,739,591,690,566,644,534,603,522,593,507,587,477,580,478,575,509,582,525,589,538,599,571,641,596,688,615,737,628,788,642,882,644,953"/>
<area shape="rect" href="tensor_8h.html#ae66ddfcd20907014f524982e01698d82" title="Create a diagonal matrix from a 1D tensor." alt="" coords="410,613,498,640"/>
<area shape="poly" title=" " alt="" coords="637,953,632,891,616,811,603,768,585,727,563,688,535,654,518,642,498,635,500,630,520,637,538,650,567,685,590,724,608,766,621,809,637,890,643,952"/>
<area shape="rect" href="namespacelinalg.html#a4f401211bb16058dcce20c796bda8dd2" title="Compute dot product of two vectors." alt="" coords="416,664,493,691"/>
<area shape="poly" title=" " alt="" coords="635,953,627,900,609,833,580,764,559,732,535,705,515,692,492,684,494,679,517,687,538,701,563,729,584,762,615,831,632,899,641,952"/>
<area shape="rect" href="namespacelinalg.html#a7141076f8e6b39635853e8368a13c4ea" title="Compute eigenvalues and eigenvectors for symmetric matrices." alt="" coords="390,715,519,741"/>
<area shape="poly" title=" " alt="" coords="633,954,622,910,603,856,574,802,556,777,535,755,517,744,520,740,538,751,560,774,579,799,607,854,627,908,638,952"/>
<area shape="rect" href="tensor_8h.html#a04c7965d0b8f08cfdb84580050e9e0b5" title="Extract first n elements from a 1D tensor." alt="" coords="430,765,479,792"/>
<area shape="poly" title=" " alt="" coords="629,954,615,920,595,880,568,840,535,806,507,791,479,784,480,779,509,786,538,802,572,837,600,877,620,918,634,952"/>
<area shape="rect" href="namespacelinalg.html#abc25aee98d873c690a7d8a88277e7219" title="Compute inverse of a square matrix." alt="" coords="182,639,283,665"/>
<area shape="poly" title=" " alt="" coords="637,953,630,840,613,688,600,611,583,542,561,487,548,466,535,451,495,427,476,423,457,422,418,431,373,452,346,470,322,493,283,546,256,599,240,639,235,637,251,597,278,544,318,489,343,466,371,447,416,426,457,416,477,417,497,422,538,447,553,463,566,484,588,540,605,610,619,687,635,840,642,952"/>
<area shape="rect" href="tensor_8h.html#a0d1116cdf6624cb52514979cd1869e55" title="Extract leftmost n columns from a 2D tensor." alt="" coords="421,867,487,893"/>
<area shape="poly" title=" " alt="" coords="612,960,577,933,535,908,487,890,489,885,537,903,580,929,615,956"/>
<area shape="rect" href="tensor_8h.html#a47fb1071bbaf297c2b7804f3a16cbce0" title="Create a tensor with evenly spaced values (NumPy linspace&#45;compatible)." alt="" coords="420,917,489,944"/>
<area shape="poly" title=" " alt="" coords="574,966,489,943,490,937,576,961"/>
<area shape="rect" href="tensor_8h.html#ac9b881e42d5eeb214b4ca87579eaaffc" title="Create a tensor with values spaced evenly on a log scale." alt="" coords="418,968,491,995"/>
<area shape="poly" title=" " alt="" coords="569,984,491,984,491,979,569,979"/>
<area shape="rect" href="namespacelinalg.html#a8405b084d692b1fc7f685f40425a0970" title="Solve least squares problem: minimize ||Ax &#45; b||" alt="" coords="5,1221,93,1248"/>
<area shape="poly" title=" " alt="" coords="644,1010,642,1151,629,1350,617,1452,598,1544,572,1618,556,1647,538,1667,500,1692,460,1703,421,1701,382,1688,344,1665,306,1635,270,1598,235,1557,172,1467,119,1377,54,1250,59,1247,123,1375,176,1464,239,1554,274,1594,310,1631,347,1661,384,1683,422,1696,460,1698,497,1687,535,1663,552,1643,567,1616,593,1542,611,1451,624,1350,636,1151,638,1010"/>
<area shape="rect" href="namespacelinalg.html#a299049265c4cb34923444e82e56f381f" title="Compute LU decomposition with partial pivoting: P*A = L*U." alt="" coords="393,816,515,843"/>
<area shape="poly" title=" " alt="" coords="623,956,587,905,562,879,535,857,513,846,516,841,538,852,566,875,591,902,627,953"/>
<area shape="rect" href="namespacelinalg.html#a49a644f54af36b484886d433da564a1f" title="Solve linear system Ax = b." alt="" coords="187,867,278,893"/>
<area shape="poly" title=" " alt="" coords="598,1003,548,1020,489,1031,458,1032,428,1030,398,1022,371,1009,357,998,350,985,344,959,339,932,333,919,322,907,301,895,277,887,279,882,303,890,326,903,337,916,344,930,349,958,355,983,361,994,373,1004,400,1017,429,1025,459,1027,489,1026,547,1015,596,998"/>
<area shape="rect" href="namespacelinalg.html#a6ee776536e47c3e57b3b24ed6225bff2" title=" " alt="" coords="403,1171,505,1197"/>
<area shape="poly" title=" " alt="" coords="634,1010,620,1045,600,1085,572,1126,538,1161,507,1177,505,1172,535,1157,568,1122,595,1082,615,1043,629,1008"/>
<area shape="rect" href="namespacelinalg.html#a57a91e9770c813128f00c0a1ea674012" title=" " alt="" coords="403,1221,505,1248"/>
<area shape="poly" title=" " alt="" coords="638,1010,627,1054,607,1108,579,1163,560,1189,538,1211,507,1228,505,1224,535,1207,556,1185,574,1161,603,1106,622,1053,633,1009"/>
<area shape="rect" href="namespacelinalg.html#a16562e1c4018bf2a58455158a8022fb9" title="Compute the L2 norm (Euclidean norm) of a vector." alt="" coords="410,1272,498,1299"/>
<area shape="poly" title=" " alt="" coords="641,1011,632,1064,615,1131,584,1201,563,1233,538,1262,520,1274,500,1282,498,1277,517,1270,535,1258,559,1230,580,1199,609,1130,627,1063,635,1010"/>
<area shape="rect" href="tensor_8h.html#aa8d30c4d06f085bf8078c8644030c633" title="Normalize tensor using L1 norm (sum of absolute values)." alt="" coords="407,1323,501,1349"/>
<area shape="poly" title=" " alt="" coords="643,1011,637,1073,621,1153,608,1196,590,1238,567,1278,538,1313,522,1324,503,1332,501,1327,519,1320,535,1309,563,1275,585,1236,603,1194,616,1152,632,1072,637,1010"/>
<area shape="rect" href="tensor_8h.html#a7718d2096a1190de7777bc65f9a86deb" title="Normalize tensor using L2 norm (Euclidean norm)." alt="" coords="407,1373,501,1400"/>
<area shape="poly" title=" " alt="" coords="644,1010,642,1080,628,1175,615,1225,596,1275,571,1322,538,1363,522,1375,503,1383,501,1378,519,1371,534,1359,566,1319,591,1273,610,1224,623,1174,636,1080,639,1010"/>
<area shape="rect" href="tensor_8h.html#a1782e0dff417e1292f8a6f1e3e1975f1" title="Min&#45;Max normalization: scales values to [min_val, max_val] range." alt="" coords="389,1424,519,1451"/>
<area shape="poly" title=" " alt="" coords="640,1010,628,1101,606,1222,577,1337,559,1382,538,1414,521,1426,518,1422,534,1410,554,1380,572,1335,601,1221,622,1101,635,1010"/>
<area shape="rect" href="tensor_8h.html#a57c931d0d77f610850f315fdd9acef39" title="Z&#45;score normalization (standardization): (x &#45; mean) / std." alt="" coords="392,1475,516,1501"/>
<area shape="poly" title=" " alt="" coords="641,1011,630,1111,610,1247,596,1315,580,1377,560,1429,538,1464,518,1479,515,1475,534,1461,556,1426,575,1376,591,1314,605,1246,625,1111,636,1010"/>
<area shape="rect" href="namespacelinalg.html#a3395139856f5efebaa58f3bc9c4ed3bd" title="QR decomposition: A = QR." alt="" coords="392,1525,516,1552"/>
<area shape="poly" title=" " alt="" coords="641,1010,632,1120,613,1271,599,1348,583,1417,562,1475,538,1515,518,1530,515,1526,534,1512,558,1473,577,1416,594,1346,608,1270,627,1120,636,1010"/>
<area shape="rect" href="tensor_8h.html#a280a6c1ac0d132b0a98af81c1fe371d8" title="Reshape a tensor (returns variant for error handling)." alt="" coords="412,1576,497,1603"/>
<area shape="poly" title=" " alt="" coords="642,1010,634,1129,616,1295,603,1380,586,1457,564,1521,552,1546,538,1566,520,1580,498,1588,496,1583,517,1575,534,1562,547,1544,559,1519,580,1456,598,1379,611,1295,629,1129,637,1010"/>
<area shape="rect" href="tensor_8h.html#a3798be100af6c60da8c8489ba3ac808a" title="Extract rightmost n columns from a 2D tensor." alt="" coords="418,1627,491,1653"/>
<area shape="poly" title=" " alt="" coords="642,1010,636,1139,619,1320,606,1413,588,1498,566,1568,553,1595,538,1617,517,1632,492,1640,490,1635,514,1627,534,1613,548,1593,561,1566,583,1496,601,1412,614,1319,631,1139,637,1010"/>
<area shape="rect" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee" title="Extract a single row from a 2D tensor." alt="" coords="433,1120,475,1147"/>
<area shape="poly" title=" " alt="" coords="627,1010,591,1061,566,1087,538,1110,507,1125,477,1133,475,1128,505,1120,535,1106,562,1083,587,1057,623,1006"/>
<area shape="rect" href="classTensorSlice.html#a97f65d9035ab3c07afba7640a2507deb" title=" " alt="" coords="395,1728,513,1755"/>
<area shape="poly" title=" " alt="" coords="643,1010,638,1155,623,1364,610,1471,592,1571,568,1653,554,1686,538,1711,515,1729,512,1725,534,1708,550,1683,563,1651,587,1569,605,1471,618,1363,633,1155,638,1010"/>
<area shape="rect" href="classTensorSlice.html#ab59881da676b46fd6be88b2b7361e981" title=" " alt="" coords="392,1779,516,1805"/>
<area shape="poly" title=" " alt="" coords="644,1010,641,1165,628,1392,616,1509,597,1617,572,1706,556,1741,538,1768,518,1783,515,1779,534,1765,551,1739,567,1705,592,1616,610,1509,623,1392,636,1165,638,1010"/>
<area shape="rect" href="namespacelinalg.html#a2e81c90534586128fa4bcae3bb042175" title="Singular Value Decomposition: A = U * Sigma * V^T." alt="" coords="388,1829,521,1856"/>
<area shape="poly" title=" " alt="" coords="644,1010,643,1175,631,1416,619,1542,600,1657,574,1753,557,1790,538,1819,523,1832,520,1827,534,1816,553,1788,569,1751,595,1656,613,1541,626,1416,637,1174,638,1010"/>
<area shape="rect" href="tensor_8h.html#a90d629271a42d730c36b7be1f66deae8" title="Extract last n elements from a 1D tensor." alt="" coords="435,1880,473,1907"/>
<area shape="poly" title=" " alt="" coords="642,1010,630,1195,608,1468,594,1605,578,1726,559,1818,549,1850,538,1870,524,1882,507,1889,474,1896,473,1890,506,1884,521,1877,534,1866,544,1848,554,1817,572,1725,589,1604,603,1467,625,1195,636,1010"/>
<area shape="rect" href="tensor_8h.html#a1cb2cae503ca515b1780c72fd05b21db" title="Extract top n rows from a 2D tensor." alt="" coords="418,1931,491,1957"/>
<area shape="poly" title=" " alt="" coords="642,1011,631,1206,610,1494,596,1640,579,1768,560,1866,550,1899,538,1920,517,1936,492,1944,491,1939,515,1932,534,1917,545,1897,555,1865,574,1767,590,1639,605,1494,626,1206,637,1010"/>
<area shape="rect" href="classMemoryPool.html#a980db306a49ce0f4b149198a99b6d24e" title="Clear all pooled memory." alt="" coords="167,132,298,159"/>
<area shape="poly" title=" " alt="" coords="412,169,298,155,298,150,413,163"/>
<area shape="rect" href="classMemoryPool.html#a842e63c49f94b807e42b8ed5897bd1bb" title="Destructor &#45; frees all pooled memory." alt="" coords="141,183,324,209"/>
<area shape="poly" title=" " alt="" coords="413,178,325,188,324,183,412,173"/>
<area shape="rect" href="tensor__c_8cpp.html#ae83aa792d547c4137efbfed451c7357c" title=" " alt="" coords="152,335,313,361"/>
<area shape="poly" title=" " alt="" coords="357,365,313,360,314,355,357,360"/>
<area shape="rect" href="tensor__c_8cpp.html#a255ee6f1fd55dc24865fd759cda653c9" title=" " alt="" coords="158,385,306,412"/>
<area shape="poly" title=" " alt="" coords="357,387,307,393,307,388,356,382"/>
<area shape="rect" href="namespacelinalg.html#a6b7af062b5a9642d788fcc084335b39c" title=" " alt="" coords="162,1171,302,1197"/>
<area shape="poly" title=" " alt="" coords="420,1092,396,1099,373,1110,359,1122,350,1135,341,1148,325,1161,301,1172,298,1168,323,1156,337,1144,346,1132,355,1119,371,1106,395,1094,419,1086"/>
<area shape="rect" href="tensor__c_8cpp.html#a1d2268dec0e2609a5de6ddad0045383e" title=" " alt="" coords="169,1069,296,1096"/>
<area shape="poly" title=" " alt="" coords="419,1085,296,1085,296,1080,419,1080"/>
<area shape="rect" href="tensor__c_8cpp.html#a6caf88ca765b604eab7b9bab9f47ee10" title=" " alt="" coords="157,917,308,944"/>
<area shape="poly" title=" " alt="" coords="419,1078,394,1068,370,1053,353,1028,346,1003,340,980,322,958,304,947,307,942,326,954,344,978,351,1002,357,1026,374,1049,396,1063,421,1073"/>
<area shape="rect" href="tensor__c_8cpp.html#a876c89ce000825fa6255ea8c7649aefe" title=" " alt="" coords="169,1120,296,1147"/>
<area shape="poly" title=" " alt="" coords="420,1093,295,1122,293,1117,419,1088"/>
<area shape="rect" href="tensor__c_8cpp.html#a5a98f19069ba7a51f436659c6a6941b7" title=" " alt="" coords="175,1019,290,1045"/>
<area shape="poly" title=" " alt="" coords="419,1078,289,1048,290,1042,420,1072"/>
<area shape="rect" href="tensor__c_8cpp.html#a036fdfc552daa9f0aa2030e56775d327" title=" " alt="" coords="163,968,302,995"/>
<area shape="poly" title=" " alt="" coords="419,1075,371,1053,356,1041,346,1030,337,1019,323,1009,297,998,299,993,325,1004,341,1015,350,1026,360,1037,373,1048,422,1070"/>
<area shape="poly" title=" " alt="" coords="380,812,371,806,327,772,290,733,240,667,244,664,294,730,331,768,373,802,383,807"/>
<area shape="poly" title=" " alt="" coords="378,849,279,872,277,867,377,844"/>
<area shape="poly" title=" " alt="" coords="173,890,157,897,143,907,113,945,90,987,74,1033,63,1079,53,1163,52,1221,47,1221,48,1163,58,1078,69,1031,85,985,108,942,139,903,154,892,171,885"/>
<area shape="poly" title=" " alt="" coords="387,1187,303,1187,303,1181,387,1181"/>
<area shape="poly" title=" " alt="" coords="389,1201,324,1212,199,1226,93,1235,93,1229,198,1221,324,1207,388,1195"/>
<area shape="poly" title=" " alt="" coords="418,1144,295,1173,294,1167,417,1139"/>
<area shape="poly" title=" " alt="" coords="417,1128,294,1099,295,1094,418,1123"/>
<area shape="poly" title=" " alt="" coords="418,1136,297,1136,297,1131,418,1131"/>
<area shape="poly" title=" " alt="" coords="417,1129,394,1122,371,1110,355,1097,346,1084,337,1072,323,1060,289,1045,291,1040,325,1055,341,1068,350,1081,359,1094,373,1106,396,1117,419,1124"/>
</map>
</div>

</div>
</div>
<a id="ae5b52299c11f3ba81e781cb008542285" name="ae5b52299c11f3ba81e781cb008542285"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5b52299c11f3ba81e781cb008542285">&#9670;&#160;</a></span>detach()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::detach </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Detach this tensor from the computation graph. </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with the same data but no gradient tracking. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00822">822</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  822</span>                                {</div>
<div class="line"><span class="lineno">  823</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  824</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno">  825</span>        <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_class" href="classTensor.html">total</a>, <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno">  826</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno">  827</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_ae5b52299c11f3ba81e781cb008542285_icgraph.png" border="0" usemap="#aclassTensor_ae5b52299c11f3ba81e781cb008542285_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_ae5b52299c11f3ba81e781cb008542285_icgraph" id="aclassTensor_ae5b52299c11f3ba81e781cb008542285_icgraph">
<area shape="rect" title=" " alt="" coords="219,265,326,292"/>
<area shape="rect" href="namespaceloss.html#a365059b00ea1e6ec1db86710cfcf3b31" title="Binary cross entropy loss for binary classification." alt="" coords="24,5,152,48"/>
<area shape="poly" title=" " alt="" coords="262,251,251,209,232,159,205,107,169,62,151,49,154,44,173,58,210,104,237,157,256,208,268,249"/>
<area shape="rect" href="namespaceloss.html#ab7fbd0200f34e3d12f66d20b681a948f" title="L1 loss (Mean Absolute Error)." alt="" coords="41,72,135,99"/>
<area shape="poly" title=" " alt="" coords="259,252,246,220,226,182,201,145,169,113,153,103,135,96,137,91,155,98,172,109,205,141,231,179,251,217,264,250"/>
<area shape="rect" href="classTensor.html#a834720ab65874a6c5503f7670c4f22fe" title=" " alt="" coords="23,123,153,165"/>
<area shape="poly" title=" " alt="" coords="249,255,214,217,169,180,149,168,152,164,172,175,218,213,253,252"/>
<area shape="rect" href="classTensor.html#a88d5a081d321cbd88ca46ed42ca1112c" title=" " alt="" coords="10,189,166,216"/>
<area shape="poly" title=" " alt="" coords="232,260,170,230,138,219,140,214,172,226,234,255"/>
<area shape="rect" href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7" title="Mean Squared Error (MSE) Loss." alt="" coords="33,240,143,267"/>
<area shape="poly" title=" " alt="" coords="203,272,143,263,143,258,204,267"/>
<area shape="rect" href="classTensor.html#af352346a629f774750b12c97234979a9" title=" " alt="" coords="5,291,171,317"/>
<area shape="poly" title=" " alt="" coords="204,291,172,295,171,290,203,285"/>
<area shape="rect" href="classTensor.html#a74db7588a7150d94b620ad63de1f5980" title=" " alt="" coords="21,341,155,368"/>
<area shape="poly" title=" " alt="" coords="234,302,172,332,140,343,138,338,170,327,232,297"/>
<area shape="rect" href="classTensor.html#afff455663faa35d6cfa72aa03f689e94" title=" " alt="" coords="9,392,167,419"/>
<area shape="poly" title=" " alt="" coords="254,306,218,345,172,382,148,394,145,389,169,378,215,341,250,302"/>
<area shape="rect" href="namespaceloss.html#a2d2c1dacdb37d834f7dc10e85cd1a742" title="Smooth L1 loss (Huber loss)." alt="" coords="16,443,160,469"/>
<area shape="poly" title=" " alt="" coords="262,307,228,370,203,404,172,433,152,444,149,440,169,429,199,400,224,367,258,305"/>
<area shape="rect" href="classTensor.html#a4ae322784a9d62e8db2c073f5e2395f7" title=" " alt="" coords="8,493,168,520"/>
<area shape="poly" title=" " alt="" coords="267,308,255,347,236,394,209,442,172,483,154,495,151,491,169,479,205,439,232,392,250,345,262,306"/>
</map>
</div>

</div>
</div>
<a id="af46e252ac24e0557b28c177bd9070596" name="af46e252ac24e0557b28c177bd9070596"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af46e252ac24e0557b28c177bd9070596">&#9670;&#160;</a></span>diag()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::diag </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract diagonal elements (only for 2D tensors). </p>
<dl class="section return"><dt>Returns</dt><dd>1D tensor containing diagonal elements </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05059">5059</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5059</span>                              {</div>
<div class="line"><span class="lineno"> 5060</span>        <a class="code hl_class" href="classTensor.html">return ::diag</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)));</div>
<div class="line"><span class="lineno"> 5061</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a03d314303958ffc5644796d8025cd012" name="a03d314303958ffc5644796d8025cd012"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03d314303958ffc5644796d8025cd012">&#9670;&#160;</a></span>dims()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::dims </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the dimensions of the tensor. </p><dl class="section return"><dt>Returns</dt><dd>An array containing the size of each dimension. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00644">644</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  644</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="adfb14d7fcd29dddd0d1a790719f57b6d" name="adfb14d7fcd29dddd0d1a790719f57b6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfb14d7fcd29dddd0d1a790719f57b6d">&#9670;&#160;</a></span>dot() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if&lt; M==1, <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt; &gt;::type <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::dot </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Dot product for 1D tensors (vector dot product). Computes the sum of element-wise products. Uses GPU acceleration if available and enabled. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The other 1D tensor to compute dot product with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing either the scalar result or an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03140">3140</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3140</span>                                         {</div>
<div class="line"><span class="lineno"> 3141</span>        <span class="keyword">static_assert</span>(<a class="code hl_class" href="classTensor.html">N</a> == 1, <span class="stringliteral">&quot;This dot product is only for 1D tensors&quot;</span>);</div>
<div class="line"><span class="lineno"> 3142</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0] != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0]) {</div>
<div class="line"><span class="lineno"> 3143</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3144</span>        }</div>
<div class="line"><span class="lineno"> 3145</span>        </div>
<div class="line"><span class="lineno"> 3146</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">result</a> = <a class="code hl_class" href="classTensor.html">T</a>();</div>
<div class="line"><span class="lineno"> 3147</span>        </div>
<div class="line"><span class="lineno"> 3148</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 3149</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 3150</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::dot_1d_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), &amp;<a class="code hl_class" href="classTensor.html">result</a>, <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0]);</div>
<div class="line"><span class="lineno"> 3151</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3152</span>        }</div>
<div class="line"><span class="lineno"> 3153</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3154</span>        </div>
<div class="line"><span class="lineno"> 3155</span><span class="preprocessor">#ifdef USE_BLAS</span></div>
<div class="line"><span class="lineno"> 3156</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 3157</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">blas_dot&lt;T&gt;</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0], <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), 1, <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), 1);</div>
<div class="line"><span class="lineno"> 3158</span>        }</div>
<div class="line"><span class="lineno"> 3159</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3160</span>        </div>
<div class="line"><span class="lineno"> 3161</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0]; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3162</span>            <a class="code hl_class" href="classTensor.html">result</a> += <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3163</span>        }</div>
<div class="line"><span class="lineno"> 3164</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3165</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f852881c836e20e6a16469980d7f9b0" name="a2f852881c836e20e6a16469980d7f9b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f852881c836e20e6a16469980d7f9b0">&#9670;&#160;</a></span>dot() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if&lt; M==2, <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; &gt; &gt;::type <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::dot </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Dot product for 2D tensors (matrix multiplication). Computes C = A  B where A is (m  n) and B is (n  p), resulting in C (m  p). Uses GPU acceleration if available, otherwise uses parallel CPU execution. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The other 2D tensor (matrix) to multiply with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing either a new tensor with the result or an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03176">3176</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3176</span>                                         {</div>
<div class="line"><span class="lineno"> 3177</span>        <span class="keyword">static_assert</span>(<a class="code hl_class" href="classTensor.html">N</a> == 2, <span class="stringliteral">&quot;This dot product is only for 2D tensors&quot;</span>);</div>
<div class="line"><span class="lineno"> 3178</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[1] != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0]) {</div>
<div class="line"><span class="lineno"> 3179</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3180</span>        }</div>
<div class="line"><span class="lineno"> 3181</span>        </div>
<div class="line"><span class="lineno"> 3182</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">m</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0];</div>
<div class="line"><span class="lineno"> 3183</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">n</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[1];</div>
<div class="line"><span class="lineno"> 3184</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">p</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[1];</div>
<div class="line"><span class="lineno"> 3185</span>        </div>
<div class="line"><span class="lineno"> 3186</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>({<a class="code hl_class" href="classTensor.html">m</a>, <a class="code hl_class" href="classTensor.html">p</a>}, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3187</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>());</div>
<div class="line"><span class="lineno"> 3188</span>        </div>
<div class="line"><span class="lineno"> 3189</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 3190</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 3191</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::dot_2d_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">m</a>, <a class="code hl_class" href="classTensor.html">n</a>, <a class="code hl_class" href="classTensor.html">p</a>);</div>
<div class="line"><span class="lineno"> 3192</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3193</span>        }</div>
<div class="line"><span class="lineno"> 3194</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3195</span>        </div>
<div class="line"><span class="lineno"> 3196</span><span class="preprocessor">#ifdef USE_BLAS</span></div>
<div class="line"><span class="lineno"> 3197</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 3198</span>            <span class="comment">// BLAS gemm: C = alpha * A * B + beta * C</span></div>
<div class="line"><span class="lineno"> 3199</span>            <span class="comment">// A is mn, B is np, C is mp</span></div>
<div class="line"><span class="lineno"> 3200</span>            <a class="code hl_class" href="classTensor.html">blas_gemm&lt;T&gt;</a>(<a class="code hl_class" href="classTensor.html">CblasRowMajor</a>, <a class="code hl_class" href="classTensor.html">CblasNoTrans</a>, <a class="code hl_class" href="classTensor.html">CblasNoTrans</a>,</div>
<div class="line"><span class="lineno"> 3201</span>                        <a class="code hl_class" href="classTensor.html">m</a>, <a class="code hl_class" href="classTensor.html">p</a>, <a class="code hl_class" href="classTensor.html">n</a>, <a class="code hl_class" href="classTensor.html">T</a>(1), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">n</a>,</div>
<div class="line"><span class="lineno"> 3202</span>                        <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">p</a>, <a class="code hl_class" href="classTensor.html">T</a>(0), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">p</a>);</div>
<div class="line"><span class="lineno"> 3203</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3204</span>        }</div>
<div class="line"><span class="lineno"> 3205</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3206</span>        </div>
<div class="line"><span class="lineno"> 3207</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">row_range</a> = <a class="code hl_class" href="classTensor.html">std::views::iota</a>(<span class="keywordtype">size_t</span>(0), <a class="code hl_class" href="classTensor.html">m</a>);</div>
<div class="line"><span class="lineno"> 3208</span>        <a class="code hl_class" href="classTensor.html">std::for_each</a>(<a class="code hl_class" href="classTensor.html">std::execution::par</a>, <a class="code hl_class" href="classTensor.html">row_range</a>.begin(), <a class="code hl_class" href="classTensor.html">row_range</a>.end(), </div>
<div class="line"><span class="lineno"> 3209</span>                      [&amp;](<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3210</span>            for (size_t j = 0; j &lt; p; ++j) {</div>
<div class="line"><span class="lineno"> 3211</span>                T sum = T();</div>
<div class="line"><span class="lineno"> 3212</span>                for (size_t k = 0; k &lt; n; ++k) {</div>
<div class="line"><span class="lineno"> 3213</span>                    sum += (*this)[{i, k}] * other[{k, j}];</div>
<div class="line"><span class="lineno"> 3214</span>                }</div>
<div class="line"><span class="lineno"> 3215</span>                result[{i, j}] = sum;</div>
<div class="line"><span class="lineno"> 3216</span>            }</div>
<div class="line"><span class="lineno"> 3217</span>        });</div>
<div class="line"><span class="lineno"> 3218</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3219</span>    }</div>
<div class="ttc" id="aclassTensor_html_a234f74cd16bd13561f7963ba29efb163"><div class="ttname"><a href="#a234f74cd16bd13561f7963ba29efb163">Tensor::fill</a></div><div class="ttdeci">void fill(const T &amp;value)</div><div class="ttdoc">Fill the tensor with a specified value.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00636">tensor.h:636</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae29eec9ab673b7d33a191f9e18b57f6b" name="ae29eec9ab673b7d33a191f9e18b57f6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae29eec9ab673b7d33a191f9e18b57f6b">&#9670;&#160;</a></span>dot() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, size_t P&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if&lt;(M &gt;=3), <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N+P-2 &gt; &gt; &gt;::type <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::dot </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, P &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Generalized dot product for N-D tensors (N &gt;= 3). Performs tensor contraction over the last axis of this tensor and the first axis of the other tensor. For tensors A with shape (..., k) and B with shape (k, ...), the result has shape (...A[:-1], ...B[1:]). Uses GPU acceleration if available, otherwise uses parallel CPU execution.</p>
<p>Example: A(2,3,4)  B(4,5,6) = C(2,3,5,6)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The other N-D tensor to contract with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing either a new tensor with the result or an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03236">3236</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3236</span>                                         {</div>
<div class="line"><span class="lineno"> 3237</span>        <span class="keyword">static_assert</span>(<a class="code hl_class" href="classTensor.html">N</a> &gt;= 3 || <a class="code hl_class" href="classTensor.html">P</a> &gt;= 1, <span class="stringliteral">&quot;This dot product is for higher dimensional tensors&quot;</span>);</div>
<div class="line"><span class="lineno"> 3238</span>        </div>
<div class="line"><span class="lineno"> 3239</span>        <span class="comment">// Check that the last dimension of this matches first dimension of other</span></div>
<div class="line"><span class="lineno"> 3240</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">N</a> - 1] != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0]) {</div>
<div class="line"><span class="lineno"> 3241</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::ContractionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3242</span>        }</div>
<div class="line"><span class="lineno"> 3243</span>        </div>
<div class="line"><span class="lineno"> 3244</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">contract_dim</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">N</a> - 1];</div>
<div class="line"><span class="lineno"> 3245</span>        </div>
<div class="line"><span class="lineno"> 3246</span>        <span class="comment">// Calculate output dimensions: all dims of this except last,</span></div>
<div class="line"><span class="lineno"> 3247</span>        <span class="comment">// plus all dims of other except first</span></div>
<div class="line"><span class="lineno"> 3248</span>        <a class="code hl_class" href="classTensor.html">TensorIndices</a>&lt;<a class="code hl_class" href="classTensor.html">N</a> + <a class="code hl_class" href="classTensor.html">P</a> - 2&gt; <a class="code hl_class" href="classTensor.html">result_dims</a>;</div>
<div class="line"><span class="lineno"> 3249</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a> - 1; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3250</span>            <a class="code hl_class" href="classTensor.html">result_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3251</span>        }</div>
<div class="line"><span class="lineno"> 3252</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">P</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3253</span>            <a class="code hl_class" href="classTensor.html">result_dims</a>[<a class="code hl_class" href="classTensor.html">N</a> - 1 + <a class="code hl_class" href="classTensor.html">i</a> - 1] = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3254</span>        }</div>
<div class="line"><span class="lineno"> 3255</span>        </div>
<div class="line"><span class="lineno"> 3256</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor</a>&lt;<a class="code hl_class" href="classTensor.html">T</a>, <a class="code hl_class" href="classTensor.html">N</a> + <a class="code hl_class" href="classTensor.html">P</a> - 2&gt; <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">result_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3257</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>());</div>
<div class="line"><span class="lineno"> 3258</span>        </div>
<div class="line"><span class="lineno"> 3259</span>        <span class="comment">// Calculate strides for output indexing</span></div>
<div class="line"><span class="lineno"> 3260</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer_size</a> = 1;  <span class="comment">// Product of all dims except last in this tensor</span></div>
<div class="line"><span class="lineno"> 3261</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a> - 1; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3262</span>            <a class="code hl_class" href="classTensor.html">outer_size</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3263</span>        }</div>
<div class="line"><span class="lineno"> 3264</span>        </div>
<div class="line"><span class="lineno"> 3265</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner_size</a> = 1;  <span class="comment">// Product of all dims except first in other tensor</span></div>
<div class="line"><span class="lineno"> 3266</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">P</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3267</span>            <a class="code hl_class" href="classTensor.html">inner_size</a> *= <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3268</span>        }</div>
<div class="line"><span class="lineno"> 3269</span>        </div>
<div class="line"><span class="lineno"> 3270</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 3271</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 3272</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::dot_nd_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(),</div>
<div class="line"><span class="lineno"> 3273</span>                                  <a class="code hl_class" href="classTensor.html">outer_size</a>, <a class="code hl_class" href="classTensor.html">contract_dim</a>, <a class="code hl_class" href="classTensor.html">inner_size</a>);</div>
<div class="line"><span class="lineno"> 3274</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3275</span>        }</div>
<div class="line"><span class="lineno"> 3276</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3277</span>        </div>
<div class="line"><span class="lineno"> 3278</span>        <span class="comment">// Perform contraction with parallel execution</span></div>
<div class="line"><span class="lineno"> 3279</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">outer_range</a> = <a class="code hl_class" href="classTensor.html">std::views::iota</a>(<span class="keywordtype">size_t</span>(0), <a class="code hl_class" href="classTensor.html">outer_size</a>);</div>
<div class="line"><span class="lineno"> 3280</span>        <a class="code hl_class" href="classTensor.html">std::for_each</a>(<a class="code hl_class" href="classTensor.html">std::execution::par</a>, <a class="code hl_class" href="classTensor.html">outer_range</a>.begin(), <a class="code hl_class" href="classTensor.html">outer_range</a>.end(), </div>
<div class="line"><span class="lineno"> 3281</span>            [&amp;](<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a>) {</div>
<div class="line"><span class="lineno"> 3282</span>                for (size_t inner = 0; inner &lt; inner_size; ++inner) {</div>
<div class="line"><span class="lineno"> 3283</span>                    T sum = T();</div>
<div class="line"><span class="lineno"> 3284</span>                    for (size_t k = 0; k &lt; contract_dim; ++k) {</div>
<div class="line"><span class="lineno"> 3285</span>                        <span class="comment">// Calculate flat indices for input tensors</span></div>
<div class="line"><span class="lineno"> 3286</span>                        size_t idx_this = outer * contract_dim + k;</div>
<div class="line"><span class="lineno"> 3287</span>                        size_t idx_other = k * inner_size + inner;</div>
<div class="line"><span class="lineno"> 3288</span>                        sum += data_[idx_this] * other.data_[idx_other];</div>
<div class="line"><span class="lineno"> 3289</span>                    }</div>
<div class="line"><span class="lineno"> 3290</span>                    <span class="comment">// Calculate flat index for output tensor</span></div>
<div class="line"><span class="lineno"> 3291</span>                    size_t idx_result = outer * inner_size + inner;</div>
<div class="line"><span class="lineno"> 3292</span>                    result.data_[idx_result] = sum;</div>
<div class="line"><span class="lineno"> 3293</span>                }</div>
<div class="line"><span class="lineno"> 3294</span>            });</div>
<div class="line"><span class="lineno"> 3295</span>        </div>
<div class="line"><span class="lineno"> 3296</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3297</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a452fb091d4b50605c931485385d29aac" name="a452fb091d4b50605c931485385d29aac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a452fb091d4b50605c931485385d29aac">&#9670;&#160;</a></span>eq()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::eq </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>epsilon</em></span><span class="paramdefsep"> = </span><span class="paramdefval">std::numeric_limits&lt;T&gt;::epsilon()</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise equality comparison. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to compare with. </td></tr>
    <tr><td class="paramname">epsilon</td><td>Tolerance for floating-point comparison. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02710">2710</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2710</span>                                                                                                {</div>
<div class="line"><span class="lineno"> 2711</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 2712</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2713</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 2714</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2715</span>        }</div>
<div class="line"><span class="lineno"> 2716</span>        </div>
<div class="line"><span class="lineno"> 2717</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2718</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2719</span>        </div>
<div class="line"><span class="lineno"> 2720</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2721</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_class" href="classTensor.html">std::abs</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] - <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]) &lt; <a class="code hl_class" href="classTensor.html">epsilon</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2722</span>        }</div>
<div class="line"><span class="lineno"> 2723</span>        </div>
<div class="line"><span class="lineno"> 2724</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2725</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afa7d4923af4f40166ac5dec4a893b74e" name="afa7d4923af4f40166ac5dec4a893b74e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa7d4923af4f40166ac5dec4a893b74e">&#9670;&#160;</a></span>erf()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::erf </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply error function (erf) to all elements (creates new tensor). The error function is used in probability and statistics. </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with erf(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01951">1951</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1951</span>                             {</div>
<div class="line"><span class="lineno"> 1952</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::erf</a>(<a class="code hl_class" href="classTensor.html">x</a>); });</div>
<div class="line"><span class="lineno"> 1953</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae94340cb4134b887428082dc683fe2b2" name="ae94340cb4134b887428082dc683fe2b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae94340cb4134b887428082dc683fe2b2">&#9670;&#160;</a></span>exp()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::exp </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply exponential function to all elements (creates new tensor). </p>
<p>Computes e^x for each element. Uses GPU acceleration when available. Supports automatic differentiation.</p>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with exp(x) applied to all elements</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_exp"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> matrix({2, 2});</div>
<div class="line">matrix.fill(1.0f);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> result = matrix.exp();  <span class="comment">// All elements  2.718</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// With autograd:</span></div>
<div class="line"><a class="code hl_class" href="classTensor.html">Tensor&lt;float, 1&gt;</a> x({3}, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line">x.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(0.0f);</div>
<div class="line"><span class="keyword">auto</span> y = x.exp().sum();  <span class="comment">// sum(exp(x))</span></div>
<div class="line">y.backward();</div>
<div class="line"><span class="comment">// x.grad() contains derivatives</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01512">1512</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1512</span>                             {</div>
<div class="line"><span class="lineno"> 1513</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1514</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1515</span>        </div>
<div class="line"><span class="lineno"> 1516</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1517</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1518</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::exp_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1519</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1520</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1521</span>        {</div>
<div class="line"><span class="lineno"> 1522</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1523</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::exp</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 1524</span>            }</div>
<div class="line"><span class="lineno"> 1525</span>        }</div>
<div class="line"><span class="lineno"> 1526</span>        </div>
<div class="line"><span class="lineno"> 1527</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1528</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_ae94340cb4134b887428082dc683fe2b2_icgraph.png" border="0" usemap="#aclassTensor_ae94340cb4134b887428082dc683fe2b2_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_ae94340cb4134b887428082dc683fe2b2_icgraph" id="aclassTensor_ae94340cb4134b887428082dc683fe2b2_icgraph">
<area shape="rect" title="Apply exponential function to all elements (creates new tensor)." alt="" coords="188,13,277,40"/>
<area shape="rect" href="classTensor.html#aadc56fba91e522ff5de95202106be9db" title=" " alt="" coords="5,5,140,48"/>
<area shape="poly" title=" " alt="" coords="172,29,140,29,140,24,172,24"/>
</map>
</div>

</div>
</div>
<a id="aadc56fba91e522ff5de95202106be9db" name="aadc56fba91e522ff5de95202106be9db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadc56fba91e522ff5de95202106be9db">&#9670;&#160;</a></span>exp_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::exp_derivative </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of exponential function. d/dx[exp(x)] = exp(x) </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with exp derivative (same as exp). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02112">2112</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2112</span>                                        {</div>
<div class="line"><span class="lineno"> 2113</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#ae94340cb4134b887428082dc683fe2b2">exp</a>();</div>
<div class="line"><span class="lineno"> 2114</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab64cb0dcc82a371720c3bfc7f2265ece" name="ab64cb0dcc82a371720c3bfc7f2265ece"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab64cb0dcc82a371720c3bfc7f2265ece">&#9670;&#160;</a></span>expm1()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::expm1 </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply expm1 function to all elements (creates new tensor). Computes exp(x) - 1 in a numerically stable way for small x. </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with expm1(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01969">1969</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1969</span>                               {</div>
<div class="line"><span class="lineno"> 1970</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::expm1</a>(<a class="code hl_class" href="classTensor.html">x</a>); });</div>
<div class="line"><span class="lineno"> 1971</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a234f74cd16bd13561f7963ba29efb163" name="a234f74cd16bd13561f7963ba29efb163"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a234f74cd16bd13561f7963ba29efb163">&#9670;&#160;</a></span>fill()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::fill </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>value</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fill the tensor with a specified value. </p>
<p>Sets all elements in the tensor to the same value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>The value to fill the tensor with</td></tr>
  </table>
  </dd>
</dl>
<h1 class="doxsection"><a class="anchor" id="example_fill"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> matrix({3, 3});</div>
<div class="line">matrix.fill(5.0f);  <span class="comment">// All elements are now 5.0</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00636">636</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  636</span>                              {</div>
<div class="line"><span class="lineno">  637</span>        <a class="code hl_class" href="classTensor.html">std::fill</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>(), <a class="code hl_class" href="classTensor.html">value</a>);</div>
<div class="line"><span class="lineno">  638</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a234f74cd16bd13561f7963ba29efb163_icgraph.png" border="0" usemap="#aclassTensor_a234f74cd16bd13561f7963ba29efb163_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a234f74cd16bd13561f7963ba29efb163_icgraph" id="aclassTensor_a234f74cd16bd13561f7963ba29efb163_icgraph">
<area shape="rect" title="Fill the tensor with a specified value." alt="" coords="643,537,725,564"/>
<area shape="rect" href="namespacelinalg.html#a1df90002eef905350589edef7a4ace1b" title=" " alt="" coords="464,5,547,32"/>
<area shape="poly" title=" " alt="" coords="679,522,673,417,658,274,647,202,633,136,615,82,593,46,572,31,547,23,548,18,574,26,597,42,620,80,638,135,652,201,664,273,678,417,684,522"/>
<area shape="rect" href="tensor_8h.html#ae66ddfcd20907014f524982e01698d82" title="Create a diagonal matrix from a 1D tensor." alt="" coords="461,56,549,83"/>
<area shape="poly" title=" " alt="" coords="678,522,671,427,655,299,644,235,630,176,613,129,593,96,573,82,549,75,551,70,576,78,597,93,618,126,635,175,649,234,660,298,676,426,684,522"/>
<area shape="rect" href="classTensor.html#a452fb091d4b50605c931485385d29aac" title=" " alt="" coords="442,107,569,133"/>
<area shape="poly" title=" " alt="" coords="678,522,668,436,652,324,627,217,611,175,593,147,568,131,571,126,597,143,616,173,632,215,657,323,674,436,683,522"/>
<area shape="rect" href="tensor_8h.html#a8a0e6e335b72a473208ce2c8f17b4a6e" title="Create an identity matrix (NumPy eye&#45;compatible)." alt="" coords="484,157,526,184"/>
<area shape="poly" title=" " alt="" coords="677,523,666,446,648,349,624,257,609,222,593,198,579,187,561,180,526,173,527,168,563,174,581,182,597,194,614,219,629,255,654,348,671,446,682,522"/>
<area shape="rect" href="namespacelinalg.html#a6ee776536e47c3e57b3b24ed6225bff2" title=" " alt="" coords="454,208,556,235"/>
<area shape="poly" title=" " alt="" coords="680,522,677,465,665,391,654,352,639,315,619,279,594,249,576,236,556,229,558,224,579,232,597,245,623,276,644,312,659,351,670,390,682,464,686,522"/>
<area shape="rect" href="tensor__c_8cpp.html#a47d70db99aa0a5e3874682316e4e173e" title=" " alt="" coords="436,259,574,285"/>
<area shape="poly" title=" " alt="" coords="678,522,672,474,658,414,633,352,615,324,594,299,573,286,576,281,597,295,619,321,638,350,663,412,678,473,684,521"/>
<area shape="rect" href="tensor__c_8cpp.html#a83628a7a4557aa438413f22c5b0cf244" title=" " alt="" coords="434,309,576,336"/>
<area shape="poly" title=" " alt="" coords="676,523,667,484,651,437,627,390,594,350,575,338,578,334,597,346,632,387,656,435,672,482,681,522"/>
<area shape="rect" href="tensor__c_8cpp.html#a1a72f081df9afd553ef6af18324322b6" title=" " alt="" coords="443,360,567,387"/>
<area shape="poly" title=" " alt="" coords="671,524,643,461,621,428,594,401,567,386,569,382,597,397,625,425,648,459,676,522"/>
<area shape="rect" href="tensor__c_8cpp.html#a6b1e7f8c3cd8c831827661bdf87c9bfa" title=" " alt="" coords="441,411,569,437"/>
<area shape="poly" title=" " alt="" coords="665,526,635,487,615,468,594,452,569,439,571,435,597,447,619,464,639,484,669,523"/>
<area shape="rect" href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7" title="Mean Squared Error (MSE) Loss." alt="" coords="450,461,560,488"/>
<area shape="poly" title=" " alt="" coords="648,531,594,502,559,490,561,485,596,498,651,526"/>
<area shape="rect" href="classTensor.html#aab0bca33fa0dbe68308c0a828cec9f44" title=" " alt="" coords="442,512,569,539"/>
<area shape="poly" title=" " alt="" coords="627,545,569,537,570,532,628,540"/>
<area shape="rect" href="tensor_8h.html#a37ee39b629ca93dc83259b6c8591d0d9" title="Create a tensor filled with ones (NumPy&#45;compatible)." alt="" coords="480,563,530,589"/>
<area shape="poly" title=" " alt="" coords="628,561,530,575,530,570,627,556"/>
<area shape="rect" href="classTensor.html#a26deab87b696076f055af17f4386b4d0" title=" " alt="" coords="421,613,589,640"/>
<area shape="poly" title=" " alt="" coords="651,575,596,604,564,615,562,610,594,599,648,570"/>
<area shape="rect" href="classTensor.html#a2cab1fc8ca70e8d2fa4bce5ff88fabe1" title=" " alt="" coords="417,664,593,691"/>
<area shape="poly" title=" " alt="" coords="669,578,639,617,619,637,597,654,573,666,571,661,594,650,615,633,635,614,665,575"/>
<area shape="rect" href="classTensor.html#a06eeff8ce7f54262b935b324bcb6833e" title=" " alt="" coords="415,715,595,741"/>
<area shape="poly" title=" " alt="" coords="676,580,648,643,625,676,597,705,577,717,574,712,594,701,621,673,643,640,671,578"/>
<area shape="rect" href="classTensor.html#ac20a4679e14de6f68e148b447496adfc" title=" " alt="" coords="420,765,590,792"/>
<area shape="poly" title=" " alt="" coords="681,580,672,619,656,666,632,714,597,755,579,767,576,762,594,751,627,711,651,664,667,618,676,578"/>
<area shape="rect" href="classTensor.html#ac15f7a77f31ef7862dd9909c9ad97160" title=" " alt="" coords="420,816,590,843"/>
<area shape="poly" title=" " alt="" coords="684,580,678,629,663,689,638,752,619,781,597,806,580,818,577,813,594,802,615,777,633,749,658,688,672,628,678,579"/>
<area shape="rect" href="tensor__c_8cpp.html#a6c7566970a435f965c674f01e5bdba09" title=" " alt="" coords="436,867,574,893"/>
<area shape="poly" title=" " alt="" coords="686,580,682,637,670,711,659,751,644,789,623,825,597,857,576,871,573,867,594,853,619,822,639,787,654,749,665,710,677,637,680,579"/>
<area shape="rect" href="tensor__c_8cpp.html#a87b984c2cf077d9da06fe364caddd4da" title=" " alt="" coords="434,917,576,944"/>
<area shape="poly" title=" " alt="" coords="682,579,671,656,654,753,629,846,614,882,597,907,578,921,575,917,593,903,609,880,624,844,648,752,666,655,677,579"/>
<area shape="rect" href="tensor__c_8cpp.html#ad2106718d1bf483b3daeefd07f1961f2" title=" " alt="" coords="443,968,567,995"/>
<area shape="poly" title=" " alt="" coords="683,580,674,666,657,779,632,886,616,929,597,958,584,968,569,976,567,971,581,964,593,954,611,926,627,885,652,778,668,665,678,579"/>
<area shape="rect" href="tensor__c_8cpp.html#a7a2d55aad07eba8741646b6c305c4352" title=" " alt="" coords="441,1019,569,1045"/>
<area shape="poly" title=" " alt="" coords="684,579,676,675,660,803,649,868,635,927,618,975,597,1009,571,1026,568,1021,593,1005,613,973,630,925,644,867,655,802,671,675,678,579"/>
<area shape="rect" href="tensor_8h.html#a249e6ed21f6e3540a11b62433237175a" title="Create a tensor filled with zeros (NumPy&#45;compatible)." alt="" coords="478,1069,532,1096"/>
<area shape="poly" title=" " alt="" coords="684,579,678,685,664,828,652,900,638,967,620,1021,597,1059,583,1071,566,1078,533,1085,532,1080,565,1073,580,1066,593,1056,615,1019,633,965,647,899,658,827,673,684,679,579"/>
<area shape="rect" href="namespacelinalg.html#a6b7af062b5a9642d788fcc084335b39c" title=" " alt="" coords="209,157,349,184"/>
<area shape="poly" title=" " alt="" coords="438,209,341,187,342,182,439,204"/>
<area shape="rect" href="namespacelinalg.html#a8405b084d692b1fc7f685f40425a0970" title="Solve least squares problem: minimize ||Ax &#45; b||" alt="" coords="235,208,322,235"/>
<area shape="poly" title=" " alt="" coords="439,224,323,224,323,219,439,219"/>
<area shape="rect" href="namespacelinalg.html#a6ff4392ae10b75895ce02443bf3c77d6" title="Compute Moore&#45;Penrose pseudo&#45;inverse using SVD." alt="" coords="237,259,320,285"/>
<area shape="poly" title=" " alt="" coords="440,239,321,265,320,260,438,233"/>
<area shape="rect" href="tensor__c_8cpp.html#ac4676f00843bcb11305f402265e7b747" title=" " alt="" coords="5,157,143,184"/>
<area shape="poly" title=" " alt="" coords="219,209,130,187,131,182,220,204"/>
<area shape="rect" href="tensor__c_8cpp.html#ab0ed3244c40a7734ca7af5affd241c6d" title=" " alt="" coords="12,208,136,235"/>
<area shape="poly" title=" " alt="" coords="220,224,137,224,137,219,220,219"/>
<area shape="rect" href="tensor__c_8cpp.html#ad0eab2342bda5d725085476abc7c50b6" title=" " alt="" coords="7,259,141,285"/>
<area shape="poly" title=" " alt="" coords="221,275,141,275,141,269,221,269"/>
<area shape="rect" href="tensor__c_8cpp.html#acf74b6d7b42a82859c1fbec640125775" title=" " alt="" coords="14,309,134,336"/>
<area shape="poly" title=" " alt="" coords="223,288,132,311,130,306,221,283"/>
<area shape="rect" href="classTensor.html#adf1fcb0ddd0ef2db3003401db519ec1c" title=" " alt="" coords="191,740,367,767"/>
<area shape="poly" title=" " alt="" coords="405,770,367,766,368,761,405,765"/>
<area shape="rect" href="classTensor.html#aeb3f6a9bf8ee28d46a887238a9d3d460" title=" " alt="" coords="191,791,367,817"/>
<area shape="poly" title=" " alt="" coords="405,793,368,797,367,791,405,787"/>
</map>
</div>

</div>
</div>
<a id="a5a354f1c9709ae8089a859608564fc4f" name="a5a354f1c9709ae8089a859608564fc4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a354f1c9709ae8089a859608564fc4f">&#9670;&#160;</a></span>flatten()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::flatten </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Flatten tensor to 1D. </p><dl class="section return"><dt>Returns</dt><dd>A 1D tensor containing all elements in row-major order</dd></dl>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> A({3, 4});</div>
<div class="line"><span class="keyword">auto</span> B = A.flatten();  <span class="comment">// Tensor&lt;float, 1&gt; with 12 elements</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04952">4952</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4952</span>                                 {</div>
<div class="line"><span class="lineno"> 4953</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4954</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 1&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>({<a class="code hl_class" href="classTensor.html">total</a>}, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4955</span>        <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_class" href="classTensor.html">total</a>, <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno"> 4956</span>        </div>
<div class="line"><span class="lineno"> 4957</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4958</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6047a6a731e93d59e92073e997969cc7" name="a6047a6a731e93d59e92073e997969cc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6047a6a731e93d59e92073e997969cc7">&#9670;&#160;</a></span>floor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::floor </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply floor function to all elements (creates new tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with floor(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01910">1910</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1910</span>                               {</div>
<div class="line"><span class="lineno"> 1911</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::floor</a>(<a class="code hl_class" href="classTensor.html">x</a>); });</div>
<div class="line"><span class="lineno"> 1912</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c0ac5752345f4abb81ebe4fa78411fd" name="a8c0ac5752345f4abb81ebe4fa78411fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c0ac5752345f4abb81ebe4fa78411fd">&#9670;&#160;</a></span>grad() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; * <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::grad </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the gradient tensor. </p><dl class="section return"><dt>Returns</dt><dd>Pointer to gradient tensor (nullptr if not tracking gradients). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00740">740</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  740</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>.get(); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae20c5c5722bd41013f11b326f9e50b2f" name="ae20c5c5722bd41013f11b326f9e50b2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae20c5c5722bd41013f11b326f9e50b2f">&#9670;&#160;</a></span>grad() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; * <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::grad </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00741">741</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  741</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>.get(); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a89cf45ee5d7ddfdf69a387c2345039c7" name="a89cf45ee5d7ddfdf69a387c2345039c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89cf45ee5d7ddfdf69a387c2345039c7">&#9670;&#160;</a></span>head()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 1&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::head </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract first n elements (only for 1D tensors). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of elements to extract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1D tensor containing first n elements </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05083">5083</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5083</span>                                      {</div>
<div class="line"><span class="lineno"> 5084</span>        <a class="code hl_class" href="classTensor.html">return ::head</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 1&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)), <a class="code hl_class" href="classTensor.html">n</a>);</div>
<div class="line"><span class="lineno"> 5085</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aed3511f1720813839550315f701cb516" name="aed3511f1720813839550315f701cb516"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed3511f1720813839550315f701cb516">&#9670;&#160;</a></span>hstack()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::hstack </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensors</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Horizontal stack (stack along second dimension) - convenience method for 2D tensors. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tensors</td><td><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b" title="Type alias for 1D vectors.">Vector</a> of tensors to stack horizontally. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor stacked horizontally. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03013">3013</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3013</span>                                                                       {</div>
<div class="line"><span class="lineno"> 3014</span>        <span class="keyword">static_assert</span>(<a class="code hl_class" href="classTensor.html">N</a> &gt;= 2, <span class="stringliteral">&quot;hstack requires at least 2D tensors&quot;</span>);</div>
<div class="line"><span class="lineno"> 3015</span>        </div>
<div class="line"><span class="lineno"> 3016</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">tensors</a>.empty()) {</div>
<div class="line"><span class="lineno"> 3017</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 3018</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3019</span>        }</div>
<div class="line"><span class="lineno"> 3020</span>        </div>
<div class="line"><span class="lineno"> 3021</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">tensors</a>.size() == 1) {</div>
<div class="line"><span class="lineno"> 3022</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">tensors</a>[0]);</div>
<div class="line"><span class="lineno"> 3023</span>        }</div>
<div class="line"><span class="lineno"> 3024</span>        </div>
<div class="line"><span class="lineno"> 3025</span>        <span class="comment">// Start with first tensor and concatenate the rest</span></div>
<div class="line"><span class="lineno"> 3026</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">tensors</a>[0]);</div>
<div class="line"><span class="lineno"> 3027</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">tensors</a>.size(); ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3028</span>            <a class="code hl_class" href="classTensor.html">result</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a7a0af0b59b00d2f2623609ff3562f087">concatenate</a>(<a class="code hl_class" href="classTensor.html">tensors</a>[<a class="code hl_class" href="classTensor.html">i</a>], 1);</div>
<div class="line"><span class="lineno"> 3029</span>        }</div>
<div class="line"><span class="lineno"> 3030</span>        </div>
<div class="line"><span class="lineno"> 3031</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3032</span>    }</div>
<div class="ttc" id="aclassTensor_html_a7a0af0b59b00d2f2623609ff3562f087"><div class="ttname"><a href="#a7a0af0b59b00d2f2623609ff3562f087">Tensor::concatenate</a></div><div class="ttdeci">Tensor&lt; T, N &gt; concatenate(const Tensor&lt; T, N &gt; &amp;other, size_t axis) const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l04275">tensor.h:4275</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3090598433576f68f34f340cd6a18089" name="a3090598433576f68f34f340cd6a18089"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3090598433576f68f34f340cd6a18089">&#9670;&#160;</a></span>index_select()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::index_select </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mask</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Boolean indexing: extract elements where mask is true (non-zero). This is similar to masked_select but emphasized for indexing operations. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mask</td><td>Boolean-like tensor (0 or non-zero values). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A 1D tensor containing selected values. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04441">4441</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4441</span>                                                              {</div>
<div class="line"><span class="lineno"> 4442</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a4773678cdfb3526a2bdb1079ef68b87e">masked_select</a>(<a class="code hl_class" href="classTensor.html">mask</a>);</div>
<div class="line"><span class="lineno"> 4443</span>    }</div>
<div class="ttc" id="aclassTensor_html_a4773678cdfb3526a2bdb1079ef68b87e"><div class="ttname"><a href="#a4773678cdfb3526a2bdb1079ef68b87e">Tensor::masked_select</a></div><div class="ttdeci">Tensor&lt; T, 1 &gt; masked_select(const Tensor&lt; M, N &gt; &amp;mask) const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l02827">tensor.h:2827</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aae15047e75bb7e0734b82eceea1cd009" name="aae15047e75bb7e0734b82eceea1cd009"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae15047e75bb7e0734b82eceea1cd009">&#9670;&#160;</a></span>is_leaf()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::is_leaf </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if this is a leaf tensor. </p><dl class="section return"><dt>Returns</dt><dd>True if this is a leaf tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00734">734</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  734</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5aac0c5222fc09da3327d08ee2c3a2ed" name="a5aac0c5222fc09da3327d08ee2c3a2ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5aac0c5222fc09da3327d08ee2c3a2ed">&#9670;&#160;</a></span>isfinite()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::isfinite </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if elements are finite (creates boolean-like tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with 1 where finite, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01993">1993</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1993</span>                                  {</div>
<div class="line"><span class="lineno"> 1994</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::isfinite</a>(<a class="code hl_class" href="classTensor.html">x</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0); });</div>
<div class="line"><span class="lineno"> 1995</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac56c689ad6c5077e9cb9792a552a8d38" name="ac56c689ad6c5077e9cb9792a552a8d38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac56c689ad6c5077e9cb9792a552a8d38">&#9670;&#160;</a></span>isinf()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::isinf </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if elements are infinite (creates boolean-like tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with 1 where infinite, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01985">1985</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1985</span>                               {</div>
<div class="line"><span class="lineno"> 1986</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::isinf</a>(<a class="code hl_class" href="classTensor.html">x</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0); });</div>
<div class="line"><span class="lineno"> 1987</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a703855e2cfaff43769ef254a3dbce50c" name="a703855e2cfaff43769ef254a3dbce50c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a703855e2cfaff43769ef254a3dbce50c">&#9670;&#160;</a></span>isnan()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::isnan </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if elements are NaN (creates boolean-like tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with 1 where NaN, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01977">1977</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1977</span>                               {</div>
<div class="line"><span class="lineno"> 1978</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::isnan</a>(<a class="code hl_class" href="classTensor.html">x</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0); });</div>
<div class="line"><span class="lineno"> 1979</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa33851e29d0df735e3fab0002a119602" name="aa33851e29d0df735e3fab0002a119602"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa33851e29d0df735e3fab0002a119602">&#9670;&#160;</a></span>leaky_relu_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::leaky_relu_derivative </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>alpha</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(0.01)</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of Leaky ReLU function. d/dx[LeakyReLU(x)] = 1 if x &gt; 0, else alpha </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alpha</td><td>The slope for negative values (default 0.01). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with Leaky ReLU derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02103">2103</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2103</span>                                                                {</div>
<div class="line"><span class="lineno"> 2104</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([<a class="code hl_class" href="classTensor.html">alpha</a>](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">x</a> &gt; <a class="code hl_class" href="classTensor.html">T</a>(0) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">alpha</a>; });</div>
<div class="line"><span class="lineno"> 2105</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aff781405a45c8ec01fde149ecba560b6" name="aff781405a45c8ec01fde149ecba560b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff781405a45c8ec01fde149ecba560b6">&#9670;&#160;</a></span>leftCols()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::leftCols </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract leftmost n columns (only for 2D tensors). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of columns to extract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>2D tensor containing leftmost n columns </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05123">5123</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5123</span>                                          {</div>
<div class="line"><span class="lineno"> 5124</span>        <a class="code hl_class" href="classTensor.html">return ::leftCols</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)), <a class="code hl_class" href="classTensor.html">n</a>);</div>
<div class="line"><span class="lineno"> 5125</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4ca468e14a70671e0258c613612bc506" name="a4ca468e14a70671e0258c613612bc506"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ca468e14a70671e0258c613612bc506">&#9670;&#160;</a></span>log()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::log </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply natural logarithm to all elements (creates new tensor). </p>
<p>Computes ln(x) for each element. Uses GPU acceleration when available.</p>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with log(x) applied to all elements </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Elements must be positive (log of non-positive values is undefined)</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_log"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> vec({4});</div>
<div class="line">vec.fill(2.718f);  <span class="comment">// e</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> result = vec.log();  <span class="comment">// All elements  1.0</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Useful for log-space computations</span></div>
<div class="line"><span class="keyword">auto</span> log_probs = probs.log();</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01549">1549</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1549</span>                             {</div>
<div class="line"><span class="lineno"> 1550</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1551</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1552</span>        </div>
<div class="line"><span class="lineno"> 1553</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1554</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1555</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::log_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1556</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1557</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1558</span>        {</div>
<div class="line"><span class="lineno"> 1559</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1560</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::log</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 1561</span>            }</div>
<div class="line"><span class="lineno"> 1562</span>        }</div>
<div class="line"><span class="lineno"> 1563</span>        </div>
<div class="line"><span class="lineno"> 1564</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1565</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7375a160ffb9b310d78c1f7f5a44c956" name="a7375a160ffb9b310d78c1f7f5a44c956"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7375a160ffb9b310d78c1f7f5a44c956">&#9670;&#160;</a></span>log1p()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::log1p </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply log1p function to all elements (creates new tensor). Computes log(1 + x) in a numerically stable way for small x. </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with log1p(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01960">1960</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1960</span>                               {</div>
<div class="line"><span class="lineno"> 1961</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::log1p</a>(<a class="code hl_class" href="classTensor.html">x</a>); });</div>
<div class="line"><span class="lineno"> 1962</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1c578c4b3e0f4a8d2fc16b67e84815b5" name="a1c578c4b3e0f4a8d2fc16b67e84815b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c578c4b3e0f4a8d2fc16b67e84815b5">&#9670;&#160;</a></span>log_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::log_derivative </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of natural logarithm. d/dx[log(x)] = 1/x </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with log derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02121">2121</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2121</span>                                        {</div>
<div class="line"><span class="lineno"> 2122</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">T</a>(1) / <a class="code hl_class" href="classTensor.html">x</a>; });</div>
<div class="line"><span class="lineno"> 2123</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a834720ab65874a6c5503f7670c4f22fe" name="a834720ab65874a6c5503f7670c4f22fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a834720ab65874a6c5503f7670c4f22fe">&#9670;&#160;</a></span>log_softmax()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::log_softmax </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>axis</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Log-softmax operation (numerically stable). log_softmax(x) = log(softmax(x)) = x - log(sum(exp(x))) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The axis to apply log-softmax along </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> with log-softmax applied </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03831">3831</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3831</span>                                                  {</div>
<div class="line"><span class="lineno"> 3832</span>        <span class="comment">// More numerically stable than log(softmax(x))</span></div>
<div class="line"><span class="lineno"> 3833</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &lt; 0) {</div>
<div class="line"><span class="lineno"> 3834</span>            <a class="code hl_class" href="classTensor.html">axis</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) + <a class="code hl_class" href="classTensor.html">axis</a>;</div>
<div class="line"><span class="lineno"> 3835</span>        }</div>
<div class="line"><span class="lineno"> 3836</span>        </div>
<div class="line"><span class="lineno"> 3837</span>        <span class="comment">// log_softmax(x) = x - max(x) - log(sum(exp(x - max(x))))</span></div>
<div class="line"><span class="lineno"> 3838</span>        <span class="comment">// This avoids computing softmax explicitly</span></div>
<div class="line"><span class="lineno"> 3839</span>        </div>
<div class="line"><span class="lineno"> 3840</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">ax</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">axis</a>);</div>
<div class="line"><span class="lineno"> 3841</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 3842</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3843</span>        </div>
<div class="line"><span class="lineno"> 3844</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 3845</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">ax</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3846</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3847</span>        }</div>
<div class="line"><span class="lineno"> 3848</span>        </div>
<div class="line"><span class="lineno"> 3849</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">softmax_dim</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">ax</a>];</div>
<div class="line"><span class="lineno"> 3850</span>        </div>
<div class="line"><span class="lineno"> 3851</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 3852</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">ax</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3853</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3854</span>        }</div>
<div class="line"><span class="lineno"> 3855</span>        </div>
<div class="line"><span class="lineno"> 3856</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 3857</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3858</span>                <span class="comment">// Find max</span></div>
<div class="line"><span class="lineno"> 3859</span>                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_class" href="classTensor.html">std::numeric_limits&lt;T&gt;::lowest</a>();</div>
<div class="line"><span class="lineno"> 3860</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">s</a> = 0; <a class="code hl_class" href="classTensor.html">s</a> &lt; <a class="code hl_class" href="classTensor.html">softmax_dim</a>; ++<a class="code hl_class" href="classTensor.html">s</a>) {</div>
<div class="line"><span class="lineno"> 3861</span>                    <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 3862</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">linear_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">softmax_dim</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">s</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 3863</span>                    </div>
<div class="line"><span class="lineno"> 3864</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">linear_idx</a>;</div>
<div class="line"><span class="lineno"> 3865</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 3866</span>                        <a class="code hl_class" href="classTensor.html">idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3867</span>                        <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3868</span>                    }</div>
<div class="line"><span class="lineno"> 3869</span>                    </div>
<div class="line"><span class="lineno"> 3870</span>                    <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_class" href="classTensor.html">std::max</a>(<a class="code hl_class" href="classTensor.html">max_val</a>, (*<span class="keyword">this</span>)[<a class="code hl_class" href="classTensor.html">idx</a>]);</div>
<div class="line"><span class="lineno"> 3871</span>                }</div>
<div class="line"><span class="lineno"> 3872</span>                </div>
<div class="line"><span class="lineno"> 3873</span>                <span class="comment">// Compute log(sum(exp(x - max)))</span></div>
<div class="line"><span class="lineno"> 3874</span>                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">log_sum_exp</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3875</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">s</a> = 0; <a class="code hl_class" href="classTensor.html">s</a> &lt; <a class="code hl_class" href="classTensor.html">softmax_dim</a>; ++<a class="code hl_class" href="classTensor.html">s</a>) {</div>
<div class="line"><span class="lineno"> 3876</span>                    <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 3877</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">linear_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">softmax_dim</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">s</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 3878</span>                    </div>
<div class="line"><span class="lineno"> 3879</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">linear_idx</a>;</div>
<div class="line"><span class="lineno"> 3880</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 3881</span>                        <a class="code hl_class" href="classTensor.html">idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3882</span>                        <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3883</span>                    }</div>
<div class="line"><span class="lineno"> 3884</span>                    </div>
<div class="line"><span class="lineno"> 3885</span>                    <a class="code hl_class" href="classTensor.html">log_sum_exp</a> += <a class="code hl_class" href="classTensor.html">std::exp</a>((*<span class="keyword">this</span>)[<a class="code hl_class" href="classTensor.html">idx</a>] - <a class="code hl_class" href="classTensor.html">max_val</a>);</div>
<div class="line"><span class="lineno"> 3886</span>                }</div>
<div class="line"><span class="lineno"> 3887</span>                <a class="code hl_class" href="classTensor.html">log_sum_exp</a> = <a class="code hl_class" href="classTensor.html">std::log</a>(<a class="code hl_class" href="classTensor.html">log_sum_exp</a>);</div>
<div class="line"><span class="lineno"> 3888</span>                </div>
<div class="line"><span class="lineno"> 3889</span>                <span class="comment">// Compute result: x - max - log_sum_exp</span></div>
<div class="line"><span class="lineno"> 3890</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">s</a> = 0; <a class="code hl_class" href="classTensor.html">s</a> &lt; <a class="code hl_class" href="classTensor.html">softmax_dim</a>; ++<a class="code hl_class" href="classTensor.html">s</a>) {</div>
<div class="line"><span class="lineno"> 3891</span>                    <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 3892</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">linear_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">softmax_dim</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">s</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 3893</span>                    </div>
<div class="line"><span class="lineno"> 3894</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">linear_idx</a>;</div>
<div class="line"><span class="lineno"> 3895</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 3896</span>                        <a class="code hl_class" href="classTensor.html">idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3897</span>                        <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3898</span>                    }</div>
<div class="line"><span class="lineno"> 3899</span>                    </div>
<div class="line"><span class="lineno"> 3900</span>                    <a class="code hl_class" href="classTensor.html">result</a>[<a class="code hl_class" href="classTensor.html">idx</a>] = (*this)[<a class="code hl_class" href="classTensor.html">idx</a>] - <a class="code hl_class" href="classTensor.html">max_val</a> - <a class="code hl_class" href="classTensor.html">log_sum_exp</a>;</div>
<div class="line"><span class="lineno"> 3901</span>                }</div>
<div class="line"><span class="lineno"> 3902</span>            }</div>
<div class="line"><span class="lineno"> 3903</span>        }</div>
<div class="line"><span class="lineno"> 3904</span>        </div>
<div class="line"><span class="lineno"> 3905</span>        <span class="comment">// Backward pass for log_softmax</span></div>
<div class="line"><span class="lineno"> 3906</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 3907</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">output_copy</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#ae5b52299c11f3ba81e781cb008542285">detach</a>();</div>
<div class="line"><span class="lineno"> 3908</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3909</span>            </div>
<div class="line"><span class="lineno"> 3910</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">output_copy</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 3911</span>                <span class="comment">// d/dx[log_softmax(x)] = 1 - softmax(x) for diagonal</span></div>
<div class="line"><span class="lineno"> 3912</span>                <span class="comment">// Gradient: grad_input = grad_output - softmax(x) * sum(grad_output)</span></div>
<div class="line"><span class="lineno"> 3913</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 3914</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 3915</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3916</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 3917</span>                    }</div>
<div class="line"><span class="lineno"> 3918</span>                    </div>
<div class="line"><span class="lineno"> 3919</span>                    <span class="comment">// Compute softmax from log_softmax</span></div>
<div class="line"><span class="lineno"> 3920</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3921</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3922</span>                        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">softmax_val</a> = <a class="code hl_class" href="classTensor.html">std::exp</a>(<a class="code hl_class" href="classTensor.html">output_copy</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 3923</span>                        </div>
<div class="line"><span class="lineno"> 3924</span>                        <span class="comment">// Compute sum of gradients (simplified for now)</span></div>
<div class="line"><span class="lineno"> 3925</span>                        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">grad_sum</a> = <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3926</span>                        </div>
<div class="line"><span class="lineno"> 3927</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>] - <a class="code hl_class" href="classTensor.html">softmax_val</a> * <a class="code hl_class" href="classTensor.html">grad_sum</a>;</div>
<div class="line"><span class="lineno"> 3928</span>                    }</div>
<div class="line"><span class="lineno"> 3929</span>                    </div>
<div class="line"><span class="lineno"> 3930</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 3931</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 3932</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 3933</span>                        }</div>
<div class="line"><span class="lineno"> 3934</span>                    }</div>
<div class="line"><span class="lineno"> 3935</span>                }</div>
<div class="line"><span class="lineno"> 3936</span>            });</div>
<div class="line"><span class="lineno"> 3937</span>        }</div>
<div class="line"><span class="lineno"> 3938</span>        </div>
<div class="line"><span class="lineno"> 3939</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3940</span>    }</div>
<div class="ttc" id="aclassTensor_html_ae5b52299c11f3ba81e781cb008542285"><div class="ttname"><a href="#ae5b52299c11f3ba81e781cb008542285">Tensor::detach</a></div><div class="ttdeci">Tensor&lt; T, N &gt; detach() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00822">tensor.h:822</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a834720ab65874a6c5503f7670c4f22fe_icgraph.png" border="0" usemap="#aclassTensor_a834720ab65874a6c5503f7670c4f22fe_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a834720ab65874a6c5503f7670c4f22fe_icgraph" id="aclassTensor_a834720ab65874a6c5503f7670c4f22fe_icgraph">
<area shape="rect" title=" " alt="" coords="220,5,359,32"/>
<area shape="rect" href="namespaceloss.html#a75edef9d102d2ab811b15c50f13c4eee" title="Cross entropy loss for multi&#45;class classification." alt="" coords="5,5,172,32"/>
<area shape="poly" title=" " alt="" coords="204,21,172,21,172,16,204,16"/>
</map>
</div>

</div>
</div>
<a id="a314dfaedc4f6b2dc8e3b44bbc5381eb3" name="a314dfaedc4f6b2dc8e3b44bbc5381eb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">&#9670;&#160;</a></span>map()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename Func&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::map </td>
          <td>(</td>
          <td class="paramtype">Func</td>          <td class="paramname"><span class="paramname"><em>func</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply a function to each element of the tensor (creates new tensor). </p>
<p>Maps a custom function over all elements, creating a new tensor with the results. The function should accept a single element of type T and return a value of type T.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Func</td><td>Function type (can be lambda, function pointer, or functor) </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">func</td><td>The function to apply to each element </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with the function applied to all elements</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_map"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> matrix({2, 3});</div>
<div class="line">matrix.fill(2.0f);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Square each element</span></div>
<div class="line"><span class="keyword">auto</span> squared = matrix.map([](<span class="keywordtype">float</span> x) { <span class="keywordflow">return</span> x * x; });</div>
<div class="line"><span class="comment">// squared contains all 4.0</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Apply custom function</span></div>
<div class="line"><span class="keyword">auto</span> result = matrix.map([](<span class="keywordtype">float</span> x) { <span class="keywordflow">return</span> std::sqrt(x) + 1.0f; });</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Can also use function pointers</span></div>
<div class="line"><span class="keyword">auto</span> exponential = matrix.map(std::exp&lt;float&gt;);</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01443">1443</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1443</span>                                      {</div>
<div class="line"><span class="lineno"> 1444</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1445</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1446</span>        </div>
<div class="line"><span class="lineno"> 1447</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1448</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">func</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 1449</span>        }</div>
<div class="line"><span class="lineno"> 1450</span>        </div>
<div class="line"><span class="lineno"> 1451</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1452</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a314dfaedc4f6b2dc8e3b44bbc5381eb3_icgraph.png" border="0" usemap="#aclassTensor_a314dfaedc4f6b2dc8e3b44bbc5381eb3_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a314dfaedc4f6b2dc8e3b44bbc5381eb3_icgraph" id="aclassTensor_a314dfaedc4f6b2dc8e3b44bbc5381eb3_icgraph">
<area shape="rect" title="Apply a function to each element of the tensor (creates new tensor)." alt="" coords="219,725,312,752"/>
<area shape="rect" href="classTensor.html#a694440b236a5cfb314e68adec066a9c6" title=" " alt="" coords="21,5,155,32"/>
<area shape="poly" title=" " alt="" coords="261,710,259,570,247,371,236,269,219,175,197,98,184,68,169,46,154,34,157,30,173,42,188,66,202,96,225,174,241,268,253,371,264,570,267,710"/>
<area shape="rect" href="classTensor.html#a62dff46109e314ef2d44683e3d4d581d" title=" " alt="" coords="21,56,155,83"/>
<area shape="poly" title=" " alt="" coords="261,710,257,579,244,396,233,301,216,215,195,145,183,117,169,96,154,84,157,80,173,93,187,115,200,143,222,214,238,301,250,395,263,579,266,710"/>
<area shape="rect" href="classTensor.html#a824a51062936324b316f066fdce66f77" title=" " alt="" coords="14,107,162,133"/>
<area shape="poly" title=" " alt="" coords="261,710,256,589,241,421,229,334,214,256,193,191,182,166,169,147,155,136,158,132,173,144,186,163,198,189,219,254,235,334,247,420,261,589,266,710"/>
<area shape="rect" href="classTensor.html#a1dafe6c812c9cd6d5f34a31ffdad59bb" title=" " alt="" coords="5,157,171,184"/>
<area shape="poly" title=" " alt="" coords="260,710,254,599,238,445,226,367,211,296,192,237,169,198,155,187,158,183,173,194,197,235,216,294,231,366,243,444,259,598,266,710"/>
<area shape="rect" href="classTensor.html#a5e477d9be3b8b907cbcc34efe73e31bc" title=" " alt="" coords="7,208,169,235"/>
<area shape="poly" title=" " alt="" coords="260,710,252,607,235,469,223,399,208,336,190,284,169,248,154,237,158,233,173,245,195,282,213,334,228,398,240,468,257,607,265,710"/>
<area shape="rect" href="classTensor.html#a0ee894165491bb19bf33d8282a166fde" title=" " alt="" coords="21,259,155,301"/>
<area shape="poly" title=" " alt="" coords="259,710,248,621,229,503,203,390,187,346,169,315,154,302,158,298,173,312,191,343,208,388,234,502,253,620,264,710"/>
<area shape="rect" href="classTensor.html#afa7d4923af4f40166ac5dec4a893b74e" title=" " alt="" coords="24,325,152,352"/>
<area shape="poly" title=" " alt="" coords="258,710,246,630,227,527,201,429,186,391,169,366,151,353,154,349,173,362,190,389,206,427,232,526,252,629,263,709"/>
<area shape="rect" href="classTensor.html#ab64cb0dcc82a371720c3bfc7f2265ece" title=" " alt="" coords="12,376,164,403"/>
<area shape="poly" title=" " alt="" coords="262,710,258,649,245,570,233,529,217,488,196,450,169,417,154,405,157,401,173,413,200,447,222,486,238,527,250,569,263,648,267,709"/>
<area shape="rect" href="classTensor.html#a6047a6a731e93d59e92073e997969cc7" title=" " alt="" coords="19,427,157,453"/>
<area shape="poly" title=" " alt="" coords="260,710,253,658,238,593,211,526,192,495,169,467,153,456,156,452,172,463,197,491,216,523,243,591,259,657,265,710"/>
<area shape="rect" href="classTensor.html#a5aac0c5222fc09da3327d08ee2c3a2ed" title=" " alt="" coords="12,477,164,504"/>
<area shape="poly" title=" " alt="" coords="257,711,248,668,231,616,206,563,189,539,169,518,152,507,155,502,172,514,193,536,210,561,236,614,253,667,263,710"/>
<area shape="rect" href="classTensor.html#ac56c689ad6c5077e9cb9792a552a8d38" title=" " alt="" coords="19,528,157,555"/>
<area shape="poly" title=" " alt="" coords="254,711,242,678,224,640,200,601,169,569,150,557,153,553,172,565,204,598,229,637,247,676,259,709"/>
<area shape="rect" href="classTensor.html#a703855e2cfaff43769ef254a3dbce50c" title=" " alt="" coords="16,579,160,605"/>
<area shape="poly" title=" " alt="" coords="248,713,215,665,194,640,169,620,148,608,150,604,172,615,198,637,220,662,252,710"/>
<area shape="rect" href="classTensor.html#aa33851e29d0df735e3fab0002a119602" title=" " alt="" coords="16,629,160,672"/>
<area shape="poly" title=" " alt="" coords="228,719,169,686,145,675,147,670,172,682,231,714"/>
<area shape="rect" href="classTensor.html#a7375a160ffb9b310d78c1f7f5a44c956" title=" " alt="" coords="16,696,160,723"/>
<area shape="poly" title=" " alt="" coords="203,731,160,724,161,719,204,726"/>
<area shape="rect" href="classTensor.html#a1c578c4b3e0f4a8d2fc16b67e84815b5" title=" " alt="" coords="23,747,153,789"/>
<area shape="poly" title=" " alt="" coords="204,752,154,760,153,755,203,746"/>
<area shape="rect" href="classTensor.html#acf750ad4eaebe934c9422566ccb63081" title=" " alt="" coords="19,813,157,856"/>
<area shape="poly" title=" " alt="" coords="235,763,172,804,148,815,146,810,169,799,232,759"/>
<area shape="rect" href="classTensor.html#a780523f1c499b857930f305b22aae9aa" title=" " alt="" coords="21,880,155,923"/>
<area shape="poly" title=" " alt="" coords="253,767,220,819,198,846,172,870,154,882,152,877,169,866,194,842,216,816,248,764"/>
<area shape="rect" href="classTensor.html#a2daa379012cbb23c00fe3ac60bde0122" title=" " alt="" coords="15,947,161,973"/>
<area shape="poly" title=" " alt="" coords="261,768,250,806,232,851,207,897,172,937,154,948,152,944,169,933,203,894,228,849,245,804,256,766"/>
<area shape="rect" href="classTensor.html#aa711e60597e988054c669e131ddce774" title=" " alt="" coords="9,997,167,1040"/>
<area shape="poly" title=" " alt="" coords="263,768,255,815,238,873,212,933,194,962,173,987,158,999,155,995,169,983,189,959,207,931,233,871,249,813,258,767"/>
<area shape="rect" href="classTensor.html#a369fb30e582324d1331132a5b29884b9" title=" " alt="" coords="9,1064,167,1107"/>
<area shape="poly" title=" " alt="" coords="266,768,261,826,247,902,235,942,219,982,198,1020,173,1054,159,1065,156,1061,169,1050,194,1017,214,980,230,941,242,901,256,826,261,767"/>
<area shape="rect" href="classTensor.html#a8effb9d585936f292d45c090fa06a96b" title=" " alt="" coords="19,1131,157,1157"/>
<area shape="poly" title=" " alt="" coords="263,768,252,849,233,954,206,1054,190,1093,173,1120,157,1132,154,1128,169,1117,186,1091,201,1052,228,953,247,848,258,767"/>
<area shape="rect" href="classTensor.html#ae0c783450c731955dab75dcb1e697319" title=" " alt="" coords="8,1181,168,1224"/>
<area shape="poly" title=" " alt="" coords="264,767,253,858,235,978,208,1093,192,1139,173,1171,160,1183,156,1179,169,1168,187,1137,203,1092,230,977,248,857,259,767"/>
<area shape="rect" href="classTensor.html#a958bad1db0d0a6867d12c75957d2de17" title=" " alt="" coords="20,1248,156,1291"/>
<area shape="poly" title=" " alt="" coords="265,768,256,871,239,1010,227,1081,212,1146,194,1200,173,1238,158,1251,155,1247,169,1234,189,1198,207,1145,221,1080,234,1010,251,870,259,767"/>
<area shape="rect" href="classTensor.html#aeede6504125b5aeff52c1a56dfbee125" title=" " alt="" coords="12,1315,164,1341"/>
<area shape="poly" title=" " alt="" coords="266,767,260,883,245,1043,233,1125,217,1200,197,1262,173,1304,158,1316,155,1312,169,1301,192,1259,212,1198,228,1124,239,1043,254,882,260,767"/>
<area shape="rect" href="classTensor.html#a0ccbe9aa15ebe52d33cb890388bdf1ca" title=" " alt="" coords="22,1365,154,1392"/>
<area shape="poly" title=" " alt="" coords="266,768,262,893,248,1068,236,1158,220,1240,199,1308,187,1334,173,1355,156,1368,152,1364,169,1352,182,1332,194,1306,215,1239,231,1157,243,1067,256,892,261,767"/>
<area shape="rect" href="classTensor.html#a7cc09049ddf2fb131becaefe19b7725a" title=" " alt="" coords="22,1416,154,1459"/>
<area shape="poly" title=" " alt="" coords="266,767,262,901,249,1091,237,1188,221,1278,200,1353,187,1383,173,1406,156,1421,152,1417,169,1402,182,1380,195,1351,216,1277,232,1188,243,1090,257,901,261,767"/>
<area shape="rect" href="classTensor.html#ab400f3516df53eb4e6547a850335571e" title=" " alt="" coords="19,1483,157,1525"/>
<area shape="poly" title=" " alt="" coords="267,768,264,913,252,1122,241,1231,224,1331,202,1414,188,1447,173,1472,160,1485,156,1481,169,1469,184,1444,197,1412,219,1330,236,1230,247,1122,259,913,261,767"/>
<area shape="rect" href="classTensor.html#afa485f1ec713acb3499de0a08659fc4a" title=" " alt="" coords="12,1549,164,1592"/>
<area shape="poly" title=" " alt="" coords="267,768,266,925,256,1154,245,1273,228,1383,204,1475,190,1511,173,1539,161,1551,157,1547,169,1536,185,1508,199,1473,223,1382,240,1273,251,1154,261,925,262,768"/>
</map>
</div>

</div>
</div>
<a id="a1ee81db1a8ee83fe46fd9af9563812fd" name="a1ee81db1a8ee83fe46fd9af9563812fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ee81db1a8ee83fe46fd9af9563812fd">&#9670;&#160;</a></span>map_inplace()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename Func&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::map_inplace </td>
          <td>(</td>
          <td class="paramtype">Func</td>          <td class="paramname"><span class="paramname"><em>func</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply a function to each element of the tensor (in-place). </p>
<p>Maps a custom function over all elements, modifying the tensor in-place. More memory-efficient than <a class="el" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3" title="Apply a function to each element of the tensor (creates new tensor).">map()</a> when you don't need to preserve the original.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Func</td><td>Function type (can be lambda, function pointer, or functor) </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">func</td><td>The function to apply to each element </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor (for method chaining)</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_map_inplace"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> vec({5});</div>
<div class="line">vec.fill(3.0f);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Double all elements in-place</span></div>
<div class="line">vec.map_inplace([](<span class="keywordtype">float</span> x) { <span class="keywordflow">return</span> x * 2.0f; });</div>
<div class="line"><span class="comment">// vec now contains all 6.0</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Chain multiple operations</span></div>
<div class="line">vec.map_inplace([](<span class="keywordtype">float</span> x) { <span class="keywordflow">return</span> x + 1.0f; })</div>
<div class="line">   .<a class="code hl_function" href="#a1ee81db1a8ee83fe46fd9af9563812fd">map_inplace</a>([](<span class="keywordtype">float</span> x) { <span class="keywordflow">return</span> x * x; });</div>
<div class="ttc" id="aclassTensor_html_a1ee81db1a8ee83fe46fd9af9563812fd"><div class="ttname"><a href="#a1ee81db1a8ee83fe46fd9af9563812fd">Tensor::map_inplace</a></div><div class="ttdeci">Tensor&lt; T, N &gt; &amp; map_inplace(Func func)</div><div class="ttdoc">Apply a function to each element of the tensor (in-place).</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l01479">tensor.h:1479</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01479">1479</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1479</span>                                         {</div>
<div class="line"><span class="lineno"> 1480</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1481</span>        </div>
<div class="line"><span class="lineno"> 1482</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1483</span>            <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">func</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 1484</span>        }</div>
<div class="line"><span class="lineno"> 1485</span>        </div>
<div class="line"><span class="lineno"> 1486</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1487</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a754cdcbf16b91d5621e7405a2aa68f68" name="a754cdcbf16b91d5621e7405a2aa68f68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a754cdcbf16b91d5621e7405a2aa68f68">&#9670;&#160;</a></span>masked_fill()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::masked_fill </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; M, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mask</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>fill_value</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Masked fill: replace values where mask is true (non-zero) with fill_value. </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">M</td><td>The mask tensor element type (typically bool or numeric). </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mask</td><td>Boolean-like tensor (0 or non-zero values). </td></tr>
    <tr><td class="paramname">fill_value</td><td>Value to fill where mask is non-zero. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with masked values filled. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02805">2805</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2805</span>                                                                           {</div>
<div class="line"><span class="lineno"> 2806</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">mask</a>.<a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>()) {</div>
<div class="line"><span class="lineno"> 2807</span>            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 2808</span>        }</div>
<div class="line"><span class="lineno"> 2809</span>        </div>
<div class="line"><span class="lineno"> 2810</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2811</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2812</span>        </div>
<div class="line"><span class="lineno"> 2813</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2814</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_class" href="classTensor.html">mask</a>.<a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>()[<a class="code hl_class" href="classTensor.html">i</a>] != <a class="code hl_class" href="classTensor.html">M</a>(0)) ? <a class="code hl_class" href="classTensor.html">fill_value</a> : <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 2815</span>        }</div>
<div class="line"><span class="lineno"> 2816</span>        </div>
<div class="line"><span class="lineno"> 2817</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2818</span>    }</div>
<div class="ttc" id="aclassTensor_html_a03d314303958ffc5644796d8025cd012"><div class="ttname"><a href="#a03d314303958ffc5644796d8025cd012">Tensor::dims</a></div><div class="ttdeci">TensorIndices&lt; N &gt; dims() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00644">tensor.h:644</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4773678cdfb3526a2bdb1079ef68b87e" name="a4773678cdfb3526a2bdb1079ef68b87e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4773678cdfb3526a2bdb1079ef68b87e">&#9670;&#160;</a></span>masked_select()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::masked_select </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; M, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mask</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Masked select: return 1D tensor of values where mask is true (non-zero). </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">M</td><td>The mask tensor element type (typically bool or numeric). </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mask</td><td>Boolean-like tensor (0 or non-zero values). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A 1D tensor containing selected values. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02827">2827</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2827</span>                                                               {</div>
<div class="line"><span class="lineno"> 2828</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">mask</a>.<a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>()) {</div>
<div class="line"><span class="lineno"> 2829</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 1&gt;</a>({0}, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2830</span>        }</div>
<div class="line"><span class="lineno"> 2831</span>        </div>
<div class="line"><span class="lineno"> 2832</span>        <span class="comment">// Count how many values to select</span></div>
<div class="line"><span class="lineno"> 2833</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2834</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">count</a> = 0;</div>
<div class="line"><span class="lineno"> 2835</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2836</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">mask</a>.<a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>()[<a class="code hl_class" href="classTensor.html">i</a>] != <a class="code hl_class" href="classTensor.html">M</a>(0)) {</div>
<div class="line"><span class="lineno"> 2837</span>                <a class="code hl_class" href="classTensor.html">count</a>++;</div>
<div class="line"><span class="lineno"> 2838</span>            }</div>
<div class="line"><span class="lineno"> 2839</span>        }</div>
<div class="line"><span class="lineno"> 2840</span>        </div>
<div class="line"><span class="lineno"> 2841</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 1&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>({<a class="code hl_class" href="classTensor.html">count</a>}, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2842</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">idx</a> = 0;</div>
<div class="line"><span class="lineno"> 2843</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2844</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">mask</a>.<a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>()[<a class="code hl_class" href="classTensor.html">i</a>] != <a class="code hl_class" href="classTensor.html">M</a>(0)) {</div>
<div class="line"><span class="lineno"> 2845</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">idx</a>++] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 2846</span>            }</div>
<div class="line"><span class="lineno"> 2847</span>        }</div>
<div class="line"><span class="lineno"> 2848</span>        </div>
<div class="line"><span class="lineno"> 2849</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2850</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a88d5a081d321cbd88ca46ed42ca1112c" name="a88d5a081d321cbd88ca46ed42ca1112c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88d5a081d321cbd88ca46ed42ca1112c">&#9670;&#160;</a></span>matmul()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if&lt; M==2, <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; &gt; &gt;::type <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::matmul </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc" title="Type alias for 2D matrices.">Matrix</a> multiplication with autograd support (matmul). </p>
<p>Performs standard matrix multiplication: A(m,n) @ B(n,p) = C(m,p)</p>
<p>This is the fundamental operation for neural network layers. Uses optimized implementations (BLAS/GPU) when available. Supports automatic differentiation for training neural networks.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">M</td><td>Template parameter ensuring N==2 (2D tensors only) </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to multiply with (must have compatible dimensions) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Result tensor or <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa2664c241558d7674e8ed4d5f63d2e463" title="Tensor dimensions do not match for the operation.">TensorError::DimensionMismatch</a> if incompatible</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_matmul"></a>
Example</h1>
<div class="fragment"><div class="line"><span class="comment">// Linear layer: output = input @ weights</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> input({32, 784}, <span class="keyword">true</span>, <span class="keyword">true</span>);   <span class="comment">// batch=32, features=784</span></div>
<div class="line"><a class="code hl_class" href="classTensor.html">Tensor&lt;float, 2&gt;</a> weights({784, 128}, <span class="keyword">true</span>, <span class="keyword">true</span>); <span class="comment">// 784 -&gt; 128 hidden units</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> output_result = input.<a class="code hl_function" href="#a88d5a081d321cbd88ca46ed42ca1112c">matmul</a>(weights);</div>
<div class="line"><span class="keywordflow">if</span> (std::holds_alternative&lt;<a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a>&gt;(output_result)) {</div>
<div class="line">    <span class="keyword">auto</span>&amp; output = std::get&lt;Tensor&lt;float, 2&gt;&gt;(output_result);</div>
<div class="line">    <span class="comment">// output shape: (32, 128)</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Full neural network layer with bias:</span></div>
<div class="line"><span class="keyword">auto</span> hidden = input.matmul(W1) + b1;  <span class="comment">// Broadcasting b1</span></div>
<div class="line"><span class="keyword">auto</span> activated = std::get&lt;Tensor&lt;float, 2&gt;&gt;(hidden).<a class="code hl_function" href="#a74db7588a7150d94b620ad63de1f5980">relu</a>();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Multi-layer network with autograd:</span></div>
<div class="line"><span class="keyword">auto</span> h1_result = input.matmul(W1);</div>
<div class="line"><span class="keyword">auto</span>&amp; h1 = std::get&lt;Tensor&lt;float, 2&gt;&gt;(h1_result);</div>
<div class="line"><span class="keyword">auto</span> h1_act = (h1 + b1).<a class="code hl_function" href="#a74db7588a7150d94b620ad63de1f5980">relu</a>();</div>
<div class="line"><span class="keyword">auto</span> h2_result = h1_act.matmul(W2);</div>
<div class="line"><span class="keyword">auto</span>&amp; h2 = std::get&lt;Tensor&lt;float, 2&gt;&gt;(h2_result);</div>
<div class="line"><span class="keyword">auto</span> output = h2 + b2;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Compute gradients:</span></div>
<div class="line"><span class="keyword">auto</span> loss = <a class="code hl_function" href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7">loss::mse_loss</a>(output, targets);</div>
<div class="line">loss.backward();</div>
<div class="line"><span class="comment">// Now W1.grad(), W2.grad(), etc. contain gradients</span></div>
<div class="ttc" id="aclassTensor_html_a74db7588a7150d94b620ad63de1f5980"><div class="ttname"><a href="#a74db7588a7150d94b620ad63de1f5980">Tensor::relu</a></div><div class="ttdeci">Tensor&lt; T, N &gt; relu() const</div><div class="ttdoc">Apply ReLU (Rectified Linear Unit) to all elements (creates new tensor).</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l01857">tensor.h:1857</a></div></div>
<div class="ttc" id="aclassTensor_html_a88d5a081d321cbd88ca46ed42ca1112c"><div class="ttname"><a href="#a88d5a081d321cbd88ca46ed42ca1112c">Tensor::matmul</a></div><div class="ttdeci">std::enable_if&lt; M==2, TensorResult&lt; Tensor&lt; T, 2 &gt; &gt; &gt;::type matmul(const Tensor&lt; T, 2 &gt; &amp;other) const</div><div class="ttdoc">Matrix multiplication with autograd support (matmul).</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l03406">tensor.h:3406</a></div></div>
<div class="ttc" id="anamespaceloss_html_aff5180b0c38ddd16d08f058205c01ef7"><div class="ttname"><a href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7">loss::mse_loss</a></div><div class="ttdeci">Tensor&lt; T, N &gt; mse_loss(const Tensor&lt; T, N &gt; &amp;predictions, const Tensor&lt; T, N &gt; &amp;targets, const std::string &amp;reduction)</div><div class="ttdoc">Mean Squared Error (MSE) Loss.</div><div class="ttdef"><b>Definition</b> <a href="loss__functions_8h_source.html#l00087">loss_functions.h:87</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03406">3406</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3406</span>                                            {</div>
<div class="line"><span class="lineno"> 3407</span>        <span class="keyword">static_assert</span>(<a class="code hl_class" href="classTensor.html">N</a> == 2, <span class="stringliteral">&quot;matmul requires 2D tensors&quot;</span>);</div>
<div class="line"><span class="lineno"> 3408</span>        </div>
<div class="line"><span class="lineno"> 3409</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[1] != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0]) {</div>
<div class="line"><span class="lineno"> 3410</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3411</span>        }</div>
<div class="line"><span class="lineno"> 3412</span>        </div>
<div class="line"><span class="lineno"> 3413</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">m</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0];</div>
<div class="line"><span class="lineno"> 3414</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">n</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[1];</div>
<div class="line"><span class="lineno"> 3415</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">p</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[1];</div>
<div class="line"><span class="lineno"> 3416</span>        </div>
<div class="line"><span class="lineno"> 3417</span>        <span class="keywordtype">bool</span> <a class="code hl_class" href="classTensor.html">track_grad</a> = <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a> || <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>;</div>
<div class="line"><span class="lineno"> 3418</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>({<a class="code hl_class" href="classTensor.html">m</a>, <a class="code hl_class" href="classTensor.html">p</a>}, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_class" href="classTensor.html">track_grad</a>);</div>
<div class="line"><span class="lineno"> 3419</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3420</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 3421</span>        </div>
<div class="line"><span class="lineno"> 3422</span>        <span class="comment">// Forward pass - use existing optimized dot product</span></div>
<div class="line"><span class="lineno"> 3423</span><span class="preprocessor">#ifdef USE_BLAS</span></div>
<div class="line"><span class="lineno"> 3424</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 3425</span>            <a class="code hl_class" href="classTensor.html">blas_gemm&lt;T&gt;</a>(<a class="code hl_class" href="classTensor.html">CblasRowMajor</a>, <a class="code hl_class" href="classTensor.html">CblasNoTrans</a>, <a class="code hl_class" href="classTensor.html">CblasNoTrans</a>,</div>
<div class="line"><span class="lineno"> 3426</span>                        <a class="code hl_class" href="classTensor.html">m</a>, <a class="code hl_class" href="classTensor.html">p</a>, <a class="code hl_class" href="classTensor.html">n</a>, <a class="code hl_class" href="classTensor.html">T</a>(1), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">n</a>,</div>
<div class="line"><span class="lineno"> 3427</span>                        <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">p</a>, <a class="code hl_class" href="classTensor.html">T</a>(0), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">p</a>);</div>
<div class="line"><span class="lineno"> 3428</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3429</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3430</span>        {</div>
<div class="line"><span class="lineno"> 3431</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">m</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3432</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">j</a> = 0; <a class="code hl_class" href="classTensor.html">j</a> &lt; <a class="code hl_class" href="classTensor.html">p</a>; ++<a class="code hl_class" href="classTensor.html">j</a>) {</div>
<div class="line"><span class="lineno"> 3433</span>                    <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3434</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">k</a> = 0; <a class="code hl_class" href="classTensor.html">k</a> &lt; <a class="code hl_class" href="classTensor.html">n</a>; ++<a class="code hl_class" href="classTensor.html">k</a>) {</div>
<div class="line"><span class="lineno"> 3435</span>                        <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> += (*this)[{<a class="code hl_class" href="classTensor.html">i</a>, <a class="code hl_class" href="classTensor.html">k</a>}] * <a class="code hl_class" href="classTensor.html">other</a>[{<a class="code hl_class" href="classTensor.html">k</a>, <a class="code hl_class" href="classTensor.html">j</a>}];</div>
<div class="line"><span class="lineno"> 3436</span>                    }</div>
<div class="line"><span class="lineno"> 3437</span>                    <a class="code hl_class" href="classTensor.html">result</a>[{<a class="code hl_class" href="classTensor.html">i</a>, <a class="code hl_class" href="classTensor.html">j</a>}] = <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>;</div>
<div class="line"><span class="lineno"> 3438</span>                }</div>
<div class="line"><span class="lineno"> 3439</span>            }</div>
<div class="line"><span class="lineno"> 3440</span>        }</div>
<div class="line"><span class="lineno"> 3441</span>        </div>
<div class="line"><span class="lineno"> 3442</span>        <span class="comment">// Setup backward pass for autograd</span></div>
<div class="line"><span class="lineno"> 3443</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">track_grad</a>) {</div>
<div class="line"><span class="lineno"> 3444</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a> <a class="code hl_class" href="classTensor.html">self_copy</a> = this-&gt;<a class="code hl_function" href="#ae5b52299c11f3ba81e781cb008542285">detach</a>();</div>
<div class="line"><span class="lineno"> 3445</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a> <a class="code hl_class" href="classTensor.html">other_copy</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_function" href="#ae5b52299c11f3ba81e781cb008542285">detach</a>();</div>
<div class="line"><span class="lineno"> 3446</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3447</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>* <a class="code hl_class" href="classTensor.html">other_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_class" href="classTensor.html">other</a>);</div>
<div class="line"><span class="lineno"> 3448</span>            </div>
<div class="line"><span class="lineno"> 3449</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">other_ptr</a>, <a class="code hl_class" href="classTensor.html">self_copy</a>, <a class="code hl_class" href="classTensor.html">other_copy</a>, <a class="code hl_class" href="classTensor.html">m</a>, <a class="code hl_class" href="classTensor.html">n</a>, <a class="code hl_class" href="classTensor.html">p</a>]</div>
<div class="line"><span class="lineno"> 3450</span>                                    (<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 3451</span>                <span class="comment">// Gradient for matmul:</span></div>
<div class="line"><span class="lineno"> 3452</span>                <span class="comment">// If C = A @ B, then:</span></div>
<div class="line"><span class="lineno"> 3453</span>                <span class="comment">// dL/dA = dL/dC @ B^T</span></div>
<div class="line"><span class="lineno"> 3454</span>                <span class="comment">// dL/dB = A^T @ dL/dC</span></div>
<div class="line"><span class="lineno"> 3455</span>                </div>
<div class="line"><span class="lineno"> 3456</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 3457</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 3458</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, 2&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3459</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 3460</span>                    }</div>
<div class="line"><span class="lineno"> 3461</span>                    </div>
<div class="line"><span class="lineno"> 3462</span>                    <span class="comment">// dL/dA = grad @ other^T</span></div>
<div class="line"><span class="lineno"> 3463</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">m</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3464</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">k</a> = 0; <a class="code hl_class" href="classTensor.html">k</a> &lt; <a class="code hl_class" href="classTensor.html">n</a>; ++<a class="code hl_class" href="classTensor.html">k</a>) {</div>
<div class="line"><span class="lineno"> 3465</span>                            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3466</span>                            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">j</a> = 0; <a class="code hl_class" href="classTensor.html">j</a> &lt; <a class="code hl_class" href="classTensor.html">p</a>; ++<a class="code hl_class" href="classTensor.html">j</a>) {</div>
<div class="line"><span class="lineno"> 3467</span>                                <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>[{<a class="code hl_class" href="classTensor.html">i</a>, <a class="code hl_class" href="classTensor.html">j</a>}] * <a class="code hl_class" href="classTensor.html">other_copy</a>[{<a class="code hl_class" href="classTensor.html">k</a>, <a class="code hl_class" href="classTensor.html">j</a>}];</div>
<div class="line"><span class="lineno"> 3468</span>                            }</div>
<div class="line"><span class="lineno"> 3469</span>                            (*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>)[{<a class="code hl_class" href="classTensor.html">i</a>, <a class="code hl_class" href="classTensor.html">k</a>}] += <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>;</div>
<div class="line"><span class="lineno"> 3470</span>                        }</div>
<div class="line"><span class="lineno"> 3471</span>                    }</div>
<div class="line"><span class="lineno"> 3472</span>                    </div>
<div class="line"><span class="lineno"> 3473</span>                    <span class="comment">// Propagate further if not leaf</span></div>
<div class="line"><span class="lineno"> 3474</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 3475</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 3476</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 3477</span>                        }</div>
<div class="line"><span class="lineno"> 3478</span>                    }</div>
<div class="line"><span class="lineno"> 3479</span>                }</div>
<div class="line"><span class="lineno"> 3480</span>                </div>
<div class="line"><span class="lineno"> 3481</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 3482</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 3483</span>                        <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, 2&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3484</span>                        <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 3485</span>                    }</div>
<div class="line"><span class="lineno"> 3486</span>                    </div>
<div class="line"><span class="lineno"> 3487</span>                    <span class="comment">// dL/dB = self^T @ grad</span></div>
<div class="line"><span class="lineno"> 3488</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">k</a> = 0; <a class="code hl_class" href="classTensor.html">k</a> &lt; <a class="code hl_class" href="classTensor.html">n</a>; ++<a class="code hl_class" href="classTensor.html">k</a>) {</div>
<div class="line"><span class="lineno"> 3489</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">j</a> = 0; <a class="code hl_class" href="classTensor.html">j</a> &lt; <a class="code hl_class" href="classTensor.html">p</a>; ++<a class="code hl_class" href="classTensor.html">j</a>) {</div>
<div class="line"><span class="lineno"> 3490</span>                            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3491</span>                            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">m</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3492</span>                                <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> += <a class="code hl_class" href="classTensor.html">self_copy</a>[{<a class="code hl_class" href="classTensor.html">i</a>, <a class="code hl_class" href="classTensor.html">k</a>}] * <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>[{<a class="code hl_class" href="classTensor.html">i</a>, <a class="code hl_class" href="classTensor.html">j</a>}];</div>
<div class="line"><span class="lineno"> 3493</span>                            }</div>
<div class="line"><span class="lineno"> 3494</span>                            (*<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>)[{<a class="code hl_class" href="classTensor.html">k</a>, <a class="code hl_class" href="classTensor.html">j</a>}] += <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>;</div>
<div class="line"><span class="lineno"> 3495</span>                        }</div>
<div class="line"><span class="lineno"> 3496</span>                    }</div>
<div class="line"><span class="lineno"> 3497</span>                    </div>
<div class="line"><span class="lineno"> 3498</span>                    <span class="comment">// Propagate further if not leaf</span></div>
<div class="line"><span class="lineno"> 3499</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 3500</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 3501</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 3502</span>                        }</div>
<div class="line"><span class="lineno"> 3503</span>                    }</div>
<div class="line"><span class="lineno"> 3504</span>                }</div>
<div class="line"><span class="lineno"> 3505</span>            });</div>
<div class="line"><span class="lineno"> 3506</span>        }</div>
<div class="line"><span class="lineno"> 3507</span>        </div>
<div class="line"><span class="lineno"> 3508</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3509</span>    }</div>
<div class="ttc" id="aclassTensor_html_a3d279878b61732de2f1986dfc7de8400"><div class="ttname"><a href="#a3d279878b61732de2f1986dfc7de8400">Tensor::sum</a></div><div class="ttdeci">T sum() const</div><div class="ttdoc">Compute sum reduction along all dimensions.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l02234">tensor.h:2234</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a88d5a081d321cbd88ca46ed42ca1112c_icgraph.png" border="0" usemap="#aclassTensor_a88d5a081d321cbd88ca46ed42ca1112c_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a88d5a081d321cbd88ca46ed42ca1112c_icgraph" id="aclassTensor_a88d5a081d321cbd88ca46ed42ca1112c_icgraph">
<area shape="rect" title="Matrix multiplication with autograd support (matmul)." alt="" coords="190,47,301,73"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Linear.html#a5364162aed6bb8c7758d88142ac74c1b" title=" " alt="" coords="5,5,142,48"/>
<area shape="poly" title=" " alt="" coords="174,49,141,42,142,37,175,44"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Linear.html#a0af1f08655e4b88cc7adc4e7d8a323e3" title=" " alt="" coords="5,72,142,115"/>
<area shape="poly" title=" " alt="" coords="175,76,142,83,141,78,174,71"/>
</map>
</div>

</div>
</div>
<a id="a421ff1c638234245b00425702d3f23aa" name="a421ff1c638234245b00425702d3f23aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a421ff1c638234245b00425702d3f23aa">&#9670;&#160;</a></span>max()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::max </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute max value of all elements. </p><dl class="section return"><dt>Returns</dt><dd>The maximum value. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02447">2447</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2447</span>                  {</div>
<div class="line"><span class="lineno"> 2448</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2449</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0];</div>
<div class="line"><span class="lineno"> 2450</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2451</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt; <a class="code hl_class" href="classTensor.html">max_val</a>) {</div>
<div class="line"><span class="lineno"> 2452</span>                <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 2453</span>            }</div>
<div class="line"><span class="lineno"> 2454</span>        }</div>
<div class="line"><span class="lineno"> 2455</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">max_val</a>;</div>
<div class="line"><span class="lineno"> 2456</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a421ff1c638234245b00425702d3f23aa_icgraph.png" border="0" usemap="#aclassTensor_a421ff1c638234245b00425702d3f23aa_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a421ff1c638234245b00425702d3f23aa_icgraph" id="aclassTensor_a421ff1c638234245b00425702d3f23aa_icgraph">
<area shape="rect" title=" " alt="" coords="234,5,327,32"/>
<area shape="rect" href="classTensor.html#a06eeff8ce7f54262b935b324bcb6833e" title=" " alt="" coords="5,5,186,32"/>
<area shape="poly" title=" " alt="" coords="218,21,186,21,186,16,218,16"/>
</map>
</div>

</div>
</div>
<a id="a84b27bf0213ab3f228c2efe5ca31eaec" name="a84b27bf0213ab3f228c2efe5ca31eaec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84b27bf0213ab3f228c2efe5ca31eaec">&#9670;&#160;</a></span>mean()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::mean </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute mean of all elements. </p>
<p>Calculates the arithmetic mean (average) of all tensor elements.</p>
<dl class="section return"><dt>Returns</dt><dd>The mean value as a scalar</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_mean"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>({2, 3});</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{0, 0}] = 1.0f;</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{0, 1}] = 2.0f;</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{0, 2}] = 3.0f;</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{1, 0}] = 4.0f;</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{1, 1}] = 5.0f;</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{1, 2}] = 6.0f;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">float</span> avg = <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>.mean();  <span class="comment">// Returns 3.5 = (1+2+3+4+5+6)/6</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Useful for normalization:</span></div>
<div class="line"><span class="keyword">auto</span> centered = <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a> - <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>.mean();  <span class="comment">// Center around zero</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02268">2268</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2268</span>                   {</div>
<div class="line"><span class="lineno"> 2269</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>() / <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>());</div>
<div class="line"><span class="lineno"> 2270</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a84b27bf0213ab3f228c2efe5ca31eaec_icgraph.png" border="0" usemap="#aclassTensor_a84b27bf0213ab3f228c2efe5ca31eaec_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a84b27bf0213ab3f228c2efe5ca31eaec_icgraph" id="aclassTensor_a84b27bf0213ab3f228c2efe5ca31eaec_icgraph">
<area shape="rect" title="Compute mean of all elements." alt="" coords="230,81,330,108"/>
<area shape="rect" href="classTensor.html#a2b57a0f04d06e24633c240fe7b007b4a" title=" " alt="" coords="7,5,180,32"/>
<area shape="poly" title=" " alt="" coords="241,76,181,46,148,35,150,30,183,42,243,71"/>
<area shape="rect" href="classTensor.html#a36b35209e077e06698d7b0cb5e687b95" title=" " alt="" coords="5,56,182,83"/>
<area shape="poly" title=" " alt="" coords="214,88,182,84,182,79,215,83"/>
<area shape="rect" href="classTensor.html#ab319628634a6c30afddd1a331d9c22e8" title=" " alt="" coords="9,107,178,133"/>
<area shape="poly" title=" " alt="" coords="214,106,179,111,178,106,214,101"/>
<area shape="rect" href="classTensor.html#ac24ac40382bfcce441f59645c4b73257" title=" " alt="" coords="12,157,175,184"/>
<area shape="poly" title=" " alt="" coords="243,118,183,148,150,159,148,154,181,143,241,114"/>
</map>
</div>

</div>
</div>
<a id="adf1fcb0ddd0ef2db3003401db519ec1c" name="adf1fcb0ddd0ef2db3003401db519ec1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf1fcb0ddd0ef2db3003401db519ec1c">&#9670;&#160;</a></span>mean_axis() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::mean_axis </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>axis</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>keepdims</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Mean reduction along a specific axis with autograd support. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The axis to average along (-1 for last axis) </td></tr>
    <tr><td class="paramname">keepdims</td><td>Whether to keep the reduced dimension </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reduced tensor </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03641">3641</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3641</span>                                                                  {</div>
<div class="line"><span class="lineno"> 3642</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">sum_result</a> = <a class="code hl_function" href="#ac20a4679e14de6f68e148b447496adfc">sum_axis</a>(<a class="code hl_class" href="classTensor.html">axis</a>, <a class="code hl_class" href="classTensor.html">keepdims</a>);</div>
<div class="line"><span class="lineno"> 3643</span>        </div>
<div class="line"><span class="lineno"> 3644</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &lt; 0) {</div>
<div class="line"><span class="lineno"> 3645</span>            <a class="code hl_class" href="classTensor.html">axis</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) + <a class="code hl_class" href="classTensor.html">axis</a>;</div>
<div class="line"><span class="lineno"> 3646</span>        }</div>
<div class="line"><span class="lineno"> 3647</span>        </div>
<div class="line"><span class="lineno"> 3648</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">count</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>]);</div>
<div class="line"><span class="lineno"> 3649</span>        </div>
<div class="line"><span class="lineno"> 3650</span>        <span class="comment">// Divide by count</span></div>
<div class="line"><span class="lineno"> 3651</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a> = <a class="code hl_class" href="classTensor.html">sum_result</a> * (<a class="code hl_class" href="classTensor.html">T</a>(1) / <a class="code hl_class" href="classTensor.html">count</a>);</div>
<div class="line"><span class="lineno"> 3652</span>        </div>
<div class="line"><span class="lineno"> 3653</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3654</span>    }</div>
<div class="ttc" id="aclassTensor_html_ac20a4679e14de6f68e148b447496adfc"><div class="ttname"><a href="#ac20a4679e14de6f68e148b447496adfc">Tensor::sum_axis</a></div><div class="ttdeci">Tensor&lt; T, N &gt; sum_axis(int axis, bool keepdims=false) const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l03517">tensor.h:3517</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeb3f6a9bf8ee28d46a887238a9d3d460" name="aeb3f6a9bf8ee28d46a887238a9d3d460"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb3f6a9bf8ee28d46a887238a9d3d460">&#9670;&#160;</a></span>mean_axis() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::mean_axis </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>axis</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>keepdims</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Mean reduction along a specific axis. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The dimension along which to compute the mean. </td></tr>
    <tr><td class="paramname">keepdims</td><td>Whether to keep the reduced dimension (size 1) or remove it. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with the mean along the specified axis. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04600">4600</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4600</span>                                                                     {</div>
<div class="line"><span class="lineno"> 4601</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &gt;= <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 4602</span>            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 4603</span>        }</div>
<div class="line"><span class="lineno"> 4604</span>        </div>
<div class="line"><span class="lineno"> 4605</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a> = <a class="code hl_function" href="#ac20a4679e14de6f68e148b447496adfc">sum_axis</a>(<a class="code hl_class" href="classTensor.html">axis</a>, <a class="code hl_class" href="classTensor.html">keepdims</a>);</div>
<div class="line"><span class="lineno"> 4606</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">divisor</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>]);</div>
<div class="line"><span class="lineno"> 4607</span>        </div>
<div class="line"><span class="lineno"> 4608</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4609</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4610</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] /= <a class="code hl_class" href="classTensor.html">divisor</a>;</div>
<div class="line"><span class="lineno"> 4611</span>        }</div>
<div class="line"><span class="lineno"> 4612</span>        </div>
<div class="line"><span class="lineno"> 4613</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4614</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1704d259280947373cbcbe3d1ca14854" name="a1704d259280947373cbcbe3d1ca14854"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1704d259280947373cbcbe3d1ca14854">&#9670;&#160;</a></span>median()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::median </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute median of all elements. Note: This creates a sorted copy of the data. </p><dl class="section return"><dt>Returns</dt><dd>The median value. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02390">2390</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2390</span>                     {</div>
<div class="line"><span class="lineno"> 2391</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2392</span>        <a class="code hl_class" href="classTensor.html">std::vector&lt;T&gt;</a> <a class="code hl_class" href="classTensor.html">sorted_data</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2393</span>        <a class="code hl_class" href="classTensor.html">std::sort</a>(<a class="code hl_class" href="classTensor.html">sorted_data</a>.begin(), <a class="code hl_class" href="classTensor.html">sorted_data</a>.end());</div>
<div class="line"><span class="lineno"> 2394</span>        </div>
<div class="line"><span class="lineno"> 2395</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">total</a> % 2 == 0) {</div>
<div class="line"><span class="lineno"> 2396</span>            <span class="keywordflow">return</span> (<a class="code hl_class" href="classTensor.html">sorted_data</a>[<a class="code hl_class" href="classTensor.html">total</a>/2 - 1] + <a class="code hl_class" href="classTensor.html">sorted_data</a>[<a class="code hl_class" href="classTensor.html">total</a>/2]) / <a class="code hl_class" href="classTensor.html">T</a>(2);</div>
<div class="line"><span class="lineno"> 2397</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2398</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">sorted_data</a>[<a class="code hl_class" href="classTensor.html">total</a>/2];</div>
<div class="line"><span class="lineno"> 2399</span>        }</div>
<div class="line"><span class="lineno"> 2400</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a20cb276f18c104077f75c6f712e4107b" name="a20cb276f18c104077f75c6f712e4107b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20cb276f18c104077f75c6f712e4107b">&#9670;&#160;</a></span>min()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::min </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute min value of all elements. </p><dl class="section return"><dt>Returns</dt><dd>The minimum value. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02432">2432</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2432</span>                  {</div>
<div class="line"><span class="lineno"> 2433</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2434</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">min_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0];</div>
<div class="line"><span class="lineno"> 2435</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2436</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &lt; <a class="code hl_class" href="classTensor.html">min_val</a>) {</div>
<div class="line"><span class="lineno"> 2437</span>                <a class="code hl_class" href="classTensor.html">min_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 2438</span>            }</div>
<div class="line"><span class="lineno"> 2439</span>        }</div>
<div class="line"><span class="lineno"> 2440</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">min_val</a>;</div>
<div class="line"><span class="lineno"> 2441</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a20cb276f18c104077f75c6f712e4107b_icgraph.png" border="0" usemap="#aclassTensor_a20cb276f18c104077f75c6f712e4107b_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a20cb276f18c104077f75c6f712e4107b_icgraph" id="aclassTensor_a20cb276f18c104077f75c6f712e4107b_icgraph">
<area shape="rect" title=" " alt="" coords="234,5,323,32"/>
<area shape="rect" href="classTensor.html#a06eeff8ce7f54262b935b324bcb6833e" title=" " alt="" coords="5,5,186,32"/>
<area shape="poly" title=" " alt="" coords="218,21,186,21,186,16,218,16"/>
</map>
</div>

</div>
</div>
<a id="a3091aa5abf57a0e2a900a25443f50dd8" name="a3091aa5abf57a0e2a900a25443f50dd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3091aa5abf57a0e2a900a25443f50dd8">&#9670;&#160;</a></span>mse_loss()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;<a class="el" href="#a73e9357327da350df1da748ebeeefdaf">::mse_loss</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>target</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute MSE (Mean Squared Error) loss. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target</td><td>The target tensor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The MSE value or error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03043">3043</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3043</span>                                                               {</div>
<div class="line"><span class="lineno"> 3044</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">target</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 3045</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3046</span>        }</div>
<div class="line"><span class="lineno"> 3047</span>        </div>
<div class="line"><span class="lineno"> 3048</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">loss</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3049</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3050</span>        </div>
<div class="line"><span class="lineno"> 3051</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3052</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">diff</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] - <a class="code hl_class" href="classTensor.html">target</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3053</span>            <a class="code hl_class" href="classTensor.html">loss</a> += <a class="code hl_class" href="classTensor.html">diff</a> * <a class="code hl_class" href="classTensor.html">diff</a>;</div>
<div class="line"><span class="lineno"> 3054</span>        }</div>
<div class="line"><span class="lineno"> 3055</span>        </div>
<div class="line"><span class="lineno"> 3056</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">loss</a> / <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 3057</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a06009b18adaea5bd8fa428a5ccbef2d2" name="a06009b18adaea5bd8fa428a5ccbef2d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06009b18adaea5bd8fa428a5ccbef2d2">&#9670;&#160;</a></span>mse_loss_gradient()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::mse_loss_gradient </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>target</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute gradient of MSE loss with respect to predictions. d/dx[MSE] = 2 * (prediction - target) / n </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target</td><td>The target tensor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The gradient tensor or error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03065">3065</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3065</span>                                                                                   {</div>
<div class="line"><span class="lineno"> 3066</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">target</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 3067</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3068</span>        }</div>
<div class="line"><span class="lineno"> 3069</span>        </div>
<div class="line"><span class="lineno"> 3070</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3071</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3072</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">scale</a> = <a class="code hl_class" href="classTensor.html">T</a>(2) / <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 3073</span>        </div>
<div class="line"><span class="lineno"> 3074</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3075</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">scale</a> * (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] - <a class="code hl_class" href="classTensor.html">target</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 3076</span>        }</div>
<div class="line"><span class="lineno"> 3077</span>        </div>
<div class="line"><span class="lineno"> 3078</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3079</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aab0bca33fa0dbe68308c0a828cec9f44" name="aab0bca33fa0dbe68308c0a828cec9f44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab0bca33fa0dbe68308c0a828cec9f44">&#9670;&#160;</a></span>ne()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::ne </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>epsilon</em></span><span class="paramdefsep"> = </span><span class="paramdefval">std::numeric_limits&lt;T&gt;::epsilon()</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise inequality comparison. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to compare with. </td></tr>
    <tr><td class="paramname">epsilon</td><td>Tolerance for floating-point comparison. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02733">2733</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2733</span>                                                                                                {</div>
<div class="line"><span class="lineno"> 2734</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 2735</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2736</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(1));</div>
<div class="line"><span class="lineno"> 2737</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2738</span>        }</div>
<div class="line"><span class="lineno"> 2739</span>        </div>
<div class="line"><span class="lineno"> 2740</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2741</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2742</span>        </div>
<div class="line"><span class="lineno"> 2743</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2744</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_class" href="classTensor.html">std::abs</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] - <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]) &gt;= <a class="code hl_class" href="classTensor.html">epsilon</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2745</span>        }</div>
<div class="line"><span class="lineno"> 2746</span>        </div>
<div class="line"><span class="lineno"> 2747</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2748</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab319628634a6c30afddd1a331d9c22e8" name="ab319628634a6c30afddd1a331d9c22e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab319628634a6c30afddd1a331d9c22e8">&#9670;&#160;</a></span>normalize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::normalize </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>ddof</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Normalize tensor to have zero mean and unit variance (z-score normalization). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ddof</td><td>Delta degrees of freedom for standard deviation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new normalized tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02508">2508</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2508</span>                                                  {</div>
<div class="line"><span class="lineno"> 2509</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">m</a> = <a class="code hl_function" href="#a84b27bf0213ab3f228c2efe5ca31eaec">mean</a>();</div>
<div class="line"><span class="lineno"> 2510</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">s</a> = <a class="code hl_function" href="#a0cda55fce732dcb563b598ff636d8758">std</a>(<a class="code hl_class" href="classTensor.html">ddof</a>);</div>
<div class="line"><span class="lineno"> 2511</span>        </div>
<div class="line"><span class="lineno"> 2512</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">s</a> &lt; <a class="code hl_class" href="classTensor.html">std::numeric_limits&lt;T&gt;::epsilon</a>()) {</div>
<div class="line"><span class="lineno"> 2513</span>            <span class="comment">// If std is zero, just center the data</span></div>
<div class="line"><span class="lineno"> 2514</span>            <span class="keywordflow">return</span> *<span class="keyword">this</span> - <a class="code hl_class" href="classTensor.html">m</a>;</div>
<div class="line"><span class="lineno"> 2515</span>        }</div>
<div class="line"><span class="lineno"> 2516</span>        </div>
<div class="line"><span class="lineno"> 2517</span>        <span class="keywordflow">return</span> (*<span class="keyword">this</span> - <a class="code hl_class" href="classTensor.html">m</a>) / <a class="code hl_class" href="classTensor.html">s</a>;</div>
<div class="line"><span class="lineno"> 2518</span>    }</div>
<div class="ttc" id="aclassTensor_html_a0cda55fce732dcb563b598ff636d8758"><div class="ttname"><a href="#a0cda55fce732dcb563b598ff636d8758">Tensor::std</a></div><div class="ttdeci">T std(size_t ddof=0) const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l02318">tensor.h:2318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acfd498e431d2689e191c1e9cb8d600fb" name="acfd498e431d2689e191c1e9cb8d600fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfd498e431d2689e191c1e9cb8d600fb">&#9670;&#160;</a></span>offset()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::offset </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>indices</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the flat offset for given multi-dimensional indices. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">indices</td><td>An array of indices for each dimension. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The corresponding flat offset in the data array. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00464">464</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  464</span>                                                         {</div>
<div class="line"><span class="lineno">  465</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">off</a> = 0;</div>
<div class="line"><span class="lineno">  466</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno">  467</span>            <a class="code hl_class" href="classTensor.html">off</a> += <a class="code hl_class" href="classTensor.html">indices</a>[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_variable" href="#af6821d656bfc94c60fe4cd256c1d7402">strides_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno">  468</span>        }</div>
<div class="line"><span class="lineno">  469</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">off</a>;</div>
<div class="line"><span class="lineno">  470</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_acfd498e431d2689e191c1e9cb8d600fb_icgraph.png" border="0" usemap="#aclassTensor_acfd498e431d2689e191c1e9cb8d600fb_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_acfd498e431d2689e191c1e9cb8d600fb_icgraph" id="aclassTensor_acfd498e431d2689e191c1e9cb8d600fb_icgraph">
<area shape="rect" title=" " alt="" coords="222,31,322,57"/>
<area shape="rect" href="classTensor.html#acd343a064481a9fc4a0c8f3d17fc489c" title=" " alt="" coords="5,5,174,32"/>
<area shape="poly" title=" " alt="" coords="206,38,174,33,174,28,207,32"/>
<area shape="rect" href="classTensor.html#a9f1420cd0be3272bdb3b9a3f53d58c76" title=" " alt="" coords="5,56,174,83"/>
<area shape="poly" title=" " alt="" coords="207,56,174,60,174,55,206,50"/>
</map>
</div>

</div>
</div>
<a id="a808dc758321fc810256e3efd13042c98" name="a808dc758321fc810256e3efd13042c98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a808dc758321fc810256e3efd13042c98">&#9670;&#160;</a></span>operator*() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator* </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise multiplication with scalar (creates new tensor). Supports automatic differentiation. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to multiply all elements with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with the result. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01214">1214</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1214</span>                                                  {</div>
<div class="line"><span class="lineno"> 1215</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 1216</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1217</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1218</span>        </div>
<div class="line"><span class="lineno"> 1219</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1220</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1221</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::mul_scalar_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">scalar</a>, <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1222</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1223</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1224</span>        {</div>
<div class="line"><span class="lineno"> 1225</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1226</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">scalar</a>;</div>
<div class="line"><span class="lineno"> 1227</span>            }</div>
<div class="line"><span class="lineno"> 1228</span>        }</div>
<div class="line"><span class="lineno"> 1229</span>        </div>
<div class="line"><span class="lineno"> 1230</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 1231</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 1232</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 1233</span>            </div>
<div class="line"><span class="lineno"> 1234</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">scalar</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 1235</span>                <span class="comment">// Gradient of multiplication with scalar: d/dx(x*c) = c</span></div>
<div class="line"><span class="lineno"> 1236</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 1237</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 1238</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1239</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 1240</span>                    }</div>
<div class="line"><span class="lineno"> 1241</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1242</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1243</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">scalar</a>;</div>
<div class="line"><span class="lineno"> 1244</span>                    }</div>
<div class="line"><span class="lineno"> 1245</span>                    </div>
<div class="line"><span class="lineno"> 1246</span>                    <span class="comment">// If self is not a leaf, propagate gradients further</span></div>
<div class="line"><span class="lineno"> 1247</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 1248</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 1249</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 1250</span>                        }</div>
<div class="line"><span class="lineno"> 1251</span>                    }</div>
<div class="line"><span class="lineno"> 1252</span>                }</div>
<div class="line"><span class="lineno"> 1253</span>            });</div>
<div class="line"><span class="lineno"> 1254</span>        }</div>
<div class="line"><span class="lineno"> 1255</span>        </div>
<div class="line"><span class="lineno"> 1256</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1257</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af352346a629f774750b12c97234979a9" name="af352346a629f774750b12c97234979a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af352346a629f774750b12c97234979a9">&#9670;&#160;</a></span>operator*() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator* </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise multiplication with another tensor (creates new tensor). Supports automatic differentiation. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to multiply with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing either a new tensor with the result or an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01136">1136</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1136</span>                                                                          {</div>
<div class="line"><span class="lineno"> 1137</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 1138</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 1139</span>        }</div>
<div class="line"><span class="lineno"> 1140</span>        </div>
<div class="line"><span class="lineno"> 1141</span>        <span class="keywordtype">bool</span> <a class="code hl_class" href="classTensor.html">track_grad</a> = <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a> || <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>;</div>
<div class="line"><span class="lineno"> 1142</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_class" href="classTensor.html">track_grad</a>);</div>
<div class="line"><span class="lineno"> 1143</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1144</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1145</span>        </div>
<div class="line"><span class="lineno"> 1146</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1147</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1148</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::mul_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1149</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1150</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1151</span>        {</div>
<div class="line"><span class="lineno"> 1152</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1153</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1154</span>            }</div>
<div class="line"><span class="lineno"> 1155</span>        }</div>
<div class="line"><span class="lineno"> 1156</span>        </div>
<div class="line"><span class="lineno"> 1157</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 1158</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">track_grad</a>) {</div>
<div class="line"><span class="lineno"> 1159</span>            <span class="comment">// Need to store copies of input data for gradient computation</span></div>
<div class="line"><span class="lineno"> 1160</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">self_copy</a> = this-&gt;<a class="code hl_function" href="#ae5b52299c11f3ba81e781cb008542285">detach</a>();</div>
<div class="line"><span class="lineno"> 1161</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">other_copy</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_function" href="#ae5b52299c11f3ba81e781cb008542285">detach</a>();</div>
<div class="line"><span class="lineno"> 1162</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 1163</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">other_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_class" href="classTensor.html">other</a>);</div>
<div class="line"><span class="lineno"> 1164</span>            </div>
<div class="line"><span class="lineno"> 1165</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">other_ptr</a>, <a class="code hl_class" href="classTensor.html">self_copy</a>, <a class="code hl_class" href="classTensor.html">other_copy</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 1166</span>                <span class="comment">// Gradient of multiplication: d/dx(x*y) = y, d/dy(x*y) = x</span></div>
<div class="line"><span class="lineno"> 1167</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 1168</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 1169</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1170</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 1171</span>                    }</div>
<div class="line"><span class="lineno"> 1172</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1173</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1174</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">other_copy</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1175</span>                    }</div>
<div class="line"><span class="lineno"> 1176</span>                    </div>
<div class="line"><span class="lineno"> 1177</span>                    <span class="comment">// If self is not a leaf, propagate gradients further</span></div>
<div class="line"><span class="lineno"> 1178</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 1179</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 1180</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 1181</span>                        }</div>
<div class="line"><span class="lineno"> 1182</span>                    }</div>
<div class="line"><span class="lineno"> 1183</span>                }</div>
<div class="line"><span class="lineno"> 1184</span>                </div>
<div class="line"><span class="lineno"> 1185</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 1186</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 1187</span>                        <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1188</span>                        <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 1189</span>                    }</div>
<div class="line"><span class="lineno"> 1190</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1191</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1192</span>                        <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">self_copy</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1193</span>                    }</div>
<div class="line"><span class="lineno"> 1194</span>                    </div>
<div class="line"><span class="lineno"> 1195</span>                    <span class="comment">// If other is not a leaf, propagate gradients further</span></div>
<div class="line"><span class="lineno"> 1196</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 1197</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 1198</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 1199</span>                        }</div>
<div class="line"><span class="lineno"> 1200</span>                    }</div>
<div class="line"><span class="lineno"> 1201</span>                }</div>
<div class="line"><span class="lineno"> 1202</span>            });</div>
<div class="line"><span class="lineno"> 1203</span>        }</div>
<div class="line"><span class="lineno"> 1204</span>        </div>
<div class="line"><span class="lineno"> 1205</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1206</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a29213c270a7d4b9f44f27f4cec4246bf" name="a29213c270a7d4b9f44f27f4cec4246bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29213c270a7d4b9f44f27f4cec4246bf">&#9670;&#160;</a></span>operator*=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator*= </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise multiplication with scalar (in-place). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to multiply all elements with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01290">1290</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1290</span>                                              {</div>
<div class="line"><span class="lineno"> 1291</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1292</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1293</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1294</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::mul_scalar_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">scalar</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1295</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1296</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1297</span>        {</div>
<div class="line"><span class="lineno"> 1298</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1299</span>                <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] *= <a class="code hl_class" href="classTensor.html">scalar</a>;</div>
<div class="line"><span class="lineno"> 1300</span>            }</div>
<div class="line"><span class="lineno"> 1301</span>        }</div>
<div class="line"><span class="lineno"> 1302</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1303</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4a0f41f0cbce7ad6637c457a68ff3e32" name="a4a0f41f0cbce7ad6637c457a68ff3e32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a0f41f0cbce7ad6637c457a68ff3e32">&#9670;&#160;</a></span>operator*=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator*= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise multiplication with another tensor (in-place). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to multiply with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>If dimensions don't match, the operation is skipped. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01265">1265</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1265</span>                                                        {</div>
<div class="line"><span class="lineno"> 1266</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 1267</span>            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1268</span>        }</div>
<div class="line"><span class="lineno"> 1269</span>        </div>
<div class="line"><span class="lineno"> 1270</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1271</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1272</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1273</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::mul_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1274</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1275</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1276</span>        {</div>
<div class="line"><span class="lineno"> 1277</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1278</span>                <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] *= <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1279</span>            }</div>
<div class="line"><span class="lineno"> 1280</span>        }</div>
<div class="line"><span class="lineno"> 1281</span>        </div>
<div class="line"><span class="lineno"> 1282</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1283</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aab73fe3969bc9ab6b35a89c3787f2a22" name="aab73fe3969bc9ab6b35a89c3787f2a22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab73fe3969bc9ab6b35a89c3787f2a22">&#9670;&#160;</a></span>operator+() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator+ </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise addition with scalar (creates new tensor). Supports automatic differentiation. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to add to all elements. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with the result. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00943">943</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  943</span>                                                  {</div>
<div class="line"><span class="lineno">  944</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno">  945</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  946</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno">  947</span>        </div>
<div class="line"><span class="lineno">  948</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  949</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno">  950</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::add_scalar_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">scalar</a>, <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno">  951</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  952</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  953</span>        {</div>
<div class="line"><span class="lineno">  954</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno">  955</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] + <a class="code hl_class" href="classTensor.html">scalar</a>;</div>
<div class="line"><span class="lineno">  956</span>            }</div>
<div class="line"><span class="lineno">  957</span>        }</div>
<div class="line"><span class="lineno">  958</span>        </div>
<div class="line"><span class="lineno">  959</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno">  960</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno">  961</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno">  962</span>            </div>
<div class="line"><span class="lineno">  963</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno">  964</span>                <span class="comment">// Gradient of addition with scalar: d/dx(x+c) = 1</span></div>
<div class="line"><span class="lineno">  965</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno">  966</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno">  967</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  968</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno">  969</span>                    }</div>
<div class="line"><span class="lineno">  970</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno">  971</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno">  972</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno">  973</span>                    }</div>
<div class="line"><span class="lineno">  974</span>                    </div>
<div class="line"><span class="lineno">  975</span>                    <span class="comment">// If self is not a leaf, propagate gradients further</span></div>
<div class="line"><span class="lineno">  976</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno">  977</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno">  978</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno">  979</span>                        }</div>
<div class="line"><span class="lineno">  980</span>                    }</div>
<div class="line"><span class="lineno">  981</span>                }</div>
<div class="line"><span class="lineno">  982</span>            });</div>
<div class="line"><span class="lineno">  983</span>        }</div>
<div class="line"><span class="lineno">  984</span>        </div>
<div class="line"><span class="lineno">  985</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno">  986</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1947fa453cc8c0a746b26d2481bb6b39" name="a1947fa453cc8c0a746b26d2481bb6b39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1947fa453cc8c0a746b26d2481bb6b39">&#9670;&#160;</a></span>operator+() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator+ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Element-wise addition with another tensor (creates new tensor). </p>
<p>Performs element-wise addition of two tensors. Supports automatic differentiation and will track gradients if either input requires gradients.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to add </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing either a new tensor with the result or <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa2664c241558d7674e8ed4d5f63d2e463" title="Tensor dimensions do not match for the operation.">TensorError::DimensionMismatch</a></dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_add"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> A({2, 3});</div>
<div class="line"><a class="code hl_class" href="classTensor.html">Tensor&lt;float, 2&gt;</a> B({2, 3});</div>
<div class="line">A.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(1.0f);</div>
<div class="line">B.fill(2.0f);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> result = A + B;  <span class="comment">// Returns TensorResult&lt;Tensor&lt;float, 2&gt;&gt;</span></div>
<div class="line"><span class="keywordflow">if</span> (std::holds_alternative&lt;<a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a>&gt;(result)) {</div>
<div class="line">    <span class="keyword">auto</span>&amp; C = std::get&lt;Tensor&lt;float, 2&gt;&gt;(result);</div>
<div class="line">    <span class="comment">// C[{i, j}] == 3.0 for all i, j</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// With autograd:</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> x({3}, <span class="keyword">true</span>, <span class="keyword">true</span>);  <span class="comment">// requires_grad=true</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> y({3}, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="keyword">auto</span> z_result = x + y;</div>
<div class="line"><span class="keyword">auto</span>&amp; z = std::get&lt;Tensor&lt;float, 1&gt;&gt;(z_result);</div>
<div class="line">z.backward();  <span class="comment">// Computes gradients</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00867">867</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  867</span>                                                                          {</div>
<div class="line"><span class="lineno">  868</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno">  869</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno">  870</span>        }</div>
<div class="line"><span class="lineno">  871</span>        </div>
<div class="line"><span class="lineno">  872</span>        <span class="keywordtype">bool</span> <a class="code hl_class" href="classTensor.html">track_grad</a> = <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a> || <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>;</div>
<div class="line"><span class="lineno">  873</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_class" href="classTensor.html">track_grad</a>);</div>
<div class="line"><span class="lineno">  874</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  875</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno">  876</span>        </div>
<div class="line"><span class="lineno">  877</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  878</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno">  879</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::add_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno">  880</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  881</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  882</span>        {</div>
<div class="line"><span class="lineno">  883</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno">  884</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] + <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno">  885</span>            }</div>
<div class="line"><span class="lineno">  886</span>        }</div>
<div class="line"><span class="lineno">  887</span>        </div>
<div class="line"><span class="lineno">  888</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno">  889</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">track_grad</a>) {</div>
<div class="line"><span class="lineno">  890</span>            <span class="comment">// Capture pointers to input tensors</span></div>
<div class="line"><span class="lineno">  891</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno">  892</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">other_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_class" href="classTensor.html">other</a>);</div>
<div class="line"><span class="lineno">  893</span>            </div>
<div class="line"><span class="lineno">  894</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">other_ptr</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno">  895</span>                <span class="comment">// Gradient of addition: d/dx(x+y) = 1, d/dy(x+y) = 1</span></div>
<div class="line"><span class="lineno">  896</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno">  897</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno">  898</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  899</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno">  900</span>                    }</div>
<div class="line"><span class="lineno">  901</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno">  902</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno">  903</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno">  904</span>                    }</div>
<div class="line"><span class="lineno">  905</span>                    </div>
<div class="line"><span class="lineno">  906</span>                    <span class="comment">// If self is not a leaf, propagate gradients further</span></div>
<div class="line"><span class="lineno">  907</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno">  908</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno">  909</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno">  910</span>                        }</div>
<div class="line"><span class="lineno">  911</span>                    }</div>
<div class="line"><span class="lineno">  912</span>                }</div>
<div class="line"><span class="lineno">  913</span>                </div>
<div class="line"><span class="lineno">  914</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno">  915</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno">  916</span>                        <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  917</span>                        <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno">  918</span>                    }</div>
<div class="line"><span class="lineno">  919</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno">  920</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno">  921</span>                        <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno">  922</span>                    }</div>
<div class="line"><span class="lineno">  923</span>                    </div>
<div class="line"><span class="lineno">  924</span>                    <span class="comment">// If other is not a leaf, propagate gradients further</span></div>
<div class="line"><span class="lineno">  925</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno">  926</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno">  927</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno">  928</span>                        }</div>
<div class="line"><span class="lineno">  929</span>                    }</div>
<div class="line"><span class="lineno">  930</span>                }</div>
<div class="line"><span class="lineno">  931</span>            });</div>
<div class="line"><span class="lineno">  932</span>        }</div>
<div class="line"><span class="lineno">  933</span>        </div>
<div class="line"><span class="lineno">  934</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno">  935</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4613cd0a8fdde8d4e067384adcba7015" name="a4613cd0a8fdde8d4e067384adcba7015"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4613cd0a8fdde8d4e067384adcba7015">&#9670;&#160;</a></span>operator+=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator+= </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise addition with scalar (in-place). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to add to all elements. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01019">1019</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1019</span>                                              {</div>
<div class="line"><span class="lineno"> 1020</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1021</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1022</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1023</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::add_scalar_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">scalar</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1024</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1025</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1026</span>        {</div>
<div class="line"><span class="lineno"> 1027</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1028</span>                <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_class" href="classTensor.html">scalar</a>;</div>
<div class="line"><span class="lineno"> 1029</span>            }</div>
<div class="line"><span class="lineno"> 1030</span>        }</div>
<div class="line"><span class="lineno"> 1031</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1032</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afe3aaaf08972bed6b0ea4b7b0eb03689" name="afe3aaaf08972bed6b0ea4b7b0eb03689"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe3aaaf08972bed6b0ea4b7b0eb03689">&#9670;&#160;</a></span>operator+=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator+= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise addition with another tensor (in-place). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to add. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>If dimensions don't match, the operation is skipped. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00994">994</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  994</span>                                                        {</div>
<div class="line"><span class="lineno">  995</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno">  996</span>            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno">  997</span>        }</div>
<div class="line"><span class="lineno">  998</span>        </div>
<div class="line"><span class="lineno">  999</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1000</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1001</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1002</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::add_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1003</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1004</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1005</span>        {</div>
<div class="line"><span class="lineno"> 1006</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1007</span>                <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1008</span>            }</div>
<div class="line"><span class="lineno"> 1009</span>        }</div>
<div class="line"><span class="lineno"> 1010</span>        </div>
<div class="line"><span class="lineno"> 1011</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1012</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a79cd53c980f1a1dde80fc6eeba73743a" name="a79cd53c980f1a1dde80fc6eeba73743a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79cd53c980f1a1dde80fc6eeba73743a">&#9670;&#160;</a></span>operator-() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator- </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Unary negation operator (creates new tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with all elements negated. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01405">1405</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1405</span>                                   {</div>
<div class="line"><span class="lineno"> 1406</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1407</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1408</span>        </div>
<div class="line"><span class="lineno"> 1409</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1410</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = -<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1411</span>        }</div>
<div class="line"><span class="lineno"> 1412</span>        </div>
<div class="line"><span class="lineno"> 1413</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1414</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0b67c5a06ac74ab08db3f00e400e61af" name="a0b67c5a06ac74ab08db3f00e400e61af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b67c5a06ac74ab08db3f00e400e61af">&#9670;&#160;</a></span>operator-() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator- </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise subtraction with scalar (creates new tensor). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to subtract from all elements. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with the result. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01066">1066</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1066</span>                                                  {</div>
<div class="line"><span class="lineno"> 1067</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1068</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1069</span>        </div>
<div class="line"><span class="lineno"> 1070</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1071</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1072</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::sub_scalar_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">scalar</a>, <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1073</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1074</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1075</span>        {</div>
<div class="line"><span class="lineno"> 1076</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1077</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] - <a class="code hl_class" href="classTensor.html">scalar</a>;</div>
<div class="line"><span class="lineno"> 1078</span>            }</div>
<div class="line"><span class="lineno"> 1079</span>        }</div>
<div class="line"><span class="lineno"> 1080</span>        </div>
<div class="line"><span class="lineno"> 1081</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1082</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad2e51c1fbe247b637e415e60c3993ea9" name="ad2e51c1fbe247b637e415e60c3993ea9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2e51c1fbe247b637e415e60c3993ea9">&#9670;&#160;</a></span>operator-() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator- </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise subtraction with another tensor (creates new tensor). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to subtract. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing either a new tensor with the result or an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01039">1039</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1039</span>                                                                          {</div>
<div class="line"><span class="lineno"> 1040</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 1041</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 1042</span>        }</div>
<div class="line"><span class="lineno"> 1043</span>        </div>
<div class="line"><span class="lineno"> 1044</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1045</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1046</span>        </div>
<div class="line"><span class="lineno"> 1047</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1048</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1049</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::sub_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1050</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1051</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1052</span>        {</div>
<div class="line"><span class="lineno"> 1053</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1054</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] - <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1055</span>            }</div>
<div class="line"><span class="lineno"> 1056</span>        }</div>
<div class="line"><span class="lineno"> 1057</span>        </div>
<div class="line"><span class="lineno"> 1058</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1059</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a42121a48ea8b32bcfb25e3b59834bc5c" name="a42121a48ea8b32bcfb25e3b59834bc5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42121a48ea8b32bcfb25e3b59834bc5c">&#9670;&#160;</a></span>operator-=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator-= </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise subtraction with scalar (in-place). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to subtract from all elements. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01115">1115</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1115</span>                                              {</div>
<div class="line"><span class="lineno"> 1116</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1117</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1118</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1119</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::sub_scalar_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">scalar</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1120</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1121</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1122</span>        {</div>
<div class="line"><span class="lineno"> 1123</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1124</span>                <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] -= <a class="code hl_class" href="classTensor.html">scalar</a>;</div>
<div class="line"><span class="lineno"> 1125</span>            }</div>
<div class="line"><span class="lineno"> 1126</span>        }</div>
<div class="line"><span class="lineno"> 1127</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1128</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a57e4d2c4f4d08e48b1a1c0abe573c39c" name="a57e4d2c4f4d08e48b1a1c0abe573c39c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57e4d2c4f4d08e48b1a1c0abe573c39c">&#9670;&#160;</a></span>operator-=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator-= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise subtraction with another tensor (in-place). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to subtract. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>If dimensions don't match, the operation is skipped. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01090">1090</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1090</span>                                                        {</div>
<div class="line"><span class="lineno"> 1091</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 1092</span>            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1093</span>        }</div>
<div class="line"><span class="lineno"> 1094</span>        </div>
<div class="line"><span class="lineno"> 1095</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1096</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1097</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1098</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::sub_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1099</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1100</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1101</span>        {</div>
<div class="line"><span class="lineno"> 1102</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1103</span>                <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] -= <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1104</span>            }</div>
<div class="line"><span class="lineno"> 1105</span>        }</div>
<div class="line"><span class="lineno"> 1106</span>        </div>
<div class="line"><span class="lineno"> 1107</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1108</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aecba99a38d50cec2aa5009513481e2d1" name="aecba99a38d50cec2aa5009513481e2d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecba99a38d50cec2aa5009513481e2d1">&#9670;&#160;</a></span>operator/() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator/ </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise division with scalar (creates new tensor). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to divide all elements by. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with the result. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01337">1337</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1337</span>                                                  {</div>
<div class="line"><span class="lineno"> 1338</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1339</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1340</span>        </div>
<div class="line"><span class="lineno"> 1341</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1342</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1343</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::div_scalar_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">scalar</a>, <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1344</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1345</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1346</span>        {</div>
<div class="line"><span class="lineno"> 1347</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1348</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] / <a class="code hl_class" href="classTensor.html">scalar</a>;</div>
<div class="line"><span class="lineno"> 1349</span>            }</div>
<div class="line"><span class="lineno"> 1350</span>        }</div>
<div class="line"><span class="lineno"> 1351</span>        </div>
<div class="line"><span class="lineno"> 1352</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1353</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e414490131d73889ccb977cc4ef047b" name="a0e414490131d73889ccb977cc4ef047b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e414490131d73889ccb977cc4ef047b">&#9670;&#160;</a></span>operator/() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator/ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise division with another tensor (creates new tensor). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to divide by. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing either a new tensor with the result or an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01310">1310</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1310</span>                                                                          {</div>
<div class="line"><span class="lineno"> 1311</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 1312</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 1313</span>        }</div>
<div class="line"><span class="lineno"> 1314</span>        </div>
<div class="line"><span class="lineno"> 1315</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1316</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1317</span>        </div>
<div class="line"><span class="lineno"> 1318</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1319</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1320</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::div_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1321</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1322</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1323</span>        {</div>
<div class="line"><span class="lineno"> 1324</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1325</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] / <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1326</span>            }</div>
<div class="line"><span class="lineno"> 1327</span>        }</div>
<div class="line"><span class="lineno"> 1328</span>        </div>
<div class="line"><span class="lineno"> 1329</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1330</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af5d1375e8ccabc8e28631c6caf597699" name="af5d1375e8ccabc8e28631c6caf597699"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5d1375e8ccabc8e28631c6caf597699">&#9670;&#160;</a></span>operator/=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator/= </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise division with scalar (in-place). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to divide all elements by. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01386">1386</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1386</span>                                              {</div>
<div class="line"><span class="lineno"> 1387</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1388</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1389</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1390</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::div_scalar_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">scalar</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1391</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1392</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1393</span>        {</div>
<div class="line"><span class="lineno"> 1394</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1395</span>                <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] /= <a class="code hl_class" href="classTensor.html">scalar</a>;</div>
<div class="line"><span class="lineno"> 1396</span>            }</div>
<div class="line"><span class="lineno"> 1397</span>        }</div>
<div class="line"><span class="lineno"> 1398</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1399</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad83f8e7f5e6a51fe67a6ec3a25662f63" name="ad83f8e7f5e6a51fe67a6ec3a25662f63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad83f8e7f5e6a51fe67a6ec3a25662f63">&#9670;&#160;</a></span>operator/=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator/= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise division with another tensor (in-place). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to divide by. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>If dimensions don't match, the operation is skipped. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01361">1361</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1361</span>                                                        {</div>
<div class="line"><span class="lineno"> 1362</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 1363</span>            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1364</span>        }</div>
<div class="line"><span class="lineno"> 1365</span>        </div>
<div class="line"><span class="lineno"> 1366</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1367</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1368</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1369</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::div_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1370</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1371</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1372</span>        {</div>
<div class="line"><span class="lineno"> 1373</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1374</span>                <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] /= <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1375</span>            }</div>
<div class="line"><span class="lineno"> 1376</span>        }</div>
<div class="line"><span class="lineno"> 1377</span>        </div>
<div class="line"><span class="lineno"> 1378</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1379</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="acaa2ad71d3cd141fd3f0a506e492d56c" name="acaa2ad71d3cd141fd3f0a506e492d56c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaa2ad71d3cd141fd3f0a506e492d56c">&#9670;&#160;</a></span>operator&lt;() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator&lt; </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise comparison: less than scalar. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to compare with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02579">2579</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2617</span>                                                  {</div>
<div class="line"><span class="lineno"> 2618</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2619</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2620</span>        </div>
<div class="line"><span class="lineno"> 2621</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2622</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &lt; <a class="code hl_class" href="classTensor.html">scalar</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2623</span>        }</div>
<div class="line"><span class="lineno"> 2624</span>        </div>
<div class="line"><span class="lineno"> 2625</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2626</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4a37be92854759ae7891294f57666127" name="a4a37be92854759ae7891294f57666127"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a37be92854759ae7891294f57666127">&#9670;&#160;</a></span>operator&lt;() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator&lt; </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise comparison: less than. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to compare with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02579">2579</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2595</span>                                                            {</div>
<div class="line"><span class="lineno"> 2596</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 2597</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2598</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 2599</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2600</span>        }</div>
<div class="line"><span class="lineno"> 2601</span>        </div>
<div class="line"><span class="lineno"> 2602</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2603</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2604</span>        </div>
<div class="line"><span class="lineno"> 2605</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2606</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &lt; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2607</span>        }</div>
<div class="line"><span class="lineno"> 2608</span>        </div>
<div class="line"><span class="lineno"> 2609</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2610</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af1bf02c8d1a0a04ded404de0493982f2" name="af1bf02c8d1a0a04ded404de0493982f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1bf02c8d1a0a04ded404de0493982f2">&#9670;&#160;</a></span>operator&lt;=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator&lt;= </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise comparison: less than or equal scalar. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to compare with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02655">2655</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2693</span>                                                   {</div>
<div class="line"><span class="lineno"> 2694</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2695</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2696</span>        </div>
<div class="line"><span class="lineno"> 2697</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2698</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &lt;= <a class="code hl_class" href="classTensor.html">scalar</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2699</span>        }</div>
<div class="line"><span class="lineno"> 2700</span>        </div>
<div class="line"><span class="lineno"> 2701</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2702</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a563d023db0ab1338f2831ba24813f835" name="a563d023db0ab1338f2831ba24813f835"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a563d023db0ab1338f2831ba24813f835">&#9670;&#160;</a></span>operator&lt;=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator&lt;= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise comparison: less than or equal. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to compare with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02655">2655</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2671</span>                                                             {</div>
<div class="line"><span class="lineno"> 2672</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 2673</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2674</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 2675</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2676</span>        }</div>
<div class="line"><span class="lineno"> 2677</span>        </div>
<div class="line"><span class="lineno"> 2678</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2679</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2680</span>        </div>
<div class="line"><span class="lineno"> 2681</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2682</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &lt;= <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2683</span>        }</div>
<div class="line"><span class="lineno"> 2684</span>        </div>
<div class="line"><span class="lineno"> 2685</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2686</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a129f7f00cdc80a5ad067a8eb3c910290" name="a129f7f00cdc80a5ad067a8eb3c910290"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a129f7f00cdc80a5ad067a8eb3c910290">&#9670;&#160;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a> &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Assignment operator for deep copying the tensor. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to copy from. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to the assigned tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00582">582</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  582</span>                                           {</div>
<div class="line"><span class="lineno">  583</span>        <span class="keywordflow">if</span> (<span class="keyword">this</span> != &amp;<a class="code hl_class" href="classTensor.html">other</a>) {</div>
<div class="line"><span class="lineno">  584</span>            <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno">  585</span>            <a class="code hl_variable" href="#af6821d656bfc94c60fe4cd256c1d7402">strides_</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#af6821d656bfc94c60fe4cd256c1d7402">strides_</a>;</div>
<div class="line"><span class="lineno">  586</span>            <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>;</div>
<div class="line"><span class="lineno">  587</span>            <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>;</div>
<div class="line"><span class="lineno">  588</span>            <a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a>;</div>
<div class="line"><span class="lineno">  589</span>            <a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>;</div>
<div class="line"><span class="lineno">  590</span>            </div>
<div class="line"><span class="lineno">  591</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno">  592</span>            <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;T[]&gt;</a>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno">  593</span>            <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_class" href="classTensor.html">total</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno">  594</span>            </div>
<div class="line"><span class="lineno">  595</span>            <span class="comment">// Copy gradient if it exists</span></div>
<div class="line"><span class="lineno">  596</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno">  597</span>                <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(*<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno">  598</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  599</span>                <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>.reset();</div>
<div class="line"><span class="lineno">  600</span>            }</div>
<div class="line"><span class="lineno">  601</span>        }</div>
<div class="line"><span class="lineno">  602</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno">  603</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a214d0fc69786dddb10d1b334845b29f9" name="a214d0fc69786dddb10d1b334845b29f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a214d0fc69786dddb10d1b334845b29f9">&#9670;&#160;</a></span>operator&gt;() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator&gt; </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise comparison: greater than scalar. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to compare with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02579">2579</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2579</span>                                                  {</div>
<div class="line"><span class="lineno"> 2580</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2581</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2582</span>        </div>
<div class="line"><span class="lineno"> 2583</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2584</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt; <a class="code hl_class" href="classTensor.html">scalar</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2585</span>        }</div>
<div class="line"><span class="lineno"> 2586</span>        </div>
<div class="line"><span class="lineno"> 2587</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2588</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a26deab87b696076f055af17f4386b4d0" name="a26deab87b696076f055af17f4386b4d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26deab87b696076f055af17f4386b4d0">&#9670;&#160;</a></span>operator&gt;() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator&gt; </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise comparison: greater than. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to compare with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02557">2557</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2557</span>                                                            {</div>
<div class="line"><span class="lineno"> 2558</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 2559</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2560</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 2561</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2562</span>        }</div>
<div class="line"><span class="lineno"> 2563</span>        </div>
<div class="line"><span class="lineno"> 2564</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2565</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2566</span>        </div>
<div class="line"><span class="lineno"> 2567</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2568</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2569</span>        }</div>
<div class="line"><span class="lineno"> 2570</span>        </div>
<div class="line"><span class="lineno"> 2571</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2572</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac107bd4eaca6b12fe51303a692e9ea81" name="ac107bd4eaca6b12fe51303a692e9ea81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac107bd4eaca6b12fe51303a692e9ea81">&#9670;&#160;</a></span>operator&gt;=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator&gt;= </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise comparison: greater than or equal scalar. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to compare with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02655">2655</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2655</span>                                                   {</div>
<div class="line"><span class="lineno"> 2656</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2657</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2658</span>        </div>
<div class="line"><span class="lineno"> 2659</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2660</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt;= <a class="code hl_class" href="classTensor.html">scalar</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2661</span>        }</div>
<div class="line"><span class="lineno"> 2662</span>        </div>
<div class="line"><span class="lineno"> 2663</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2664</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2cab1fc8ca70e8d2fa4bce5ff88fabe1" name="a2cab1fc8ca70e8d2fa4bce5ff88fabe1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cab1fc8ca70e8d2fa4bce5ff88fabe1">&#9670;&#160;</a></span>operator&gt;=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator&gt;= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise comparison: greater than or equal. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to compare with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02633">2633</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2633</span>                                                             {</div>
<div class="line"><span class="lineno"> 2634</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 2635</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2636</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 2637</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2638</span>        }</div>
<div class="line"><span class="lineno"> 2639</span>        </div>
<div class="line"><span class="lineno"> 2640</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2641</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2642</span>        </div>
<div class="line"><span class="lineno"> 2643</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2644</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt;= <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2645</span>        }</div>
<div class="line"><span class="lineno"> 2646</span>        </div>
<div class="line"><span class="lineno"> 2647</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2648</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="acd343a064481a9fc4a0c8f3d17fc489c" name="acd343a064481a9fc4a0c8f3d17fc489c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd343a064481a9fc4a0c8f3d17fc489c">&#9670;&#160;</a></span>operator[]() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator[] </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>indices</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Indexing operator to access elements. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">indices</td><td>An array of indices for each dimension. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to the element at the specified indices. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00610">610</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  610</span>                                                   {</div>
<div class="line"><span class="lineno">  611</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_function" href="#acfd498e431d2689e191c1e9cb8d600fb">offset</a>(<a class="code hl_class" href="classTensor.html">indices</a>)];</div>
<div class="line"><span class="lineno">  612</span>    }</div>
<div class="ttc" id="aclassTensor_html_acfd498e431d2689e191c1e9cb8d600fb"><div class="ttname"><a href="#acfd498e431d2689e191c1e9cb8d600fb">Tensor::offset</a></div><div class="ttdeci">size_t offset(const TensorIndices&lt; N &gt; &amp;indices) const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00464">tensor.h:464</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9f1420cd0be3272bdb3b9a3f53d58c76" name="a9f1420cd0be3272bdb3b9a3f53d58c76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f1420cd0be3272bdb3b9a3f53d58c76">&#9670;&#160;</a></span>operator[]() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const T &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator[] </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>indices</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Const version of the indexing operator. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">indices</td><td>An array of indices for each dimension. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A const reference to the element at the specified indices. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00619">619</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  619</span>                                                               {</div>
<div class="line"><span class="lineno">  620</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_function" href="#acfd498e431d2689e191c1e9cb8d600fb">offset</a>(<a class="code hl_class" href="classTensor.html">indices</a>)];</div>
<div class="line"><span class="lineno">  621</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2429005aeaabb920c7cc943f044dd9d8" name="a2429005aeaabb920c7cc943f044dd9d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2429005aeaabb920c7cc943f044dd9d8">&#9670;&#160;</a></span>permute()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::permute </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>axes</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Permute (rearrange) dimensions. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axes</td><td>New order of dimensions (must be a permutation of 0..N-1) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> with permuted dimensions, or zero tensor if axes is invalid </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04086">4086</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4086</span>                                                             {</div>
<div class="line"><span class="lineno"> 4087</span>        <span class="comment">// Validate that axes is a permutation</span></div>
<div class="line"><span class="lineno"> 4088</span>        <a class="code hl_class" href="classTensor.html">std::array&lt;bool, N&gt;</a> <a class="code hl_class" href="classTensor.html">seen</a> = {<span class="keyword">false</span>};</div>
<div class="line"><span class="lineno"> 4089</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4090</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axes</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt;= <a class="code hl_class" href="classTensor.html">N</a> || <a class="code hl_class" href="classTensor.html">seen</a>[<a class="code hl_class" href="classTensor.html">axes</a>[<a class="code hl_class" href="classTensor.html">i</a>]]) {</div>
<div class="line"><span class="lineno"> 4091</span>                <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 4092</span>                <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4093</span>            }</div>
<div class="line"><span class="lineno"> 4094</span>            <a class="code hl_class" href="classTensor.html">seen</a>[<a class="code hl_class" href="classTensor.html">axes</a>[<a class="code hl_class" href="classTensor.html">i</a>]] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4095</span>        }</div>
<div class="line"><span class="lineno"> 4096</span>        </div>
<div class="line"><span class="lineno"> 4097</span>        <span class="comment">// Compute new dimensions</span></div>
<div class="line"><span class="lineno"> 4098</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a>;</div>
<div class="line"><span class="lineno"> 4099</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4100</span>            <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axes</a>[<a class="code hl_class" href="classTensor.html">i</a>]];</div>
<div class="line"><span class="lineno"> 4101</span>        }</div>
<div class="line"><span class="lineno"> 4102</span>        </div>
<div class="line"><span class="lineno"> 4103</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4104</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4105</span>        </div>
<div class="line"><span class="lineno"> 4106</span>        <span class="comment">// Permute data</span></div>
<div class="line"><span class="lineno"> 4107</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4108</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">idx</a> = 0; <a class="code hl_class" href="classTensor.html">idx</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">idx</a>) {</div>
<div class="line"><span class="lineno"> 4109</span>            <span class="comment">// Convert linear index to multi-dimensional indices</span></div>
<div class="line"><span class="lineno"> 4110</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">src_idx</a>;</div>
<div class="line"><span class="lineno"> 4111</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 4112</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">N</a>-1; <a class="code hl_class" href="classTensor.html">i</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4113</span>                <a class="code hl_class" href="classTensor.html">src_idx</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4114</span>                <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4115</span>            }</div>
<div class="line"><span class="lineno"> 4116</span>            </div>
<div class="line"><span class="lineno"> 4117</span>            <span class="comment">// Permute indices</span></div>
<div class="line"><span class="lineno"> 4118</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">dst_idx</a>;</div>
<div class="line"><span class="lineno"> 4119</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4120</span>                <a class="code hl_class" href="classTensor.html">dst_idx</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">src_idx</a>[<a class="code hl_class" href="classTensor.html">axes</a>[<a class="code hl_class" href="classTensor.html">i</a>]];</div>
<div class="line"><span class="lineno"> 4121</span>            }</div>
<div class="line"><span class="lineno"> 4122</span>            </div>
<div class="line"><span class="lineno"> 4123</span>            <a class="code hl_class" href="classTensor.html">result</a>[<a class="code hl_class" href="classTensor.html">dst_idx</a>] = (*this)[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 4124</span>        }</div>
<div class="line"><span class="lineno"> 4125</span>        </div>
<div class="line"><span class="lineno"> 4126</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 4127</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4128</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">inv_axes</a>;</div>
<div class="line"><span class="lineno"> 4129</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4130</span>                <a class="code hl_class" href="classTensor.html">inv_axes</a>[<a class="code hl_class" href="classTensor.html">axes</a>[<a class="code hl_class" href="classTensor.html">i</a>]] = <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4131</span>            }</div>
<div class="line"><span class="lineno"> 4132</span>            </div>
<div class="line"><span class="lineno"> 4133</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4134</span>            </div>
<div class="line"><span class="lineno"> 4135</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">inv_axes</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 4136</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4137</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4138</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, </div>
<div class="line"><span class="lineno"> 4139</span>                                                                          <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4140</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4141</span>                    }</div>
<div class="line"><span class="lineno"> 4142</span>                    </div>
<div class="line"><span class="lineno"> 4143</span>                    <span class="comment">// Gradient flows back with inverse permutation</span></div>
<div class="line"><span class="lineno"> 4144</span>                    <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">grad_permuted</a> = <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.permute(<a class="code hl_class" href="classTensor.html">inv_axes</a>);</div>
<div class="line"><span class="lineno"> 4145</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4146</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4147</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_class" href="classTensor.html">grad_permuted</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4148</span>                    }</div>
<div class="line"><span class="lineno"> 4149</span>                    </div>
<div class="line"><span class="lineno"> 4150</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4151</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4152</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4153</span>                        }</div>
<div class="line"><span class="lineno"> 4154</span>                    }</div>
<div class="line"><span class="lineno"> 4155</span>                }</div>
<div class="line"><span class="lineno"> 4156</span>            });</div>
<div class="line"><span class="lineno"> 4157</span>        }</div>
<div class="line"><span class="lineno"> 4158</span>        </div>
<div class="line"><span class="lineno"> 4159</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4160</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aed782eb734b3ef0dd50e5355e3d883c8" name="aed782eb734b3ef0dd50e5355e3d883c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed782eb734b3ef0dd50e5355e3d883c8">&#9670;&#160;</a></span>pow()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::pow </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>exponent</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply power function to all elements (creates new tensor). </p>
<p>Computes x^exponent for each element. Uses GPU acceleration when available. Supports automatic differentiation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exponent</td><td>The exponent to raise each element to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with pow(x, exponent) applied to all elements</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_pow"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> vec({3});</div>
<div class="line">vec.fill(2.0f);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> squared = vec.pow(2.0f);    <span class="comment">// All elements = 4.0</span></div>
<div class="line"><span class="keyword">auto</span> cubed = vec.pow(3.0f);      <span class="comment">// All elements = 8.0</span></div>
<div class="line"><span class="keyword">auto</span> rooted = vec.pow(0.5f);     <span class="comment">// All elements  1.414 (square root)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// With autograd:</span></div>
<div class="line"><a class="code hl_class" href="classTensor.html">Tensor&lt;float, 1&gt;</a> x({5}, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line">x.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(2.0f);</div>
<div class="line"><span class="keyword">auto</span> y = x.pow(3.0f).sum();  <span class="comment">// sum(x)</span></div>
<div class="line">y.backward();</div>
<div class="line"><span class="comment">// x.grad() contains 3*x</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01631">1631</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1631</span>                                       {</div>
<div class="line"><span class="lineno"> 1632</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1633</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1634</span>        </div>
<div class="line"><span class="lineno"> 1635</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1636</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1637</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::pow_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">exponent</a>, <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1638</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1639</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1640</span>        {</div>
<div class="line"><span class="lineno"> 1641</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1642</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::pow</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>], <a class="code hl_class" href="classTensor.html">exponent</a>);</div>
<div class="line"><span class="lineno"> 1643</span>            }</div>
<div class="line"><span class="lineno"> 1644</span>        }</div>
<div class="line"><span class="lineno"> 1645</span>        </div>
<div class="line"><span class="lineno"> 1646</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1647</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="acf750ad4eaebe934c9422566ccb63081" name="acf750ad4eaebe934c9422566ccb63081"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf750ad4eaebe934c9422566ccb63081">&#9670;&#160;</a></span>pow_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::pow_derivative </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>exponent</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of power function. d/dx[x^n] = n * x^(n-1) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exponent</td><td>The exponent used in the power function. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with power derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02140">2140</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2140</span>                                                  {</div>
<div class="line"><span class="lineno"> 2141</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([<a class="code hl_class" href="classTensor.html">exponent</a>](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { </div>
<div class="line"><span class="lineno"> 2142</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">exponent</a> * <a class="code hl_class" href="classTensor.html">std::pow</a>(<a class="code hl_class" href="classTensor.html">x</a>, <a class="code hl_class" href="classTensor.html">exponent</a> - <a class="code hl_class" href="classTensor.html">T</a>(1)); </div>
<div class="line"><span class="lineno"> 2143</span>        });</div>
<div class="line"><span class="lineno"> 2144</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afc82c153b9df7088bd28dedb89cf7855" name="afc82c153b9df7088bd28dedb89cf7855"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc82c153b9df7088bd28dedb89cf7855">&#9670;&#160;</a></span>prod()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::prod </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Product of all elements. </p><dl class="section return"><dt>Returns</dt><dd>The product of all tensor elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04900">4900</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4900</span>                   {</div>
<div class="line"><span class="lineno"> 4901</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">result</a> = <a class="code hl_class" href="classTensor.html">T</a>(1);</div>
<div class="line"><span class="lineno"> 4902</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4903</span>        </div>
<div class="line"><span class="lineno"> 4904</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4905</span>            <a class="code hl_class" href="classTensor.html">result</a> *= <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4906</span>        }</div>
<div class="line"><span class="lineno"> 4907</span>        </div>
<div class="line"><span class="lineno"> 4908</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4909</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aedbf41ac61911d6ac3dcd6fc32b89f2c" name="aedbf41ac61911d6ac3dcd6fc32b89f2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedbf41ac61911d6ac3dcd6fc32b89f2c">&#9670;&#160;</a></span>put()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::put </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; size_t &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>indices</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>values</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set elements at specific flat indices (fancy indexing assignment). Treats the tensor as a flattened 1D array and sets values at the given indices. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">indices</td><td><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b" title="Type alias for 1D vectors.">Vector</a> of flat indices to set. </td></tr>
    <tr><td class="paramname">values</td><td><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b" title="Type alias for 1D vectors.">Vector</a> of values to set (must match indices size). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04424">4424</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4424</span>                                                                           {</div>
<div class="line"><span class="lineno"> 4425</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">count</a> = <a class="code hl_class" href="classTensor.html">std::min</a>(<a class="code hl_class" href="classTensor.html">indices</a>.size(), <a class="code hl_class" href="classTensor.html">values</a>.size());</div>
<div class="line"><span class="lineno"> 4426</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4427</span>        </div>
<div class="line"><span class="lineno"> 4428</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">count</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4429</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">indices</a>[<a class="code hl_class" href="classTensor.html">i</a>] &lt; <a class="code hl_class" href="classTensor.html">total</a>) {</div>
<div class="line"><span class="lineno"> 4430</span>                <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">indices</a>[<a class="code hl_class" href="classTensor.html">i</a>]] = <a class="code hl_class" href="classTensor.html">values</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4431</span>            }</div>
<div class="line"><span class="lineno"> 4432</span>        }</div>
<div class="line"><span class="lineno"> 4433</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a33b18c3717d32fa9bf3bc40a988523fe" name="a33b18c3717d32fa9bf3bc40a988523fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33b18c3717d32fa9bf3bc40a988523fe">&#9670;&#160;</a></span>quantile()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::quantile </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>q</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute quantile of all elements. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>Quantile value between 0 and 1 (e.g., 0.25 for 25th percentile). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The quantile value or error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02407">2407</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2407</span>                                        {</div>
<div class="line"><span class="lineno"> 2408</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">q</a> &lt; <a class="code hl_class" href="classTensor.html">T</a>(0) || <a class="code hl_class" href="classTensor.html">q</a> &gt; <a class="code hl_class" href="classTensor.html">T</a>(1)) {</div>
<div class="line"><span class="lineno"> 2409</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::InvalidArgument</a>;</div>
<div class="line"><span class="lineno"> 2410</span>        }</div>
<div class="line"><span class="lineno"> 2411</span>        </div>
<div class="line"><span class="lineno"> 2412</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2413</span>        <a class="code hl_class" href="classTensor.html">std::vector&lt;T&gt;</a> <a class="code hl_class" href="classTensor.html">sorted_data</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2414</span>        <a class="code hl_class" href="classTensor.html">std::sort</a>(<a class="code hl_class" href="classTensor.html">sorted_data</a>.begin(), <a class="code hl_class" href="classTensor.html">sorted_data</a>.end());</div>
<div class="line"><span class="lineno"> 2415</span>        </div>
<div class="line"><span class="lineno"> 2416</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">pos</a> = <a class="code hl_class" href="classTensor.html">q</a> * <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">total</a> - 1);</div>
<div class="line"><span class="lineno"> 2417</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">lower</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">pos</a>);</div>
<div class="line"><span class="lineno"> 2418</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">upper</a> = <a class="code hl_class" href="classTensor.html">lower</a> + 1;</div>
<div class="line"><span class="lineno"> 2419</span>        </div>
<div class="line"><span class="lineno"> 2420</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">upper</a> &gt;= <a class="code hl_class" href="classTensor.html">total</a>) {</div>
<div class="line"><span class="lineno"> 2421</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">sorted_data</a>[<a class="code hl_class" href="classTensor.html">total</a> - 1];</div>
<div class="line"><span class="lineno"> 2422</span>        }</div>
<div class="line"><span class="lineno"> 2423</span>        </div>
<div class="line"><span class="lineno"> 2424</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">frac</a> = <a class="code hl_class" href="classTensor.html">pos</a> - <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">lower</a>);</div>
<div class="line"><span class="lineno"> 2425</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">sorted_data</a>[<a class="code hl_class" href="classTensor.html">lower</a>] * (<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">frac</a>) + <a class="code hl_class" href="classTensor.html">sorted_data</a>[<a class="code hl_class" href="classTensor.html">upper</a>] * <a class="code hl_class" href="classTensor.html">frac</a>;</div>
<div class="line"><span class="lineno"> 2426</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af274147e833dd1ab399ce08155ad169b" name="af274147e833dd1ab399ce08155ad169b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af274147e833dd1ab399ce08155ad169b">&#9670;&#160;</a></span>register_backward()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::register_backward </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tensor_8h.html#a1e846f46f87b55f57de12d6aa70eda1e">BackwardFunc</a>&lt; T, N &gt;</td>          <td class="paramname"><span class="paramname"><em>func</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Register a backward function for this tensor. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">func</td><td>The function to call during backward pass. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00833">833</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  833</span>                                                    {</div>
<div class="line"><span class="lineno">  834</span>        <a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.push_back(<a class="code hl_class" href="classTensor.html">func</a>);</div>
<div class="line"><span class="lineno">  835</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_af274147e833dd1ab399ce08155ad169b_icgraph.png" border="0" usemap="#aclassTensor_af274147e833dd1ab399ce08155ad169b_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_af274147e833dd1ab399ce08155ad169b_icgraph" id="aclassTensor_af274147e833dd1ab399ce08155ad169b_icgraph">
<area shape="rect" title=" " alt="" coords="462,427,636,453"/>
<area shape="rect" href="classTensor.html#a265342749ca5f239466cb467bbf73277" title=" " alt="" coords="255,5,388,32"/>
<area shape="poly" title=" " alt="" coords="544,411,537,338,517,239,500,187,477,135,448,88,412,46,387,31,390,26,416,42,453,85,482,133,505,185,522,238,542,337,550,411"/>
<area shape="rect" href="classTensor.html#a7a0af0b59b00d2f2623609ff3562f087" title=" " alt="" coords="230,56,414,83"/>
<area shape="poly" title=" " alt="" coords="543,411,532,346,510,261,493,217,472,173,445,132,412,97,395,85,398,81,416,93,449,129,476,170,498,214,515,260,538,345,548,411"/>
<area shape="rect" href="classTensor.html#a834720ab65874a6c5503f7670c4f22fe" title=" " alt="" coords="257,107,387,149"/>
<area shape="poly" title=" " alt="" coords="539,412,524,360,499,293,462,224,439,192,412,163,386,147,389,142,416,159,443,188,467,221,504,291,530,358,544,411"/>
<area shape="rect" href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7" title="Mean Squared Error (MSE) Loss." alt="" coords="267,173,376,200"/>
<area shape="poly" title=" " alt="" coords="537,413,520,369,494,315,458,260,437,236,412,214,395,204,376,197,378,192,397,199,416,210,440,232,462,257,498,312,525,367,542,411"/>
<area shape="rect" href="classTensor.html#a808dc758321fc810256e3efd13042c98" title=" " alt="" coords="239,224,404,251"/>
<area shape="poly" title=" " alt="" coords="532,414,513,380,486,339,452,299,413,265,391,254,393,249,415,260,456,295,490,336,518,377,537,411"/>
<area shape="rect" href="classTensor.html#af352346a629f774750b12c97234979a9" title=" " alt="" coords="239,275,404,301"/>
<area shape="poly" title=" " alt="" coords="526,416,477,365,446,338,413,316,387,304,389,300,415,311,450,334,481,361,530,413"/>
<area shape="rect" href="classTensor.html#aab73fe3969bc9ab6b35a89c3787f2a22" title=" " alt="" coords="238,325,406,352"/>
<area shape="poly" title=" " alt="" coords="513,420,467,393,413,366,380,355,382,350,415,362,469,388,516,416"/>
<area shape="rect" href="classTensor.html#a1947fa453cc8c0a746b26d2481bb6b39" title=" " alt="" coords="238,376,406,403"/>
<area shape="poly" title=" " alt="" coords="470,425,384,406,386,401,472,420"/>
<area shape="rect" href="classTensor.html#a2429005aeaabb920c7cc943f044dd9d8" title=" " alt="" coords="242,427,402,453"/>
<area shape="poly" title=" " alt="" coords="446,443,403,443,403,437,446,437"/>
<area shape="rect" href="classTensor.html#a74db7588a7150d94b620ad63de1f5980" title=" " alt="" coords="255,477,389,504"/>
<area shape="poly" title=" " alt="" coords="472,460,386,479,384,474,470,455"/>
<area shape="rect" href="classTensor.html#af7f0645bcaf472ac0f6214d2b1effd40" title=" " alt="" coords="242,528,402,555"/>
<area shape="poly" title=" " alt="" coords="516,464,469,492,415,518,382,530,380,525,413,514,467,487,513,460"/>
<area shape="rect" href="classTensor.html#afff455663faa35d6cfa72aa03f689e94" title=" " alt="" coords="243,579,401,605"/>
<area shape="poly" title=" " alt="" coords="530,467,481,519,450,546,415,569,389,580,387,576,413,564,446,542,477,515,526,464"/>
<area shape="rect" href="classTensor.html#a4ae322784a9d62e8db2c073f5e2395f7" title=" " alt="" coords="242,629,402,656"/>
<area shape="poly" title=" " alt="" coords="537,469,518,503,490,544,456,585,415,620,393,631,391,626,413,615,452,581,486,541,513,500,532,466"/>
<area shape="rect" href="classTensor.html#a46d44bb69fc3f0b7376ea35e21903b97" title=" " alt="" coords="241,680,403,707"/>
<area shape="poly" title=" " alt="" coords="542,469,525,513,498,568,462,623,440,648,416,670,396,682,393,677,412,666,437,644,458,620,494,565,520,511,537,467"/>
<area shape="rect" href="classTensor.html#ac20a4679e14de6f68e148b447496adfc" title=" " alt="" coords="237,731,406,757"/>
<area shape="poly" title=" " alt="" coords="545,469,531,522,506,590,468,661,444,693,416,721,397,732,394,728,412,717,440,689,464,658,501,588,526,521,540,468"/>
<area shape="rect" href="classTensor.html#aed9419fabd015e2c1c35ff6723c1600a" title=" " alt="" coords="237,781,407,808"/>
<area shape="poly" title=" " alt="" coords="547,469,536,532,513,613,496,656,474,698,448,737,416,771,398,783,395,779,412,767,444,734,470,695,491,654,508,611,531,531,542,468"/>
<area shape="rect" href="classTensor.html#ac953ca944380b138ad1e524a1124070f" title=" " alt="" coords="234,832,410,859"/>
<area shape="poly" title=" " alt="" coords="549,469,541,540,520,635,503,686,480,735,451,781,416,822,399,834,396,829,412,818,447,778,476,733,498,684,515,634,536,539,544,469"/>
<area shape="rect" href="classTensor.html#adf1fcb0ddd0ef2db3003401db519ec1c" title=" " alt="" coords="5,705,182,732"/>
<area shape="poly" title=" " alt="" coords="222,736,182,731,182,726,222,730"/>
<area shape="rect" href="classTensor.html#aeb3f6a9bf8ee28d46a887238a9d3d460" title=" " alt="" coords="5,756,182,783"/>
<area shape="poly" title=" " alt="" coords="222,758,182,762,182,757,222,752"/>
</map>
</div>

</div>
</div>
<a id="a74db7588a7150d94b620ad63de1f5980" name="a74db7588a7150d94b620ad63de1f5980"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74db7588a7150d94b620ad63de1f5980">&#9670;&#160;</a></span>relu()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::relu </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply ReLU (Rectified Linear Unit) to all elements (creates new tensor). </p>
<p>Computes ReLU(x) = max(0, x) for each element. Most widely used activation function in deep learning due to its simplicity and effectiveness in preventing vanishing gradients.</p>
<p>Properties:</p><ul>
<li>Non-linearity without saturation for positive values</li>
<li>Sparse activation (outputs 0 for negative inputs)</li>
<li>Computationally efficient</li>
</ul>
<p>Supports automatic differentiation.</p>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with ReLU(x) applied to all elements</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_relu"></a>
Example</h1>
<div class="fragment"><div class="line"><span class="comment">// Hidden layer in neural network</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> hidden({32, 128}, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="keyword">auto</span> activated = hidden.relu();  <span class="comment">// Apply ReLU activation</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Full network layer example:</span></div>
<div class="line"><span class="keyword">auto</span> layer1 = (input.matmul(W1) + b1).relu();</div>
<div class="line"><span class="keyword">auto</span> layer2 = (layer1.matmul(W2) + b2).relu();</div>
<div class="line"><span class="keyword">auto</span> output = layer2.matmul(W3) + b3;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// With autograd:</span></div>
<div class="line"><span class="keyword">auto</span> <a class="code hl_namespace" href="namespaceloss.html">loss</a> = <a class="code hl_function" href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7">loss::mse_loss</a>(output, target);</div>
<div class="line"><a class="code hl_namespace" href="namespaceloss.html">loss</a>.backward();  <span class="comment">// Gradients flow through ReLU layers</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01857">1857</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1857</span>                              {</div>
<div class="line"><span class="lineno"> 1858</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 1859</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1860</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1861</span>        </div>
<div class="line"><span class="lineno"> 1862</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1863</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1864</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::relu_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1865</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1866</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1867</span>        {</div>
<div class="line"><span class="lineno"> 1868</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1869</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt; <a class="code hl_class" href="classTensor.html">T</a>(0) ? <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 1870</span>            }</div>
<div class="line"><span class="lineno"> 1871</span>        }</div>
<div class="line"><span class="lineno"> 1872</span>        </div>
<div class="line"><span class="lineno"> 1873</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 1874</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 1875</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">input_copy</a> = this-&gt;<a class="code hl_function" href="#ae5b52299c11f3ba81e781cb008542285">detach</a>();</div>
<div class="line"><span class="lineno"> 1876</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 1877</span>            </div>
<div class="line"><span class="lineno"> 1878</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">input_copy</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 1879</span>                <span class="comment">// Gradient of ReLU: d/dx[ReLU(x)] = 1 if x &gt; 0, else 0</span></div>
<div class="line"><span class="lineno"> 1880</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 1881</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 1882</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1883</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 1884</span>                    }</div>
<div class="line"><span class="lineno"> 1885</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1886</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1887</span>                        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">input_copy</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt; <a class="code hl_class" href="classTensor.html">T</a>(0)) {</div>
<div class="line"><span class="lineno"> 1888</span>                            <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1889</span>                        }</div>
<div class="line"><span class="lineno"> 1890</span>                    }</div>
<div class="line"><span class="lineno"> 1891</span>                }</div>
<div class="line"><span class="lineno"> 1892</span>            });</div>
<div class="line"><span class="lineno"> 1893</span>        }</div>
<div class="line"><span class="lineno"> 1894</span>        </div>
<div class="line"><span class="lineno"> 1895</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1896</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a74db7588a7150d94b620ad63de1f5980_icgraph.png" border="0" usemap="#aclassTensor_a74db7588a7150d94b620ad63de1f5980_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a74db7588a7150d94b620ad63de1f5980_icgraph" id="aclassTensor_a74db7588a7150d94b620ad63de1f5980_icgraph">
<area shape="rect" title="Apply ReLU (Rectified Linear Unit) to all elements (creates new tensor)." alt="" coords="189,13,278,40"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1ReLU.html#a07b3b9bee90208e9510c4cc740639689" title=" " alt="" coords="5,5,141,48"/>
<area shape="poly" title=" " alt="" coords="173,29,141,29,141,24,173,24"/>
</map>
</div>

</div>
</div>
<a id="a780523f1c499b857930f305b22aae9aa" name="a780523f1c499b857930f305b22aae9aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a780523f1c499b857930f305b22aae9aa">&#9670;&#160;</a></span>relu_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::relu_derivative </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of ReLU function. d/dx[ReLU(x)] = 1 if x &gt; 0, else 0 </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with ReLU derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02093">2093</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2093</span>                                         {</div>
<div class="line"><span class="lineno"> 2094</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">x</a> &gt; <a class="code hl_class" href="classTensor.html">T</a>(0) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0); });</div>
<div class="line"><span class="lineno"> 2095</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9905069af5b17d1a5d1c16ec6f0a80fa" name="a9905069af5b17d1a5d1c16ec6f0a80fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9905069af5b17d1a5d1c16ec6f0a80fa">&#9670;&#160;</a></span>repeat()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::repeat </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>repeats</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Repeat tensor along dimensions. Each dimension is repeated the specified number of times. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">repeats</td><td>Number of times to repeat along each dimension </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with repeated elements</dd></dl>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> A({2, 3});</div>
<div class="line">A.fill(1.0f);</div>
<div class="line"><span class="keyword">auto</span> B = A.repeat({2, 3});  <span class="comment">// Result is {4, 9} with repeated values</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04972">4972</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4972</span>                                                               {</div>
<div class="line"><span class="lineno"> 4973</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a>;</div>
<div class="line"><span class="lineno"> 4974</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4975</span>            <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">repeats</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4976</span>        }</div>
<div class="line"><span class="lineno"> 4977</span>        </div>
<div class="line"><span class="lineno"> 4978</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4979</span>        </div>
<div class="line"><span class="lineno"> 4980</span>        <span class="comment">// Helper function to convert flat index to multi-dimensional indices</span></div>
<div class="line"><span class="lineno"> 4981</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">flat_to_indices</a> = [](<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">flat</a>, <span class="keyword">const</span> <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a>&amp; <a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>) {</div>
<div class="line"><span class="lineno"> 4982</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">indices</a>;</div>
<div class="line"><span class="lineno"> 4983</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">N</a> - 1; <a class="code hl_class" href="classTensor.html">i</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4984</span>                <a class="code hl_class" href="classTensor.html">indices</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">flat</a> % <a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4985</span>                <a class="code hl_class" href="classTensor.html">flat</a> /= <a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4986</span>            }</div>
<div class="line"><span class="lineno"> 4987</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">indices</a>;</div>
<div class="line"><span class="lineno"> 4988</span>        };</div>
<div class="line"><span class="lineno"> 4989</span>        </div>
<div class="line"><span class="lineno"> 4990</span>        <span class="comment">// Helper function to convert multi-dimensional indices to flat index</span></div>
<div class="line"><span class="lineno"> 4991</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">indices_to_flat</a> = [](<span class="keyword">const</span> <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a>&amp; <a class="code hl_class" href="classTensor.html">indices</a>, <span class="keyword">const</span> <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a>&amp; <a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>) {</div>
<div class="line"><span class="lineno"> 4992</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">flat</a> = 0;</div>
<div class="line"><span class="lineno"> 4993</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">multiplier</a> = 1;</div>
<div class="line"><span class="lineno"> 4994</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">N</a> - 1; <a class="code hl_class" href="classTensor.html">i</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4995</span>                <a class="code hl_class" href="classTensor.html">flat</a> += <a class="code hl_class" href="classTensor.html">indices</a>[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">multiplier</a>;</div>
<div class="line"><span class="lineno"> 4996</span>                <a class="code hl_class" href="classTensor.html">multiplier</a> *= <a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4997</span>            }</div>
<div class="line"><span class="lineno"> 4998</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">flat</a>;</div>
<div class="line"><span class="lineno"> 4999</span>        };</div>
<div class="line"><span class="lineno"> 5000</span>        </div>
<div class="line"><span class="lineno"> 5001</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total_new</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 5002</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total_new</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5003</span>            <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">new_indices</a> = <a class="code hl_class" href="classTensor.html">flat_to_indices</a>(<a class="code hl_class" href="classTensor.html">i</a>, <a class="code hl_class" href="classTensor.html">new_dims</a>);</div>
<div class="line"><span class="lineno"> 5004</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">src_indices</a>;</div>
<div class="line"><span class="lineno"> 5005</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">j</a> = 0; <a class="code hl_class" href="classTensor.html">j</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">j</a>) {</div>
<div class="line"><span class="lineno"> 5006</span>                <a class="code hl_class" href="classTensor.html">src_indices</a>[<a class="code hl_class" href="classTensor.html">j</a>] = <a class="code hl_class" href="classTensor.html">new_indices</a>[<a class="code hl_class" href="classTensor.html">j</a>] % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">j</a>];</div>
<div class="line"><span class="lineno"> 5007</span>            }</div>
<div class="line"><span class="lineno"> 5008</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">indices_to_flat</a>(<a class="code hl_class" href="classTensor.html">src_indices</a>, <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>);</div>
<div class="line"><span class="lineno"> 5009</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 5010</span>        }</div>
<div class="line"><span class="lineno"> 5011</span>        </div>
<div class="line"><span class="lineno"> 5012</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 5013</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a947326cf96b1bf3423b40861e1213ab8" name="a947326cf96b1bf3423b40861e1213ab8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a947326cf96b1bf3423b40861e1213ab8">&#9670;&#160;</a></span>requires_grad()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::requires_grad </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if this tensor requires gradients. </p><dl class="section return"><dt>Returns</dt><dd>True if gradients are being tracked. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00728">728</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  728</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>; }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a947326cf96b1bf3423b40861e1213ab8_icgraph.png" border="0" usemap="#aclassTensor_a947326cf96b1bf3423b40861e1213ab8_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a947326cf96b1bf3423b40861e1213ab8_icgraph" id="aclassTensor_a947326cf96b1bf3423b40861e1213ab8_icgraph">
<area shape="rect" title=" " alt="" coords="220,148,366,175"/>
<area shape="rect" href="namespaceloss.html#a365059b00ea1e6ec1db86710cfcf3b31" title="Binary cross entropy loss for binary classification." alt="" coords="25,5,152,48"/>
<area shape="poly" title=" " alt="" coords="266,139,223,100,170,62,149,51,151,46,173,58,226,96,269,135"/>
<area shape="rect" href="namespaceloss.html#a75edef9d102d2ab811b15c50f13c4eee" title="Cross entropy loss for multi&#45;class classification." alt="" coords="5,72,172,99"/>
<area shape="poly" title=" " alt="" coords="246,144,171,113,137,102,139,97,173,108,248,139"/>
<area shape="rect" href="namespaceloss.html#ab7fbd0200f34e3d12f66d20b681a948f" title="L1 loss (Mean Absolute Error)." alt="" coords="41,123,136,149"/>
<area shape="poly" title=" " alt="" coords="204,153,135,144,136,139,205,148"/>
<area shape="rect" href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7" title="Mean Squared Error (MSE) Loss." alt="" coords="34,173,143,200"/>
<area shape="poly" title=" " alt="" coords="205,175,144,183,143,177,204,170"/>
<area shape="rect" href="namespacelinalg.html#afbe723a0bf8fb7dc2d98815c1ea724b2" title="Normalize a vector to unit length." alt="" coords="31,224,146,251"/>
<area shape="poly" title=" " alt="" coords="248,184,173,215,139,226,137,221,171,209,246,179"/>
<area shape="rect" href="namespaceloss.html#a2d2c1dacdb37d834f7dc10e85cd1a742" title="Smooth L1 loss (Huber loss)." alt="" coords="16,275,161,301"/>
<area shape="poly" title=" " alt="" coords="270,188,227,227,173,265,147,276,145,272,170,260,224,223,266,184"/>
</map>
</div>

</div>
</div>
<a id="af7f0645bcaf472ac0f6214d2b1effd40" name="af7f0645bcaf472ac0f6214d2b1effd40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7f0645bcaf472ac0f6214d2b1effd40">&#9670;&#160;</a></span>reshape()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, M &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::reshape </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>new_dims</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Reshape tensor to new dimensions without copying data. Total size must remain the same. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">new_dims</td><td>New dimensions </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reshaped tensor (view of same data), or zero tensor if size doesn't match </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03951">3951</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3951</span>                                                                 {</div>
<div class="line"><span class="lineno"> 3952</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">new_total</a> = 1;</div>
<div class="line"><span class="lineno"> 3953</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">M</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3954</span>            <a class="code hl_class" href="classTensor.html">new_total</a> *= <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3955</span>        }</div>
<div class="line"><span class="lineno"> 3956</span>        </div>
<div class="line"><span class="lineno"> 3957</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">new_total</a> != <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>()) {</div>
<div class="line"><span class="lineno"> 3958</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;M&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 3959</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, M&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 3960</span>        }</div>
<div class="line"><span class="lineno"> 3961</span>        </div>
<div class="line"><span class="lineno"> 3962</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, M&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 3963</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3964</span>        </div>
<div class="line"><span class="lineno"> 3965</span>        <span class="comment">// Copy data</span></div>
<div class="line"><span class="lineno"> 3966</span>        <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno"> 3967</span>        </div>
<div class="line"><span class="lineno"> 3968</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 3969</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 3970</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">orig_dims</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 3971</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3972</span>            </div>
<div class="line"><span class="lineno"> 3973</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">orig_dims</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, M&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 3974</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 3975</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 3976</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">orig_dims</a>, </div>
<div class="line"><span class="lineno"> 3977</span>                                                                          <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3978</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 3979</span>                    }</div>
<div class="line"><span class="lineno"> 3980</span>                    </div>
<div class="line"><span class="lineno"> 3981</span>                    <span class="comment">// Gradient flows back with same reshape</span></div>
<div class="line"><span class="lineno"> 3982</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3983</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3984</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3985</span>                    }</div>
<div class="line"><span class="lineno"> 3986</span>                    </div>
<div class="line"><span class="lineno"> 3987</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 3988</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 3989</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 3990</span>                        }</div>
<div class="line"><span class="lineno"> 3991</span>                    }</div>
<div class="line"><span class="lineno"> 3992</span>                }</div>
<div class="line"><span class="lineno"> 3993</span>            });</div>
<div class="line"><span class="lineno"> 3994</span>        }</div>
<div class="line"><span class="lineno"> 3995</span>        </div>
<div class="line"><span class="lineno"> 3996</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3997</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa25623075f40e0244dd4c2a649e2b3d5" name="aa25623075f40e0244dd4c2a649e2b3d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa25623075f40e0244dd4c2a649e2b3d5">&#9670;&#160;</a></span>rightCols()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::rightCols </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract rightmost n columns (only for 2D tensors). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of columns to extract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>2D tensor containing rightmost n columns </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05133">5133</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5133</span>                                           {</div>
<div class="line"><span class="lineno"> 5134</span>        <a class="code hl_class" href="classTensor.html">return ::rightCols</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)), <a class="code hl_class" href="classTensor.html">n</a>);</div>
<div class="line"><span class="lineno"> 5135</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2daa379012cbb23c00fe3ac60bde0122" name="a2daa379012cbb23c00fe3ac60bde0122"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2daa379012cbb23c00fe3ac60bde0122">&#9670;&#160;</a></span>round()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::round </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply round function to all elements (creates new tensor). Rounds to nearest integer value. </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with round(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01942">1942</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1942</span>                               {</div>
<div class="line"><span class="lineno"> 1943</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::round</a>(<a class="code hl_class" href="classTensor.html">x</a>); });</div>
<div class="line"><span class="lineno"> 1944</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4ff4d01c7fdd48791ebe12a02dbeb655" name="a4ff4d01c7fdd48791ebe12a02dbeb655"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ff4d01c7fdd48791ebe12a02dbeb655">&#9670;&#160;</a></span>row()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::row </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>row_idx</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract a single row (only for 2D tensors). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">row_idx</td><td>Row index to extract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1D tensor containing the row </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05040">5040</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5040</span>                                           {</div>
<div class="line"><span class="lineno"> 5041</span>        <a class="code hl_class" href="classTensor.html">return ::row</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)), <a class="code hl_class" href="classTensor.html">row_idx</a>);</div>
<div class="line"><span class="lineno"> 5042</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a54c613dc9fe3b552a5e9de8966408fd9" name="a54c613dc9fe3b552a5e9de8966408fd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54c613dc9fe3b552a5e9de8966408fd9">&#9670;&#160;</a></span>select()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = (N &gt; 1 ? N - 1 : 1)&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if_t&lt;(N &gt; 1), <a class="el" href="classTensor.html">Tensor</a>&lt; T, M &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::select </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>dim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>index</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Select a specific index along a dimension, reducing that dimension. For example, selecting row 2 from a 2D tensor returns a 1D tensor. Only available for tensors with N &gt; 1. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dim</td><td>The dimension along which to select. </td></tr>
    <tr><td class="paramname">index</td><td>The index to select in that dimension. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A tensor with dimension N-1. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04454">4454</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4454</span>                                                                                 {</div>
<div class="line"><span class="lineno"> 4455</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">dim</a> &gt;= <a class="code hl_class" href="classTensor.html">N</a> || <a class="code hl_class" href="classTensor.html">index</a> &gt;= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a>]) {</div>
<div class="line"><span class="lineno"> 4456</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;M&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 4457</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, M&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 4458</span>        }</div>
<div class="line"><span class="lineno"> 4459</span>        </div>
<div class="line"><span class="lineno"> 4460</span>        <span class="comment">// Calculate new dimensions (removing the selected dimension)</span></div>
<div class="line"><span class="lineno"> 4461</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;M&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a>;</div>
<div class="line"><span class="lineno"> 4462</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">new_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 4463</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4464</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">i</a> != <a class="code hl_class" href="classTensor.html">dim</a>) {</div>
<div class="line"><span class="lineno"> 4465</span>                <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">new_idx</a>++] = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4466</span>            }</div>
<div class="line"><span class="lineno"> 4467</span>        }</div>
<div class="line"><span class="lineno"> 4468</span>        </div>
<div class="line"><span class="lineno"> 4469</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, M&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 4470</span>        </div>
<div class="line"><span class="lineno"> 4471</span>        <span class="comment">// Copy selected slice</span></div>
<div class="line"><span class="lineno"> 4472</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">result_total</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4473</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">stride</a> = <a class="code hl_variable" href="#af6821d656bfc94c60fe4cd256c1d7402">strides_</a>[<a class="code hl_class" href="classTensor.html">dim</a>];</div>
<div class="line"><span class="lineno"> 4474</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dim_size</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a>];</div>
<div class="line"><span class="lineno"> 4475</span>        </div>
<div class="line"><span class="lineno"> 4476</span>        <span class="comment">// Calculate outer and inner sizes</span></div>
<div class="line"><span class="lineno"> 4477</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 4478</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">dim</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4479</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4480</span>        }</div>
<div class="line"><span class="lineno"> 4481</span>        </div>
<div class="line"><span class="lineno"> 4482</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 4483</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">dim</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4484</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4485</span>        }</div>
<div class="line"><span class="lineno"> 4486</span>        </div>
<div class="line"><span class="lineno"> 4487</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4488</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4489</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">dim_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">index</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4490</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dst_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4491</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">dst_idx</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 4492</span>            }</div>
<div class="line"><span class="lineno"> 4493</span>        }</div>
<div class="line"><span class="lineno"> 4494</span>        </div>
<div class="line"><span class="lineno"> 4495</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4496</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aba945884d7b2221e4a6b35e7916ae0d9" name="aba945884d7b2221e4a6b35e7916ae0d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba945884d7b2221e4a6b35e7916ae0d9">&#9670;&#160;</a></span>set_requires_grad()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::set_requires_grad </td>
          <td>(</td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>requires_grad</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Enable gradient tracking for this tensor. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">requires_grad</td><td>Whether to require gradients. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00716">716</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  716</span>                                               {</div>
<div class="line"><span class="lineno">  717</span>        <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a> = <a class="code hl_function" href="#a947326cf96b1bf3423b40861e1213ab8">requires_grad</a>;</div>
<div class="line"><span class="lineno">  718</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a> &amp;&amp; !<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno">  719</span>            <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  720</span>            <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno">  721</span>        }</div>
<div class="line"><span class="lineno">  722</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a80b3ffaf92ed36f02d6f4d4230b5d2a0" name="a80b3ffaf92ed36f02d6f4d4230b5d2a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80b3ffaf92ed36f02d6f4d4230b5d2a0">&#9670;&#160;</a></span>shape()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::shape </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the shape of the tensor (alias for dims). </p><dl class="section return"><dt>Returns</dt><dd>An array containing the size of each dimension. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00650">650</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  650</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>; }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a80b3ffaf92ed36f02d6f4d4230b5d2a0_icgraph.png" border="0" usemap="#aclassTensor_a80b3ffaf92ed36f02d6f4d4230b5d2a0_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a80b3ffaf92ed36f02d6f4d4230b5d2a0_icgraph" id="aclassTensor_a80b3ffaf92ed36f02d6f4d4230b5d2a0_icgraph">
<area shape="rect" title=" " alt="" coords="235,227,338,253"/>
<area shape="rect" href="tensor_8h.html#a912e291f7a42f325c111def58ac98acf" title="Cast tensor to a different data type (NumPy&#45;compatible astype)." alt="" coords="66,5,126,32"/>
<area shape="poly" title=" " alt="" coords="276,212,264,174,246,129,220,84,185,46,156,31,126,24,127,18,158,26,188,42,224,81,251,127,269,172,281,211"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1BatchNorm1d.html#a48ea5fa069810067b9756e3d24b48b73" title=" " alt="" coords="5,56,187,99"/>
<area shape="poly" title=" " alt="" coords="269,215,234,163,211,136,185,113,166,101,169,97,188,109,215,132,239,160,273,212"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Dropout.html#ad7713d85865e3238e14e920b47f44237" title=" " alt="" coords="22,123,170,165"/>
<area shape="poly" title=" " alt="" coords="252,220,185,180,160,168,162,163,188,175,255,215"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Linear.html#a5364162aed6bb8c7758d88142ac74c1b" title=" " alt="" coords="28,189,164,232"/>
<area shape="poly" title=" " alt="" coords="219,232,164,224,165,219,220,227"/>
<area shape="rect" href="tensor_8h.html#a3331b6cf4ac182d022336e4d068a0e58" title="Create a copy of a tensor (NumPy&#45;compatible)." alt="" coords="71,256,121,283"/>
<area shape="poly" title=" " alt="" coords="219,253,122,268,121,263,219,248"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1BatchNorm1d.html#a8e589b2051e3a2c38b1a0feccc33bdb2" title=" " alt="" coords="5,307,187,349"/>
<area shape="poly" title=" " alt="" coords="251,264,188,297,161,309,159,304,186,292,248,259"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Dropout.html#aff0f87aa27d1aceca0bbcc6b0655ce24" title=" " alt="" coords="22,373,170,416"/>
<area shape="poly" title=" " alt="" coords="272,268,237,316,214,341,188,364,169,375,166,370,185,359,210,338,233,313,267,265"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Softmax.html#a62cc4acc056fbd4f8a365637e1159a9e" title=" " alt="" coords="21,440,171,483"/>
<area shape="poly" title=" " alt="" coords="280,269,267,305,248,348,222,392,188,430,172,442,169,437,185,426,218,389,244,346,262,303,275,267"/>
</map>
</div>

</div>
</div>
<a id="afff455663faa35d6cfa72aa03f689e94" name="afff455663faa35d6cfa72aa03f689e94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afff455663faa35d6cfa72aa03f689e94">&#9670;&#160;</a></span>sigmoid()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sigmoid </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply sigmoid function to all elements (creates new tensor). </p>
<p>Computes sigmoid(x) = 1 / (1 + exp(-x)) for each element. Commonly used as activation function in neural networks, especially for binary classification in output layers.</p>
<p>Range: (0, 1) - useful for representing probabilities. Supports automatic differentiation.</p>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with sigmoid(x) applied to all elements</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_sigmoid"></a>
Example</h1>
<div class="fragment"><div class="line"><span class="comment">// Binary classification output layer</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> logits({32, 1}, <span class="keyword">true</span>, <span class="keyword">true</span>);  <span class="comment">// batch_size=32</span></div>
<div class="line"><span class="keyword">auto</span> probs = logits.sigmoid();  <span class="comment">// Convert to probabilities in (0, 1)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// With autograd:</span></div>
<div class="line"><span class="keyword">auto</span> <a class="code hl_namespace" href="namespaceloss.html">loss</a> = <a class="code hl_function" href="namespaceloss.html#a365059b00ea1e6ec1db86710cfcf3b31">loss::binary_cross_entropy</a>(probs, targets);</div>
<div class="line"><a class="code hl_namespace" href="namespaceloss.html">loss</a>.backward();  <span class="comment">// Computes gradient through sigmoid</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Gating mechanism (like in LSTM)</span></div>
<div class="line"><span class="keyword">auto</span> forget_gate = (W_f.matmul(x) + b_f).sigmoid();</div>
<div class="ttc" id="anamespaceloss_html_a365059b00ea1e6ec1db86710cfcf3b31"><div class="ttname"><a href="namespaceloss.html#a365059b00ea1e6ec1db86710cfcf3b31">loss::binary_cross_entropy</a></div><div class="ttdeci">Tensor&lt; T, 1 &gt; binary_cross_entropy(const Tensor&lt; T, N &gt; &amp;predictions, const Tensor&lt; T, N &gt; &amp;targets, const std::string &amp;reduction)</div><div class="ttdoc">Binary cross entropy loss for binary classification.</div><div class="ttdef"><b>Definition</b> <a href="loss__functions_8h_source.html#l00212">loss_functions.h:212</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01778">1778</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1778</span>                                 {</div>
<div class="line"><span class="lineno"> 1779</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 1780</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1781</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1782</span>        </div>
<div class="line"><span class="lineno"> 1783</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1784</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1785</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::sigmoid_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1786</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1787</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1788</span>        {</div>
<div class="line"><span class="lineno"> 1789</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1790</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">T</a>(1) / (<a class="code hl_class" href="classTensor.html">T</a>(1) + <a class="code hl_class" href="classTensor.html">std::exp</a>(-<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]));</div>
<div class="line"><span class="lineno"> 1791</span>            }</div>
<div class="line"><span class="lineno"> 1792</span>        }</div>
<div class="line"><span class="lineno"> 1793</span>        </div>
<div class="line"><span class="lineno"> 1794</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 1795</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 1796</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">output_copy</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#ae5b52299c11f3ba81e781cb008542285">detach</a>();</div>
<div class="line"><span class="lineno"> 1797</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 1798</span>            </div>
<div class="line"><span class="lineno"> 1799</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">output_copy</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 1800</span>                <span class="comment">// Gradient of sigmoid: d/dx[sigmoid(x)] = sigmoid(x) * (1 - sigmoid(x))</span></div>
<div class="line"><span class="lineno"> 1801</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 1802</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 1803</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1804</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 1805</span>                    }</div>
<div class="line"><span class="lineno"> 1806</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1807</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1808</span>                        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">sig</a> = <a class="code hl_class" href="classTensor.html">output_copy</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1809</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">sig</a> * (<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">sig</a>);</div>
<div class="line"><span class="lineno"> 1810</span>                    }</div>
<div class="line"><span class="lineno"> 1811</span>                    </div>
<div class="line"><span class="lineno"> 1812</span>                    <span class="comment">// If self is not a leaf, propagate gradients further</span></div>
<div class="line"><span class="lineno"> 1813</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 1814</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 1815</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 1816</span>                        }</div>
<div class="line"><span class="lineno"> 1817</span>                    }</div>
<div class="line"><span class="lineno"> 1818</span>                }</div>
<div class="line"><span class="lineno"> 1819</span>            });</div>
<div class="line"><span class="lineno"> 1820</span>        }</div>
<div class="line"><span class="lineno"> 1821</span>        </div>
<div class="line"><span class="lineno"> 1822</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1823</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_afff455663faa35d6cfa72aa03f689e94_icgraph.png" border="0" usemap="#aclassTensor_afff455663faa35d6cfa72aa03f689e94_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_afff455663faa35d6cfa72aa03f689e94_icgraph" id="aclassTensor_afff455663faa35d6cfa72aa03f689e94_icgraph">
<area shape="rect" title="Apply sigmoid function to all elements (creates new tensor)." alt="" coords="202,13,315,40"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Sigmoid.html#a5bde4d78573f5ea7c6c5e4d624bda3fb" title=" " alt="" coords="5,5,154,48"/>
<area shape="poly" title=" " alt="" coords="186,29,154,29,154,24,186,24"/>
</map>
</div>

</div>
</div>
<a id="aa711e60597e988054c669e131ddce774" name="aa711e60597e988054c669e131ddce774"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa711e60597e988054c669e131ddce774">&#9670;&#160;</a></span>sigmoid_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sigmoid_derivative </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of sigmoid function with respect to input. Given output y = sigmoid(x), computes dy/dx = y * (1 - y) This is more numerically stable when you have the sigmoid output. </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with sigmoid derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02051">2051</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2051</span>                                            {</div>
<div class="line"><span class="lineno"> 2052</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">y</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">y</a> * (<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">y</a>); });</div>
<div class="line"><span class="lineno"> 2053</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a369fb30e582324d1331132a5b29884b9" name="a369fb30e582324d1331132a5b29884b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a369fb30e582324d1331132a5b29884b9">&#9670;&#160;</a></span>sigmoid_derivative_from_input()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sigmoid_derivative_from_input </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of sigmoid from input values. Given input x, computes d/dx[sigmoid(x)] = sigmoid(x) * (1 - sigmoid(x)) </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with sigmoid derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02060">2060</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2060</span>                                                       {</div>
<div class="line"><span class="lineno"> 2061</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) {</div>
<div class="line"><span class="lineno"> 2062</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">sig</a> = <a class="code hl_class" href="classTensor.html">T</a>(1) / (<a class="code hl_class" href="classTensor.html">T</a>(1) + <a class="code hl_class" href="classTensor.html">std::exp</a>(-<a class="code hl_class" href="classTensor.html">x</a>));</div>
<div class="line"><span class="lineno"> 2063</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">sig</a> * (<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">sig</a>);</div>
<div class="line"><span class="lineno"> 2064</span>        });</div>
<div class="line"><span class="lineno"> 2065</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8effb9d585936f292d45c090fa06a96b" name="a8effb9d585936f292d45c090fa06a96b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8effb9d585936f292d45c090fa06a96b">&#9670;&#160;</a></span>sign()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sign </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply sign function to all elements (creates new tensor). Returns -1 for negative values, 0 for zero, and +1 for positive values. </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with sign(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01931">1931</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1931</span>                              {</div>
<div class="line"><span class="lineno"> 1932</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { </div>
<div class="line"><span class="lineno"> 1933</span>            <span class="keywordflow">return</span> (<a class="code hl_class" href="classTensor.html">x</a> &gt; <a class="code hl_class" href="classTensor.html">T</a>(0)) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : ((<a class="code hl_class" href="classTensor.html">x</a> &lt; <a class="code hl_class" href="classTensor.html">T</a>(0)) ? <a class="code hl_class" href="classTensor.html">T</a>(-1) : <a class="code hl_class" href="classTensor.html">T</a>(0)); </div>
<div class="line"><span class="lineno"> 1934</span>        });</div>
<div class="line"><span class="lineno"> 1935</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9340456b98f6f4da7fad1b80f9f81712" name="a9340456b98f6f4da7fad1b80f9f81712"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9340456b98f6f4da7fad1b80f9f81712">&#9670;&#160;</a></span>sin()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sin </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply sine function to all elements (creates new tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with sin(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01661">1661</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1661</span>                             {</div>
<div class="line"><span class="lineno"> 1662</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1663</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1664</span>        </div>
<div class="line"><span class="lineno"> 1665</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1666</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1667</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::sin_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1668</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1669</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1670</span>        {</div>
<div class="line"><span class="lineno"> 1671</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1672</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::sin</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 1673</span>            }</div>
<div class="line"><span class="lineno"> 1674</span>        }</div>
<div class="line"><span class="lineno"> 1675</span>        </div>
<div class="line"><span class="lineno"> 1676</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1677</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aeb435c4d428047076a5b3c3dd5ba7114" name="aeb435c4d428047076a5b3c3dd5ba7114"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb435c4d428047076a5b3c3dd5ba7114">&#9670;&#160;</a></span>sin_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sin_derivative </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of sine function. d/dx[sin(x)] = cos(x) </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with sin derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02151">2151</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2151</span>                                        {</div>
<div class="line"><span class="lineno"> 2152</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a6563fb519990f052d63759c50d1febe9">cos</a>();</div>
<div class="line"><span class="lineno"> 2153</span>    }</div>
<div class="ttc" id="aclassTensor_html_a6563fb519990f052d63759c50d1febe9"><div class="ttname"><a href="#a6563fb519990f052d63759c50d1febe9">Tensor::cos</a></div><div class="ttdeci">Tensor&lt; T, N &gt; cos() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l01683">tensor.h:1683</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4ae322784a9d62e8db2c073f5e2395f7" name="a4ae322784a9d62e8db2c073f5e2395f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ae322784a9d62e8db2c073f5e2395f7">&#9670;&#160;</a></span>softmax()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::softmax </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>axis</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Softmax operation with autograd support. </p>
<p>Applies softmax normalization along a specified axis: softmax(x_i) = exp(x_i) / sum(exp(x_j))</p>
<p>Converts logits to probabilities that sum to 1. Uses numerically stable implementation (subtracts max before exp) to prevent overflow.</p>
<p>Essential for multi-class classification output layers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The axis to apply softmax along (default: -1 = last axis) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> with softmax applied, or zero tensor if axis is out of range</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_softmax"></a>
Example</h1>
<div class="fragment"><div class="line"><span class="comment">// Multi-class classification (10 classes, batch size 32)</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> logits({32, 10}, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="keyword">auto</span> probs = logits.softmax(-1);  <span class="comment">// Apply along class dimension</span></div>
<div class="line"><span class="comment">// Each row now sums to 1.0 and represents class probabilities</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// With loss computation:</span></div>
<div class="line"><span class="keyword">auto</span> <a class="code hl_namespace" href="namespaceloss.html">loss</a> = <a class="code hl_function" href="namespaceloss.html#a75edef9d102d2ab811b15c50f13c4eee">loss::cross_entropy_loss</a>(logits, targets);</div>
<div class="line"><a class="code hl_namespace" href="namespaceloss.html">loss</a>.backward();  <span class="comment">// Gradient flows through softmax</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Attention mechanism example:</span></div>
<div class="line"><span class="keyword">auto</span> scores = query.matmul(key.transpose());  <span class="comment">// Attention scores</span></div>
<div class="line"><span class="keyword">auto</span> attention_weights = scores.softmax(-1);   <span class="comment">// Normalize scores</span></div>
<div class="line"><span class="keyword">auto</span> context = attention_weights.matmul(value);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Temperature scaling for controlling confidence:</span></div>
<div class="line"><span class="keywordtype">float</span> temperature = 2.0f;</div>
<div class="line"><span class="keyword">auto</span> calibrated_probs = (logits / temperature).<a class="code hl_function" href="#a4ae322784a9d62e8db2c073f5e2395f7">softmax</a>(-1);</div>
<div class="ttc" id="aclassTensor_html_a4ae322784a9d62e8db2c073f5e2395f7"><div class="ttname"><a href="#a4ae322784a9d62e8db2c073f5e2395f7">Tensor::softmax</a></div><div class="ttdeci">Tensor&lt; T, N &gt; softmax(int axis=-1) const</div><div class="ttdoc">Softmax operation with autograd support.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l03691">tensor.h:3691</a></div></div>
<div class="ttc" id="anamespaceloss_html_a75edef9d102d2ab811b15c50f13c4eee"><div class="ttname"><a href="namespaceloss.html#a75edef9d102d2ab811b15c50f13c4eee">loss::cross_entropy_loss</a></div><div class="ttdeci">Tensor&lt; T, 1 &gt; cross_entropy_loss(const Tensor&lt; T, N &gt; &amp;logits, const Tensor&lt; T, N &gt; &amp;targets, const std::string &amp;reduction)</div><div class="ttdoc">Cross entropy loss for multi-class classification.</div><div class="ttdef"><b>Definition</b> <a href="loss__functions_8h_source.html#l00159">loss_functions.h:159</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03691">3691</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3691</span>                                              {</div>
<div class="line"><span class="lineno"> 3692</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &lt; 0) {</div>
<div class="line"><span class="lineno"> 3693</span>            <a class="code hl_class" href="classTensor.html">axis</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) + <a class="code hl_class" href="classTensor.html">axis</a>;</div>
<div class="line"><span class="lineno"> 3694</span>        }</div>
<div class="line"><span class="lineno"> 3695</span>        </div>
<div class="line"><span class="lineno"> 3696</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis &lt; 0 || axis &gt;</a>= <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>)) {</div>
<div class="line"><span class="lineno"> 3697</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 3698</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 3699</span>        }</div>
<div class="line"><span class="lineno"> 3700</span>        </div>
<div class="line"><span class="lineno"> 3701</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">ax</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">axis</a>);</div>
<div class="line"><span class="lineno"> 3702</span>        </div>
<div class="line"><span class="lineno"> 3703</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 3704</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3705</span>        </div>
<div class="line"><span class="lineno"> 3706</span>        <span class="comment">// Compute softmax with numerical stability (subtract max)</span></div>
<div class="line"><span class="lineno"> 3707</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 3708</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">ax</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3709</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3710</span>        }</div>
<div class="line"><span class="lineno"> 3711</span>        </div>
<div class="line"><span class="lineno"> 3712</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">softmax_dim</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">ax</a>];</div>
<div class="line"><span class="lineno"> 3713</span>        </div>
<div class="line"><span class="lineno"> 3714</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 3715</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">ax</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3716</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3717</span>        }</div>
<div class="line"><span class="lineno"> 3718</span>        </div>
<div class="line"><span class="lineno"> 3719</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 3720</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3721</span>                <span class="comment">// Find max for numerical stability</span></div>
<div class="line"><span class="lineno"> 3722</span>                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_class" href="classTensor.html">std::numeric_limits&lt;T&gt;::lowest</a>();</div>
<div class="line"><span class="lineno"> 3723</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">s</a> = 0; <a class="code hl_class" href="classTensor.html">s</a> &lt; <a class="code hl_class" href="classTensor.html">softmax_dim</a>; ++<a class="code hl_class" href="classTensor.html">s</a>) {</div>
<div class="line"><span class="lineno"> 3724</span>                    <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 3725</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">linear_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">softmax_dim</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">s</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 3726</span>                    </div>
<div class="line"><span class="lineno"> 3727</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">linear_idx</a>;</div>
<div class="line"><span class="lineno"> 3728</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 3729</span>                        <a class="code hl_class" href="classTensor.html">idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3730</span>                        <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3731</span>                    }</div>
<div class="line"><span class="lineno"> 3732</span>                    </div>
<div class="line"><span class="lineno"> 3733</span>                    <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_class" href="classTensor.html">std::max</a>(<a class="code hl_class" href="classTensor.html">max_val</a>, (*<span class="keyword">this</span>)[<a class="code hl_class" href="classTensor.html">idx</a>]);</div>
<div class="line"><span class="lineno"> 3734</span>                }</div>
<div class="line"><span class="lineno"> 3735</span>                </div>
<div class="line"><span class="lineno"> 3736</span>                <span class="comment">// Compute exp(x - max) and sum</span></div>
<div class="line"><span class="lineno"> 3737</span>                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">sum_exp</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3738</span>                <a class="code hl_class" href="classTensor.html">std::vector&lt;T&gt;</a> <a class="code hl_class" href="classTensor.html">exp_vals</a>(<a class="code hl_class" href="classTensor.html">softmax_dim</a>);</div>
<div class="line"><span class="lineno"> 3739</span>                </div>
<div class="line"><span class="lineno"> 3740</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">s</a> = 0; <a class="code hl_class" href="classTensor.html">s</a> &lt; <a class="code hl_class" href="classTensor.html">softmax_dim</a>; ++<a class="code hl_class" href="classTensor.html">s</a>) {</div>
<div class="line"><span class="lineno"> 3741</span>                    <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 3742</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">linear_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">softmax_dim</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">s</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 3743</span>                    </div>
<div class="line"><span class="lineno"> 3744</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">linear_idx</a>;</div>
<div class="line"><span class="lineno"> 3745</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 3746</span>                        <a class="code hl_class" href="classTensor.html">idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3747</span>                        <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3748</span>                    }</div>
<div class="line"><span class="lineno"> 3749</span>                    </div>
<div class="line"><span class="lineno"> 3750</span>                    <a class="code hl_class" href="classTensor.html">exp_vals</a>[<a class="code hl_class" href="classTensor.html">s</a>] = <a class="code hl_class" href="classTensor.html">std::exp</a>((*<span class="keyword">this</span>)[<a class="code hl_class" href="classTensor.html">idx</a>] - <a class="code hl_class" href="classTensor.html">max_val</a>);</div>
<div class="line"><span class="lineno"> 3751</span>                    <a class="code hl_class" href="classTensor.html">sum_exp</a> += <a class="code hl_class" href="classTensor.html">exp_vals</a>[<a class="code hl_class" href="classTensor.html">s</a>];</div>
<div class="line"><span class="lineno"> 3752</span>                }</div>
<div class="line"><span class="lineno"> 3753</span>                </div>
<div class="line"><span class="lineno"> 3754</span>                <span class="comment">// Normalize</span></div>
<div class="line"><span class="lineno"> 3755</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">s</a> = 0; <a class="code hl_class" href="classTensor.html">s</a> &lt; <a class="code hl_class" href="classTensor.html">softmax_dim</a>; ++<a class="code hl_class" href="classTensor.html">s</a>) {</div>
<div class="line"><span class="lineno"> 3756</span>                    <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 3757</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">linear_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">softmax_dim</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">s</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 3758</span>                    </div>
<div class="line"><span class="lineno"> 3759</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">linear_idx</a>;</div>
<div class="line"><span class="lineno"> 3760</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 3761</span>                        <a class="code hl_class" href="classTensor.html">idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3762</span>                        <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3763</span>                    }</div>
<div class="line"><span class="lineno"> 3764</span>                    </div>
<div class="line"><span class="lineno"> 3765</span>                    <a class="code hl_class" href="classTensor.html">result</a>[<a class="code hl_class" href="classTensor.html">idx</a>] = <a class="code hl_class" href="classTensor.html">exp_vals</a>[<a class="code hl_class" href="classTensor.html">s</a>] / <a class="code hl_class" href="classTensor.html">sum_exp</a>;</div>
<div class="line"><span class="lineno"> 3766</span>                }</div>
<div class="line"><span class="lineno"> 3767</span>            }</div>
<div class="line"><span class="lineno"> 3768</span>        }</div>
<div class="line"><span class="lineno"> 3769</span>        </div>
<div class="line"><span class="lineno"> 3770</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 3771</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 3772</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">output_copy</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#ae5b52299c11f3ba81e781cb008542285">detach</a>();</div>
<div class="line"><span class="lineno"> 3773</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3774</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">softmax_axis</a> = <a class="code hl_class" href="classTensor.html">ax</a>;</div>
<div class="line"><span class="lineno"> 3775</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">self_dims</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 3776</span>            </div>
<div class="line"><span class="lineno"> 3777</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">output_copy</a>, <a class="code hl_class" href="classTensor.html">softmax_axis</a>, <a class="code hl_class" href="classTensor.html">self_dims</a>, <a class="code hl_class" href="classTensor.html">outer</a>, <a class="code hl_class" href="classTensor.html">softmax_dim</a>, <a class="code hl_class" href="classTensor.html">inner</a>]</div>
<div class="line"><span class="lineno"> 3778</span>                                    (<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 3779</span>                <span class="comment">// Gradient of softmax:</span></div>
<div class="line"><span class="lineno"> 3780</span>                <span class="comment">// dsoftmax_i/dx_j = softmax_i * (_ij - softmax_j)</span></div>
<div class="line"><span class="lineno"> 3781</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 3782</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 3783</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3784</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 3785</span>                    }</div>
<div class="line"><span class="lineno"> 3786</span>                    </div>
<div class="line"><span class="lineno"> 3787</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 3788</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3789</span>                            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">s</a> = 0; <a class="code hl_class" href="classTensor.html">s</a> &lt; <a class="code hl_class" href="classTensor.html">softmax_dim</a>; ++<a class="code hl_class" href="classTensor.html">s</a>) {</div>
<div class="line"><span class="lineno"> 3790</span>                                <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx_s</a>;</div>
<div class="line"><span class="lineno"> 3791</span>                                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">linear_s</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">softmax_dim</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">s</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 3792</span>                                </div>
<div class="line"><span class="lineno"> 3793</span>                                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">linear_s</a>;</div>
<div class="line"><span class="lineno"> 3794</span>                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 3795</span>                                    <a class="code hl_class" href="classTensor.html">idx_s</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_class" href="classTensor.html">self_dims</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3796</span>                                    <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_class" href="classTensor.html">self_dims</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3797</span>                                }</div>
<div class="line"><span class="lineno"> 3798</span>                                </div>
<div class="line"><span class="lineno"> 3799</span>                                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3800</span>                                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">j</a> = 0; <a class="code hl_class" href="classTensor.html">j</a> &lt; <a class="code hl_class" href="classTensor.html">softmax_dim</a>; ++<a class="code hl_class" href="classTensor.html">j</a>) {</div>
<div class="line"><span class="lineno"> 3801</span>                                    <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx_j</a> = <a class="code hl_class" href="classTensor.html">idx_s</a>;</div>
<div class="line"><span class="lineno"> 3802</span>                                    <a class="code hl_class" href="classTensor.html">idx_j</a>[<a class="code hl_class" href="classTensor.html">softmax_axis</a>] = <a class="code hl_class" href="classTensor.html">j</a>;</div>
<div class="line"><span class="lineno"> 3803</span>                                    </div>
<div class="line"><span class="lineno"> 3804</span>                                    <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">delta_ij</a> = (<a class="code hl_class" href="classTensor.html">s</a> == <a class="code hl_class" href="classTensor.html">j</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3805</span>                                    <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>[<a class="code hl_class" href="classTensor.html">idx_j</a>] * (<a class="code hl_class" href="classTensor.html">delta_ij</a> - <a class="code hl_class" href="classTensor.html">output_copy</a>[<a class="code hl_class" href="classTensor.html">idx_j</a>]);</div>
<div class="line"><span class="lineno"> 3806</span>                                }</div>
<div class="line"><span class="lineno"> 3807</span>                                </div>
<div class="line"><span class="lineno"> 3808</span>                                (*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>)[<a class="code hl_class" href="classTensor.html">idx_s</a>] += <a class="code hl_class" href="classTensor.html">output_copy</a>[<a class="code hl_class" href="classTensor.html">idx_s</a>] * <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>;</div>
<div class="line"><span class="lineno"> 3809</span>                            }</div>
<div class="line"><span class="lineno"> 3810</span>                        }</div>
<div class="line"><span class="lineno"> 3811</span>                    }</div>
<div class="line"><span class="lineno"> 3812</span>                    </div>
<div class="line"><span class="lineno"> 3813</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 3814</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 3815</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 3816</span>                        }</div>
<div class="line"><span class="lineno"> 3817</span>                    }</div>
<div class="line"><span class="lineno"> 3818</span>                }</div>
<div class="line"><span class="lineno"> 3819</span>            });</div>
<div class="line"><span class="lineno"> 3820</span>        }</div>
<div class="line"><span class="lineno"> 3821</span>        </div>
<div class="line"><span class="lineno"> 3822</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3823</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae0c783450c731955dab75dcb1e697319" name="ae0c783450c731955dab75dcb1e697319"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0c783450c731955dab75dcb1e697319">&#9670;&#160;</a></span>softmax_gradient_diagonal()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::softmax_gradient_diagonal </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute gradient of softmax function (for classification). This computes the Jacobian diagonal for each output with respect to itself. For output y_i = softmax(x)_i, computes dy_i/dx_i = y_i * (1 - y_i) Note: Full softmax Jacobian requires matrix output. </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with softmax gradient diagonal. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02183">2183</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2183</span>                                                   {</div>
<div class="line"><span class="lineno"> 2184</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">y</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">y</a> * (<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">y</a>); });</div>
<div class="line"><span class="lineno"> 2185</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a71992cdc0fae28d4c1947d7ebc3b85f3" name="a71992cdc0fae28d4c1947d7ebc3b85f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71992cdc0fae28d4c1947d7ebc3b85f3">&#9670;&#160;</a></span>spearman_correlation()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::spearman_correlation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute Spearman rank correlation coefficient with another tensor. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The other tensor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The Spearman correlation coefficient or error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02463">2463</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2463</span>                                                                          {</div>
<div class="line"><span class="lineno"> 2464</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>() != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>()) {</div>
<div class="line"><span class="lineno"> 2465</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 2466</span>        }</div>
<div class="line"><span class="lineno"> 2467</span>        </div>
<div class="line"><span class="lineno"> 2468</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2469</span>        </div>
<div class="line"><span class="lineno"> 2470</span>        <span class="comment">// Create rank vectors</span></div>
<div class="line"><span class="lineno"> 2471</span>        <a class="code hl_class" href="classTensor.html">std::vector&lt;std::pair&lt;T, size_t&gt;</a>&gt; <a class="code hl_class" href="classTensor.html">data1</a>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2472</span>        <a class="code hl_class" href="classTensor.html">std::vector&lt;std::pair&lt;T, size_t&gt;</a>&gt; <a class="code hl_class" href="classTensor.html">data2</a>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2473</span>        </div>
<div class="line"><span class="lineno"> 2474</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2475</span>            <a class="code hl_class" href="classTensor.html">data1</a>[<a class="code hl_class" href="classTensor.html">i</a>] = {<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>], <a class="code hl_class" href="classTensor.html">i</a>};</div>
<div class="line"><span class="lineno"> 2476</span>            <a class="code hl_class" href="classTensor.html">data2</a>[<a class="code hl_class" href="classTensor.html">i</a>] = {<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>], <a class="code hl_class" href="classTensor.html">i</a>};</div>
<div class="line"><span class="lineno"> 2477</span>        }</div>
<div class="line"><span class="lineno"> 2478</span>        </div>
<div class="line"><span class="lineno"> 2479</span>        <span class="comment">// Sort by value</span></div>
<div class="line"><span class="lineno"> 2480</span>        <a class="code hl_class" href="classTensor.html">std::sort</a>(<a class="code hl_class" href="classTensor.html">data1</a>.begin(), <a class="code hl_class" href="classTensor.html">data1</a>.end());</div>
<div class="line"><span class="lineno"> 2481</span>        <a class="code hl_class" href="classTensor.html">std::sort</a>(<a class="code hl_class" href="classTensor.html">data2</a>.begin(), <a class="code hl_class" href="classTensor.html">data2</a>.end());</div>
<div class="line"><span class="lineno"> 2482</span>        </div>
<div class="line"><span class="lineno"> 2483</span>        <span class="comment">// Assign ranks</span></div>
<div class="line"><span class="lineno"> 2484</span>        <a class="code hl_class" href="classTensor.html">std::vector&lt;T&gt;</a> <a class="code hl_class" href="classTensor.html">rank1</a>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2485</span>        <a class="code hl_class" href="classTensor.html">std::vector&lt;T&gt;</a> <a class="code hl_class" href="classTensor.html">rank2</a>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2486</span>        </div>
<div class="line"><span class="lineno"> 2487</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2488</span>            <a class="code hl_class" href="classTensor.html">rank1</a>[<a class="code hl_class" href="classTensor.html">data1</a>[<a class="code hl_class" href="classTensor.html">i</a>].second] = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">i</a> + 1);</div>
<div class="line"><span class="lineno"> 2489</span>            <a class="code hl_class" href="classTensor.html">rank2</a>[<a class="code hl_class" href="classTensor.html">data2</a>[<a class="code hl_class" href="classTensor.html">i</a>].second] = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">i</a> + 1);</div>
<div class="line"><span class="lineno"> 2490</span>        }</div>
<div class="line"><span class="lineno"> 2491</span>        </div>
<div class="line"><span class="lineno"> 2492</span>        <span class="comment">// Compute Pearson correlation on ranks</span></div>
<div class="line"><span class="lineno"> 2493</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">sum_d_squared</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2494</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2495</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">diff</a> = <a class="code hl_class" href="classTensor.html">rank1</a>[<a class="code hl_class" href="classTensor.html">i</a>] - <a class="code hl_class" href="classTensor.html">rank2</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 2496</span>            <a class="code hl_class" href="classTensor.html">sum_d_squared</a> += <a class="code hl_class" href="classTensor.html">diff</a> * <a class="code hl_class" href="classTensor.html">diff</a>;</div>
<div class="line"><span class="lineno"> 2497</span>        }</div>
<div class="line"><span class="lineno"> 2498</span>        </div>
<div class="line"><span class="lineno"> 2499</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">n</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2500</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">T</a>(1) - (<a class="code hl_class" href="classTensor.html">T</a>(6) * <a class="code hl_class" href="classTensor.html">sum_d_squared</a>) / (<a class="code hl_class" href="classTensor.html">n</a> * (<a class="code hl_class" href="classTensor.html">n</a> * <a class="code hl_class" href="classTensor.html">n</a> - <a class="code hl_class" href="classTensor.html">T</a>(1)));</div>
<div class="line"><span class="lineno"> 2501</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af5c4a58c5b957dcfe32a0e7842520404" name="af5c4a58c5b957dcfe32a0e7842520404"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5c4a58c5b957dcfe32a0e7842520404">&#9670;&#160;</a></span>sqrt()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sqrt </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply square root to all elements (creates new tensor). </p>
<p>Computes x for each element. Uses GPU acceleration when available.</p>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with sqrt(x) applied to all elements </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Elements must be non-negative (sqrt of negative values is undefined)</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_sqrt"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> matrix({2, 2});</div>
<div class="line">matrix.fill(4.0f);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> result = matrix.sqrt();  <span class="comment">// All elements = 2.0</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Useful for computing standard deviation</span></div>
<div class="line"><span class="keyword">auto</span> <a class="code hl_function" href="#ac24ac40382bfcce441f59645c4b73257">variance</a> = <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>.variance();</div>
<div class="line"><span class="keyword">auto</span> std_dev = <a class="code hl_function" href="#ac24ac40382bfcce441f59645c4b73257">variance</a>.sqrt();</div>
<div class="ttc" id="aclassTensor_html_ac24ac40382bfcce441f59645c4b73257"><div class="ttname"><a href="#ac24ac40382bfcce441f59645c4b73257">Tensor::variance</a></div><div class="ttdeci">T variance(size_t ddof=0) const</div><div class="ttdoc">Compute variance of all elements.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l02300">tensor.h:2300</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01587">1587</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1587</span>                              {</div>
<div class="line"><span class="lineno"> 1588</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1589</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1590</span>        </div>
<div class="line"><span class="lineno"> 1591</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1592</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1593</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::sqrt_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1594</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1595</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1596</span>        {</div>
<div class="line"><span class="lineno"> 1597</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1598</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::sqrt</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 1599</span>            }</div>
<div class="line"><span class="lineno"> 1600</span>        }</div>
<div class="line"><span class="lineno"> 1601</span>        </div>
<div class="line"><span class="lineno"> 1602</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1603</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a958bad1db0d0a6867d12c75957d2de17" name="a958bad1db0d0a6867d12c75957d2de17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a958bad1db0d0a6867d12c75957d2de17">&#9670;&#160;</a></span>sqrt_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sqrt_derivative </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of square root. d/dx[sqrt(x)] = 1 / (2 * sqrt(x)) </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with sqrt derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02130">2130</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2130</span>                                         {</div>
<div class="line"><span class="lineno"> 2131</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">T</a>(1) / (<a class="code hl_class" href="classTensor.html">T</a>(2) * <a class="code hl_class" href="classTensor.html">std::sqrt</a>(<a class="code hl_class" href="classTensor.html">x</a>)); });</div>
<div class="line"><span class="lineno"> 2132</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aeede6504125b5aeff52c1a56dfbee125" name="aeede6504125b5aeff52c1a56dfbee125"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeede6504125b5aeff52c1a56dfbee125">&#9670;&#160;</a></span>square()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::square </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute element-wise square (x). Useful for computing squared errors. </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with squared values. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02544">2544</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2544</span>                                {</div>
<div class="line"><span class="lineno"> 2545</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">x</a> * <a class="code hl_class" href="classTensor.html">x</a>; });</div>
<div class="line"><span class="lineno"> 2546</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a46d44bb69fc3f0b7376ea35e21903b97" name="a46d44bb69fc3f0b7376ea35e21903b97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46d44bb69fc3f0b7376ea35e21903b97">&#9670;&#160;</a></span>squeeze()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::squeeze </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>axis</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Squeeze - remove dimensions of size 1. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>Specific axis to squeeze, or -1 to squeeze all axes of size 1 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> with squeezed dimensions, or zero tensor if invalid axis </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04167">4167</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4167</span>                                              {</div>
<div class="line"><span class="lineno"> 4168</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &gt;= 0) {</div>
<div class="line"><span class="lineno"> 4169</span>            <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">axis</a>) &gt;= <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 4170</span>                <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 4171</span>                <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4172</span>            }</div>
<div class="line"><span class="lineno"> 4173</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>] != 1) {</div>
<div class="line"><span class="lineno"> 4174</span>                <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 4175</span>                <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4176</span>            }</div>
<div class="line"><span class="lineno"> 4177</span>        }</div>
<div class="line"><span class="lineno"> 4178</span>        </div>
<div class="line"><span class="lineno"> 4179</span>        <span class="comment">// For simplicity, return a copy with same dimensions</span></div>
<div class="line"><span class="lineno"> 4180</span>        <span class="comment">// A proper implementation would change rank</span></div>
<div class="line"><span class="lineno"> 4181</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4182</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4183</span>        </div>
<div class="line"><span class="lineno"> 4184</span>        <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno"> 4185</span>        </div>
<div class="line"><span class="lineno"> 4186</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4187</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4188</span>            </div>
<div class="line"><span class="lineno"> 4189</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 4190</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4191</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4192</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, </div>
<div class="line"><span class="lineno"> 4193</span>                                                                          <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4194</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4195</span>                    }</div>
<div class="line"><span class="lineno"> 4196</span>                    </div>
<div class="line"><span class="lineno"> 4197</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4198</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4199</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4200</span>                    }</div>
<div class="line"><span class="lineno"> 4201</span>                    </div>
<div class="line"><span class="lineno"> 4202</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4203</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4204</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4205</span>                        }</div>
<div class="line"><span class="lineno"> 4206</span>                    }</div>
<div class="line"><span class="lineno"> 4207</span>                }</div>
<div class="line"><span class="lineno"> 4208</span>            });</div>
<div class="line"><span class="lineno"> 4209</span>        }</div>
<div class="line"><span class="lineno"> 4210</span>        </div>
<div class="line"><span class="lineno"> 4211</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4212</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9583b3dbaa99f4251d08085617f1b858" name="a9583b3dbaa99f4251d08085617f1b858"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9583b3dbaa99f4251d08085617f1b858">&#9670;&#160;</a></span>stack()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t... Dims&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N+1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::stack </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensors</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>dim</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Stack tensors along a new dimension (creates new dimension). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tensors</td><td><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b" title="Type alias for 1D vectors.">Vector</a> of tensors to stack. </td></tr>
    <tr><td class="paramname">dim</td><td>Dimension along which to stack (must be &lt;= N). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with dimension N+1. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02942">2942</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2942</span>                                                                                        {</div>
<div class="line"><span class="lineno"> 2943</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">tensors</a>.empty()) {</div>
<div class="line"><span class="lineno"> 2944</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N+1&gt;</a>({0}, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2945</span>        }</div>
<div class="line"><span class="lineno"> 2946</span>        </div>
<div class="line"><span class="lineno"> 2947</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">dim</a> &gt; <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 2948</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N+1&gt;</a>({0}, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2949</span>        }</div>
<div class="line"><span class="lineno"> 2950</span>        </div>
<div class="line"><span class="lineno"> 2951</span>        <span class="comment">// Check all tensors have the same shape</span></div>
<div class="line"><span class="lineno"> 2952</span>        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">first_dims</a> = <a class="code hl_class" href="classTensor.html">tensors</a>[0].<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 2953</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">t</a> : <a class="code hl_class" href="classTensor.html">tensors</a>) {</div>
<div class="line"><span class="lineno"> 2954</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">t</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">first_dims</a>) {</div>
<div class="line"><span class="lineno"> 2955</span>                <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N+1&gt;</a>({0}, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2956</span>            }</div>
<div class="line"><span class="lineno"> 2957</span>        }</div>
<div class="line"><span class="lineno"> 2958</span>        </div>
<div class="line"><span class="lineno"> 2959</span>        <span class="comment">// Compute new dimensions</span></div>
<div class="line"><span class="lineno"> 2960</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N+1&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a>;</div>
<div class="line"><span class="lineno"> 2961</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">dim</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2962</span>            <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">first_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 2963</span>        }</div>
<div class="line"><span class="lineno"> 2964</span>        <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">dim</a>] = <a class="code hl_class" href="classTensor.html">tensors</a>.size();</div>
<div class="line"><span class="lineno"> 2965</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">dim</a>; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2966</span>            <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>+1] = <a class="code hl_class" href="classTensor.html">first_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 2967</span>        }</div>
<div class="line"><span class="lineno"> 2968</span>        </div>
<div class="line"><span class="lineno"> 2969</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N+1&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <a class="code hl_class" href="classTensor.html">tensors</a>[0].<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2970</span>        </div>
<div class="line"><span class="lineno"> 2971</span>        <span class="comment">// Copy data</span></div>
<div class="line"><span class="lineno"> 2972</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">slice_size</a> = <a class="code hl_class" href="classTensor.html">tensors</a>[0].<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2973</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">t</a> = 0; <a class="code hl_class" href="classTensor.html">t</a> &lt; <a class="code hl_class" href="classTensor.html">tensors</a>.size(); ++<a class="code hl_class" href="classTensor.html">t</a>) {</div>
<div class="line"><span class="lineno"> 2974</span>            <span class="keywordtype">size_t</span> <a class="code hl_function" href="#acfd498e431d2689e191c1e9cb8d600fb">offset</a> = <a class="code hl_class" href="classTensor.html">t</a> * <a class="code hl_class" href="classTensor.html">slice_size</a>;</div>
<div class="line"><span class="lineno"> 2975</span>            <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_class" href="classTensor.html">tensors</a>[<a class="code hl_class" href="classTensor.html">t</a>].<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">tensors</a>[<a class="code hl_class" href="classTensor.html">t</a>].<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_class" href="classTensor.html">slice_size</a>,</div>
<div class="line"><span class="lineno"> 2976</span>                     <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_function" href="#acfd498e431d2689e191c1e9cb8d600fb">offset</a>);</div>
<div class="line"><span class="lineno"> 2977</span>        }</div>
<div class="line"><span class="lineno"> 2978</span>        </div>
<div class="line"><span class="lineno"> 2979</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2980</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a06eeff8ce7f54262b935b324bcb6833e" name="a06eeff8ce7f54262b935b324bcb6833e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06eeff8ce7f54262b935b324bcb6833e">&#9670;&#160;</a></span>standardize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::standardize </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Standardize tensor to [0, 1] range using min-max scaling. </p><dl class="section return"><dt>Returns</dt><dd>A new standardized tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02524">2524</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2524</span>                                     {</div>
<div class="line"><span class="lineno"> 2525</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">min_val</a> = <a class="code hl_function" href="#a20cb276f18c104077f75c6f712e4107b">min</a>();</div>
<div class="line"><span class="lineno"> 2526</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_function" href="#a421ff1c638234245b00425702d3f23aa">max</a>();</div>
<div class="line"><span class="lineno"> 2527</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">range</a> = <a class="code hl_class" href="classTensor.html">max_val</a> - <a class="code hl_class" href="classTensor.html">min_val</a>;</div>
<div class="line"><span class="lineno"> 2528</span>        </div>
<div class="line"><span class="lineno"> 2529</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">range</a> &lt; <a class="code hl_class" href="classTensor.html">std::numeric_limits&lt;T&gt;::epsilon</a>()) {</div>
<div class="line"><span class="lineno"> 2530</span>            <span class="comment">// If all values are the same, return zeros</span></div>
<div class="line"><span class="lineno"> 2531</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2532</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 2533</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2534</span>        }</div>
<div class="line"><span class="lineno"> 2535</span>        </div>
<div class="line"><span class="lineno"> 2536</span>        <span class="keywordflow">return</span> (*<span class="keyword">this</span> - <a class="code hl_class" href="classTensor.html">min_val</a>) / <a class="code hl_class" href="classTensor.html">range</a>;</div>
<div class="line"><span class="lineno"> 2537</span>    }</div>
<div class="ttc" id="aclassTensor_html_a20cb276f18c104077f75c6f712e4107b"><div class="ttname"><a href="#a20cb276f18c104077f75c6f712e4107b">Tensor::min</a></div><div class="ttdeci">T min() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l02432">tensor.h:2432</a></div></div>
<div class="ttc" id="aclassTensor_html_a421ff1c638234245b00425702d3f23aa"><div class="ttname"><a href="#a421ff1c638234245b00425702d3f23aa">Tensor::max</a></div><div class="ttdeci">T max() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l02447">tensor.h:2447</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0cda55fce732dcb563b598ff636d8758" name="a0cda55fce732dcb563b598ff636d8758"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cda55fce732dcb563b598ff636d8758">&#9670;&#160;</a></span>std()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::std </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>ddof</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute standard deviation of all elements. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ddof</td><td>Delta degrees of freedom (default 0). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The standard deviation. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02318">2318</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2318</span>                                 {</div>
<div class="line"><span class="lineno"> 2319</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::sqrt</a>(<a class="code hl_function" href="#ac24ac40382bfcce441f59645c4b73257">variance</a>(<a class="code hl_class" href="classTensor.html">ddof</a>));</div>
<div class="line"><span class="lineno"> 2320</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a0cda55fce732dcb563b598ff636d8758_icgraph.png" border="0" usemap="#aclassTensor_a0cda55fce732dcb563b598ff636d8758_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a0cda55fce732dcb563b598ff636d8758_icgraph" id="aclassTensor_a0cda55fce732dcb563b598ff636d8758_icgraph">
<area shape="rect" title=" " alt="" coords="223,5,309,32"/>
<area shape="rect" href="classTensor.html#ab319628634a6c30afddd1a331d9c22e8" title=" " alt="" coords="5,5,175,32"/>
<area shape="poly" title=" " alt="" coords="207,21,175,21,175,16,207,16"/>
</map>
</div>

</div>
</div>
<a id="a938d78600782073a1ff2725066b46c85" name="a938d78600782073a1ff2725066b46c85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a938d78600782073a1ff2725066b46c85">&#9670;&#160;</a></span>strides()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::strides </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get strides for each dimension. </p><dl class="section return"><dt>Returns</dt><dd>Array of strides for each dimension. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00530">530</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  530</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#af6821d656bfc94c60fe4cd256c1d7402">strides_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d279878b61732de2f1986dfc7de8400" name="a3d279878b61732de2f1986dfc7de8400"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d279878b61732de2f1986dfc7de8400">&#9670;&#160;</a></span>sum()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sum </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute sum reduction along all dimensions. </p>
<p>Sums all elements in the tensor to produce a single scalar value. Useful for computing loss, gradient aggregation, or total statistics.</p>
<dl class="section return"><dt>Returns</dt><dd>The sum of all elements as a scalar</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_sum"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> matrix({3, 3});</div>
<div class="line">matrix.fill(2.0f);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">float</span> total = matrix.sum();  <span class="comment">// Returns 18.0 (9 elements  2.0)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Useful in loss computation:</span></div>
<div class="line"><a class="code hl_class" href="classTensor.html">Tensor&lt;float, 1&gt;</a> errors({100}, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="keyword">auto</span> loss_tensor = errors.<a class="code hl_function" href="#aed782eb734b3ef0dd50e5355e3d883c8">pow</a>(2.0f);  <span class="comment">// Square errors</span></div>
<div class="line"><span class="keywordtype">float</span> mse = loss_tensor.<a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>() / 100.0f;  <span class="comment">// Mean squared error</span></div>
<div class="ttc" id="aclassTensor_html_aed782eb734b3ef0dd50e5355e3d883c8"><div class="ttname"><a href="#aed782eb734b3ef0dd50e5355e3d883c8">Tensor::pow</a></div><div class="ttdeci">Tensor&lt; T, N &gt; pow(T exponent) const</div><div class="ttdoc">Apply power function to all elements (creates new tensor).</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l01631">tensor.h:1631</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02234">2234</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2234</span>                  {</div>
<div class="line"><span class="lineno"> 2235</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">result</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2236</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2237</span>        </div>
<div class="line"><span class="lineno"> 2238</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2239</span>            <a class="code hl_class" href="classTensor.html">result</a> += <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 2240</span>        }</div>
<div class="line"><span class="lineno"> 2241</span>        </div>
<div class="line"><span class="lineno"> 2242</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2243</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a3d279878b61732de2f1986dfc7de8400_icgraph.png" border="0" usemap="#aclassTensor_a3d279878b61732de2f1986dfc7de8400_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a3d279878b61732de2f1986dfc7de8400_icgraph" id="aclassTensor_a3d279878b61732de2f1986dfc7de8400_icgraph">
<area shape="rect" title="Compute sum reduction along all dimensions." alt="" coords="199,5,292,32"/>
<area shape="rect" href="classTensor.html#a84b27bf0213ab3f228c2efe5ca31eaec" title=" " alt="" coords="5,5,151,32"/>
<area shape="poly" title=" " alt="" coords="183,21,151,21,151,16,183,16"/>
</map>
</div>

</div>
</div>
<a id="ac20a4679e14de6f68e148b447496adfc" name="ac20a4679e14de6f68e148b447496adfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac20a4679e14de6f68e148b447496adfc">&#9670;&#160;</a></span>sum_axis() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sum_axis </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>axis</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>keepdims</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sum reduction along a specific axis with autograd support. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The axis to sum along (-1 for last axis) </td></tr>
    <tr><td class="paramname">keepdims</td><td>Whether to keep the reduced dimension as size 1 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reduced tensor, or zero tensor if axis is out of range </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03517">3517</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3517</span>                                                                 {</div>
<div class="line"><span class="lineno"> 3518</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &lt; 0) {</div>
<div class="line"><span class="lineno"> 3519</span>            <a class="code hl_class" href="classTensor.html">axis</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) + <a class="code hl_class" href="classTensor.html">axis</a>;</div>
<div class="line"><span class="lineno"> 3520</span>        }</div>
<div class="line"><span class="lineno"> 3521</span>        </div>
<div class="line"><span class="lineno"> 3522</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis &lt; 0 || axis &gt;</a>= <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>)) {</div>
<div class="line"><span class="lineno"> 3523</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 3524</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 3525</span>        }</div>
<div class="line"><span class="lineno"> 3526</span>        </div>
<div class="line"><span class="lineno"> 3527</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">ax</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">axis</a>);</div>
<div class="line"><span class="lineno"> 3528</span>        </div>
<div class="line"><span class="lineno"> 3529</span>        <span class="comment">// Compute output dimensions</span></div>
<div class="line"><span class="lineno"> 3530</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">result_dims</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 3531</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">keepdims</a>) {</div>
<div class="line"><span class="lineno"> 3532</span>            <a class="code hl_class" href="classTensor.html">result_dims</a>[<a class="code hl_class" href="classTensor.html">ax</a>] = 1;</div>
<div class="line"><span class="lineno"> 3533</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3534</span>            <span class="comment">// For now, keep the dimension but set to 1</span></div>
<div class="line"><span class="lineno"> 3535</span>            <span class="comment">// A proper implementation would reduce the tensor rank</span></div>
<div class="line"><span class="lineno"> 3536</span>            <a class="code hl_class" href="classTensor.html">result_dims</a>[<a class="code hl_class" href="classTensor.html">ax</a>] = 1;</div>
<div class="line"><span class="lineno"> 3537</span>        }</div>
<div class="line"><span class="lineno"> 3538</span>        </div>
<div class="line"><span class="lineno"> 3539</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">result_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 3540</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3541</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 3542</span>        </div>
<div class="line"><span class="lineno"> 3543</span>        <span class="comment">// Compute sum</span></div>
<div class="line"><span class="lineno"> 3544</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 3545</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">ax</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3546</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3547</span>        }</div>
<div class="line"><span class="lineno"> 3548</span>        </div>
<div class="line"><span class="lineno"> 3549</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">reduce_dim</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">ax</a>];</div>
<div class="line"><span class="lineno"> 3550</span>        </div>
<div class="line"><span class="lineno"> 3551</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 3552</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">ax</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3553</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3554</span>        }</div>
<div class="line"><span class="lineno"> 3555</span>        </div>
<div class="line"><span class="lineno"> 3556</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 3557</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3558</span>                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3559</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">r</a> = 0; <a class="code hl_class" href="classTensor.html">r</a> &lt; <a class="code hl_class" href="classTensor.html">reduce_dim</a>; ++<a class="code hl_class" href="classTensor.html">r</a>) {</div>
<div class="line"><span class="lineno"> 3560</span>                    <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 3561</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">linear_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">reduce_dim</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">r</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 3562</span>                    </div>
<div class="line"><span class="lineno"> 3563</span>                    <span class="comment">// Convert linear index to multi-dimensional</span></div>
<div class="line"><span class="lineno"> 3564</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">linear_idx</a>;</div>
<div class="line"><span class="lineno"> 3565</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 3566</span>                        <a class="code hl_class" href="classTensor.html">idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3567</span>                        <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3568</span>                    }</div>
<div class="line"><span class="lineno"> 3569</span>                    </div>
<div class="line"><span class="lineno"> 3570</span>                    <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> += (*this)[<a class="code hl_class" href="classTensor.html">idx</a>];</div>
<div class="line"><span class="lineno"> 3571</span>                }</div>
<div class="line"><span class="lineno"> 3572</span>                </div>
<div class="line"><span class="lineno"> 3573</span>                <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">result_idx</a>;</div>
<div class="line"><span class="lineno"> 3574</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">result_linear</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 3575</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">result_linear</a>;</div>
<div class="line"><span class="lineno"> 3576</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 3577</span>                    <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">d</a> == <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">ax</a>)) {</div>
<div class="line"><span class="lineno"> 3578</span>                        <a class="code hl_class" href="classTensor.html">result_idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = 0;</div>
<div class="line"><span class="lineno"> 3579</span>                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">d</a> &lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">ax</a>)) {</div>
<div class="line"><span class="lineno"> 3580</span>                        <a class="code hl_class" href="classTensor.html">result_idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> / <a class="code hl_class" href="classTensor.html">inner</a>;</div>
<div class="line"><span class="lineno"> 3581</span>                        <a class="code hl_class" href="classTensor.html">temp</a> %= <a class="code hl_class" href="classTensor.html">inner</a>;</div>
<div class="line"><span class="lineno"> 3582</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3583</span>                        <a class="code hl_class" href="classTensor.html">result_idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_class" href="classTensor.html">result_dims</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3584</span>                        <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_class" href="classTensor.html">result_dims</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3585</span>                    }</div>
<div class="line"><span class="lineno"> 3586</span>                }</div>
<div class="line"><span class="lineno"> 3587</span>                </div>
<div class="line"><span class="lineno"> 3588</span>                <a class="code hl_class" href="classTensor.html">result</a>[<a class="code hl_class" href="classTensor.html">result_idx</a>] = <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>;</div>
<div class="line"><span class="lineno"> 3589</span>            }</div>
<div class="line"><span class="lineno"> 3590</span>        }</div>
<div class="line"><span class="lineno"> 3591</span>        </div>
<div class="line"><span class="lineno"> 3592</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 3593</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 3594</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3595</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">self_dims</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 3596</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">reduce_axis</a> = <a class="code hl_class" href="classTensor.html">ax</a>;</div>
<div class="line"><span class="lineno"> 3597</span>            </div>
<div class="line"><span class="lineno"> 3598</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">self_dims</a>, <a class="code hl_class" href="classTensor.html">reduce_axis</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 3599</span>                <span class="comment">// Gradient of sum: broadcast gradient back to original shape</span></div>
<div class="line"><span class="lineno"> 3600</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 3601</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 3602</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3603</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 3604</span>                    }</div>
<div class="line"><span class="lineno"> 3605</span>                    </div>
<div class="line"><span class="lineno"> 3606</span>                    <span class="comment">// Each element in the original tensor contributed to one element in the sum</span></div>
<div class="line"><span class="lineno"> 3607</span>                    <span class="comment">// So gradient is just broadcast of the output gradient</span></div>
<div class="line"><span class="lineno"> 3608</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3609</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3610</span>                        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 3611</span>                        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 3612</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 3613</span>                            <a class="code hl_class" href="classTensor.html">idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_class" href="classTensor.html">self_dims</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3614</span>                            <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_class" href="classTensor.html">self_dims</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 3615</span>                        }</div>
<div class="line"><span class="lineno"> 3616</span>                        </div>
<div class="line"><span class="lineno"> 3617</span>                        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">grad_idx</a> = <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 3618</span>                        <a class="code hl_class" href="classTensor.html">grad_idx</a>[<a class="code hl_class" href="classTensor.html">reduce_axis</a>] = 0;  <span class="comment">// Sum reduced this dimension</span></div>
<div class="line"><span class="lineno"> 3619</span>                        </div>
<div class="line"><span class="lineno"> 3620</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>[<a class="code hl_class" href="classTensor.html">grad_idx</a>];</div>
<div class="line"><span class="lineno"> 3621</span>                    }</div>
<div class="line"><span class="lineno"> 3622</span>                    </div>
<div class="line"><span class="lineno"> 3623</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 3624</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 3625</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 3626</span>                        }</div>
<div class="line"><span class="lineno"> 3627</span>                    }</div>
<div class="line"><span class="lineno"> 3628</span>                }</div>
<div class="line"><span class="lineno"> 3629</span>            });</div>
<div class="line"><span class="lineno"> 3630</span>        }</div>
<div class="line"><span class="lineno"> 3631</span>        </div>
<div class="line"><span class="lineno"> 3632</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3633</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac15f7a77f31ef7862dd9909c9ad97160" name="ac15f7a77f31ef7862dd9909c9ad97160"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac15f7a77f31ef7862dd9909c9ad97160">&#9670;&#160;</a></span>sum_axis() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sum_axis </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>axis</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>keepdims</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sum reduction along a specific axis. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The dimension along which to sum. </td></tr>
    <tr><td class="paramname">keepdims</td><td>Whether to keep the reduced dimension (size 1) or remove it. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with the sum along the specified axis. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04508">4508</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4508</span>                                                                    {</div>
<div class="line"><span class="lineno"> 4509</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &gt;= <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 4510</span>            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 4511</span>        }</div>
<div class="line"><span class="lineno"> 4512</span>        </div>
<div class="line"><span class="lineno"> 4513</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 4514</span>        <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">axis</a>] = 1;</div>
<div class="line"><span class="lineno"> 4515</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4516</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4517</span>        </div>
<div class="line"><span class="lineno"> 4518</span>        <span class="comment">// Calculate strides for iteration</span></div>
<div class="line"><span class="lineno"> 4519</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 4520</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">axis</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4521</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4522</span>        }</div>
<div class="line"><span class="lineno"> 4523</span>        </div>
<div class="line"><span class="lineno"> 4524</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 4525</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">axis</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4526</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4527</span>        }</div>
<div class="line"><span class="lineno"> 4528</span>        </div>
<div class="line"><span class="lineno"> 4529</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">axis_size</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>];</div>
<div class="line"><span class="lineno"> 4530</span>        </div>
<div class="line"><span class="lineno"> 4531</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4532</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4533</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 0; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 4534</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4535</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dst_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4536</span>                    <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">dst_idx</a>] += <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 4537</span>                }</div>
<div class="line"><span class="lineno"> 4538</span>            }</div>
<div class="line"><span class="lineno"> 4539</span>        }</div>
<div class="line"><span class="lineno"> 4540</span>        </div>
<div class="line"><span class="lineno"> 4541</span>        <span class="comment">// If requested, squeeze the result (remove dimension of size 1)</span></div>
<div class="line"><span class="lineno"> 4542</span>        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">keepdims</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">N</a> &gt; 1) {</div>
<div class="line"><span class="lineno"> 4543</span>            <span class="comment">// Return as-is with size 1 dimension</span></div>
<div class="line"><span class="lineno"> 4544</span>            <span class="comment">// Full squeeze would require changing dimension template parameter</span></div>
<div class="line"><span class="lineno"> 4545</span>        }</div>
<div class="line"><span class="lineno"> 4546</span>        </div>
<div class="line"><span class="lineno"> 4547</span>        <span class="comment">// Handle gradient tracking</span></div>
<div class="line"><span class="lineno"> 4548</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4549</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4550</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4551</span>            </div>
<div class="line"><span class="lineno"> 4552</span>            <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">self_ptr</a> = <a class="code hl_class" href="classTensor.html">std::make_shared&lt;Tensor&lt;T, N&gt;</a>&gt;(*this);</div>
<div class="line"><span class="lineno"> 4553</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.push_back([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">axis</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 4554</span>                <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4555</span>                    <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>,</div>
<div class="line"><span class="lineno"> 4556</span>                                                                      <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4557</span>                    <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4558</span>                }</div>
<div class="line"><span class="lineno"> 4559</span>                </div>
<div class="line"><span class="lineno"> 4560</span>                <span class="comment">// Broadcast gradient back to original shape</span></div>
<div class="line"><span class="lineno"> 4561</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 4562</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">axis</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4563</span>                    <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4564</span>                }</div>
<div class="line"><span class="lineno"> 4565</span>                </div>
<div class="line"><span class="lineno"> 4566</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 4567</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">axis</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4568</span>                    <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4569</span>                }</div>
<div class="line"><span class="lineno"> 4570</span>                </div>
<div class="line"><span class="lineno"> 4571</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">axis_size</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>];</div>
<div class="line"><span class="lineno"> 4572</span>                </div>
<div class="line"><span class="lineno"> 4573</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4574</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4575</span>                        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">grad_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4576</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 0; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 4577</span>                            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">self_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4578</span>                            <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">self_idx</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">grad_idx</a>];</div>
<div class="line"><span class="lineno"> 4579</span>                        }</div>
<div class="line"><span class="lineno"> 4580</span>                    }</div>
<div class="line"><span class="lineno"> 4581</span>                }</div>
<div class="line"><span class="lineno"> 4582</span>                </div>
<div class="line"><span class="lineno"> 4583</span>                <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4584</span>                    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4585</span>                        <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4586</span>                    }</div>
<div class="line"><span class="lineno"> 4587</span>                }</div>
<div class="line"><span class="lineno"> 4588</span>            });</div>
<div class="line"><span class="lineno"> 4589</span>        }</div>
<div class="line"><span class="lineno"> 4590</span>        </div>
<div class="line"><span class="lineno"> 4591</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4592</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a44953b617ae85b4e9cc7906454bee59d" name="a44953b617ae85b4e9cc7906454bee59d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44953b617ae85b4e9cc7906454bee59d">&#9670;&#160;</a></span>tail()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 1&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::tail </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract last n elements (only for 1D tensors). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of elements to extract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1D tensor containing last n elements </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05093">5093</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5093</span>                                      {</div>
<div class="line"><span class="lineno"> 5094</span>        <a class="code hl_class" href="classTensor.html">return ::tail</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 1&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)), <a class="code hl_class" href="classTensor.html">n</a>);</div>
<div class="line"><span class="lineno"> 5095</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab71358eec191f202a2e95ce375133c28" name="ab71358eec191f202a2e95ce375133c28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab71358eec191f202a2e95ce375133c28">&#9670;&#160;</a></span>take()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::take </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; size_t &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>indices</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Extract elements at specific flat indices (fancy indexing). Treats the tensor as a flattened 1D array and extracts elements at the given indices. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">indices</td><td><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b" title="Type alias for 1D vectors.">Vector</a> of flat indices to extract. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new 1D tensor containing the extracted elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04403">4403</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4403</span>                                                              {</div>
<div class="line"><span class="lineno"> 4404</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 1&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>({<a class="code hl_class" href="classTensor.html">indices</a>.size()}, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 4405</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4406</span>        </div>
<div class="line"><span class="lineno"> 4407</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">indices</a>.size(); ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4408</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">indices</a>[<a class="code hl_class" href="classTensor.html">i</a>] &lt; <a class="code hl_class" href="classTensor.html">total</a>) {</div>
<div class="line"><span class="lineno"> 4409</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">indices</a>[<a class="code hl_class" href="classTensor.html">i</a>]];</div>
<div class="line"><span class="lineno"> 4410</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4411</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">T</a>(0);  <span class="comment">// Out of bounds returns zero</span></div>
<div class="line"><span class="lineno"> 4412</span>            }</div>
<div class="line"><span class="lineno"> 4413</span>        }</div>
<div class="line"><span class="lineno"> 4414</span>        </div>
<div class="line"><span class="lineno"> 4415</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4416</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ccbe9aa15ebe52d33cb890388bdf1ca" name="a0ccbe9aa15ebe52d33cb890388bdf1ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ccbe9aa15ebe52d33cb890388bdf1ca">&#9670;&#160;</a></span>tan()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::tan </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply tangent function to all elements (creates new tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with tan(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01705">1705</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1705</span>                             {</div>
<div class="line"><span class="lineno"> 1706</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::tan</a>(<a class="code hl_class" href="classTensor.html">x</a>); });</div>
<div class="line"><span class="lineno"> 1707</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7cc09049ddf2fb131becaefe19b7725a" name="a7cc09049ddf2fb131becaefe19b7725a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cc09049ddf2fb131becaefe19b7725a">&#9670;&#160;</a></span>tan_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::tan_derivative </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of tangent function. d/dx[tan(x)] = sec(x) = 1 / cos(x) </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with tan derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02169">2169</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2169</span>                                        {</div>
<div class="line"><span class="lineno"> 2170</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { </div>
<div class="line"><span class="lineno"> 2171</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">c</a> = <a class="code hl_class" href="classTensor.html">std::cos</a>(<a class="code hl_class" href="classTensor.html">x</a>);</div>
<div class="line"><span class="lineno"> 2172</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">T</a>(1) / (<a class="code hl_class" href="classTensor.html">c</a> * <a class="code hl_class" href="classTensor.html">c</a>);</div>
<div class="line"><span class="lineno"> 2173</span>        });</div>
<div class="line"><span class="lineno"> 2174</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="adcc5341aa2156f24c0f4069543c958e1" name="adcc5341aa2156f24c0f4069543c958e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcc5341aa2156f24c0f4069543c958e1">&#9670;&#160;</a></span>tanh()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::tanh </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply hyperbolic tangent (tanh) to all elements (creates new tensor). </p>
<p>Computes tanh(x) = (exp(x) - exp(-x)) / (exp(x) + exp(-x)) for each element. Alternative activation function that outputs values in (-1, 1), making it zero-centered (unlike sigmoid). Often preferred in RNNs and hidden layers.</p>
<p>Range: (-1, 1) - zero-centered output helps with convergence.</p>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with tanh(x) applied to all elements</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_tanh"></a>
Example</h1>
<div class="fragment"><div class="line"><span class="comment">// Hidden layer with tanh activation</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> hidden({32, 64}, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="keyword">auto</span> activated = hidden.tanh();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Common in RNNs for cell state updates:</span></div>
<div class="line"><span class="keyword">auto</span> cell_candidate = (W_c.matmul(concat) + b_c).tanh();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Comparison with sigmoid:</span></div>
<div class="line"><span class="keyword">auto</span> sigmoid_out = x.sigmoid();  <span class="comment">// Range: (0, 1)</span></div>
<div class="line"><span class="keyword">auto</span> tanh_out = x.tanh();        <span class="comment">// Range: (-1, 1), zero-centered</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01734">1734</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1734</span>                              {</div>
<div class="line"><span class="lineno"> 1735</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1736</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1737</span>        </div>
<div class="line"><span class="lineno"> 1738</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1739</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1740</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::tanh_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1741</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1742</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1743</span>        {</div>
<div class="line"><span class="lineno"> 1744</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1745</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::tanh</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 1746</span>            }</div>
<div class="line"><span class="lineno"> 1747</span>        }</div>
<div class="line"><span class="lineno"> 1748</span>        </div>
<div class="line"><span class="lineno"> 1749</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1750</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_adcc5341aa2156f24c0f4069543c958e1_icgraph.png" border="0" usemap="#aclassTensor_adcc5341aa2156f24c0f4069543c958e1_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_adcc5341aa2156f24c0f4069543c958e1_icgraph" id="aclassTensor_adcc5341aa2156f24c0f4069543c958e1_icgraph">
<area shape="rect" title="Apply hyperbolic tangent (tanh) to all elements (creates new tensor)." alt="" coords="183,13,276,40"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Tanh.html#a5bf1911c8b5865f171c90efbefbbe437" title=" " alt="" coords="5,5,135,48"/>
<area shape="poly" title=" " alt="" coords="167,29,135,29,135,24,167,24"/>
</map>
</div>

</div>
</div>
<a id="ab400f3516df53eb4e6547a850335571e" name="ab400f3516df53eb4e6547a850335571e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab400f3516df53eb4e6547a850335571e">&#9670;&#160;</a></span>tanh_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::tanh_derivative </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of tanh function. Given output y = tanh(x), computes dy/dx = 1 - y </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with tanh derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02072">2072</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2072</span>                                         {</div>
<div class="line"><span class="lineno"> 2073</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">y</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">y</a> * <a class="code hl_class" href="classTensor.html">y</a>; });</div>
<div class="line"><span class="lineno"> 2074</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afa485f1ec713acb3499de0a08659fc4a" name="afa485f1ec713acb3499de0a08659fc4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa485f1ec713acb3499de0a08659fc4a">&#9670;&#160;</a></span>tanh_derivative_from_input()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::tanh_derivative_from_input </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of tanh from input values. Given input x, computes d/dx[tanh(x)] = 1 - tanh(x) </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with tanh derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02081">2081</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2081</span>                                                    {</div>
<div class="line"><span class="lineno"> 2082</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) {</div>
<div class="line"><span class="lineno"> 2083</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">th</a> = <a class="code hl_class" href="classTensor.html">std::tanh</a>(<a class="code hl_class" href="classTensor.html">x</a>);</div>
<div class="line"><span class="lineno"> 2084</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">th</a> * <a class="code hl_class" href="classTensor.html">th</a>;</div>
<div class="line"><span class="lineno"> 2085</span>        });</div>
<div class="line"><span class="lineno"> 2086</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a84007917e116ae1e79622ca804360146" name="a84007917e116ae1e79622ca804360146"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84007917e116ae1e79622ca804360146">&#9670;&#160;</a></span>tile()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::tile </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>reps</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Tile (repeat) tensor multiple times along each dimension. Similar to <a class="el" href="#a9905069af5b17d1a5d1c16ec6f0a80fa">repeat()</a> but with slightly different semantics matching NumPy's tile. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">reps</td><td>Number of repetitions along each dimension </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with tiled data</dd></dl>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> A({2, 3});</div>
<div class="line"><span class="keyword">auto</span> B = A.tile({2, 2});  <span class="comment">// Tile 2x in each dimension -&gt; {4, 6}</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05026">5026</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5026</span>                                                          {</div>
<div class="line"><span class="lineno"> 5027</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a9905069af5b17d1a5d1c16ec6f0a80fa">repeat</a>(<a class="code hl_class" href="classTensor.html">reps</a>);</div>
<div class="line"><span class="lineno"> 5028</span>    }</div>
<div class="ttc" id="aclassTensor_html_a9905069af5b17d1a5d1c16ec6f0a80fa"><div class="ttname"><a href="#a9905069af5b17d1a5d1c16ec6f0a80fa">Tensor::repeat</a></div><div class="ttdeci">Tensor&lt; T, N &gt; repeat(const TensorIndices&lt; N &gt; &amp;repeats) const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l04972">tensor.h:4972</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af09f3224c551629f43c48c18a1fe87ee" name="af09f3224c551629f43c48c18a1fe87ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af09f3224c551629f43c48c18a1fe87ee">&#9670;&#160;</a></span>topRows()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::topRows </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract top n rows (only for 2D tensors). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of rows to extract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>2D tensor containing top n rows </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05103">5103</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5103</span>                                         {</div>
<div class="line"><span class="lineno"> 5104</span>        <a class="code hl_class" href="classTensor.html">return ::topRows</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)), <a class="code hl_class" href="classTensor.html">n</a>);</div>
<div class="line"><span class="lineno"> 5105</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aad6aeb4859940befd0c46f0b99388bd7" name="aad6aeb4859940befd0c46f0b99388bd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad6aeb4859940befd0c46f0b99388bd7">&#9670;&#160;</a></span>total_size()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::total_size </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the total size of the tensor. </p><dl class="section return"><dt>Returns</dt><dd>The total number of elements in the tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00511">511</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  511</span>                              {</div>
<div class="line"><span class="lineno">  512</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">size</a> = 1;</div>
<div class="line"><span class="lineno">  513</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno">  514</span>            <a class="code hl_class" href="classTensor.html">size</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno">  515</span>        }</div>
<div class="line"><span class="lineno">  516</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">size</a>;</div>
<div class="line"><span class="lineno">  517</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aed9419fabd015e2c1c35ff6723c1600a" name="aed9419fabd015e2c1c35ff6723c1600a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed9419fabd015e2c1c35ff6723c1600a">&#9670;&#160;</a></span>transpose()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::transpose </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Transpose 2D tensor (swap dimensions 0 and 1). For N&gt;2, this swaps the last two dimensions. </p><dl class="section return"><dt>Returns</dt><dd>Transposed tensor </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04004">4004</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4004</span>                                   {</div>
<div class="line"><span class="lineno"> 4005</span>        <span class="keyword">static_assert</span>(<a class="code hl_class" href="classTensor.html">N</a> &gt;= 2, <span class="stringliteral">&quot;Transpose requires at least 2 dimensions&quot;</span>);</div>
<div class="line"><span class="lineno"> 4006</span>        </div>
<div class="line"><span class="lineno"> 4007</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 4008</span>        <a class="code hl_class" href="classTensor.html">std::swap</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">N</a>-2], <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">N</a>-1]);</div>
<div class="line"><span class="lineno"> 4009</span>        </div>
<div class="line"><span class="lineno"> 4010</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4011</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4012</span>        </div>
<div class="line"><span class="lineno"> 4013</span>        <span class="comment">// Transpose the last two dimensions</span></div>
<div class="line"><span class="lineno"> 4014</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<a class="code hl_class" href="classTensor.html">N</a> == 2) {</div>
<div class="line"><span class="lineno"> 4015</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0]; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4016</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">j</a> = 0; <a class="code hl_class" href="classTensor.html">j</a> &lt; <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[1]; ++<a class="code hl_class" href="classTensor.html">j</a>) {</div>
<div class="line"><span class="lineno"> 4017</span>                    <a class="code hl_class" href="classTensor.html">result</a>[{<a class="code hl_class" href="classTensor.html">j</a>, <a class="code hl_class" href="classTensor.html">i</a>}] = (*this)[{<a class="code hl_class" href="classTensor.html">i</a>, <a class="code hl_class" href="classTensor.html">j</a>}];</div>
<div class="line"><span class="lineno"> 4018</span>                }</div>
<div class="line"><span class="lineno"> 4019</span>            }</div>
<div class="line"><span class="lineno"> 4020</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4021</span>            <span class="comment">// For N&gt;2, transpose last two dims while iterating over others</span></div>
<div class="line"><span class="lineno"> 4022</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 4023</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>-2; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4024</span>                <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4025</span>            }</div>
<div class="line"><span class="lineno"> 4026</span>            </div>
<div class="line"><span class="lineno"> 4027</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4028</span>                <span class="comment">// Compute indices for outer dimensions</span></div>
<div class="line"><span class="lineno"> 4029</span>                <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">base_idx</a>;</div>
<div class="line"><span class="lineno"> 4030</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">o</a>;</div>
<div class="line"><span class="lineno"> 4031</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">N</a>-3; <a class="code hl_class" href="classTensor.html">i</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4032</span>                    <a class="code hl_class" href="classTensor.html">base_idx</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4033</span>                    <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4034</span>                }</div>
<div class="line"><span class="lineno"> 4035</span>                </div>
<div class="line"><span class="lineno"> 4036</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">N</a>-2]; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4037</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">j</a> = 0; <a class="code hl_class" href="classTensor.html">j</a> &lt; <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">N</a>-1]; ++<a class="code hl_class" href="classTensor.html">j</a>) {</div>
<div class="line"><span class="lineno"> 4038</span>                        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">base_idx</a>;</div>
<div class="line"><span class="lineno"> 4039</span>                        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">dst_idx</a> = <a class="code hl_class" href="classTensor.html">base_idx</a>;</div>
<div class="line"><span class="lineno"> 4040</span>                        <a class="code hl_class" href="classTensor.html">src_idx</a>[<a class="code hl_class" href="classTensor.html">N</a>-2] = <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4041</span>                        <a class="code hl_class" href="classTensor.html">src_idx</a>[<a class="code hl_class" href="classTensor.html">N</a>-1] = <a class="code hl_class" href="classTensor.html">j</a>;</div>
<div class="line"><span class="lineno"> 4042</span>                        <a class="code hl_class" href="classTensor.html">dst_idx</a>[<a class="code hl_class" href="classTensor.html">N</a>-2] = <a class="code hl_class" href="classTensor.html">j</a>;</div>
<div class="line"><span class="lineno"> 4043</span>                        <a class="code hl_class" href="classTensor.html">dst_idx</a>[<a class="code hl_class" href="classTensor.html">N</a>-1] = <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4044</span>                        <a class="code hl_class" href="classTensor.html">result</a>[<a class="code hl_class" href="classTensor.html">dst_idx</a>] = (*this)[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 4045</span>                    }</div>
<div class="line"><span class="lineno"> 4046</span>                }</div>
<div class="line"><span class="lineno"> 4047</span>            }</div>
<div class="line"><span class="lineno"> 4048</span>        }</div>
<div class="line"><span class="lineno"> 4049</span>        </div>
<div class="line"><span class="lineno"> 4050</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 4051</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4052</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4053</span>            </div>
<div class="line"><span class="lineno"> 4054</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 4055</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4056</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4057</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, </div>
<div class="line"><span class="lineno"> 4058</span>                                                                          <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4059</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4060</span>                    }</div>
<div class="line"><span class="lineno"> 4061</span>                    </div>
<div class="line"><span class="lineno"> 4062</span>                    <span class="comment">// Gradient of transpose is transpose of gradient</span></div>
<div class="line"><span class="lineno"> 4063</span>                    <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">grad_transposed</a> = <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.transpose();</div>
<div class="line"><span class="lineno"> 4064</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4065</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4066</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_class" href="classTensor.html">grad_transposed</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4067</span>                    }</div>
<div class="line"><span class="lineno"> 4068</span>                    </div>
<div class="line"><span class="lineno"> 4069</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4070</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4071</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4072</span>                        }</div>
<div class="line"><span class="lineno"> 4073</span>                    }</div>
<div class="line"><span class="lineno"> 4074</span>                }</div>
<div class="line"><span class="lineno"> 4075</span>            });</div>
<div class="line"><span class="lineno"> 4076</span>        }</div>
<div class="line"><span class="lineno"> 4077</span>        </div>
<div class="line"><span class="lineno"> 4078</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4079</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_aed9419fabd015e2c1c35ff6723c1600a_icgraph.png" border="0" usemap="#aclassTensor_aed9419fabd015e2c1c35ff6723c1600a_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_aed9419fabd015e2c1c35ff6723c1600a_icgraph" id="aclassTensor_aed9419fabd015e2c1c35ff6723c1600a_icgraph">
<area shape="rect" title=" " alt="" coords="190,13,315,40"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Linear.html#a5364162aed6bb8c7758d88142ac74c1b" title=" " alt="" coords="5,5,142,48"/>
<area shape="poly" title=" " alt="" coords="174,29,142,29,142,24,174,24"/>
</map>
</div>

</div>
</div>
<a id="a415f8016d31d376bb769402ce2ab5393" name="a415f8016d31d376bb769402ce2ab5393"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a415f8016d31d376bb769402ce2ab5393">&#9670;&#160;</a></span>uniform()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::uniform </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>low</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(0)</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>high</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(1)</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sample from uniform distribution [low, high). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">low</td><td>Lower bound (inclusive). </td></tr>
    <tr><td class="paramname">high</td><td>Upper bound (exclusive). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02909">2909</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2909</span>                                              {</div>
<div class="line"><span class="lineno"> 2910</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2911</span>        <a class="code hl_class" href="classTensor.html">std::random_device</a> <a class="code hl_class" href="classTensor.html">rd</a>;</div>
<div class="line"><span class="lineno"> 2912</span>        <a class="code hl_class" href="classTensor.html">std::mt19937</a> <a class="code hl_class" href="classTensor.html">gen</a>(<a class="code hl_class" href="classTensor.html">rd</a>());</div>
<div class="line"><span class="lineno"> 2913</span>        <a class="code hl_class" href="classTensor.html">std::uniform_real_distribution&lt;&gt;</a> <a class="code hl_class" href="classTensor.html">dis</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">low</a>), <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">high</a>));</div>
<div class="line"><span class="lineno"> 2914</span>        </div>
<div class="line"><span class="lineno"> 2915</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2916</span>            <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">dis</a>(<a class="code hl_class" href="classTensor.html">gen</a>));</div>
<div class="line"><span class="lineno"> 2917</span>        }</div>
<div class="line"><span class="lineno"> 2918</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac953ca944380b138ad1e524a1124070f" name="ac953ca944380b138ad1e524a1124070f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac953ca944380b138ad1e524a1124070f">&#9670;&#160;</a></span>unsqueeze()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N + 1&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, M &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::unsqueeze </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>axis</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Unsqueeze - add a dimension of size 1 at specified axis. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>Position to add the new dimension </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> with added dimension, or zero tensor if axis is invalid </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04220">4220</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4220</span>                                              {</div>
<div class="line"><span class="lineno"> 4221</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &gt; <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 4222</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;M&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 4223</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, M&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4224</span>        }</div>
<div class="line"><span class="lineno"> 4225</span>        </div>
<div class="line"><span class="lineno"> 4226</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;M&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a>;</div>
<div class="line"><span class="lineno"> 4227</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">axis</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4228</span>            <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4229</span>        }</div>
<div class="line"><span class="lineno"> 4230</span>        <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">axis</a>] = 1;</div>
<div class="line"><span class="lineno"> 4231</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">axis</a>; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4232</span>            <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>+1] = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4233</span>        }</div>
<div class="line"><span class="lineno"> 4234</span>        </div>
<div class="line"><span class="lineno"> 4235</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, M&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4236</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4237</span>        </div>
<div class="line"><span class="lineno"> 4238</span>        <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno"> 4239</span>        </div>
<div class="line"><span class="lineno"> 4240</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4241</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">orig_dims</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 4242</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4243</span>            </div>
<div class="line"><span class="lineno"> 4244</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">orig_dims</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, M&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 4245</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4246</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4247</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">orig_dims</a>, </div>
<div class="line"><span class="lineno"> 4248</span>                                                                          <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4249</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4250</span>                    }</div>
<div class="line"><span class="lineno"> 4251</span>                    </div>
<div class="line"><span class="lineno"> 4252</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4253</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4254</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4255</span>                    }</div>
<div class="line"><span class="lineno"> 4256</span>                    </div>
<div class="line"><span class="lineno"> 4257</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4258</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4259</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4260</span>                        }</div>
<div class="line"><span class="lineno"> 4261</span>                    }</div>
<div class="line"><span class="lineno"> 4262</span>                }</div>
<div class="line"><span class="lineno"> 4263</span>            });</div>
<div class="line"><span class="lineno"> 4264</span>        }</div>
<div class="line"><span class="lineno"> 4265</span>        </div>
<div class="line"><span class="lineno"> 4266</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4267</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a83ae42925e21d2871d755407d7505c10" name="a83ae42925e21d2871d755407d7505c10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83ae42925e21d2871d755407d7505c10">&#9670;&#160;</a></span>uses_gpu()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::uses_gpu </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if tensor uses GPU. </p><dl class="section return"><dt>Returns</dt><dd>True if GPU is enabled for this tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00656">656</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  656</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>; }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a83ae42925e21d2871d755407d7505c10_icgraph.png" border="0" usemap="#aclassTensor_a83ae42925e21d2871d755407d7505c10_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a83ae42925e21d2871d755407d7505c10_icgraph" id="aclassTensor_a83ae42925e21d2871d755407d7505c10_icgraph">
<area shape="rect" title=" " alt="" coords="799,1185,923,1212"/>
<area shape="rect" href="tensor_8h.html#a912e291f7a42f325c111def58ac98acf" title="Cast tensor to a different data type (NumPy&#45;compatible astype)." alt="" coords="637,5,698,32"/>
<area shape="poly" title=" " alt="" coords="856,1170,847,935,828,577,813,395,795,235,774,112,761,71,749,46,738,36,726,30,698,22,699,17,727,25,741,32,753,42,766,69,779,111,800,234,818,395,833,577,853,935,861,1170"/>
<area shape="rect" href="namespaceloss.html#a365059b00ea1e6ec1db86710cfcf3b31" title="Binary cross entropy loss for binary classification." alt="" coords="604,56,731,99"/>
<area shape="poly" title=" " alt="" coords="856,1170,845,948,824,612,809,441,791,290,771,175,760,136,749,112,730,96,733,92,753,109,765,134,776,174,797,290,814,441,829,611,851,947,861,1170"/>
<area shape="rect" href="tensor_8h.html#adc912199dacbff108e0d2cadfae000df" title="Extract a rectangular block from a 2D tensor." alt="" coords="641,123,694,149"/>
<area shape="poly" title=" " alt="" coords="856,1170,845,957,824,636,809,474,792,331,771,222,760,185,749,163,737,153,723,146,694,139,695,134,725,141,740,149,753,160,765,183,777,221,797,330,815,474,829,636,851,956,861,1170"/>
<area shape="rect" href="tensor_8h.html#aa94ca571f8bc2b76cd1bdb6fd851c556" title="Extract bottom n rows from a 2D tensor." alt="" coords="620,173,715,200"/>
<area shape="poly" title=" " alt="" coords="856,1170,844,966,823,662,808,508,790,372,770,269,760,235,749,214,734,201,715,194,717,189,736,197,753,210,765,233,776,268,796,372,813,507,828,661,850,966,861,1170"/>
<area shape="rect" href="namespacelinalg.html#a12137fd985ff57d9e9396c8f6919383e" title="Cholesky decomposition: A = L * L^T for symmetric positive definite matrices." alt="" coords="362,477,527,504"/>
<area shape="poly" title=" " alt="" coords="856,1170,848,1043,831,865,817,774,799,691,776,622,763,596,749,577,734,565,713,554,657,534,591,518,527,506,528,500,592,513,658,529,715,549,737,560,753,573,767,594,781,620,804,689,822,773,836,864,854,1043,861,1170"/>
<area shape="rect" href="tensor_8h.html#a64dfa8c2475ed50ae00ef1d4e1c12fd2" title="Divide tensor into equal&#45;sized chunks (last chunk may be smaller)." alt="" coords="639,1008,696,1035"/>
<area shape="poly" title=" " alt="" coords="845,1173,807,1110,781,1077,749,1049,723,1035,696,1028,697,1023,725,1030,752,1044,785,1073,812,1107,849,1170"/>
<area shape="rect" href="tensor_8h.html#a139335a446015c5f7ad70fa3d2ccfbec" title="Split tensor into chunks along specified axis." alt="" coords="422,996,467,1023"/>
<area shape="poly" title=" " alt="" coords="853,1171,843,1125,824,1070,793,1016,773,993,749,974,714,958,675,951,635,951,595,956,523,977,469,1000,467,995,521,972,594,951,635,945,676,945,715,953,752,970,777,989,798,1013,829,1068,848,1124,858,1170"/>
<area shape="rect" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74" title="Extract a single column from a 2D tensor." alt="" coords="648,224,687,251"/>
<area shape="poly" title=" " alt="" coords="857,1170,857,990,853,862,845,722,832,581,813,452,785,345,768,303,749,271,735,259,719,250,686,242,688,237,721,245,738,254,753,268,773,301,790,343,818,451,838,581,851,721,858,861,862,990,863,1170"/>
<area shape="rect" href="namespacelinalg.html#a6b7af062b5a9642d788fcc084335b39c" title=" " alt="" coords="374,275,515,301"/>
<area shape="poly" title=" " alt="" coords="855,1170,844,983,823,710,808,573,791,453,771,362,760,333,749,315,722,295,692,281,660,272,627,267,560,268,501,277,501,271,559,263,627,262,661,267,694,276,725,291,753,312,765,330,776,361,796,452,813,572,828,709,850,982,861,1169"/>
<area shape="rect" href="namespacelinalg.html#a61b846dd17050c602c624ff0a898d617" title=" " alt="" coords="5,376,96,403"/>
<area shape="poly" title=" " alt="" coords="857,1170,853,1024,839,815,826,708,807,610,781,531,766,500,749,478,736,470,715,462,649,447,461,422,254,404,96,394,97,389,254,399,462,417,650,442,716,457,739,465,752,474,770,498,786,529,812,609,831,707,844,815,859,1024,862,1170"/>
<area shape="rect" href="tensor_8h.html#a3331b6cf4ac182d022336e4d068a0e58" title="Create a copy of a tensor (NumPy&#45;compatible)." alt="" coords="643,1059,692,1085"/>
<area shape="poly" title=" " alt="" coords="836,1175,798,1136,749,1100,720,1087,692,1079,693,1074,722,1082,752,1095,802,1132,840,1171"/>
<area shape="rect" href="namespaceloss.html#a75edef9d102d2ab811b15c50f13c4eee" title="Cross entropy loss for multi&#45;class classification." alt="" coords="584,1109,751,1136"/>
<area shape="poly" title=" " alt="" coords="817,1180,750,1150,717,1139,719,1134,752,1146,820,1176"/>
<area shape="rect" href="tensor_8h.html#a43014e3309494c3851da86be3a162194" title="Extract the diagonal of a 2D tensor." alt="" coords="645,1160,690,1187"/>
<area shape="poly" title=" " alt="" coords="783,1191,690,1179,691,1174,783,1186"/>
<area shape="rect" href="namespacelinalg.html#ad030750ea599dfc970dc357fd319ebea" title=" " alt="" coords="626,1211,709,1237"/>
<area shape="poly" title=" " alt="" coords="784,1211,710,1221,709,1216,783,1206"/>
<area shape="rect" href="namespacelinalg.html#a1df90002eef905350589edef7a4ace1b" title=" " alt="" coords="626,1261,709,1288"/>
<area shape="poly" title=" " alt="" coords="820,1222,752,1252,710,1266,709,1261,750,1247,817,1217"/>
<area shape="rect" href="tensor_8h.html#ae66ddfcd20907014f524982e01698d82" title="Create a diagonal matrix from a 1D tensor." alt="" coords="623,1312,712,1339"/>
<area shape="poly" title=" " alt="" coords="840,1226,802,1265,752,1302,713,1318,711,1313,749,1298,798,1261,836,1222"/>
<area shape="rect" href="namespacelinalg.html#a4f401211bb16058dcce20c796bda8dd2" title="Compute dot product of two vectors." alt="" coords="629,1363,706,1389"/>
<area shape="poly" title=" " alt="" coords="849,1227,812,1290,785,1324,752,1353,730,1365,707,1372,706,1367,728,1360,749,1348,781,1320,807,1287,845,1224"/>
<area shape="rect" href="namespacelinalg.html#a7141076f8e6b39635853e8368a13c4ea" title="Compute eigenvalues and eigenvectors for symmetric matrices." alt="" coords="380,731,509,757"/>
<area shape="poly" title=" " alt="" coords="854,1170,843,1077,822,954,807,892,790,837,771,793,749,765,721,746,690,733,658,726,624,722,557,724,500,733,499,727,557,718,624,717,658,720,692,728,724,742,752,761,775,790,795,835,812,891,827,953,848,1076,859,1170"/>
<area shape="rect" href="tensor_8h.html#a04c7965d0b8f08cfdb84580050e9e0b5" title="Extract first n elements from a 1D tensor." alt="" coords="643,1413,692,1440"/>
<area shape="poly" title=" " alt="" coords="854,1228,841,1267,820,1314,791,1362,752,1403,723,1419,693,1427,692,1422,721,1414,749,1399,786,1359,815,1312,836,1265,849,1226"/>
<area shape="rect" href="namespacelinalg.html#abc25aee98d873c690a7d8a88277e7219" title="Compute inverse of a square matrix." alt="" coords="174,629,275,656"/>
<area shape="poly" title=" " alt="" coords="857,1170,853,1107,838,1026,824,984,806,945,781,909,749,879,723,863,698,853,674,848,650,848,603,856,556,871,509,888,459,898,434,899,407,895,380,887,352,873,323,851,298,824,277,793,261,761,237,701,226,657,231,656,243,699,266,759,282,791,302,820,326,847,354,868,382,882,408,890,434,893,459,893,507,883,554,866,601,851,649,842,674,843,700,848,726,859,752,875,785,905,810,942,829,982,843,1025,858,1106,862,1170"/>
<area shape="rect" href="namespacelinalg.html#a7b56c15653bd4614605326c1ced1a36d" title="Compute Kronecker product of two matrices." alt="" coords="625,1464,710,1491"/>
<area shape="poly" title=" " alt="" coords="858,1228,847,1277,827,1338,797,1400,776,1429,752,1454,733,1467,711,1474,709,1469,730,1462,749,1450,772,1425,792,1397,822,1336,842,1276,853,1227"/>
<area shape="rect" href="namespaceloss.html#ab7fbd0200f34e3d12f66d20b681a948f" title="L1 loss (Mean Absolute Error)." alt="" coords="620,1515,715,1541"/>
<area shape="poly" title=" " alt="" coords="860,1228,852,1286,834,1360,821,1399,803,1437,780,1473,752,1505,735,1517,716,1524,714,1519,733,1512,749,1501,776,1470,798,1435,816,1397,829,1358,847,1285,855,1227"/>
<area shape="rect" href="tensor_8h.html#a0d1116cdf6624cb52514979cd1869e55" title="Extract leftmost n columns from a 2D tensor." alt="" coords="634,1565,701,1592"/>
<area shape="poly" title=" " alt="" coords="862,1228,857,1294,841,1382,827,1428,808,1474,784,1517,752,1555,728,1571,702,1578,701,1573,726,1566,749,1551,779,1514,804,1472,822,1427,836,1381,852,1293,857,1227"/>
<area shape="rect" href="namespacelinalg.html#a8405b084d692b1fc7f685f40425a0970" title="Solve least squares problem: minimize ||Ax &#45; b||" alt="" coords="7,604,94,631"/>
<area shape="poly" title=" " alt="" coords="854,1171,845,1120,827,1057,813,1025,796,994,775,967,749,943,723,927,698,915,651,904,605,904,559,912,513,921,463,927,410,923,352,904,300,875,251,841,206,802,165,762,99,686,59,633,63,630,103,683,169,758,209,798,254,837,303,871,354,899,411,917,463,921,512,916,558,907,604,899,651,898,700,910,726,922,752,939,779,963,800,991,818,1023,832,1055,850,1119,859,1170"/>
<area shape="rect" href="namespacelinalg.html#a299049265c4cb34923444e82e56f381f" title="Compute LU decomposition with partial pivoting: P*A = L*U." alt="" coords="384,579,506,605"/>
<area shape="poly" title=" " alt="" coords="856,1170,849,1050,832,882,818,798,800,721,777,659,763,636,749,619,722,600,693,587,661,578,628,573,562,573,504,581,504,575,562,568,628,568,662,572,694,581,725,596,752,615,768,633,781,657,805,720,823,797,837,882,854,1049,861,1170"/>
<area shape="rect" href="namespacelinalg.html#a49a644f54af36b484886d433da564a1f" title="Solve linear system Ax = b." alt="" coords="179,528,270,555"/>
<area shape="poly" title=" " alt="" coords="856,1170,850,1034,833,842,819,743,801,653,778,579,764,550,749,529,719,506,674,486,620,471,560,460,499,454,442,453,392,458,354,468,339,478,330,491,322,505,306,518,271,534,269,529,304,514,318,501,326,488,335,474,352,463,391,452,441,448,499,449,561,455,621,466,676,481,721,501,753,525,768,547,783,577,806,651,825,742,839,841,855,1034,861,1170"/>
<area shape="rect" href="namespacelinalg.html#a6ee776536e47c3e57b3b24ed6225bff2" title=" " alt="" coords="616,376,719,403"/>
<area shape="poly" title=" " alt="" coords="857,1170,852,1017,837,794,823,678,805,572,780,484,765,449,749,423,735,411,718,402,720,397,738,406,753,420,770,447,785,482,810,570,829,677,842,793,858,1017,862,1170"/>
<area shape="rect" href="namespacelinalg.html#a57a91e9770c813128f00c0a1ea674012" title=" " alt="" coords="616,1616,719,1643"/>
<area shape="poly" title=" " alt="" coords="863,1228,861,1303,848,1404,834,1458,814,1511,787,1561,753,1606,737,1617,720,1625,718,1620,735,1613,749,1602,783,1558,809,1509,829,1456,842,1402,856,1302,858,1228"/>
<area shape="rect" href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7" title="Mean Squared Error (MSE) Loss." alt="" coords="613,1667,722,1693"/>
<area shape="poly" title=" " alt="" coords="859,1228,846,1323,824,1451,810,1516,793,1575,774,1623,753,1656,739,1667,724,1674,722,1670,736,1663,749,1653,769,1621,788,1573,805,1515,819,1450,841,1323,854,1227"/>
<area shape="rect" href="namespacelinalg.html#a16562e1c4018bf2a58455158a8022fb9" title="Compute the L2 norm (Euclidean norm) of a vector." alt="" coords="623,1768,712,1795"/>
<area shape="poly" title=" " alt="" coords="860,1228,850,1341,829,1497,815,1576,797,1649,777,1709,753,1751,734,1766,713,1776,711,1771,732,1762,749,1748,772,1707,792,1647,810,1575,824,1496,844,1340,855,1227"/>
<area shape="rect" href="namespacelinalg.html#afbe723a0bf8fb7dc2d98815c1ea724b2" title="Normalize a vector to unit length." alt="" coords="387,1743,502,1769"/>
<area shape="poly" title=" " alt="" coords="860,1228,850,1334,830,1478,816,1551,798,1617,777,1671,753,1707,734,1719,709,1729,643,1743,570,1752,503,1757,503,1751,569,1747,643,1738,707,1724,732,1714,749,1703,773,1668,793,1615,811,1550,825,1477,845,1334,855,1227"/>
<area shape="rect" href="tensor_8h.html#aa8d30c4d06f085bf8078c8644030c633" title="Normalize tensor using L1 norm (sum of absolute values)." alt="" coords="620,1819,715,1845"/>
<area shape="poly" title=" " alt="" coords="861,1228,853,1352,834,1525,820,1614,802,1695,780,1762,767,1788,753,1809,736,1822,716,1829,714,1824,733,1817,749,1805,762,1785,775,1760,797,1694,815,1613,829,1524,847,1351,856,1227"/>
<area shape="rect" href="tensor_8h.html#a7718d2096a1190de7777bc65f9a86deb" title="Normalize tensor using L2 norm (Euclidean norm)." alt="" coords="620,1869,715,1896"/>
<area shape="poly" title=" " alt="" coords="861,1227,855,1360,837,1549,823,1646,805,1735,782,1808,768,1837,753,1859,736,1872,716,1880,714,1875,733,1868,749,1856,763,1834,777,1806,800,1734,818,1645,832,1549,849,1360,856,1227"/>
<area shape="rect" href="tensor_8h.html#a1782e0dff417e1292f8a6f1e3e1975f1" title="Min&#45;Max normalization: scales values to [min_val, max_val] range." alt="" coords="602,1920,733,1947"/>
<area shape="poly" title=" " alt="" coords="862,1227,856,1369,840,1573,827,1678,808,1775,784,1855,769,1886,753,1910,735,1924,731,1919,749,1906,764,1883,779,1853,803,1774,821,1678,835,1573,851,1369,856,1227"/>
<area shape="rect" href="tensor_8h.html#a57c931d0d77f610850f315fdd9acef39" title="Z&#45;score normalization (standardization): (x &#45; mean) / std." alt="" coords="606,1971,729,1997"/>
<area shape="poly" title=" " alt="" coords="862,1228,858,1379,843,1598,830,1711,811,1815,785,1901,770,1935,753,1961,731,1976,728,1972,749,1957,765,1932,780,1899,806,1814,824,1710,838,1597,853,1379,857,1228"/>
<area shape="rect" href="namespacelinalg.html#a8a8d04b2734fdcad37cc861687fbb6fc" title=" " alt="" coords="623,2021,712,2048"/>
<area shape="poly" title=" " alt="" coords="862,1228,860,1387,846,1622,833,1743,814,1855,787,1947,771,1983,753,2011,734,2025,713,2033,711,2028,732,2021,749,2008,766,1981,782,1945,808,1854,828,1742,841,1621,854,1387,857,1227"/>
<area shape="rect" href="namespacelinalg.html#a3395139856f5efebaa58f3bc9c4ed3bd" title="QR decomposition: A = QR." alt="" coords="383,781,506,808"/>
<area shape="poly" title=" " alt="" coords="853,1170,841,1084,819,972,805,917,788,868,770,828,749,803,719,785,687,773,652,767,616,765,548,771,491,783,490,778,547,766,616,760,653,762,688,768,722,780,752,799,774,826,793,866,810,916,824,971,846,1083,859,1169"/>
<area shape="rect" href="tensor_8h.html#ad71687cadd6e7bdae0f2d66fc9f437e1" title="Construct tensor by repeating along specified axis." alt="" coords="604,2072,731,2099"/>
<area shape="poly" title=" " alt="" coords="863,1228,861,1396,857,1516,849,1646,836,1775,817,1895,789,1993,772,2032,753,2062,733,2077,730,2072,749,2058,768,2029,784,1992,811,1894,831,1775,844,1645,852,1516,856,1396,857,1228"/>
<area shape="rect" href="tensor_8h.html#a3798be100af6c60da8c8489ba3ac808a" title="Extract rightmost n columns from a 2D tensor." alt="" coords="631,2123,704,2149"/>
<area shape="poly" title=" " alt="" coords="861,1228,848,1418,826,1698,811,1840,793,1964,774,2059,764,2092,753,2112,731,2128,706,2136,704,2131,728,2124,749,2109,759,2090,769,2058,788,1964,805,1839,820,1698,843,1418,855,1227"/>
<area shape="rect" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee" title="Extract a single row from a 2D tensor." alt="" coords="646,325,689,352"/>
<area shape="poly" title=" " alt="" coords="857,1169,855,1005,842,764,829,639,810,525,783,430,767,394,749,366,736,355,721,348,689,342,690,336,722,343,739,351,753,362,772,391,788,428,815,523,834,639,848,764,860,1005,862,1169"/>
<area shape="rect" href="namespaceloss.html#a2d2c1dacdb37d834f7dc10e85cd1a742" title="Smooth L1 loss (Huber loss)." alt="" coords="595,2173,740,2200"/>
<area shape="poly" title=" " alt="" coords="861,1228,849,1428,827,1724,812,1874,795,2006,775,2107,764,2141,753,2163,739,2175,735,2171,749,2160,759,2139,770,2106,790,2005,807,1873,822,1724,844,1427,855,1227"/>
<area shape="rect" href="namespacelinalg.html#a2e81c90534586128fa4bcae3bb042175" title="Singular Value Decomposition: A = U * Sigma * V^T." alt="" coords="378,832,511,859"/>
<area shape="poly" title=" " alt="" coords="853,1170,840,1089,817,985,787,888,769,852,749,829,732,821,709,817,647,816,577,824,512,834,511,829,577,818,647,811,709,811,734,816,752,825,773,849,792,886,822,984,845,1088,858,1170"/>
<area shape="rect" href="tensor_8h.html#a90d629271a42d730c36b7be1f66deae8" title="Extract last n elements from a 1D tensor." alt="" coords="648,2224,687,2251"/>
<area shape="poly" title=" " alt="" coords="861,1228,850,1437,829,1750,814,1908,796,2048,776,2154,765,2191,753,2214,738,2226,721,2234,688,2240,687,2235,720,2229,736,2221,749,2210,760,2189,771,2153,791,2047,809,1907,823,1749,845,1437,856,1228"/>
<area shape="rect" href="tensor_8h.html#ac2791cd88647d71068c02d8824a38ff2" title="Repeat tensor multiple times along each dimension." alt="" coords="648,2275,687,2301"/>
<area shape="poly" title=" " alt="" coords="861,1228,851,1446,830,1775,815,1942,798,2089,777,2202,765,2240,753,2264,738,2277,721,2284,688,2290,687,2285,720,2279,736,2272,749,2261,760,2238,772,2201,792,2089,810,1941,825,1775,846,1446,856,1227"/>
<area shape="rect" href="tensor_8h.html#a1cb2cae503ca515b1780c72fd05b21db" title="Extract top n rows from a 2D tensor." alt="" coords="631,2325,704,2352"/>
<area shape="poly" title=" " alt="" coords="861,1227,852,1455,832,1800,817,1976,799,2131,778,2249,766,2290,753,2315,731,2331,705,2339,704,2334,728,2327,749,2312,761,2288,773,2248,794,2130,812,1975,826,1800,847,1455,856,1227"/>
<area shape="rect" href="namespacelinalg.html#af0c07b2c6a745bcb68c10766032cc5e0" title=" " alt="" coords="609,629,726,656"/>
<area shape="poly" title=" " alt="" coords="854,1170,843,1062,822,915,808,840,791,771,771,715,749,676,724,659,728,654,753,673,776,713,796,770,813,839,828,914,849,1062,860,1170"/>
<area shape="rect" href="classMemoryPool.html#a980db306a49ce0f4b149198a99b6d24e" title="Clear all pooled memory." alt="" coords="380,148,510,175"/>
<area shape="poly" title=" " alt="" coords="626,143,511,157,510,151,626,138"/>
<area shape="rect" href="classMemoryPool.html#a842e63c49f94b807e42b8ed5897bd1bb" title="Destructor &#45; frees all pooled memory." alt="" coords="353,97,536,124"/>
<area shape="poly" title=" " alt="" coords="625,134,536,124,537,118,626,129"/>
<area shape="rect" href="tensor__c_8cpp.html#ae83aa792d547c4137efbfed451c7357c" title=" " alt="" coords="144,477,305,504"/>
<area shape="poly" title=" " alt="" coords="347,493,305,493,305,488,347,488"/>
<area shape="poly" title=" " alt="" coords="702,998,692,990,667,987,647,989,636,994,634,1000,641,1007,637,1011,629,1001,632,990,645,984,668,981,694,985,705,994"/>
<area shape="poly" title=" " alt="" coords="623,1022,468,1013,468,1008,624,1016"/>
<area shape="poly" title=" " alt="" coords="634,248,507,277,506,271,632,242"/>
<area shape="poly" title=" " alt="" coords="633,239,544,239,420,249,351,259,280,274,211,295,145,322,102,350,68,378,65,374,99,345,142,318,209,290,279,269,350,254,419,243,544,234,633,233"/>
<area shape="poly" title=" " alt="" coords="369,612,276,634,275,628,368,607"/>
<area shape="poly" title=" " alt="" coords="368,577,269,554,271,549,369,572"/>
<area shape="poly" title=" " alt="" coords="163,530,142,518,112,491,87,459,56,404,60,402,92,456,116,487,145,514,166,525"/>
<area shape="poly" title=" " alt="" coords="179,564,84,606,82,601,177,559"/>
<area shape="poly" title=" " alt="" coords="600,375,583,366,568,355,558,344,549,333,535,322,495,304,497,299,538,318,553,329,562,340,572,351,586,362,603,370"/>
<area shape="poly" title=" " alt="" coords="601,384,504,379,446,380,385,385,322,395,260,412,200,435,145,467,112,499,87,538,69,575,59,604,54,602,64,573,82,535,108,496,142,463,198,431,258,407,321,390,384,380,446,375,504,374,601,378"/>
<area shape="poly" title=" " alt="" coords="607,1777,502,1765,503,1760,608,1772"/>
<area shape="poly" title=" " alt="" coords="630,333,506,305,507,299,632,328"/>
<area shape="poly" title=" " alt="" coords="640,620,585,566,535,525,496,507,498,502,538,520,588,562,644,616"/>
<area shape="poly" title=" " alt="" coords="647,617,452,303,457,300,652,615"/>
<area shape="poly" title=" " alt="" coords="611,664,586,677,562,696,538,714,495,733,493,728,535,710,559,691,583,672,609,660"/>
<area shape="poly" title=" " alt="" coords="594,645,275,645,275,640,594,640"/>
<area shape="poly" title=" " alt="" coords="594,662,503,678,389,689,328,691,266,689,203,683,143,671,102,654,69,634,72,629,105,649,144,665,204,677,266,684,328,686,389,684,502,673,594,657"/>
<area shape="poly" title=" " alt="" coords="593,629,506,609,507,603,595,623"/>
<area shape="poly" title=" " alt="" coords="635,622,589,593,535,569,464,553,392,544,325,541,270,542,270,536,325,536,392,539,465,547,537,564,592,589,638,618"/>
<area shape="poly" title=" " alt="" coords="643,669,538,772,508,785,506,780,535,767,640,665"/>
<area shape="poly" title=" " alt="" coords="652,671,596,755,565,796,538,822,513,835,511,830,535,818,561,792,591,752,647,668"/>
</map>
</div>

</div>
</div>
<a id="ac24ac40382bfcce441f59645c4b73257" name="ac24ac40382bfcce441f59645c4b73257"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac24ac40382bfcce441f59645c4b73257">&#9670;&#160;</a></span>variance()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::variance </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>ddof</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute variance of all elements. </p>
<p>Calculates the variance, measuring the spread of data around the mean. Use ddof=1 for sample variance, ddof=0 for population variance.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ddof</td><td>Delta degrees of freedom (default 0 for population variance) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The variance as a scalar</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_variance"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>({5});</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{0}] = 1.0f;</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{1}] = 2.0f;</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{2}] = 3.0f;</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{3}] = 4.0f;</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{4}] = 5.0f;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">float</span> pop_var = <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>.variance(0);  <span class="comment">// Population variance</span></div>
<div class="line"><span class="keywordtype">float</span> sample_var = <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>.variance(1);  <span class="comment">// Sample variance (unbiased)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// For normalized data distributions:</span></div>
<div class="line"><span class="keywordtype">float</span> var = <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>.variance();</div>
<div class="line"><span class="keywordflow">if</span> (var &lt; 0.01f) {</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Data has low variance\n&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02300">2300</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2300</span>                                      {</div>
<div class="line"><span class="lineno"> 2301</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">m</a> = <a class="code hl_function" href="#a84b27bf0213ab3f228c2efe5ca31eaec">mean</a>();</div>
<div class="line"><span class="lineno"> 2302</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">var</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2303</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2304</span>        </div>
<div class="line"><span class="lineno"> 2305</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2306</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">diff</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] - <a class="code hl_class" href="classTensor.html">m</a>;</div>
<div class="line"><span class="lineno"> 2307</span>            <a class="code hl_class" href="classTensor.html">var</a> += <a class="code hl_class" href="classTensor.html">diff</a> * <a class="code hl_class" href="classTensor.html">diff</a>;</div>
<div class="line"><span class="lineno"> 2308</span>        }</div>
<div class="line"><span class="lineno"> 2309</span>        </div>
<div class="line"><span class="lineno"> 2310</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">var</a> / <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">total</a> - <a class="code hl_class" href="classTensor.html">ddof</a>);</div>
<div class="line"><span class="lineno"> 2311</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_ac24ac40382bfcce441f59645c4b73257_icgraph.png" border="0" usemap="#aclassTensor_ac24ac40382bfcce441f59645c4b73257_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_ac24ac40382bfcce441f59645c4b73257_icgraph" id="aclassTensor_ac24ac40382bfcce441f59645c4b73257_icgraph">
<area shape="rect" title="Compute variance of all elements." alt="" coords="185,5,302,32"/>
<area shape="rect" href="classTensor.html#a0cda55fce732dcb563b598ff636d8758" title=" " alt="" coords="5,5,137,32"/>
<area shape="poly" title=" " alt="" coords="169,21,137,21,137,16,169,16"/>
</map>
</div>

</div>
</div>
<a id="a0fc4cc0c22be7a233b9c64c6677d54d5" name="a0fc4cc0c22be7a233b9c64c6677d54d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fc4cc0c22be7a233b9c64c6677d54d5">&#9670;&#160;</a></span>vstack()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::vstack </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensors</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Vertical stack (stack along first dimension) - convenience method for 2D tensors. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tensors</td><td><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b" title="Type alias for 1D vectors.">Vector</a> of tensors to stack vertically. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor stacked vertically. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02987">2987</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2987</span>                                                                       {</div>
<div class="line"><span class="lineno"> 2988</span>        <span class="keyword">static_assert</span>(<a class="code hl_class" href="classTensor.html">N</a> &gt;= 2, <span class="stringliteral">&quot;vstack requires at least 2D tensors&quot;</span>);</div>
<div class="line"><span class="lineno"> 2989</span>        </div>
<div class="line"><span class="lineno"> 2990</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">tensors</a>.empty()) {</div>
<div class="line"><span class="lineno"> 2991</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 2992</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2993</span>        }</div>
<div class="line"><span class="lineno"> 2994</span>        </div>
<div class="line"><span class="lineno"> 2995</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">tensors</a>.size() == 1) {</div>
<div class="line"><span class="lineno"> 2996</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">tensors</a>[0]);</div>
<div class="line"><span class="lineno"> 2997</span>        }</div>
<div class="line"><span class="lineno"> 2998</span>        </div>
<div class="line"><span class="lineno"> 2999</span>        <span class="comment">// Start with first tensor and concatenate the rest</span></div>
<div class="line"><span class="lineno"> 3000</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">tensors</a>[0]);</div>
<div class="line"><span class="lineno"> 3001</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">tensors</a>.size(); ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3002</span>            <a class="code hl_class" href="classTensor.html">result</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a7a0af0b59b00d2f2623609ff3562f087">concatenate</a>(<a class="code hl_class" href="classTensor.html">tensors</a>[<a class="code hl_class" href="classTensor.html">i</a>], 0);</div>
<div class="line"><span class="lineno"> 3003</span>        }</div>
<div class="line"><span class="lineno"> 3004</span>        </div>
<div class="line"><span class="lineno"> 3005</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3006</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab35759b8f0cec852e27c31cf339737b8" name="ab35759b8f0cec852e27c31cf339737b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab35759b8f0cec852e27c31cf339737b8">&#9670;&#160;</a></span>where()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename C&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::where </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; C, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>condition</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>y</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Conditional selection (ternary operator for tensors). Returns a tensor where each element is taken from x if condition is true, otherwise from y. This is a static method that acts as a ternary operator: condition ? x : y </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">C</td><td>The condition tensor type (should be bool or numeric) </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">condition</td><td><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> of boolean/numeric values (non-zero is true). </td></tr>
    <tr><td class="paramname">x</td><td><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> to select from when condition is true. </td></tr>
    <tr><td class="paramname">y</td><td><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> to select from when condition is false. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with conditional values. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02026">2026</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2026</span>                                                                                                           {</div>
<div class="line"><span class="lineno"> 2027</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">condition</a>.<a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>() != <a class="code hl_class" href="classTensor.html">x</a>.<a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>() || <a class="code hl_class" href="classTensor.html">x</a>.<a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>() != <a class="code hl_class" href="classTensor.html">y</a>.<a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>()) {</div>
<div class="line"><span class="lineno"> 2028</span>            <span class="keywordflow">throw</span> <a class="code hl_class" href="classTensor.html">std::invalid_argument</a>(<span class="stringliteral">&quot;where(): all tensors must have the same shape&quot;</span>);</div>
<div class="line"><span class="lineno"> 2029</span>        }</div>
<div class="line"><span class="lineno"> 2030</span>        </div>
<div class="line"><span class="lineno"> 2031</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">x</a>.<a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>(), <a class="code hl_class" href="classTensor.html">x</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2032</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">x</a>.<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2033</span>        </div>
<div class="line"><span class="lineno"> 2034</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2035</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">condition</a>.<a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>()[<a class="code hl_class" href="classTensor.html">i</a>] ? <a class="code hl_class" href="classTensor.html">x</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] : <a class="code hl_class" href="classTensor.html">y</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 2036</span>        }</div>
<div class="line"><span class="lineno"> 2037</span>        </div>
<div class="line"><span class="lineno"> 2038</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2039</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a35de015456ce4657b150b3d6add16e3d" name="a35de015456ce4657b150b3d6add16e3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35de015456ce4657b150b3d6add16e3d">&#9670;&#160;</a></span>zero_grad()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::zero_grad </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Zero out the gradients. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00746">746</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  746</span>                     {</div>
<div class="line"><span class="lineno">  747</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno">  748</span>            <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno">  749</span>        }</div>
<div class="line"><span class="lineno">  750</span>        <a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.clear();</div>
<div class="line"><span class="lineno">  751</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a name="doc-related-members" id="doc-related-members"></a><h2 id="header-doc-related-members" class="groupheader">Friends And Related Symbol Documentation</h2>
<a id="af7fd1e562b92d7f3302fc10d83effcb1" name="af7fd1e562b92d7f3302fc10d83effcb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7fd1e562b92d7f3302fc10d83effcb1">&#9670;&#160;</a></span>Adam</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classAdam.html">Adam</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00687">687</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="a90bb53720dd3d4ba6e6bdacd786a7eaa" name="a90bb53720dd3d4ba6e6bdacd786a7eaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90bb53720dd3d4ba6e6bdacd786a7eaa">&#9670;&#160;</a></span>loss::binary_cross_entropy</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, 1 &gt; <a class="el" href="namespaceloss.html#a365059b00ea1e6ec1db86710cfcf3b31">loss::binary_cross_entropy</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a683473b73d31abc59759419a3214cc0a" name="a683473b73d31abc59759419a3214cc0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a683473b73d31abc59759419a3214cc0a">&#9670;&#160;</a></span>loss::cross_entropy_loss</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, 1 &gt; <a class="el" href="namespaceloss.html#a75edef9d102d2ab811b15c50f13c4eee">loss::cross_entropy_loss</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0cda1cdc9cb6e34768415968395336e6" name="a0cda1cdc9cb6e34768415968395336e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cda1cdc9cb6e34768415968395336e6">&#9670;&#160;</a></span>loss::l1_loss</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, 1 &gt; <a class="el" href="namespaceloss.html#ab7fbd0200f34e3d12f66d20b681a948f">loss::l1_loss</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a73e9357327da350df1da748ebeeefdaf" name="a73e9357327da350df1da748ebeeefdaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73e9357327da350df1da748ebeeefdaf">&#9670;&#160;</a></span>loss::mse_loss</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; <a class="el" href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7">loss::mse_loss</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9893818a67f313b613d96073a7e499ba" name="a9893818a67f313b613d96073a7e499ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9893818a67f313b613d96073a7e499ba">&#9670;&#160;</a></span>loss::smooth_l1_loss</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, 1 &gt; <a class="el" href="namespaceloss.html#a2d2c1dacdb37d834f7dc10e85cd1a742">loss::smooth_l1_loss</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8f3108b5c57f4335e97b21b78b42330d" name="a8f3108b5c57f4335e97b21b78b42330d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f3108b5c57f4335e97b21b78b42330d">&#9670;&#160;</a></span>operator*</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; operator* </td>
          <td>(</td>
          <td class="paramtype">const U &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2cb4bd9887892f4061bcc4dca0b73bea" name="a2cb4bd9887892f4061bcc4dca0b73bea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cb4bd9887892f4061bcc4dca0b73bea">&#9670;&#160;</a></span>operator+</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; operator+ </td>
          <td>(</td>
          <td class="paramtype">const U &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aac6ea4a3d1a17a2636be1ebfe4980aca" name="aac6ea4a3d1a17a2636be1ebfe4980aca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac6ea4a3d1a17a2636be1ebfe4980aca">&#9670;&#160;</a></span>operator-</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; operator- </td>
          <td>(</td>
          <td class="paramtype">const U &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0720e918044cb7c8c9246a04605bc3dc" name="a0720e918044cb7c8c9246a04605bc3dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0720e918044cb7c8c9246a04605bc3dc">&#9670;&#160;</a></span>operator/</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; operator/ </td>
          <td>(</td>
          <td class="paramtype">const U &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7dfa2de684ae22342afca259156bc646" name="a7dfa2de684ae22342afca259156bc646"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dfa2de684ae22342afca259156bc646">&#9670;&#160;</a></span>Optimizer</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classOptimizer.html">Optimizer</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00681">681</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="a41c9488576fa08bf4f2140fa944babcb" name="a41c9488576fa08bf4f2140fa944babcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41c9488576fa08bf4f2140fa944babcb">&#9670;&#160;</a></span>print</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void print </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abaf62b111934cc2f3ca92641c4f0d6e4" name="abaf62b111934cc2f3ca92641c4f0d6e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaf62b111934cc2f3ca92641c4f0d6e4">&#9670;&#160;</a></span>RMSprop</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classRMSprop.html">RMSprop</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00690">690</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="a5d13a99740a5300be84dda1088ba7090" name="a5d13a99740a5300be84dda1088ba7090"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d13a99740a5300be84dda1088ba7090">&#9670;&#160;</a></span>save_binary</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool save_binary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a38b040592e2971efef12ec68d71ab18b" name="a38b040592e2971efef12ec68d71ab18b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38b040592e2971efef12ec68d71ab18b">&#9670;&#160;</a></span>save_npy</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool save_npy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9a5b8df7f4954ba2fb1f867a57d760dc" name="a9a5b8df7f4954ba2fb1f867a57d760dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a5b8df7f4954ba2fb1f867a57d760dc">&#9670;&#160;</a></span>save_text</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool save_text </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abd938abc7dd75aa658a2f68507d27e0c" name="abd938abc7dd75aa658a2f68507d27e0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd938abc7dd75aa658a2f68507d27e0c">&#9670;&#160;</a></span>SGD</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classSGD.html">SGD</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00684">684</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="af4a07134de1525172d3c60c57e8f1496" name="af4a07134de1525172d3c60c57e8f1496"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4a07134de1525172d3c60c57e8f1496">&#9670;&#160;</a></span>Tensor</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classTensor.html">Tensor</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00474">474</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="acff32a26ad67634e185bf3be335d8f45" name="acff32a26ad67634e185bf3be335d8f45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acff32a26ad67634e185bf3be335d8f45">&#9670;&#160;</a></span>TensorSlice</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classTensorSlice.html">TensorSlice</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00480">480</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="a22260556618c0a39e3ff6824e778fdb3" name="a22260556618c0a39e3ff6824e778fdb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22260556618c0a39e3ff6824e778fdb3">&#9670;&#160;</a></span>TensorView</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classTensorView.html">TensorView</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00478">478</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a name="doc-variable-members" id="doc-variable-members"></a><h2 id="header-doc-variable-members" class="groupheader">Member Data Documentation</h2>
<a id="a89d50a2ba15e719d4bf025178150d308" name="a89d50a2ba15e719d4bf025178150d308"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89d50a2ba15e719d4bf025178150d308">&#9670;&#160;</a></span>backward_funcs_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="tensor_8h.html#a1e846f46f87b55f57de12d6aa70eda1e">BackwardFunc</a>&lt;T, N&gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::backward_funcs_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Functions to compute gradients. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00455">455</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="acf7ced620891506216fc0112a743e04b" name="acf7ced620891506216fc0112a743e04b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf7ced620891506216fc0112a743e04b">&#9670;&#160;</a></span>data_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;T[]&gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::data_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flat data storage in row-major order. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00446">446</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="a43fadce1ce3dd9ddb47c8b82168edb52" name="a43fadce1ce3dd9ddb47c8b82168edb52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43fadce1ce3dd9ddb47c8b82168edb52">&#9670;&#160;</a></span>dims_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt;N&gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::dims_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dimensions of the tensor. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00447">447</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="a4d61cfe1428b0302cd1683dc1e6fd733" name="a4d61cfe1428b0302cd1683dc1e6fd733"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d61cfe1428b0302cd1683dc1e6fd733">&#9670;&#160;</a></span>grad_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classTensor.html">Tensor</a>&lt;T, N&gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::grad_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gradient tensor. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00454">454</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="abf7257d130e6bc46f6d2cd7de4ea2909" name="abf7257d130e6bc46f6d2cd7de4ea2909"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf7257d130e6bc46f6d2cd7de4ea2909">&#9670;&#160;</a></span>is_leaf_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::is_leaf_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether this is a leaf node in the graph. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00456">456</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="ac6b266b9e3b51d9da88b35eea30a92ec" name="ac6b266b9e3b51d9da88b35eea30a92ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6b266b9e3b51d9da88b35eea30a92ec">&#9670;&#160;</a></span>requires_grad_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::requires_grad_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether to track gradients. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00453">453</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="af6821d656bfc94c60fe4cd256c1d7402" name="af6821d656bfc94c60fe4cd256c1d7402"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6821d656bfc94c60fe4cd256c1d7402">&#9670;&#160;</a></span>strides_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt;N&gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::strides_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Strides for each dimension. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00448">448</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="aa3214ec02474d17494e1eb95d5006262" name="aa3214ec02474d17494e1eb95d5006262"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3214ec02474d17494e1eb95d5006262">&#9670;&#160;</a></span>use_gpu_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::use_gpu_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag to indicate if GPU should be used. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00449">449</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/<a class="el" href="tensor_8h_source.html">tensor.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="classTensor.html">Tensor</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
