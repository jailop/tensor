<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tensor Library: Tensor&lt; T, N &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tensor Library
   </div>
   <div id="projectbrief">High-performance C++ tensor library with GPU, BLAS, autograd, and linear algebra support</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('classTensor.html','','classTensor-members'); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Tensor&lt; T, N &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Forward declaration for autograd.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="tensor_8h_source.html">tensor.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for Tensor&lt; T, N &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor__coll__graph.png" border="0" usemap="#aTensor_3_01T_00_01N_01_4_coll__map" loading="lazy" alt="Collaboration graph"/></div>
<map name="aTensor_3_01T_00_01N_01_4_coll__map" id="aTensor_3_01T_00_01N_01_4_coll__map">
<area shape="rect" title="Forward declaration for autograd." alt="" coords="493,64,601,91"/>
<area shape="rect" title=" " alt="" coords="173,5,315,32"/>
<area shape="poly" title=" " alt="" coords="331,24,399,34,470,48,511,61,510,66,468,53,398,39,330,30"/>
<area shape="rect" title=" " alt="" coords="5,64,44,91"/>
<area shape="poly" title=" " alt="" coords="56,53,67,48,120,32,172,23,173,28,121,37,69,53,58,58"/>
<area shape="rect" title=" " alt="" coords="165,56,323,99"/>
<area shape="poly" title=" " alt="" coords="60,75,165,75,165,80,60,80"/>
<area shape="rect" title=" " alt="" coords="153,123,335,165"/>
<area shape="poly" title=" " alt="" coords="56,97,69,104,110,119,153,129,152,134,109,124,67,109,54,102"/>
<area shape="poly" title=" " alt="" coords="338,75,493,75,493,80,338,80"/>
<area shape="poly" title=" " alt="" coords="350,128,468,104,513,89,515,94,470,109,351,134"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-methods" class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3f3c97d177cb960a4423afc3dafc612a" id="r_a3f3c97d177cb960a4423afc3dafc612a"><td class="memItemLeft" align="right" valign="top">const T *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a> () const</td></tr>
<tr class="memitem:ad74772ea04c239f0878e8ad8653dce5d" id="r_ad74772ea04c239f0878e8ad8653dce5d"><td class="memItemLeft" align="right" valign="top">T *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad74772ea04c239f0878e8ad8653dce5d">data_ptr</a> ()</td></tr>
<tr class="memitem:aad6aeb4859940befd0c46f0b99388bd7" id="r_aad6aeb4859940befd0c46f0b99388bd7"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a> () const</td></tr>
<tr class="memitem:a07bf856a863505d2960b0bfad9c3b3f4" id="r_a07bf856a863505d2960b0bfad9c3b3f4"><td class="memItemLeft" align="right" valign="top">const T *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a> () const</td></tr>
<tr class="memitem:ad8befdfb5ad9c3f2a69f8bdccc9a3787" id="r_ad8befdfb5ad9c3f2a69f8bdccc9a3787"><td class="memItemLeft" align="right" valign="top">T *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad8befdfb5ad9c3f2a69f8bdccc9a3787">data</a> ()</td></tr>
<tr class="memitem:a938d78600782073a1ff2725066b46c85" id="r_a938d78600782073a1ff2725066b46c85"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a938d78600782073a1ff2725066b46c85">strides</a> () const</td></tr>
<tr class="memitem:a8a85c4bf5ad38b0ba4a3d8665dfce486" id="r_a8a85c4bf5ad38b0ba4a3d8665dfce486"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8a85c4bf5ad38b0ba4a3d8665dfce486">Tensor</a> (const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;dimensions, bool use_gpu=true, bool <a class="el" href="#a947326cf96b1bf3423b40861e1213ab8">requires_grad</a>=false)</td></tr>
<tr class="memitem:a49bbb76821a6b0d03c05a0bbc26abc18" id="r_a49bbb76821a6b0d03c05a0bbc26abc18"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a49bbb76821a6b0d03c05a0bbc26abc18">~Tensor</a> ()</td></tr>
<tr class="memitem:a905559324e349a17f2530a9b5ce067ee" id="r_a905559324e349a17f2530a9b5ce067ee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a905559324e349a17f2530a9b5ce067ee">Tensor</a> (const <a class="el" href="classTensor.html">Tensor</a> &amp;other)</td></tr>
<tr class="memitem:a129f7f00cdc80a5ad067a8eb3c910290" id="r_a129f7f00cdc80a5ad067a8eb3c910290"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a129f7f00cdc80a5ad067a8eb3c910290">operator=</a> (const <a class="el" href="classTensor.html">Tensor</a> &amp;other)</td></tr>
<tr class="memitem:acd343a064481a9fc4a0c8f3d17fc489c" id="r_acd343a064481a9fc4a0c8f3d17fc489c"><td class="memItemLeft" align="right" valign="top">T &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acd343a064481a9fc4a0c8f3d17fc489c">operator[]</a> (const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;indices)</td></tr>
<tr class="memitem:a9f1420cd0be3272bdb3b9a3f53d58c76" id="r_a9f1420cd0be3272bdb3b9a3f53d58c76"><td class="memItemLeft" align="right" valign="top">const T &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9f1420cd0be3272bdb3b9a3f53d58c76">operator[]</a> (const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;indices) const</td></tr>
<tr class="memitem:a234f74cd16bd13561f7963ba29efb163" id="r_a234f74cd16bd13561f7963ba29efb163"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a234f74cd16bd13561f7963ba29efb163">fill</a> (const T &amp;value)</td></tr>
<tr class="memdesc:a234f74cd16bd13561f7963ba29efb163"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill the tensor with a specified value.  <br /></td></tr>
<tr class="memitem:a03d314303958ffc5644796d8025cd012" id="r_a03d314303958ffc5644796d8025cd012"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a03d314303958ffc5644796d8025cd012">dims</a> () const</td></tr>
<tr class="memitem:a80b3ffaf92ed36f02d6f4d4230b5d2a0" id="r_a80b3ffaf92ed36f02d6f4d4230b5d2a0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a80b3ffaf92ed36f02d6f4d4230b5d2a0">shape</a> () const</td></tr>
<tr class="memitem:a83ae42925e21d2871d755407d7505c10" id="r_a83ae42925e21d2871d755407d7505c10"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a83ae42925e21d2871d755407d7505c10">uses_gpu</a> () const</td></tr>
<tr class="memitem:a498d185ab60ae084a26c848ccdbaab27" id="r_a498d185ab60ae084a26c848ccdbaab27"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#ae4db5848267c1a5a1413b7f87cf6889d">Backend</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a498d185ab60ae084a26c848ccdbaab27">backend</a> () const</td></tr>
<tr class="memitem:aba945884d7b2221e4a6b35e7916ae0d9" id="r_aba945884d7b2221e4a6b35e7916ae0d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aba945884d7b2221e4a6b35e7916ae0d9">set_requires_grad</a> (bool <a class="el" href="#a947326cf96b1bf3423b40861e1213ab8">requires_grad</a>)</td></tr>
<tr class="memitem:a947326cf96b1bf3423b40861e1213ab8" id="r_a947326cf96b1bf3423b40861e1213ab8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a947326cf96b1bf3423b40861e1213ab8">requires_grad</a> () const</td></tr>
<tr class="memitem:aae15047e75bb7e0734b82eceea1cd009" id="r_aae15047e75bb7e0734b82eceea1cd009"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aae15047e75bb7e0734b82eceea1cd009">is_leaf</a> () const</td></tr>
<tr class="memitem:a8c0ac5752345f4abb81ebe4fa78411fd" id="r_a8c0ac5752345f4abb81ebe4fa78411fd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a> ()</td></tr>
<tr class="memitem:ae20c5c5722bd41013f11b326f9e50b2f" id="r_ae20c5c5722bd41013f11b326f9e50b2f"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae20c5c5722bd41013f11b326f9e50b2f">grad</a> () const</td></tr>
<tr class="memitem:a35de015456ce4657b150b3d6add16e3d" id="r_a35de015456ce4657b150b3d6add16e3d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a35de015456ce4657b150b3d6add16e3d">zero_grad</a> ()</td></tr>
<tr class="memitem:ace4d96d1fc0d364577334241662fb60e" id="r_ace4d96d1fc0d364577334241662fb60e"><td class="memItemLeft" align="right" valign="top">std::optional&lt; <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaa">TensorError</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ace4d96d1fc0d364577334241662fb60e">backward</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; *gradient=nullptr)</td></tr>
<tr class="memdesc:ace4d96d1fc0d364577334241662fb60e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform backward pass to compute gradients (autograd).  <br /></td></tr>
<tr class="memitem:ae5b52299c11f3ba81e781cb008542285" id="r_ae5b52299c11f3ba81e781cb008542285"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae5b52299c11f3ba81e781cb008542285">detach</a> () const</td></tr>
<tr class="memitem:af274147e833dd1ab399ce08155ad169b" id="r_af274147e833dd1ab399ce08155ad169b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a> (<a class="el" href="tensor_8h.html#a1e846f46f87b55f57de12d6aa70eda1e">BackwardFunc</a>&lt; T, N &gt; func)</td></tr>
<tr class="memitem:a1947fa453cc8c0a746b26d2481bb6b39" id="r_a1947fa453cc8c0a746b26d2481bb6b39"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1947fa453cc8c0a746b26d2481bb6b39">operator+</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memdesc:a1947fa453cc8c0a746b26d2481bb6b39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Element-wise addition with another tensor (creates new tensor).  <br /></td></tr>
<tr class="memitem:aab73fe3969bc9ab6b35a89c3787f2a22" id="r_aab73fe3969bc9ab6b35a89c3787f2a22"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aab73fe3969bc9ab6b35a89c3787f2a22">operator+</a> (const T &amp;scalar) const</td></tr>
<tr class="memitem:afe3aaaf08972bed6b0ea4b7b0eb03689" id="r_afe3aaaf08972bed6b0ea4b7b0eb03689"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afe3aaaf08972bed6b0ea4b7b0eb03689">operator+=</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other)</td></tr>
<tr class="memitem:a4613cd0a8fdde8d4e067384adcba7015" id="r_a4613cd0a8fdde8d4e067384adcba7015"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4613cd0a8fdde8d4e067384adcba7015">operator+=</a> (const T &amp;scalar)</td></tr>
<tr class="memitem:ad2e51c1fbe247b637e415e60c3993ea9" id="r_ad2e51c1fbe247b637e415e60c3993ea9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad2e51c1fbe247b637e415e60c3993ea9">operator-</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memitem:a0b67c5a06ac74ab08db3f00e400e61af" id="r_a0b67c5a06ac74ab08db3f00e400e61af"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0b67c5a06ac74ab08db3f00e400e61af">operator-</a> (const T &amp;scalar) const</td></tr>
<tr class="memitem:a57e4d2c4f4d08e48b1a1c0abe573c39c" id="r_a57e4d2c4f4d08e48b1a1c0abe573c39c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a57e4d2c4f4d08e48b1a1c0abe573c39c">operator-=</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other)</td></tr>
<tr class="memitem:a42121a48ea8b32bcfb25e3b59834bc5c" id="r_a42121a48ea8b32bcfb25e3b59834bc5c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a42121a48ea8b32bcfb25e3b59834bc5c">operator-=</a> (const T &amp;scalar)</td></tr>
<tr class="memitem:af352346a629f774750b12c97234979a9" id="r_af352346a629f774750b12c97234979a9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af352346a629f774750b12c97234979a9">operator*</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memitem:a808dc758321fc810256e3efd13042c98" id="r_a808dc758321fc810256e3efd13042c98"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a808dc758321fc810256e3efd13042c98">operator*</a> (const T &amp;scalar) const</td></tr>
<tr class="memitem:a4a0f41f0cbce7ad6637c457a68ff3e32" id="r_a4a0f41f0cbce7ad6637c457a68ff3e32"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4a0f41f0cbce7ad6637c457a68ff3e32">operator*=</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other)</td></tr>
<tr class="memitem:a29213c270a7d4b9f44f27f4cec4246bf" id="r_a29213c270a7d4b9f44f27f4cec4246bf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a29213c270a7d4b9f44f27f4cec4246bf">operator*=</a> (const T &amp;scalar)</td></tr>
<tr class="memitem:a0e414490131d73889ccb977cc4ef047b" id="r_a0e414490131d73889ccb977cc4ef047b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0e414490131d73889ccb977cc4ef047b">operator/</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memitem:aecba99a38d50cec2aa5009513481e2d1" id="r_aecba99a38d50cec2aa5009513481e2d1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aecba99a38d50cec2aa5009513481e2d1">operator/</a> (const T &amp;scalar) const</td></tr>
<tr class="memitem:ad83f8e7f5e6a51fe67a6ec3a25662f63" id="r_ad83f8e7f5e6a51fe67a6ec3a25662f63"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad83f8e7f5e6a51fe67a6ec3a25662f63">operator/=</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other)</td></tr>
<tr class="memitem:af5d1375e8ccabc8e28631c6caf597699" id="r_af5d1375e8ccabc8e28631c6caf597699"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af5d1375e8ccabc8e28631c6caf597699">operator/=</a> (const T &amp;scalar)</td></tr>
<tr class="memitem:a79cd53c980f1a1dde80fc6eeba73743a" id="r_a79cd53c980f1a1dde80fc6eeba73743a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a79cd53c980f1a1dde80fc6eeba73743a">operator-</a> () const</td></tr>
<tr class="memitem:a314dfaedc4f6b2dc8e3b44bbc5381eb3" id="r_a314dfaedc4f6b2dc8e3b44bbc5381eb3"><td class="memTemplParams" colspan="2">template&lt;typename Func&gt; </td></tr>
<tr class="memitem:a314dfaedc4f6b2dc8e3b44bbc5381eb3 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a> (Func func) const</td></tr>
<tr class="memdesc:a314dfaedc4f6b2dc8e3b44bbc5381eb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a function to each element of the tensor (creates new tensor).  <br /></td></tr>
<tr class="memitem:a1ee81db1a8ee83fe46fd9af9563812fd" id="r_a1ee81db1a8ee83fe46fd9af9563812fd"><td class="memTemplParams" colspan="2">template&lt;typename Func&gt; </td></tr>
<tr class="memitem:a1ee81db1a8ee83fe46fd9af9563812fd template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1ee81db1a8ee83fe46fd9af9563812fd">map_inplace</a> (Func func)</td></tr>
<tr class="memdesc:a1ee81db1a8ee83fe46fd9af9563812fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a function to each element of the tensor (in-place).  <br /></td></tr>
<tr class="memitem:ae94340cb4134b887428082dc683fe2b2" id="r_ae94340cb4134b887428082dc683fe2b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae94340cb4134b887428082dc683fe2b2">exp</a> () const</td></tr>
<tr class="memdesc:ae94340cb4134b887428082dc683fe2b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply exponential function to all elements (creates new tensor).  <br /></td></tr>
<tr class="memitem:a4ca468e14a70671e0258c613612bc506" id="r_a4ca468e14a70671e0258c613612bc506"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4ca468e14a70671e0258c613612bc506">log</a> () const</td></tr>
<tr class="memdesc:a4ca468e14a70671e0258c613612bc506"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply natural logarithm to all elements (creates new tensor).  <br /></td></tr>
<tr class="memitem:af5c4a58c5b957dcfe32a0e7842520404" id="r_af5c4a58c5b957dcfe32a0e7842520404"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af5c4a58c5b957dcfe32a0e7842520404">sqrt</a> () const</td></tr>
<tr class="memdesc:af5c4a58c5b957dcfe32a0e7842520404"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply square root to all elements (creates new tensor).  <br /></td></tr>
<tr class="memitem:aed782eb734b3ef0dd50e5355e3d883c8" id="r_aed782eb734b3ef0dd50e5355e3d883c8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aed782eb734b3ef0dd50e5355e3d883c8">pow</a> (T exponent) const</td></tr>
<tr class="memdesc:aed782eb734b3ef0dd50e5355e3d883c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply power function to all elements (creates new tensor).  <br /></td></tr>
<tr class="memitem:a694440b236a5cfb314e68adec066a9c6" id="r_a694440b236a5cfb314e68adec066a9c6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a694440b236a5cfb314e68adec066a9c6">abs</a> () const</td></tr>
<tr class="memitem:a9340456b98f6f4da7fad1b80f9f81712" id="r_a9340456b98f6f4da7fad1b80f9f81712"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9340456b98f6f4da7fad1b80f9f81712">sin</a> () const</td></tr>
<tr class="memitem:a6563fb519990f052d63759c50d1febe9" id="r_a6563fb519990f052d63759c50d1febe9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6563fb519990f052d63759c50d1febe9">cos</a> () const</td></tr>
<tr class="memitem:a0ccbe9aa15ebe52d33cb890388bdf1ca" id="r_a0ccbe9aa15ebe52d33cb890388bdf1ca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ccbe9aa15ebe52d33cb890388bdf1ca">tan</a> () const</td></tr>
<tr class="memitem:adcc5341aa2156f24c0f4069543c958e1" id="r_adcc5341aa2156f24c0f4069543c958e1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adcc5341aa2156f24c0f4069543c958e1">tanh</a> () const</td></tr>
<tr class="memdesc:adcc5341aa2156f24c0f4069543c958e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply hyperbolic tangent (tanh) to all elements (creates new tensor).  <br /></td></tr>
<tr class="memitem:afff455663faa35d6cfa72aa03f689e94" id="r_afff455663faa35d6cfa72aa03f689e94"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afff455663faa35d6cfa72aa03f689e94">sigmoid</a> () const</td></tr>
<tr class="memdesc:afff455663faa35d6cfa72aa03f689e94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply sigmoid function to all elements (creates new tensor).  <br /></td></tr>
<tr class="memitem:a74db7588a7150d94b620ad63de1f5980" id="r_a74db7588a7150d94b620ad63de1f5980"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a74db7588a7150d94b620ad63de1f5980">relu</a> () const</td></tr>
<tr class="memdesc:a74db7588a7150d94b620ad63de1f5980"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply ReLU (Rectified Linear Unit) to all elements (creates new tensor).  <br /></td></tr>
<tr class="memitem:a62dff46109e314ef2d44683e3d4d581d" id="r_a62dff46109e314ef2d44683e3d4d581d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a62dff46109e314ef2d44683e3d4d581d">ceil</a> () const</td></tr>
<tr class="memitem:a6047a6a731e93d59e92073e997969cc7" id="r_a6047a6a731e93d59e92073e997969cc7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6047a6a731e93d59e92073e997969cc7">floor</a> () const</td></tr>
<tr class="memitem:a824a51062936324b316f066fdce66f77" id="r_a824a51062936324b316f066fdce66f77"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a824a51062936324b316f066fdce66f77">clamp</a> (T min_val, T max_val) const</td></tr>
<tr class="memitem:a8effb9d585936f292d45c090fa06a96b" id="r_a8effb9d585936f292d45c090fa06a96b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8effb9d585936f292d45c090fa06a96b">sign</a> () const</td></tr>
<tr class="memitem:a2daa379012cbb23c00fe3ac60bde0122" id="r_a2daa379012cbb23c00fe3ac60bde0122"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2daa379012cbb23c00fe3ac60bde0122">round</a> () const</td></tr>
<tr class="memitem:afa7d4923af4f40166ac5dec4a893b74e" id="r_afa7d4923af4f40166ac5dec4a893b74e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afa7d4923af4f40166ac5dec4a893b74e">erf</a> () const</td></tr>
<tr class="memitem:a7375a160ffb9b310d78c1f7f5a44c956" id="r_a7375a160ffb9b310d78c1f7f5a44c956"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7375a160ffb9b310d78c1f7f5a44c956">log1p</a> () const</td></tr>
<tr class="memitem:ab64cb0dcc82a371720c3bfc7f2265ece" id="r_ab64cb0dcc82a371720c3bfc7f2265ece"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab64cb0dcc82a371720c3bfc7f2265ece">expm1</a> () const</td></tr>
<tr class="memitem:a703855e2cfaff43769ef254a3dbce50c" id="r_a703855e2cfaff43769ef254a3dbce50c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a703855e2cfaff43769ef254a3dbce50c">isnan</a> () const</td></tr>
<tr class="memitem:ac56c689ad6c5077e9cb9792a552a8d38" id="r_ac56c689ad6c5077e9cb9792a552a8d38"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac56c689ad6c5077e9cb9792a552a8d38">isinf</a> () const</td></tr>
<tr class="memitem:a5aac0c5222fc09da3327d08ee2c3a2ed" id="r_a5aac0c5222fc09da3327d08ee2c3a2ed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5aac0c5222fc09da3327d08ee2c3a2ed">isfinite</a> () const</td></tr>
<tr class="memitem:a5e477d9be3b8b907cbcc34efe73e31bc" id="r_a5e477d9be3b8b907cbcc34efe73e31bc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5e477d9be3b8b907cbcc34efe73e31bc">clip_min</a> (T min_val) const</td></tr>
<tr class="memitem:a1dafe6c812c9cd6d5f34a31ffdad59bb" id="r_a1dafe6c812c9cd6d5f34a31ffdad59bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1dafe6c812c9cd6d5f34a31ffdad59bb">clip_max</a> (T max_val) const</td></tr>
<tr class="memitem:aa711e60597e988054c669e131ddce774" id="r_aa711e60597e988054c669e131ddce774"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa711e60597e988054c669e131ddce774">sigmoid_derivative</a> () const</td></tr>
<tr class="memitem:a369fb30e582324d1331132a5b29884b9" id="r_a369fb30e582324d1331132a5b29884b9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a369fb30e582324d1331132a5b29884b9">sigmoid_derivative_from_input</a> () const</td></tr>
<tr class="memitem:ab400f3516df53eb4e6547a850335571e" id="r_ab400f3516df53eb4e6547a850335571e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab400f3516df53eb4e6547a850335571e">tanh_derivative</a> () const</td></tr>
<tr class="memitem:afa485f1ec713acb3499de0a08659fc4a" id="r_afa485f1ec713acb3499de0a08659fc4a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afa485f1ec713acb3499de0a08659fc4a">tanh_derivative_from_input</a> () const</td></tr>
<tr class="memitem:a780523f1c499b857930f305b22aae9aa" id="r_a780523f1c499b857930f305b22aae9aa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a780523f1c499b857930f305b22aae9aa">relu_derivative</a> () const</td></tr>
<tr class="memitem:aa33851e29d0df735e3fab0002a119602" id="r_aa33851e29d0df735e3fab0002a119602"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa33851e29d0df735e3fab0002a119602">leaky_relu_derivative</a> (T alpha=T(0.01)) const</td></tr>
<tr class="memitem:aadc56fba91e522ff5de95202106be9db" id="r_aadc56fba91e522ff5de95202106be9db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aadc56fba91e522ff5de95202106be9db">exp_derivative</a> () const</td></tr>
<tr class="memitem:a1c578c4b3e0f4a8d2fc16b67e84815b5" id="r_a1c578c4b3e0f4a8d2fc16b67e84815b5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1c578c4b3e0f4a8d2fc16b67e84815b5">log_derivative</a> () const</td></tr>
<tr class="memitem:a958bad1db0d0a6867d12c75957d2de17" id="r_a958bad1db0d0a6867d12c75957d2de17"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a958bad1db0d0a6867d12c75957d2de17">sqrt_derivative</a> () const</td></tr>
<tr class="memitem:acf750ad4eaebe934c9422566ccb63081" id="r_acf750ad4eaebe934c9422566ccb63081"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acf750ad4eaebe934c9422566ccb63081">pow_derivative</a> (T exponent) const</td></tr>
<tr class="memitem:aeb435c4d428047076a5b3c3dd5ba7114" id="r_aeb435c4d428047076a5b3c3dd5ba7114"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeb435c4d428047076a5b3c3dd5ba7114">sin_derivative</a> () const</td></tr>
<tr class="memitem:a0ee894165491bb19bf33d8282a166fde" id="r_a0ee894165491bb19bf33d8282a166fde"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ee894165491bb19bf33d8282a166fde">cos_derivative</a> () const</td></tr>
<tr class="memitem:a7cc09049ddf2fb131becaefe19b7725a" id="r_a7cc09049ddf2fb131becaefe19b7725a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7cc09049ddf2fb131becaefe19b7725a">tan_derivative</a> () const</td></tr>
<tr class="memitem:ae0c783450c731955dab75dcb1e697319" id="r_ae0c783450c731955dab75dcb1e697319"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae0c783450c731955dab75dcb1e697319">softmax_gradient_diagonal</a> () const</td></tr>
<tr class="memitem:a4eb83e4f5d720db5858585ff199d789e" id="r_a4eb83e4f5d720db5858585ff199d789e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4eb83e4f5d720db5858585ff199d789e">chain_rule</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;upstream_grad) const</td></tr>
<tr class="memitem:a3d279878b61732de2f1986dfc7de8400" id="r_a3d279878b61732de2f1986dfc7de8400"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> () const</td></tr>
<tr class="memdesc:a3d279878b61732de2f1986dfc7de8400"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute sum reduction along all dimensions.  <br /></td></tr>
<tr class="memitem:a84b27bf0213ab3f228c2efe5ca31eaec" id="r_a84b27bf0213ab3f228c2efe5ca31eaec"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a84b27bf0213ab3f228c2efe5ca31eaec">mean</a> () const</td></tr>
<tr class="memdesc:a84b27bf0213ab3f228c2efe5ca31eaec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute mean of all elements.  <br /></td></tr>
<tr class="memitem:ac24ac40382bfcce441f59645c4b73257" id="r_ac24ac40382bfcce441f59645c4b73257"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac24ac40382bfcce441f59645c4b73257">variance</a> (size_t ddof=0) const</td></tr>
<tr class="memdesc:ac24ac40382bfcce441f59645c4b73257"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute variance of all elements.  <br /></td></tr>
<tr class="memitem:a0cda55fce732dcb563b598ff636d8758" id="r_a0cda55fce732dcb563b598ff636d8758"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0cda55fce732dcb563b598ff636d8758">std</a> (size_t ddof=0) const</td></tr>
<tr class="memitem:a36b35209e077e06698d7b0cb5e687b95" id="r_a36b35209e077e06698d7b0cb5e687b95"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a36b35209e077e06698d7b0cb5e687b95">covariance</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other, size_t ddof=0) const</td></tr>
<tr class="memitem:a2b57a0f04d06e24633c240fe7b007b4a" id="r_a2b57a0f04d06e24633c240fe7b007b4a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2b57a0f04d06e24633c240fe7b007b4a">correlation</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memitem:a1704d259280947373cbcbe3d1ca14854" id="r_a1704d259280947373cbcbe3d1ca14854"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1704d259280947373cbcbe3d1ca14854">median</a> () const</td></tr>
<tr class="memitem:a33b18c3717d32fa9bf3bc40a988523fe" id="r_a33b18c3717d32fa9bf3bc40a988523fe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a33b18c3717d32fa9bf3bc40a988523fe">quantile</a> (T q) const</td></tr>
<tr class="memitem:a20cb276f18c104077f75c6f712e4107b" id="r_a20cb276f18c104077f75c6f712e4107b"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a20cb276f18c104077f75c6f712e4107b">min</a> () const</td></tr>
<tr class="memitem:a421ff1c638234245b00425702d3f23aa" id="r_a421ff1c638234245b00425702d3f23aa"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a421ff1c638234245b00425702d3f23aa">max</a> () const</td></tr>
<tr class="memitem:a71992cdc0fae28d4c1947d7ebc3b85f3" id="r_a71992cdc0fae28d4c1947d7ebc3b85f3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a71992cdc0fae28d4c1947d7ebc3b85f3">spearman_correlation</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memitem:ab319628634a6c30afddd1a331d9c22e8" id="r_ab319628634a6c30afddd1a331d9c22e8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab319628634a6c30afddd1a331d9c22e8">normalize</a> (size_t ddof=0) const</td></tr>
<tr class="memitem:a06eeff8ce7f54262b935b324bcb6833e" id="r_a06eeff8ce7f54262b935b324bcb6833e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a06eeff8ce7f54262b935b324bcb6833e">standardize</a> () const</td></tr>
<tr class="memitem:aeede6504125b5aeff52c1a56dfbee125" id="r_aeede6504125b5aeff52c1a56dfbee125"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeede6504125b5aeff52c1a56dfbee125">square</a> () const</td></tr>
<tr class="memitem:a26deab87b696076f055af17f4386b4d0" id="r_a26deab87b696076f055af17f4386b4d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a26deab87b696076f055af17f4386b4d0">operator&gt;</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memitem:a214d0fc69786dddb10d1b334845b29f9" id="r_a214d0fc69786dddb10d1b334845b29f9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a214d0fc69786dddb10d1b334845b29f9">operator&gt;</a> (const T &amp;scalar) const</td></tr>
<tr class="memitem:a4a37be92854759ae7891294f57666127" id="r_a4a37be92854759ae7891294f57666127"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4a37be92854759ae7891294f57666127">operator&lt;</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memitem:acaa2ad71d3cd141fd3f0a506e492d56c" id="r_acaa2ad71d3cd141fd3f0a506e492d56c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acaa2ad71d3cd141fd3f0a506e492d56c">operator&lt;</a> (const T &amp;scalar) const</td></tr>
<tr class="memitem:a2cab1fc8ca70e8d2fa4bce5ff88fabe1" id="r_a2cab1fc8ca70e8d2fa4bce5ff88fabe1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2cab1fc8ca70e8d2fa4bce5ff88fabe1">operator&gt;=</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memitem:ac107bd4eaca6b12fe51303a692e9ea81" id="r_ac107bd4eaca6b12fe51303a692e9ea81"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac107bd4eaca6b12fe51303a692e9ea81">operator&gt;=</a> (const T &amp;scalar) const</td></tr>
<tr class="memitem:a563d023db0ab1338f2831ba24813f835" id="r_a563d023db0ab1338f2831ba24813f835"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a563d023db0ab1338f2831ba24813f835">operator&lt;=</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other) const</td></tr>
<tr class="memitem:af1bf02c8d1a0a04ded404de0493982f2" id="r_af1bf02c8d1a0a04ded404de0493982f2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af1bf02c8d1a0a04ded404de0493982f2">operator&lt;=</a> (const T &amp;scalar) const</td></tr>
<tr class="memitem:a452fb091d4b50605c931485385d29aac" id="r_a452fb091d4b50605c931485385d29aac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a452fb091d4b50605c931485385d29aac">eq</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other, T epsilon=std::numeric_limits&lt; T &gt;::epsilon()) const</td></tr>
<tr class="memitem:aab0bca33fa0dbe68308c0a828cec9f44" id="r_aab0bca33fa0dbe68308c0a828cec9f44"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aab0bca33fa0dbe68308c0a828cec9f44">ne</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other, T epsilon=std::numeric_limits&lt; T &gt;::epsilon()) const</td></tr>
<tr class="memitem:a265342749ca5f239466cb467bbf73277" id="r_a265342749ca5f239466cb467bbf73277"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a265342749ca5f239466cb467bbf73277">clip</a> (T min_val, T max_val) const</td></tr>
<tr class="memitem:a754cdcbf16b91d5621e7405a2aa68f68" id="r_a754cdcbf16b91d5621e7405a2aa68f68"><td class="memTemplParams" colspan="2">template&lt;typename M&gt; </td></tr>
<tr class="memitem:a754cdcbf16b91d5621e7405a2aa68f68 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a754cdcbf16b91d5621e7405a2aa68f68">masked_fill</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; M, N &gt; &amp;mask, T fill_value) const</td></tr>
<tr class="memitem:a4773678cdfb3526a2bdb1079ef68b87e" id="r_a4773678cdfb3526a2bdb1079ef68b87e"><td class="memTemplParams" colspan="2">template&lt;typename M&gt; </td></tr>
<tr class="memitem:a4773678cdfb3526a2bdb1079ef68b87e template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4773678cdfb3526a2bdb1079ef68b87e">masked_select</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; M, N &gt; &amp;mask) const</td></tr>
<tr class="memitem:a4029fcf1a134dc6add543b9bdd1c045b" id="r_a4029fcf1a134dc6add543b9bdd1c045b"><td class="memTemplParams" colspan="2">template&lt;typename U&gt; </td></tr>
<tr class="memitem:a4029fcf1a134dc6add543b9bdd1c045b template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4029fcf1a134dc6add543b9bdd1c045b">astype</a> () const</td></tr>
<tr class="memdesc:a4029fcf1a134dc6add543b9bdd1c045b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cast tensor to a different data type (NumPy-compatible astype).  <br /></td></tr>
<tr class="memitem:aebe2b244763904422344add448a0c597" id="r_aebe2b244763904422344add448a0c597"><td class="memTemplParams" colspan="2">template&lt;size_t M&gt; </td></tr>
<tr class="memitem:aebe2b244763904422344add448a0c597 template"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aebe2b244763904422344add448a0c597">broadcast_to</a> (const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; M &gt; &amp;target_shape) const -&gt; std::variant&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, M &gt;, <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaa">TensorError</a> &gt;</td></tr>
<tr class="memdesc:aebe2b244763904422344add448a0c597"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broadcast this tensor to a new shape.  <br /></td></tr>
<tr class="memitem:a415f8016d31d376bb769402ce2ab5393" id="r_a415f8016d31d376bb769402ce2ab5393"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a415f8016d31d376bb769402ce2ab5393">uniform</a> (T low=T(0), T high=T(1))</td></tr>
<tr class="memitem:a1ec080d57f42d7c582be27d51c9fd440" id="r_a1ec080d57f42d7c582be27d51c9fd440"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1ec080d57f42d7c582be27d51c9fd440">bernoulli</a> (T p=T(0.5))</td></tr>
<tr class="memitem:a3091aa5abf57a0e2a900a25443f50dd8" id="r_a3091aa5abf57a0e2a900a25443f50dd8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3091aa5abf57a0e2a900a25443f50dd8">mse_loss</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;target) const</td></tr>
<tr class="memitem:a06009b18adaea5bd8fa428a5ccbef2d2" id="r_a06009b18adaea5bd8fa428a5ccbef2d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a06009b18adaea5bd8fa428a5ccbef2d2">mse_loss_gradient</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;target) const</td></tr>
<tr class="memitem:a0f221b4aea323b94ac40cc76513fe1e4" id="r_a0f221b4aea323b94ac40cc76513fe1e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0f221b4aea323b94ac40cc76513fe1e4">binary_crossentropy_loss</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;target, T epsilon=T(1e-7)) const</td></tr>
<tr class="memitem:a41b1a12b948c41c4b159fbccc278d630" id="r_a41b1a12b948c41c4b159fbccc278d630"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a41b1a12b948c41c4b159fbccc278d630">binary_crossentropy_gradient</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;target, T epsilon=T(1e-7)) const</td></tr>
<tr class="memitem:adfb14d7fcd29dddd0d1a790719f57b6d" id="r_adfb14d7fcd29dddd0d1a790719f57b6d"><td class="memTemplParams" colspan="2">template&lt;size_t M = N&gt; </td></tr>
<tr class="memitem:adfb14d7fcd29dddd0d1a790719f57b6d template"><td class="memItemLeft" align="right" valign="top">std::enable_if&lt; M==1, <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt; &gt;::type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adfb14d7fcd29dddd0d1a790719f57b6d">dot</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; &amp;other) const</td></tr>
<tr class="memitem:a2f852881c836e20e6a16469980d7f9b0" id="r_a2f852881c836e20e6a16469980d7f9b0"><td class="memTemplParams" colspan="2">template&lt;size_t M = N&gt; </td></tr>
<tr class="memitem:a2f852881c836e20e6a16469980d7f9b0 template"><td class="memItemLeft" align="right" valign="top">std::enable_if&lt; M==2, <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; &gt; &gt;::type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2f852881c836e20e6a16469980d7f9b0">dot</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; &amp;other) const</td></tr>
<tr class="memitem:ae29eec9ab673b7d33a191f9e18b57f6b" id="r_ae29eec9ab673b7d33a191f9e18b57f6b"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, size_t P&gt; </td></tr>
<tr class="memitem:ae29eec9ab673b7d33a191f9e18b57f6b template"><td class="memItemLeft" align="right" valign="top">std::enable_if&lt;(M &gt;=3), <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N+P-2 &gt; &gt; &gt;::type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae29eec9ab673b7d33a191f9e18b57f6b">dot</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, P &gt; &amp;other) const</td></tr>
<tr class="memitem:a95ef6a804e30e0c4d1b26e8a784223c4" id="r_a95ef6a804e30e0c4d1b26e8a784223c4"><td class="memTemplParams" colspan="2">template&lt;size_t M = N&gt; </td></tr>
<tr class="memitem:a95ef6a804e30e0c4d1b26e8a784223c4 template"><td class="memItemLeft" align="right" valign="top">std::enable_if&lt; M==1, <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; &gt; &gt;::type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a95ef6a804e30e0c4d1b26e8a784223c4">cross</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; &amp;other) const</td></tr>
<tr class="memitem:a88d5a081d321cbd88ca46ed42ca1112c" id="r_a88d5a081d321cbd88ca46ed42ca1112c"><td class="memTemplParams" colspan="2">template&lt;size_t M = N&gt; </td></tr>
<tr class="memitem:a88d5a081d321cbd88ca46ed42ca1112c template"><td class="memItemLeft" align="right" valign="top">std::enable_if&lt; M==2, <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; &gt; &gt;::type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a88d5a081d321cbd88ca46ed42ca1112c">matmul</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; &amp;other) const</td></tr>
<tr class="memdesc:a88d5a081d321cbd88ca46ed42ca1112c"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc" title="Type alias for 2D matrices.">Matrix</a> multiplication with autograd support (matmul).  <br /></td></tr>
<tr class="memitem:ac20a4679e14de6f68e148b447496adfc" id="r_ac20a4679e14de6f68e148b447496adfc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac20a4679e14de6f68e148b447496adfc">sum_axis</a> (int axis, bool keepdims=false) const</td></tr>
<tr class="memitem:adf1fcb0ddd0ef2db3003401db519ec1c" id="r_adf1fcb0ddd0ef2db3003401db519ec1c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adf1fcb0ddd0ef2db3003401db519ec1c">mean_axis</a> (int axis, bool keepdims=false) const</td></tr>
<tr class="memitem:a4ae322784a9d62e8db2c073f5e2395f7" id="r_a4ae322784a9d62e8db2c073f5e2395f7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4ae322784a9d62e8db2c073f5e2395f7">softmax</a> (int axis=-1) const</td></tr>
<tr class="memdesc:a4ae322784a9d62e8db2c073f5e2395f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Softmax operation with autograd support.  <br /></td></tr>
<tr class="memitem:a834720ab65874a6c5503f7670c4f22fe" id="r_a834720ab65874a6c5503f7670c4f22fe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a834720ab65874a6c5503f7670c4f22fe">log_softmax</a> (int axis=-1) const</td></tr>
<tr class="memitem:af7f0645bcaf472ac0f6214d2b1effd40" id="r_af7f0645bcaf472ac0f6214d2b1effd40"><td class="memTemplParams" colspan="2">template&lt;size_t M&gt; </td></tr>
<tr class="memitem:af7f0645bcaf472ac0f6214d2b1effd40 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, M &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af7f0645bcaf472ac0f6214d2b1effd40">reshape</a> (const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; M &gt; &amp;new_dims) const</td></tr>
<tr class="memitem:aed9419fabd015e2c1c35ff6723c1600a" id="r_aed9419fabd015e2c1c35ff6723c1600a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aed9419fabd015e2c1c35ff6723c1600a">transpose</a> () const</td></tr>
<tr class="memitem:a2429005aeaabb920c7cc943f044dd9d8" id="r_a2429005aeaabb920c7cc943f044dd9d8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2429005aeaabb920c7cc943f044dd9d8">permute</a> (const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;axes) const</td></tr>
<tr class="memitem:a46d44bb69fc3f0b7376ea35e21903b97" id="r_a46d44bb69fc3f0b7376ea35e21903b97"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a46d44bb69fc3f0b7376ea35e21903b97">squeeze</a> (int axis=-1) const</td></tr>
<tr class="memitem:ac953ca944380b138ad1e524a1124070f" id="r_ac953ca944380b138ad1e524a1124070f"><td class="memTemplParams" colspan="2">template&lt;size_t M = N + 1&gt; </td></tr>
<tr class="memitem:ac953ca944380b138ad1e524a1124070f template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, M &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac953ca944380b138ad1e524a1124070f">unsqueeze</a> (size_t axis) const</td></tr>
<tr class="memitem:a7a0af0b59b00d2f2623609ff3562f087" id="r_a7a0af0b59b00d2f2623609ff3562f087"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7a0af0b59b00d2f2623609ff3562f087">concatenate</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other, size_t axis) const</td></tr>
<tr class="memitem:ab71358eec191f202a2e95ce375133c28" id="r_ab71358eec191f202a2e95ce375133c28"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab71358eec191f202a2e95ce375133c28">take</a> (const std::vector&lt; size_t &gt; &amp;indices) const</td></tr>
<tr class="memitem:aedbf41ac61911d6ac3dcd6fc32b89f2c" id="r_aedbf41ac61911d6ac3dcd6fc32b89f2c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aedbf41ac61911d6ac3dcd6fc32b89f2c">put</a> (const std::vector&lt; size_t &gt; &amp;indices, const std::vector&lt; T &gt; &amp;values)</td></tr>
<tr class="memitem:a3090598433576f68f34f340cd6a18089" id="r_a3090598433576f68f34f340cd6a18089"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3090598433576f68f34f340cd6a18089">index_select</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;mask) const</td></tr>
<tr class="memitem:a54c613dc9fe3b552a5e9de8966408fd9" id="r_a54c613dc9fe3b552a5e9de8966408fd9"><td class="memTemplParams" colspan="2">template&lt;size_t M = (N &gt; 1 ? N - 1 : 1)&gt; </td></tr>
<tr class="memitem:a54c613dc9fe3b552a5e9de8966408fd9 template"><td class="memItemLeft" align="right" valign="top">std::enable_if_t&lt;(N &gt; 1), <a class="el" href="classTensor.html">Tensor</a>&lt; T, M &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a54c613dc9fe3b552a5e9de8966408fd9">select</a> (size_t dim, size_t index) const</td></tr>
<tr class="memitem:ac15f7a77f31ef7862dd9909c9ad97160" id="r_ac15f7a77f31ef7862dd9909c9ad97160"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac15f7a77f31ef7862dd9909c9ad97160">sum_axis</a> (size_t axis, bool keepdims=false) const</td></tr>
<tr class="memitem:aeb3f6a9bf8ee28d46a887238a9d3d460" id="r_aeb3f6a9bf8ee28d46a887238a9d3d460"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeb3f6a9bf8ee28d46a887238a9d3d460">mean_axis</a> (size_t axis, bool keepdims=false) const</td></tr>
<tr class="memitem:addc6badb03ce57d1191f2d834169c30a" id="r_addc6badb03ce57d1191f2d834169c30a"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#addc6badb03ce57d1191f2d834169c30a">argmax</a> () const</td></tr>
<tr class="memitem:acb8cb7b5b60996adfc098a5f280aff72" id="r_acb8cb7b5b60996adfc098a5f280aff72"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acb8cb7b5b60996adfc098a5f280aff72">argmin</a> () const</td></tr>
<tr class="memitem:ae5260fcc92739949dd584a0b931d1853" id="r_ae5260fcc92739949dd584a0b931d1853"><td class="memTemplParams" colspan="2">template&lt;size_t M = (N &gt; 1 ? N - 1 : 1)&gt; </td></tr>
<tr class="memitem:ae5260fcc92739949dd584a0b931d1853 template"><td class="memItemLeft" align="right" valign="top">std::enable_if_t&lt;(N &gt; 1), <a class="el" href="classTensor.html">Tensor</a>&lt; size_t, M &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae5260fcc92739949dd584a0b931d1853">argmax_axis</a> (size_t axis) const</td></tr>
<tr class="memitem:a76c7896d6d3ec3066bfd12dbeca73f9e" id="r_a76c7896d6d3ec3066bfd12dbeca73f9e"><td class="memTemplParams" colspan="2">template&lt;size_t M = (N &gt; 1 ? N - 1 : 1)&gt; </td></tr>
<tr class="memitem:a76c7896d6d3ec3066bfd12dbeca73f9e template"><td class="memItemLeft" align="right" valign="top">std::enable_if_t&lt;(N &gt; 1), <a class="el" href="classTensor.html">Tensor</a>&lt; size_t, M &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a76c7896d6d3ec3066bfd12dbeca73f9e">argmin_axis</a> (size_t axis) const</td></tr>
<tr class="memitem:a5784e1627743c06127dbaa1b744cba8e" id="r_a5784e1627743c06127dbaa1b744cba8e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5784e1627743c06127dbaa1b744cba8e">cumsum</a> () const</td></tr>
<tr class="memitem:aead4907bc4e5e749a1dc4e535e9e33f1" id="r_aead4907bc4e5e749a1dc4e535e9e33f1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aead4907bc4e5e749a1dc4e535e9e33f1">cumprod</a> () const</td></tr>
<tr class="memitem:ad19397de13c742b72cd0829b01090dd9" id="r_ad19397de13c742b72cd0829b01090dd9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad19397de13c742b72cd0829b01090dd9">cumsum_axis</a> (size_t axis) const</td></tr>
<tr class="memitem:a885a53dcbb0408b74958517747cf3868" id="r_a885a53dcbb0408b74958517747cf3868"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a885a53dcbb0408b74958517747cf3868">cumprod_axis</a> (size_t axis) const</td></tr>
<tr class="memitem:afc82c153b9df7088bd28dedb89cf7855" id="r_afc82c153b9df7088bd28dedb89cf7855"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afc82c153b9df7088bd28dedb89cf7855">prod</a> () const</td></tr>
<tr class="memitem:a487bc4f354d9fb0dd9f1b4dc2c3c40c8" id="r_a487bc4f354d9fb0dd9f1b4dc2c3c40c8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a487bc4f354d9fb0dd9f1b4dc2c3c40c8">any</a> () const</td></tr>
<tr class="memitem:a2dc155b6d76e3ec3492e4693c59bc8c4" id="r_a2dc155b6d76e3ec3492e4693c59bc8c4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2dc155b6d76e3ec3492e4693c59bc8c4">all</a> () const</td></tr>
<tr class="memitem:a5a354f1c9709ae8089a859608564fc4f" id="r_a5a354f1c9709ae8089a859608564fc4f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a354f1c9709ae8089a859608564fc4f">flatten</a> () const</td></tr>
<tr class="memitem:a9905069af5b17d1a5d1c16ec6f0a80fa" id="r_a9905069af5b17d1a5d1c16ec6f0a80fa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9905069af5b17d1a5d1c16ec6f0a80fa">repeat</a> (const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;repeats) const</td></tr>
<tr class="memitem:a84007917e116ae1e79622ca804360146" id="r_a84007917e116ae1e79622ca804360146"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a84007917e116ae1e79622ca804360146">tile</a> (const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;reps) const</td></tr>
<tr class="memitem:a4ff4d01c7fdd48791ebe12a02dbeb655" id="r_a4ff4d01c7fdd48791ebe12a02dbeb655"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:a4ff4d01c7fdd48791ebe12a02dbeb655 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4ff4d01c7fdd48791ebe12a02dbeb655">row</a> (size_t row_idx) const</td></tr>
<tr class="memdesc:a4ff4d01c7fdd48791ebe12a02dbeb655"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract a single row (only for 2D tensors).  <br /></td></tr>
<tr class="memitem:a42cef0c31a6dcf0846d2c6e2d24e7240" id="r_a42cef0c31a6dcf0846d2c6e2d24e7240"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:a42cef0c31a6dcf0846d2c6e2d24e7240 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a42cef0c31a6dcf0846d2c6e2d24e7240">col</a> (size_t col_idx) const</td></tr>
<tr class="memdesc:a42cef0c31a6dcf0846d2c6e2d24e7240"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract a single column (only for 2D tensors).  <br /></td></tr>
<tr class="memitem:af46e252ac24e0557b28c177bd9070596" id="r_af46e252ac24e0557b28c177bd9070596"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:af46e252ac24e0557b28c177bd9070596 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af46e252ac24e0557b28c177bd9070596">diag</a> () const</td></tr>
<tr class="memdesc:af46e252ac24e0557b28c177bd9070596"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract diagonal elements (only for 2D tensors).  <br /></td></tr>
<tr class="memitem:a77397ac152988d5ed90941bac5a96c28" id="r_a77397ac152988d5ed90941bac5a96c28"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:a77397ac152988d5ed90941bac5a96c28 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a77397ac152988d5ed90941bac5a96c28">block</a> (size_t start_row, size_t start_col, size_t num_rows, size_t num_cols) const</td></tr>
<tr class="memdesc:a77397ac152988d5ed90941bac5a96c28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract a rectangular block (only for 2D tensors).  <br /></td></tr>
<tr class="memitem:a89cf45ee5d7ddfdf69a387c2345039c7" id="r_a89cf45ee5d7ddfdf69a387c2345039c7"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 1&gt;&gt; </td></tr>
<tr class="memitem:a89cf45ee5d7ddfdf69a387c2345039c7 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a89cf45ee5d7ddfdf69a387c2345039c7">head</a> (size_t n) const</td></tr>
<tr class="memdesc:a89cf45ee5d7ddfdf69a387c2345039c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract first n elements (only for 1D tensors).  <br /></td></tr>
<tr class="memitem:a44953b617ae85b4e9cc7906454bee59d" id="r_a44953b617ae85b4e9cc7906454bee59d"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 1&gt;&gt; </td></tr>
<tr class="memitem:a44953b617ae85b4e9cc7906454bee59d template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a44953b617ae85b4e9cc7906454bee59d">tail</a> (size_t n) const</td></tr>
<tr class="memdesc:a44953b617ae85b4e9cc7906454bee59d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract last n elements (only for 1D tensors).  <br /></td></tr>
<tr class="memitem:af09f3224c551629f43c48c18a1fe87ee" id="r_af09f3224c551629f43c48c18a1fe87ee"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:af09f3224c551629f43c48c18a1fe87ee template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af09f3224c551629f43c48c18a1fe87ee">topRows</a> (size_t n) const</td></tr>
<tr class="memdesc:af09f3224c551629f43c48c18a1fe87ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract top n rows (only for 2D tensors).  <br /></td></tr>
<tr class="memitem:a8ecd760521443aca3613911d9af40d5a" id="r_a8ecd760521443aca3613911d9af40d5a"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:a8ecd760521443aca3613911d9af40d5a template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8ecd760521443aca3613911d9af40d5a">bottomRows</a> (size_t n) const</td></tr>
<tr class="memdesc:a8ecd760521443aca3613911d9af40d5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract bottom n rows (only for 2D tensors).  <br /></td></tr>
<tr class="memitem:aff781405a45c8ec01fde149ecba560b6" id="r_aff781405a45c8ec01fde149ecba560b6"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:aff781405a45c8ec01fde149ecba560b6 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aff781405a45c8ec01fde149ecba560b6">leftCols</a> (size_t n) const</td></tr>
<tr class="memdesc:aff781405a45c8ec01fde149ecba560b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract leftmost n columns (only for 2D tensors).  <br /></td></tr>
<tr class="memitem:aa25623075f40e0244dd4c2a649e2b3d5" id="r_aa25623075f40e0244dd4c2a649e2b3d5"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:aa25623075f40e0244dd4c2a649e2b3d5 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa25623075f40e0244dd4c2a649e2b3d5">rightCols</a> (size_t n) const</td></tr>
<tr class="memdesc:aa25623075f40e0244dd4c2a649e2b3d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract rightmost n columns (only for 2D tensors).  <br /></td></tr>
<tr class="memitem:a65eedb0d5f6932449b64d798c9dd9b5d" id="r_a65eedb0d5f6932449b64d798c9dd9b5d"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:a65eedb0d5f6932449b64d798c9dd9b5d template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a65eedb0d5f6932449b64d798c9dd9b5d">softmax_rows</a> () const</td></tr>
<tr class="memdesc:a65eedb0d5f6932449b64d798c9dd9b5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply softmax activation along rows (axis=1) for 2D tensors.  <br /></td></tr>
<tr class="memitem:a7e486401bc789c0d2344b2b271a3316b" id="r_a7e486401bc789c0d2344b2b271a3316b"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:a7e486401bc789c0d2344b2b271a3316b template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; size_t, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7e486401bc789c0d2344b2b271a3316b">argmax_rows</a> () const</td></tr>
<tr class="memdesc:a7e486401bc789c0d2344b2b271a3316b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find argmax for each row in a 2D tensor.  <br /></td></tr>
<tr class="memitem:aeb090a8d70264aca77202fd451cae051" id="r_aeb090a8d70264aca77202fd451cae051"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeb090a8d70264aca77202fd451cae051">randn</a> (T <a class="el" href="#a84b27bf0213ab3f228c2efe5ca31eaec">mean</a>=T(0), T stddev=T(1))</td></tr>
<tr class="memdesc:aeb090a8d70264aca77202fd451cae051"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill tensor with random values from normal distribution.  <br /></td></tr>
<tr class="memitem:ad49398c4c5d1a5440b154eea6e3a2720" id="r_ad49398c4c5d1a5440b154eea6e3a2720"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad49398c4c5d1a5440b154eea6e3a2720">rand_uniform</a> (T <a class="el" href="#a20cb276f18c104077f75c6f712e4107b">min</a>=T(0), T <a class="el" href="#a421ff1c638234245b00425702d3f23aa">max</a>=T(1))</td></tr>
<tr class="memdesc:ad49398c4c5d1a5440b154eea6e3a2720"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill tensor with random values from uniform distribution.  <br /></td></tr>
<tr class="memitem:a545dc641f3e77533b2ba7478eb869a3a" id="r_a545dc641f3e77533b2ba7478eb869a3a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a545dc641f3e77533b2ba7478eb869a3a">fused_scalar_mul_sub</a> (T scalar, const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;other)</td></tr>
<tr class="memdesc:a545dc641f3e77533b2ba7478eb869a3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fused operation: this -= scalar * other.  <br /></td></tr>
<tr class="memitem:a858dee8116e109f0a56d072d3774d9dd" id="r_a858dee8116e109f0a56d072d3774d9dd"><td class="memTemplParams" colspan="2">template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </td></tr>
<tr class="memitem:a858dee8116e109f0a56d072d3774d9dd template"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a858dee8116e109f0a56d072d3774d9dd">fill_rows</a> (const std::vector&lt; std::vector&lt; T &gt; &gt; &amp;<a class="el" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>, size_t start_row=0)</td></tr>
<tr class="memdesc:a858dee8116e109f0a56d072d3774d9dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill rows from vector of vectors (2D tensors only).  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-static-methods" class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ab35759b8f0cec852e27c31cf339737b8" id="r_ab35759b8f0cec852e27c31cf339737b8"><td class="memTemplParams" colspan="2">template&lt;typename C&gt; </td></tr>
<tr class="memitem:ab35759b8f0cec852e27c31cf339737b8 template"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab35759b8f0cec852e27c31cf339737b8">where</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; C, N &gt; &amp;condition, const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;x, const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;y)</td></tr>
<tr class="memitem:a9583b3dbaa99f4251d08085617f1b858" id="r_a9583b3dbaa99f4251d08085617f1b858"><td class="memTemplParams" colspan="2">template&lt;size_t... Dims&gt; </td></tr>
<tr class="memitem:a9583b3dbaa99f4251d08085617f1b858 template"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classTensor.html">Tensor</a>&lt; T, N+1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9583b3dbaa99f4251d08085617f1b858">stack</a> (const std::vector&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; &amp;tensors, size_t dim=0)</td></tr>
<tr class="memitem:a0fc4cc0c22be7a233b9c64c6677d54d5" id="r_a0fc4cc0c22be7a233b9c64c6677d54d5"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0fc4cc0c22be7a233b9c64c6677d54d5">vstack</a> (const std::vector&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; &amp;tensors)</td></tr>
<tr class="memitem:aed3511f1720813839550315f701cb516" id="r_aed3511f1720813839550315f701cb516"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aed3511f1720813839550315f701cb516">hstack</a> (const std::vector&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; &amp;tensors)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pri-methods" class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:acfd498e431d2689e191c1e9cb8d600fb" id="r_acfd498e431d2689e191c1e9cb8d600fb"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acfd498e431d2689e191c1e9cb8d600fb">offset</a> (const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;indices) const</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pri-attribs" class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:acf7ced620891506216fc0112a743e04b" id="r_acf7ced620891506216fc0112a743e04b"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; T[]&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acf7ced620891506216fc0112a743e04b">data_</a></td></tr>
<tr class="memdesc:acf7ced620891506216fc0112a743e04b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flat data storage in row-major order.  <br /></td></tr>
<tr class="memitem:a43fadce1ce3dd9ddb47c8b82168edb52" id="r_a43fadce1ce3dd9ddb47c8b82168edb52"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a></td></tr>
<tr class="memdesc:a43fadce1ce3dd9ddb47c8b82168edb52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dimensions of the tensor.  <br /></td></tr>
<tr class="memitem:af6821d656bfc94c60fe4cd256c1d7402" id="r_af6821d656bfc94c60fe4cd256c1d7402"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af6821d656bfc94c60fe4cd256c1d7402">strides_</a></td></tr>
<tr class="memdesc:af6821d656bfc94c60fe4cd256c1d7402"><td class="mdescLeft">&#160;</td><td class="mdescRight">Strides for each dimension.  <br /></td></tr>
<tr class="memitem:aa3214ec02474d17494e1eb95d5006262" id="r_aa3214ec02474d17494e1eb95d5006262"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a></td></tr>
<tr class="memdesc:aa3214ec02474d17494e1eb95d5006262"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to indicate if GPU should be used.  <br /></td></tr>
<tr id="pri-attribs-0" class="groupHeader"><td colspan="2"><div class="groupHeader">Autograd Support</div></td></tr>
<tr class="memitem:ac6b266b9e3b51d9da88b35eea30a92ec" id="r_ac6b266b9e3b51d9da88b35eea30a92ec"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a></td></tr>
<tr class="memdesc:ac6b266b9e3b51d9da88b35eea30a92ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether to track gradients.  <br /></td></tr>
<tr class="memitem:a4d61cfe1428b0302cd1683dc1e6fd733" id="r_a4d61cfe1428b0302cd1683dc1e6fd733"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a></td></tr>
<tr class="memdesc:a4d61cfe1428b0302cd1683dc1e6fd733"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gradient tensor.  <br /></td></tr>
<tr class="memitem:a89d50a2ba15e719d4bf025178150d308" id="r_a89d50a2ba15e719d4bf025178150d308"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="tensor_8h.html#a1e846f46f87b55f57de12d6aa70eda1e">BackwardFunc</a>&lt; T, N &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a></td></tr>
<tr class="memdesc:a89d50a2ba15e719d4bf025178150d308"><td class="mdescLeft">&#160;</td><td class="mdescRight">Functions to compute gradients.  <br /></td></tr>
<tr class="memitem:abf7257d130e6bc46f6d2cd7de4ea2909" id="r_abf7257d130e6bc46f6d2cd7de4ea2909"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a></td></tr>
<tr class="memdesc:abf7257d130e6bc46f6d2cd7de4ea2909"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether this is a leaf node in the graph.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-friends" class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:af4a07134de1525172d3c60c57e8f1496" id="r_af4a07134de1525172d3c60c57e8f1496"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:af4a07134de1525172d3c60c57e8f1496 template"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af4a07134de1525172d3c60c57e8f1496">Tensor</a></td></tr>
<tr class="memitem:a22260556618c0a39e3ff6824e778fdb3" id="r_a22260556618c0a39e3ff6824e778fdb3"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a22260556618c0a39e3ff6824e778fdb3 template"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a22260556618c0a39e3ff6824e778fdb3">TensorView</a></td></tr>
<tr class="memitem:acff32a26ad67634e185bf3be335d8f45" id="r_acff32a26ad67634e185bf3be335d8f45"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:acff32a26ad67634e185bf3be335d8f45 template"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acff32a26ad67634e185bf3be335d8f45">TensorSlice</a></td></tr>
<tr class="memitem:a7dfa2de684ae22342afca259156bc646" id="r_a7dfa2de684ae22342afca259156bc646"><td class="memTemplParams" colspan="2">template&lt;typename U&gt; </td></tr>
<tr class="memitem:a7dfa2de684ae22342afca259156bc646 template"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7dfa2de684ae22342afca259156bc646">Optimizer</a></td></tr>
<tr class="memitem:abd938abc7dd75aa658a2f68507d27e0c" id="r_abd938abc7dd75aa658a2f68507d27e0c"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:abd938abc7dd75aa658a2f68507d27e0c template"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abd938abc7dd75aa658a2f68507d27e0c">SGD</a></td></tr>
<tr class="memitem:af7fd1e562b92d7f3302fc10d83effcb1" id="r_af7fd1e562b92d7f3302fc10d83effcb1"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:af7fd1e562b92d7f3302fc10d83effcb1 template"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af7fd1e562b92d7f3302fc10d83effcb1">Adam</a></td></tr>
<tr class="memitem:abaf62b111934cc2f3ca92641c4f0d6e4" id="r_abaf62b111934cc2f3ca92641c4f0d6e4"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:abaf62b111934cc2f3ca92641c4f0d6e4 template"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abaf62b111934cc2f3ca92641c4f0d6e4">RMSprop</a></td></tr>
<tr class="memitem:a5d13a99740a5300be84dda1088ba7090" id="r_a5d13a99740a5300be84dda1088ba7090"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a5d13a99740a5300be84dda1088ba7090 template"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5d13a99740a5300be84dda1088ba7090">save_binary</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const std::string &amp;)</td></tr>
<tr class="memitem:a9a5b8df7f4954ba2fb1f867a57d760dc" id="r_a9a5b8df7f4954ba2fb1f867a57d760dc"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a9a5b8df7f4954ba2fb1f867a57d760dc template"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9a5b8df7f4954ba2fb1f867a57d760dc">save_text</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const std::string &amp;, int)</td></tr>
<tr class="memitem:a38b040592e2971efef12ec68d71ab18b" id="r_a38b040592e2971efef12ec68d71ab18b"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a38b040592e2971efef12ec68d71ab18b template"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a38b040592e2971efef12ec68d71ab18b">save_npy</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const std::string &amp;)</td></tr>
<tr class="memitem:a41c9488576fa08bf4f2140fa944babcb" id="r_a41c9488576fa08bf4f2140fa944babcb"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a41c9488576fa08bf4f2140fa944babcb template"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a41c9488576fa08bf4f2140fa944babcb">print</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, std::ostream &amp;, int, size_t, size_t)</td></tr>
<tr class="memitem:a2cb4bd9887892f4061bcc4dca0b73bea" id="r_a2cb4bd9887892f4061bcc4dca0b73bea"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a2cb4bd9887892f4061bcc4dca0b73bea template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2cb4bd9887892f4061bcc4dca0b73bea">operator+</a> (const U &amp;scalar, const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;tensor)</td></tr>
<tr class="memitem:aac6ea4a3d1a17a2636be1ebfe4980aca" id="r_aac6ea4a3d1a17a2636be1ebfe4980aca"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:aac6ea4a3d1a17a2636be1ebfe4980aca template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aac6ea4a3d1a17a2636be1ebfe4980aca">operator-</a> (const U &amp;scalar, const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;tensor)</td></tr>
<tr class="memitem:a8f3108b5c57f4335e97b21b78b42330d" id="r_a8f3108b5c57f4335e97b21b78b42330d"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a8f3108b5c57f4335e97b21b78b42330d template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8f3108b5c57f4335e97b21b78b42330d">operator*</a> (const U &amp;scalar, const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;tensor)</td></tr>
<tr class="memitem:a0720e918044cb7c8c9246a04605bc3dc" id="r_a0720e918044cb7c8c9246a04605bc3dc"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a0720e918044cb7c8c9246a04605bc3dc template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0720e918044cb7c8c9246a04605bc3dc">operator/</a> (const U &amp;scalar, const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;tensor)</td></tr>
<tr class="memitem:a73e9357327da350df1da748ebeeefdaf" id="r_a73e9357327da350df1da748ebeeefdaf"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a73e9357327da350df1da748ebeeefdaf template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a73e9357327da350df1da748ebeeefdaf">loss::mse_loss</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const std::string &amp;)</td></tr>
<tr class="memitem:a683473b73d31abc59759419a3214cc0a" id="r_a683473b73d31abc59759419a3214cc0a"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a683473b73d31abc59759419a3214cc0a template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a683473b73d31abc59759419a3214cc0a">loss::cross_entropy_loss</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const std::string &amp;)</td></tr>
<tr class="memitem:a90bb53720dd3d4ba6e6bdacd786a7eaa" id="r_a90bb53720dd3d4ba6e6bdacd786a7eaa"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a90bb53720dd3d4ba6e6bdacd786a7eaa template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a90bb53720dd3d4ba6e6bdacd786a7eaa">loss::binary_cross_entropy</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const std::string &amp;)</td></tr>
<tr class="memitem:a0cda1cdc9cb6e34768415968395336e6" id="r_a0cda1cdc9cb6e34768415968395336e6"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a0cda1cdc9cb6e34768415968395336e6 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0cda1cdc9cb6e34768415968395336e6">loss::l1_loss</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const std::string &amp;)</td></tr>
<tr class="memitem:a9893818a67f313b613d96073a7e499ba" id="r_a9893818a67f313b613d96073a7e499ba"><td class="memTemplParams" colspan="2">template&lt;typename U, size_t M&gt; </td></tr>
<tr class="memitem:a9893818a67f313b613d96073a7e499ba template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTensor.html">Tensor</a>&lt; U, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9893818a67f313b613d96073a7e499ba">loss::smooth_l1_loss</a> (const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;, U, const std::string &amp;)</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename T, size_t N&gt;<br />
class Tensor&lt; T, N &gt;</div><p>Forward declaration for autograd. </p>
<p>Multi-dimensional array with GPU, BLAS, and autograd support.</p>
<p>Forward declarations.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Data type (float, double, int, etc.) </td></tr>
    <tr><td class="paramname">N</td><td>Number of dimensions</td></tr>
  </table>
  </dd>
</dl>
<p>A powerful tensor class supporting:</p><ul>
<li>Arbitrary dimensions (compile-time fixed)</li>
<li>GPU acceleration (CUDA)</li>
<li>Optimized BLAS operations</li>
<li>Automatic differentiation (autograd)</li>
<li>Element-wise operations with broadcasting</li>
<li>Mathematical functions (exp, log, sin, etc.)</li>
<li>Statistical operations (mean, variance, correlation)</li>
<li>Linear algebra operations</li>
<li><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> views and slicing</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="memory"></a>
Memory Layout</h1>
<p>Data is stored in row-major order in a flat array. Strides are computed automatically to enable efficient multi-dimensional indexing.</p>
<h1 class="doxsection"><a class="anchor" id="autograd"></a>
Automatic Differentiation</h1>
<p>When <span class="tt"><a class="el" href="#a947326cf96b1bf3423b40861e1213ab8">requires_grad</a></span> is true, the tensor participates in gradient computation. Operations build a computational graph that can be traversed via <a class="el" href="#ace4d96d1fc0d364577334241662fb60e" title="Perform backward pass to compute gradients (autograd).">backward()</a>.</p>
<h1 class="doxsection"><a class="anchor" id="example"></a>
Example Usage</h1>
<div class="fragment"><div class="line"><span class="comment">// Create a 2x3 matrix</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> A({2, 3});</div>
<div class="line">A.fill(1.0f);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Element-wise operations</span></div>
<div class="line"><span class="keyword">auto</span> B = A + 2.0f;</div>
<div class="line"><span class="keyword">auto</span> C = A * B;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// With autograd</span></div>
<div class="line"><a class="code hl_class" href="classTensor.html">Tensor&lt;float, 1&gt;</a> x({10}, <span class="keyword">true</span>, <span class="keyword">true</span>);  <span class="comment">// GPU=true, requires_grad=true</span></div>
<div class="line"><span class="keyword">auto</span> y = x.<a class="code hl_function" href="#ae94340cb4134b887428082dc683fe2b2">exp</a>().sum();</div>
<div class="line">y.<a class="code hl_function" href="#ace4d96d1fc0d364577334241662fb60e">backward</a>();</div>
<div class="line"><span class="keyword">auto</span> gradients = x.grad();  <span class="comment">// Get computed gradients</span></div>
<div class="ttc" id="aclassTensor_html"><div class="ttname"><a href="classTensor.html">Tensor</a></div><div class="ttdoc">Forward declaration for autograd.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00518">tensor.h:518</a></div></div>
<div class="ttc" id="aclassTensor_html_ace4d96d1fc0d364577334241662fb60e"><div class="ttname"><a href="#ace4d96d1fc0d364577334241662fb60e">Tensor::backward</a></div><div class="ttdeci">std::optional&lt; TensorError &gt; backward(const Tensor&lt; T, N &gt; *gradient=nullptr)</div><div class="ttdoc">Perform backward pass to compute gradients (autograd).</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00993">tensor.h:993</a></div></div>
<div class="ttc" id="aclassTensor_html_ae94340cb4134b887428082dc683fe2b2"><div class="ttname"><a href="#ae94340cb4134b887428082dc683fe2b2">Tensor::exp</a></div><div class="ttdeci">Tensor&lt; T, N &gt; exp() const</div><div class="ttdoc">Apply exponential function to all elements (creates new tensor).</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l01986">tensor.h:1986</a></div></div>
<div class="ttc" id="aclassTensor_html_af4a07134de1525172d3c60c57e8f1496"><div class="ttname"><a href="#af4a07134de1525172d3c60c57e8f1496">Tensor::Tensor</a></div><div class="ttdeci">friend class Tensor</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00602">tensor.h:602</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00518">518</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
</div><a name="doc-constructors" id="doc-constructors"></a><h2 id="header-doc-constructors" class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a8a85c4bf5ad38b0ba4a3d8665dfce486" name="a8a85c4bf5ad38b0ba4a3d8665dfce486"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a85c4bf5ad38b0ba4a3d8665dfce486">&#9670;&#160;</a></span>Tensor() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::Tensor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>dimensions</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>use_gpu</em></span><span class="paramdefsep"> = </span><span class="paramdefval">true</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>requires_grad</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor to initialize the tensor with given dimensions. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dimensions</td><td>An array specifying the size of each dimension. </td></tr>
    <tr><td class="paramname">use_gpu</td><td>Whether to use GPU acceleration when available (default: true). </td></tr>
    <tr><td class="paramname">requires_grad</td><td>Whether to track gradients for this tensor (default: false). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00682">682</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  683</span>        : <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>(<a class="code hl_class" href="classTensor.html">dimensions</a>), <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>(<a class="code hl_function" href="#a947326cf96b1bf3423b40861e1213ab8">requires_grad</a>), <a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a>(<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  684</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = 1;</div>
<div class="line"><span class="lineno">  685</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">N</a>; <a class="code hl_class" href="classTensor.html">i</a>-- &gt; 0;) {</div>
<div class="line"><span class="lineno">  686</span>            <a class="code hl_variable" href="#af6821d656bfc94c60fe4cd256c1d7402">strides_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">total</a>;</div>
<div class="line"><span class="lineno">  687</span>            <a class="code hl_class" href="classTensor.html">total</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno">  688</span>        }</div>
<div class="line"><span class="lineno">  689</span>        <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;T[]&gt;</a>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno">  690</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  691</span>        <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> = <a class="code hl_class" href="classTensor.html">use_gpu</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">TensorGPU::is_gpu_available</a>();</div>
<div class="line"><span class="lineno">  692</span>        <a class="code hl_class" href="classTensor.html">d_data_</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  693</span>        <a class="code hl_class" href="classTensor.html">data_on_gpu_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  694</span>        <a class="code hl_class" href="classTensor.html">gpu_needs_sync_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  695</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  696</span>        <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  697</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  698</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno">  699</span>            <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  700</span>            <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno">  701</span>        }</div>
<div class="line"><span class="lineno">  702</span>    }</div>
<div class="ttc" id="aclassTensor_html_a43fadce1ce3dd9ddb47c8b82168edb52"><div class="ttname"><a href="#a43fadce1ce3dd9ddb47c8b82168edb52">Tensor::dims_</a></div><div class="ttdeci">TensorIndices&lt; N &gt; dims_</div><div class="ttdoc">Dimensions of the tensor.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00521">tensor.h:521</a></div></div>
<div class="ttc" id="aclassTensor_html_a4d61cfe1428b0302cd1683dc1e6fd733"><div class="ttname"><a href="#a4d61cfe1428b0302cd1683dc1e6fd733">Tensor::grad_</a></div><div class="ttdeci">std::unique_ptr&lt; Tensor&lt; T, N &gt; &gt; grad_</div><div class="ttdoc">Gradient tensor.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00537">tensor.h:537</a></div></div>
<div class="ttc" id="aclassTensor_html_a947326cf96b1bf3423b40861e1213ab8"><div class="ttname"><a href="#a947326cf96b1bf3423b40861e1213ab8">Tensor::requires_grad</a></div><div class="ttdeci">bool requires_grad() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00938">tensor.h:938</a></div></div>
<div class="ttc" id="aclassTensor_html_aa3214ec02474d17494e1eb95d5006262"><div class="ttname"><a href="#aa3214ec02474d17494e1eb95d5006262">Tensor::use_gpu_</a></div><div class="ttdeci">bool use_gpu_</div><div class="ttdoc">Flag to indicate if GPU should be used.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00523">tensor.h:523</a></div></div>
<div class="ttc" id="aclassTensor_html_abf7257d130e6bc46f6d2cd7de4ea2909"><div class="ttname"><a href="#abf7257d130e6bc46f6d2cd7de4ea2909">Tensor::is_leaf_</a></div><div class="ttdeci">bool is_leaf_</div><div class="ttdoc">Whether this is a leaf node in the graph.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00539">tensor.h:539</a></div></div>
<div class="ttc" id="aclassTensor_html_ac6b266b9e3b51d9da88b35eea30a92ec"><div class="ttname"><a href="#ac6b266b9e3b51d9da88b35eea30a92ec">Tensor::requires_grad_</a></div><div class="ttdeci">bool requires_grad_</div><div class="ttdoc">Whether to track gradients.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00536">tensor.h:536</a></div></div>
<div class="ttc" id="aclassTensor_html_acf7ced620891506216fc0112a743e04b"><div class="ttname"><a href="#acf7ced620891506216fc0112a743e04b">Tensor::data_</a></div><div class="ttdeci">std::unique_ptr&lt; T[]&gt; data_</div><div class="ttdoc">Flat data storage in row-major order.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00520">tensor.h:520</a></div></div>
<div class="ttc" id="aclassTensor_html_af6821d656bfc94c60fe4cd256c1d7402"><div class="ttname"><a href="#af6821d656bfc94c60fe4cd256c1d7402">Tensor::strides_</a></div><div class="ttdeci">TensorIndices&lt; N &gt; strides_</div><div class="ttdoc">Strides for each dimension.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00522">tensor.h:522</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a49bbb76821a6b0d03c05a0bbc26abc18" name="a49bbb76821a6b0d03c05a0bbc26abc18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49bbb76821a6b0d03c05a0bbc26abc18">&#9670;&#160;</a></span>~Tensor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::~<a class="el" href="classTensor.html">Tensor</a> </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Destructor to free GPU memory if allocated. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00707">707</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  707</span>              {</div>
<div class="line"><span class="lineno">  708</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  709</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">d_data_</a>) {</div>
<div class="line"><span class="lineno">  710</span>            <a class="code hl_class" href="classTensor.html">cuda_free_wrapper</a>(<a class="code hl_class" href="classTensor.html">d_data_</a>);</div>
<div class="line"><span class="lineno">  711</span>            <a class="code hl_class" href="classTensor.html">d_data_</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  712</span>        }</div>
<div class="line"><span class="lineno">  713</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  714</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a905559324e349a17f2530a9b5ce067ee" name="a905559324e349a17f2530a9b5ce067ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a905559324e349a17f2530a9b5ce067ee">&#9670;&#160;</a></span>Tensor() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::Tensor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Copy constructor for deep copying the tensor. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to copy from. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00720">720</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  721</span>        : <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>), <a class="code hl_variable" href="#af6821d656bfc94c60fe4cd256c1d7402">strides_</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#af6821d656bfc94c60fe4cd256c1d7402">strides_</a>), <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>),</div>
<div class="line"><span class="lineno">  722</span>          <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>), <a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a>),</div>
<div class="line"><span class="lineno">  723</span>          <a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno">  724</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno">  725</span>        <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;T[]&gt;</a>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno">  726</span>        </div>
<div class="line"><span class="lineno">  727</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  728</span>        <a class="code hl_class" href="classTensor.html">d_data_</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  729</span>        <a class="code hl_class" href="classTensor.html">data_on_gpu_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  730</span>        <a class="code hl_class" href="classTensor.html">gpu_needs_sync_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  731</span>        </div>
<div class="line"><span class="lineno">  732</span>        <span class="comment">// If other has data on GPU, copy from GPU</span></div>
<div class="line"><span class="lineno">  733</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.data_on_gpu_) {</div>
<div class="line"><span class="lineno">  734</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">bytes</a> = <a class="code hl_class" href="classTensor.html">total</a> * <span class="keyword">sizeof</span>(<a class="code hl_class" href="classTensor.html">T</a>);</div>
<div class="line"><span class="lineno">  735</span>            <a class="code hl_class" href="classTensor.html">d_data_</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a>*<span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">cuda_malloc_wrapper</a>(<a class="code hl_class" href="classTensor.html">bytes</a>));</div>
<div class="line"><span class="lineno">  736</span>            <a class="code hl_class" href="classTensor.html">cuda_memcpy_d2d_wrapper</a>(<a class="code hl_class" href="classTensor.html">d_data_</a>, <a class="code hl_class" href="classTensor.html">other</a>.d_data_, <a class="code hl_class" href="classTensor.html">bytes</a>);</div>
<div class="line"><span class="lineno">  737</span>            <a class="code hl_class" href="classTensor.html">data_on_gpu_</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  738</span>            <span class="comment">// Also copy to CPU memory</span></div>
<div class="line"><span class="lineno">  739</span>            <a class="code hl_class" href="classTensor.html">cuda_memcpy_d2h_wrapper</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">d_data_</a>, <a class="code hl_class" href="classTensor.html">bytes</a>);</div>
<div class="line"><span class="lineno">  740</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  741</span>            <a class="code hl_class" href="classTensor.html">other</a>.ensure_on_cpu();</div>
<div class="line"><span class="lineno">  742</span>            <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_class" href="classTensor.html">total</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno">  743</span>        }</div>
<div class="line"><span class="lineno">  744</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  745</span>        <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_class" href="classTensor.html">total</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno">  746</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  747</span>        </div>
<div class="line"><span class="lineno">  748</span>        <span class="comment">// Copy gradient if it exists</span></div>
<div class="line"><span class="lineno">  749</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno">  750</span>            <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(*<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno">  751</span>        }</div>
<div class="line"><span class="lineno">  752</span>    }</div>
<div class="ttc" id="aclassTensor_html_a89d50a2ba15e719d4bf025178150d308"><div class="ttname"><a href="#a89d50a2ba15e719d4bf025178150d308">Tensor::backward_funcs_</a></div><div class="ttdeci">std::vector&lt; BackwardFunc&lt; T, N &gt; &gt; backward_funcs_</div><div class="ttdoc">Functions to compute gradients.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00538">tensor.h:538</a></div></div>
<div class="ttc" id="aclassTensor_html_aad6aeb4859940befd0c46f0b99388bd7"><div class="ttname"><a href="#aad6aeb4859940befd0c46f0b99388bd7">Tensor::total_size</a></div><div class="ttdeci">size_t total_size() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00653">tensor.h:653</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Member Function Documentation</h2>
<a id="a694440b236a5cfb314e68adec066a9c6" name="a694440b236a5cfb314e68adec066a9c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a694440b236a5cfb314e68adec066a9c6">&#9670;&#160;</a></span>abs()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::abs </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply absolute value to all elements (creates new tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with abs(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02139">2139</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2139</span>                             {</div>
<div class="line"><span class="lineno"> 2140</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::abs</a>(<a class="code hl_class" href="classTensor.html">x</a>); });</div>
<div class="line"><span class="lineno"> 2141</span>    }</div>
<div class="ttc" id="aclassTensor_html_a314dfaedc4f6b2dc8e3b44bbc5381eb3"><div class="ttname"><a href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">Tensor::map</a></div><div class="ttdeci">Tensor&lt; T, N &gt; map(Func func) const</div><div class="ttdoc">Apply a function to each element of the tensor (creates new tensor).</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l01917">tensor.h:1917</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2dc155b6d76e3ec3492e4693c59bc8c4" name="a2dc155b6d76e3ec3492e4693c59bc8c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dc155b6d76e3ec3492e4693c59bc8c4">&#9670;&#160;</a></span>all()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::all </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if all elements are non-zero (boolean reduction). </p><dl class="section return"><dt>Returns</dt><dd>true if all elements are non-zero, false otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05540">5540</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5540</span>                     {</div>
<div class="line"><span class="lineno"> 5541</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 5542</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5543</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] == <a class="code hl_class" href="classTensor.html">T</a>(0)) {</div>
<div class="line"><span class="lineno"> 5544</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 5545</span>            }</div>
<div class="line"><span class="lineno"> 5546</span>        }</div>
<div class="line"><span class="lineno"> 5547</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 5548</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a487bc4f354d9fb0dd9f1b4dc2c3c40c8" name="a487bc4f354d9fb0dd9f1b4dc2c3c40c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a487bc4f354d9fb0dd9f1b4dc2c3c40c8">&#9670;&#160;</a></span>any()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::any </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if any element is non-zero (boolean reduction). </p><dl class="section return"><dt>Returns</dt><dd>true if any element is non-zero, false otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05526">5526</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5526</span>                     {</div>
<div class="line"><span class="lineno"> 5527</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 5528</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5529</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] != <a class="code hl_class" href="classTensor.html">T</a>(0)) {</div>
<div class="line"><span class="lineno"> 5530</span>                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 5531</span>            }</div>
<div class="line"><span class="lineno"> 5532</span>        }</div>
<div class="line"><span class="lineno"> 5533</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 5534</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="addc6badb03ce57d1191f2d834169c30a" name="addc6badb03ce57d1191f2d834169c30a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addc6badb03ce57d1191f2d834169c30a">&#9670;&#160;</a></span>argmax()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::argmax </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Find index of maximum element (argmax). For multi-dimensional tensors, returns flattened index. </p><dl class="section return"><dt>Returns</dt><dd>The index of the maximum element. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05232">5232</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5232</span>                          {</div>
<div class="line"><span class="lineno"> 5233</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 5234</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">max_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 5235</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0];</div>
<div class="line"><span class="lineno"> 5236</span>        </div>
<div class="line"><span class="lineno"> 5237</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5238</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt; <a class="code hl_class" href="classTensor.html">max_val</a>) {</div>
<div class="line"><span class="lineno"> 5239</span>                <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5240</span>                <a class="code hl_class" href="classTensor.html">max_idx</a> = <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 5241</span>            }</div>
<div class="line"><span class="lineno"> 5242</span>        }</div>
<div class="line"><span class="lineno"> 5243</span>        </div>
<div class="line"><span class="lineno"> 5244</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">max_idx</a>;</div>
<div class="line"><span class="lineno"> 5245</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5260fcc92739949dd584a0b931d1853" name="ae5260fcc92739949dd584a0b931d1853"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5260fcc92739949dd584a0b931d1853">&#9670;&#160;</a></span>argmax_axis()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = (N &gt; 1 ? N - 1 : 1)&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if_t&lt;(N &gt; 1), <a class="el" href="classTensor.html">Tensor</a>&lt; size_t, M &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::argmax_axis </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>axis</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Find indices of maximum elements along an axis. Only available for tensors with N &gt; 1. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The dimension along which to find argmax. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with one less dimension containing indices. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05274">5274</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5274</span>                                                                              {</div>
<div class="line"><span class="lineno"> 5275</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &gt;= <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 5276</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;M&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 5277</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;size_t, M&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 5278</span>        }</div>
<div class="line"><span class="lineno"> 5279</span>        </div>
<div class="line"><span class="lineno"> 5280</span>        <span class="comment">// Calculate new dimensions (removing the axis dimension)</span></div>
<div class="line"><span class="lineno"> 5281</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;M&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a>;</div>
<div class="line"><span class="lineno"> 5282</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">new_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 5283</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5284</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">i</a> != <a class="code hl_class" href="classTensor.html">axis</a>) {</div>
<div class="line"><span class="lineno"> 5285</span>                <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">new_idx</a>++] = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5286</span>            }</div>
<div class="line"><span class="lineno"> 5287</span>        }</div>
<div class="line"><span class="lineno"> 5288</span>        </div>
<div class="line"><span class="lineno"> 5289</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;size_t, M&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 5290</span>        </div>
<div class="line"><span class="lineno"> 5291</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 5292</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">axis</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5293</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5294</span>        }</div>
<div class="line"><span class="lineno"> 5295</span>        </div>
<div class="line"><span class="lineno"> 5296</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 5297</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">axis</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5298</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5299</span>        }</div>
<div class="line"><span class="lineno"> 5300</span>        </div>
<div class="line"><span class="lineno"> 5301</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">axis_size</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>];</div>
<div class="line"><span class="lineno"> 5302</span>        </div>
<div class="line"><span class="lineno"> 5303</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 5304</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5305</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">max_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 5306</span>                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5307</span>                </div>
<div class="line"><span class="lineno"> 5308</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 1; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 5309</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 5310</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">src_idx</a>] &gt; <a class="code hl_class" href="classTensor.html">max_val</a>) {</div>
<div class="line"><span class="lineno"> 5311</span>                        <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 5312</span>                        <a class="code hl_class" href="classTensor.html">max_idx</a> = <a class="code hl_class" href="classTensor.html">a</a>;</div>
<div class="line"><span class="lineno"> 5313</span>                    }</div>
<div class="line"><span class="lineno"> 5314</span>                }</div>
<div class="line"><span class="lineno"> 5315</span>                </div>
<div class="line"><span class="lineno"> 5316</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dst_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 5317</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>()[<a class="code hl_class" href="classTensor.html">dst_idx</a>] = <a class="code hl_class" href="classTensor.html">max_idx</a>;</div>
<div class="line"><span class="lineno"> 5318</span>            }</div>
<div class="line"><span class="lineno"> 5319</span>        }</div>
<div class="line"><span class="lineno"> 5320</span>        </div>
<div class="line"><span class="lineno"> 5321</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 5322</span>    }</div>
<div class="ttc" id="aclassTensor_html_a07bf856a863505d2960b0bfad9c3b3f4"><div class="ttname"><a href="#a07bf856a863505d2960b0bfad9c3b3f4">Tensor::data</a></div><div class="ttdeci">const T * data() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00665">tensor.h:665</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7e486401bc789c0d2344b2b271a3316b" name="a7e486401bc789c0d2344b2b271a3316b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e486401bc789c0d2344b2b271a3316b">&#9670;&#160;</a></span>argmax_rows()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; size_t, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::argmax_rows </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Find argmax for each row in a 2D tensor. </p>
<p>Returns column index of maximum value for each row. Useful for extracting predicted classes from probability distributions.</p>
<dl class="section return"><dt>Returns</dt><dd>1D tensor of size (rows) containing column indices</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_argmax_rows"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> predictions({batch_size, num_classes});</div>
<div class="line"><span class="keyword">auto</span> pred_classes = predictions.argmax_rows();  <span class="comment">// 1D tensor with class indices</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05815">5815</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5815</span>                                          {</div>
<div class="line"><span class="lineno"> 5816</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">num_rows</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0];</div>
<div class="line"><span class="lineno"> 5817</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">num_cols</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[1];</div>
<div class="line"><span class="lineno"> 5818</span>        </div>
<div class="line"><span class="lineno"> 5819</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;size_t, 1&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>({<a class="code hl_class" href="classTensor.html">num_rows</a>}, <span class="keyword">false</span>);  <span class="comment">// Indices don&#39;t need GPU</span></div>
<div class="line"><span class="lineno"> 5820</span>        <span class="keyword">const</span> <a class="code hl_class" href="classTensor.html">T</a>* <a class="code hl_function" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get();</div>
<div class="line"><span class="lineno"> 5821</span>        <span class="keywordtype">size_t</span>* <a class="code hl_class" href="classTensor.html">result_ptr</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>();</div>
<div class="line"><span class="lineno"> 5822</span>        </div>
<div class="line"><span class="lineno"> 5823</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">num_rows</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5824</span>            <span class="keyword">const</span> <a class="code hl_class" href="classTensor.html">T</a>* <a class="code hl_function" href="#a4ff4d01c7fdd48791ebe12a02dbeb655">row</a> = <a class="code hl_function" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a> + <a class="code hl_class" href="classTensor.html">i</a> * <a class="code hl_class" href="classTensor.html">num_cols</a>;</div>
<div class="line"><span class="lineno"> 5825</span>            </div>
<div class="line"><span class="lineno"> 5826</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">max_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 5827</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_function" href="#a4ff4d01c7fdd48791ebe12a02dbeb655">row</a>[0];</div>
<div class="line"><span class="lineno"> 5828</span>            </div>
<div class="line"><span class="lineno"> 5829</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">j</a> = 1; <a class="code hl_class" href="classTensor.html">j</a> &lt; <a class="code hl_class" href="classTensor.html">num_cols</a>; ++<a class="code hl_class" href="classTensor.html">j</a>) {</div>
<div class="line"><span class="lineno"> 5830</span>                <span class="keywordflow">if</span> (<a class="code hl_function" href="#a4ff4d01c7fdd48791ebe12a02dbeb655">row</a>[<a class="code hl_class" href="classTensor.html">j</a>] &gt; <a class="code hl_class" href="classTensor.html">max_val</a>) {</div>
<div class="line"><span class="lineno"> 5831</span>                    <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_function" href="#a4ff4d01c7fdd48791ebe12a02dbeb655">row</a>[<a class="code hl_class" href="classTensor.html">j</a>];</div>
<div class="line"><span class="lineno"> 5832</span>                    <a class="code hl_class" href="classTensor.html">max_idx</a> = <a class="code hl_class" href="classTensor.html">j</a>;</div>
<div class="line"><span class="lineno"> 5833</span>                }</div>
<div class="line"><span class="lineno"> 5834</span>            }</div>
<div class="line"><span class="lineno"> 5835</span>            </div>
<div class="line"><span class="lineno"> 5836</span>            <a class="code hl_class" href="classTensor.html">result_ptr</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">max_idx</a>;</div>
<div class="line"><span class="lineno"> 5837</span>        }</div>
<div class="line"><span class="lineno"> 5838</span>        </div>
<div class="line"><span class="lineno"> 5839</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 5840</span>    }</div>
<div class="ttc" id="aclassTensor_html_a3f3c97d177cb960a4423afc3dafc612a"><div class="ttname"><a href="#a3f3c97d177cb960a4423afc3dafc612a">Tensor::data_ptr</a></div><div class="ttdeci">const T * data_ptr() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00632">tensor.h:632</a></div></div>
<div class="ttc" id="aclassTensor_html_a4ff4d01c7fdd48791ebe12a02dbeb655"><div class="ttname"><a href="#a4ff4d01c7fdd48791ebe12a02dbeb655">Tensor::row</a></div><div class="ttdeci">Tensor&lt; T, 1 &gt; row(size_t row_idx) const</div><div class="ttdoc">Extract a single row (only for 2D tensors).</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l05651">tensor.h:5651</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a7e486401bc789c0d2344b2b271a3316b_icgraph.png" border="0" usemap="#aclassTensor_a7e486401bc789c0d2344b2b271a3316b_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a7e486401bc789c0d2344b2b271a3316b_icgraph" id="aclassTensor_a7e486401bc789c0d2344b2b271a3316b_icgraph">
<area shape="rect" title="Find argmax for each row in a 2D tensor." alt="" coords="205,13,351,40"/>
<area shape="rect" href="namespacetensor4d_1_1nn.html#aabc59d678ea2b307e86f063f32102470" title="Compute classification accuracy." alt="" coords="5,5,157,48"/>
<area shape="poly" title=" " alt="" coords="189,29,157,29,157,24,189,24"/>
</map>
</div>

</div>
</div>
<a id="acb8cb7b5b60996adfc098a5f280aff72" name="acb8cb7b5b60996adfc098a5f280aff72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb8cb7b5b60996adfc098a5f280aff72">&#9670;&#160;</a></span>argmin()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::argmin </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Find index of minimum element (argmin). For multi-dimensional tensors, returns flattened index. </p><dl class="section return"><dt>Returns</dt><dd>The index of the minimum element. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05252">5252</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5252</span>                          {</div>
<div class="line"><span class="lineno"> 5253</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 5254</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">min_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 5255</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">min_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0];</div>
<div class="line"><span class="lineno"> 5256</span>        </div>
<div class="line"><span class="lineno"> 5257</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5258</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &lt; <a class="code hl_class" href="classTensor.html">min_val</a>) {</div>
<div class="line"><span class="lineno"> 5259</span>                <a class="code hl_class" href="classTensor.html">min_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5260</span>                <a class="code hl_class" href="classTensor.html">min_idx</a> = <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 5261</span>            }</div>
<div class="line"><span class="lineno"> 5262</span>        }</div>
<div class="line"><span class="lineno"> 5263</span>        </div>
<div class="line"><span class="lineno"> 5264</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">min_idx</a>;</div>
<div class="line"><span class="lineno"> 5265</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a76c7896d6d3ec3066bfd12dbeca73f9e" name="a76c7896d6d3ec3066bfd12dbeca73f9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76c7896d6d3ec3066bfd12dbeca73f9e">&#9670;&#160;</a></span>argmin_axis()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = (N &gt; 1 ? N - 1 : 1)&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if_t&lt;(N &gt; 1), <a class="el" href="classTensor.html">Tensor</a>&lt; size_t, M &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::argmin_axis </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>axis</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Find indices of minimum elements along an axis. Only available for tensors with N &gt; 1. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The dimension along which to find argmin. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with one less dimension containing indices. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05331">5331</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5331</span>                                                                              {</div>
<div class="line"><span class="lineno"> 5332</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &gt;= <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 5333</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;M&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 5334</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;size_t, M&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 5335</span>        }</div>
<div class="line"><span class="lineno"> 5336</span>        </div>
<div class="line"><span class="lineno"> 5337</span>        <span class="comment">// Calculate new dimensions (removing the axis dimension)</span></div>
<div class="line"><span class="lineno"> 5338</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;M&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a>;</div>
<div class="line"><span class="lineno"> 5339</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">new_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 5340</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5341</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">i</a> != <a class="code hl_class" href="classTensor.html">axis</a>) {</div>
<div class="line"><span class="lineno"> 5342</span>                <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">new_idx</a>++] = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5343</span>            }</div>
<div class="line"><span class="lineno"> 5344</span>        }</div>
<div class="line"><span class="lineno"> 5345</span>        </div>
<div class="line"><span class="lineno"> 5346</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;size_t, M&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 5347</span>        </div>
<div class="line"><span class="lineno"> 5348</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 5349</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">axis</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5350</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5351</span>        }</div>
<div class="line"><span class="lineno"> 5352</span>        </div>
<div class="line"><span class="lineno"> 5353</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 5354</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">axis</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5355</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5356</span>        }</div>
<div class="line"><span class="lineno"> 5357</span>        </div>
<div class="line"><span class="lineno"> 5358</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">axis_size</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>];</div>
<div class="line"><span class="lineno"> 5359</span>        </div>
<div class="line"><span class="lineno"> 5360</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 5361</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5362</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">min_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 5363</span>                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">min_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5364</span>                </div>
<div class="line"><span class="lineno"> 5365</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 1; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 5366</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 5367</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">src_idx</a>] &lt; <a class="code hl_class" href="classTensor.html">min_val</a>) {</div>
<div class="line"><span class="lineno"> 5368</span>                        <a class="code hl_class" href="classTensor.html">min_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 5369</span>                        <a class="code hl_class" href="classTensor.html">min_idx</a> = <a class="code hl_class" href="classTensor.html">a</a>;</div>
<div class="line"><span class="lineno"> 5370</span>                    }</div>
<div class="line"><span class="lineno"> 5371</span>                }</div>
<div class="line"><span class="lineno"> 5372</span>                </div>
<div class="line"><span class="lineno"> 5373</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dst_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 5374</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>()[<a class="code hl_class" href="classTensor.html">dst_idx</a>] = <a class="code hl_class" href="classTensor.html">min_idx</a>;</div>
<div class="line"><span class="lineno"> 5375</span>            }</div>
<div class="line"><span class="lineno"> 5376</span>        }</div>
<div class="line"><span class="lineno"> 5377</span>        </div>
<div class="line"><span class="lineno"> 5378</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 5379</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4029fcf1a134dc6add543b9bdd1c045b" name="a4029fcf1a134dc6add543b9bdd1c045b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4029fcf1a134dc6add543b9bdd1c045b">&#9670;&#160;</a></span>astype()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::astype </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cast tensor to a different data type (NumPy-compatible astype). </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">U</td><td>Target data type </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with the target data type</dd></dl>
<p>This method allows casting tensors between different types, similar to NumPy's astype.</p>
<p>Example: </p><div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;int, 2&gt;</a> x({2, 3});</div>
<div class="line"><span class="keyword">auto</span> y = x.astype&lt;<span class="keywordtype">float</span>&gt;();  <span class="comment">// Convert int tensor to float</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03386">3386</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3386</span>                                {</div>
<div class="line"><span class="lineno"> 3387</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;U, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3388</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3389</span>        </div>
<div class="line"><span class="lineno"> 3390</span>        <span class="keyword">const</span> <a class="code hl_class" href="classTensor.html">T</a>* <a class="code hl_class" href="classTensor.html">src_data</a> = <a class="code hl_function" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>();</div>
<div class="line"><span class="lineno"> 3391</span>        <a class="code hl_class" href="classTensor.html">U</a>* <a class="code hl_class" href="classTensor.html">dst_data</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>();</div>
<div class="line"><span class="lineno"> 3392</span>        </div>
<div class="line"><span class="lineno"> 3393</span><span class="preprocessor">        #pragma omp parallel for if(total &gt; 10000)</span></div>
<div class="line"><span class="lineno"> 3394</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3395</span>            <a class="code hl_class" href="classTensor.html">dst_data</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">U</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">src_data</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 3396</span>        }</div>
<div class="line"><span class="lineno"> 3397</span>        </div>
<div class="line"><span class="lineno"> 3398</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3399</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a498d185ab60ae084a26c848ccdbaab27" name="a498d185ab60ae084a26c848ccdbaab27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a498d185ab60ae084a26c848ccdbaab27">&#9670;&#160;</a></span>backend()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#ae4db5848267c1a5a1413b7f87cf6889d">Backend</a> <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::backend </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the backend being used by this tensor. </p><dl class="section return"><dt>Returns</dt><dd>The computational backend (GPU, BLAS, or CPU)</dd></dl>
<p>Returns the actual backend that will be used for operations on this tensor. The backend is selected at tensor creation time based on availability:</p><ul>
<li>GPU: if compiled with USE_GPU, GPU is available, and use_gpu flag is true</li>
<li>BLAS: if compiled with USE_BLAS and GPU is not used</li>
<li>CPU: fallback when neither GPU nor BLAS is available </li>
</ul>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00878">878</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  878</span>                            {</div>
<div class="line"><span class="lineno">  879</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno">  880</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">Backend::GPU</a>;</div>
<div class="line"><span class="lineno">  881</span>        }</div>
<div class="line"><span class="lineno">  882</span><span class="preprocessor">#ifdef USE_BLAS</span></div>
<div class="line"><span class="lineno">  883</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">Backend::BLAS</a>;</div>
<div class="line"><span class="lineno">  884</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  885</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">Backend::CPU</a>;</div>
<div class="line"><span class="lineno">  886</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  887</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ace4d96d1fc0d364577334241662fb60e" name="ace4d96d1fc0d364577334241662fb60e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace4d96d1fc0d364577334241662fb60e">&#9670;&#160;</a></span>backward()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::optional&lt; <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaa">TensorError</a> &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::backward </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; *</td>          <td class="paramname"><span class="paramname"><em>gradient</em></span><span class="paramdefsep"> = </span><span class="paramdefval">nullptr</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform backward pass to compute gradients (autograd). </p>
<p>Computes gradients of this tensor with respect to leaf tensors by traversing the computational graph backwards.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gradient</td><td>Optional gradient tensor to start backpropagation. If nullptr, assumes this is a scalar with gradient 1.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::nullopt on success, <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa253ca7dd096ee0956cccee4d376cab8b" title="Invalid argument provided to a function.">TensorError::InvalidArgument</a> on error</dd></dl>
<dl class="section note"><dt>Note</dt><dd>For scalar tensors (<a class="el" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size()</a> == 1), can be called without arguments. </dd>
<dd>
For non-scalar tensors, must provide a gradient tensor. </dd>
<dd>
Returns error if tensor doesn't require gradients </dd>
<dd>
Returns error if called on non-scalar without gradient argument</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_autograd"></a>
Usage Example</h1>
<div class="fragment"><div class="line"><span class="comment">// Scalar loss - no gradient needed</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> <a class="code hl_namespace" href="namespaceloss.html">loss</a>({1}, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a class="code hl_namespace" href="namespaceloss.html">loss</a>.backward();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Non-scalar - gradient required</span></div>
<div class="line"><a class="code hl_class" href="classTensor.html">Tensor&lt;float, 2&gt;</a> output({3, 4}, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>({3, 4});</div>
<div class="line"><a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.fill(1.0f);</div>
<div class="line">output.backward(&amp;<a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>);</div>
<div class="ttc" id="aclassTensor_html_a8c0ac5752345f4abb81ebe4fa78411fd"><div class="ttname"><a href="#a8c0ac5752345f4abb81ebe4fa78411fd">Tensor::grad</a></div><div class="ttdeci">Tensor&lt; T, N &gt; * grad()</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00950">tensor.h:950</a></div></div>
<div class="ttc" id="anamespaceloss_html"><div class="ttname"><a href="namespaceloss.html">loss</a></div><div class="ttdoc">Loss functions for neural network training.</div></div>
</div><!-- fragment --> <dl class="section return"><dt>Returns</dt><dd>std::nullopt on success, or <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaa" title="Error codes for tensor operations.">TensorError</a> on failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00993">993</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  993</span>                                                                              {</div>
<div class="line"><span class="lineno">  994</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno">  995</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::InvalidArgument</a>;</div>
<div class="line"><span class="lineno">  996</span>        }</div>
<div class="line"><span class="lineno">  997</span>        </div>
<div class="line"><span class="lineno">  998</span>        <span class="comment">// If this is not a scalar and no gradient provided, error</span></div>
<div class="line"><span class="lineno">  999</span>        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">gradient</a> &amp;&amp; <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>() != 1) {</div>
<div class="line"><span class="lineno"> 1000</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::InvalidArgument</a>;</div>
<div class="line"><span class="lineno"> 1001</span>        }</div>
<div class="line"><span class="lineno"> 1002</span>        </div>
<div class="line"><span class="lineno"> 1003</span>        <span class="comment">// Initialize gradient</span></div>
<div class="line"><span class="lineno"> 1004</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 1005</span>            <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1006</span>            <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 1007</span>        }</div>
<div class="line"><span class="lineno"> 1008</span>        </div>
<div class="line"><span class="lineno"> 1009</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">gradient</a>) {</div>
<div class="line"><span class="lineno"> 1010</span>            <span class="comment">// Accumulate provided gradient</span></div>
<div class="line"><span class="lineno"> 1011</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1012</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1013</span>                <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_class" href="classTensor.html">gradient</a>-&gt;<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1014</span>            }</div>
<div class="line"><span class="lineno"> 1015</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1016</span>            <span class="comment">// For scalar, start with gradient of 1</span></div>
<div class="line"><span class="lineno"> 1017</span>            <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[0] = <a class="code hl_class" href="classTensor.html">T</a>(1);</div>
<div class="line"><span class="lineno"> 1018</span>        }</div>
<div class="line"><span class="lineno"> 1019</span>        </div>
<div class="line"><span class="lineno"> 1020</span>        <span class="comment">// Call all backward functions to propagate gradients</span></div>
<div class="line"><span class="lineno"> 1021</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 1022</span>            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 1023</span>        }</div>
<div class="line"><span class="lineno"> 1024</span>        </div>
<div class="line"><span class="lineno"> 1025</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::nullopt</a>;</div>
<div class="line"><span class="lineno"> 1026</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1ec080d57f42d7c582be27d51c9fd440" name="a1ec080d57f42d7c582be27d51c9fd440"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ec080d57f42d7c582be27d51c9fd440">&#9670;&#160;</a></span>bernoulli()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::bernoulli </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>p</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(0.5)</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sample from Bernoulli distribution. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Probability of success (value 1), default 0.5. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03444">3444</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3444</span>                                 {</div>
<div class="line"><span class="lineno"> 3445</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3446</span>        <a class="code hl_class" href="classTensor.html">std::random_device</a> <a class="code hl_class" href="classTensor.html">rd</a>;</div>
<div class="line"><span class="lineno"> 3447</span>        <a class="code hl_class" href="classTensor.html">std::mt19937</a> <a class="code hl_class" href="classTensor.html">gen</a>(<a class="code hl_class" href="classTensor.html">rd</a>());</div>
<div class="line"><span class="lineno"> 3448</span>        <a class="code hl_class" href="classTensor.html">std::bernoulli_distribution</a> <a class="code hl_class" href="classTensor.html">dis</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">p</a>));</div>
<div class="line"><span class="lineno"> 3449</span>        </div>
<div class="line"><span class="lineno"> 3450</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3451</span>            <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">dis</a>(<a class="code hl_class" href="classTensor.html">gen</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3452</span>        }</div>
<div class="line"><span class="lineno"> 3453</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a41b1a12b948c41c4b159fbccc278d630" name="a41b1a12b948c41c4b159fbccc278d630"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41b1a12b948c41c4b159fbccc278d630">&#9670;&#160;</a></span>binary_crossentropy_gradient()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::binary_crossentropy_gradient </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>target</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>epsilon</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(1e-7)</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute gradient of binary cross-entropy loss. d/dx[BCE] = -(target/pred - (1-target)/(1-pred)) / n </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target</td><td>The target tensor. </td></tr>
    <tr><td class="paramname">epsilon</td><td>Small value to avoid division by zero. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The gradient tensor or error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03627">3627</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3628</span>                                                                                         {</div>
<div class="line"><span class="lineno"> 3629</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">target</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 3630</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3631</span>        }</div>
<div class="line"><span class="lineno"> 3632</span>        </div>
<div class="line"><span class="lineno"> 3633</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3634</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3635</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">scale</a> = <a class="code hl_class" href="classTensor.html">T</a>(1) / <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 3636</span>        </div>
<div class="line"><span class="lineno"> 3637</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3638</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">pred</a> = <a class="code hl_class" href="classTensor.html">std::max</a>(<a class="code hl_class" href="classTensor.html">epsilon</a>, <a class="code hl_class" href="classTensor.html">std::min</a>(<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">epsilon</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]));</div>
<div class="line"><span class="lineno"> 3639</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">scale</a> * (-(<a class="code hl_class" href="classTensor.html">target</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] / <a class="code hl_class" href="classTensor.html">pred</a>) + </div>
<div class="line"><span class="lineno"> 3640</span>                                       ((<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">target</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]) / (<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">pred</a>)));</div>
<div class="line"><span class="lineno"> 3641</span>        }</div>
<div class="line"><span class="lineno"> 3642</span>        </div>
<div class="line"><span class="lineno"> 3643</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3644</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0f221b4aea323b94ac40cc76513fe1e4" name="a0f221b4aea323b94ac40cc76513fe1e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f221b4aea323b94ac40cc76513fe1e4">&#9670;&#160;</a></span>binary_crossentropy_loss()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::binary_crossentropy_loss </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>target</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>epsilon</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(1e-7)</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute binary cross-entropy loss. Loss = -[target * log(pred) + (1-target) * log(1-pred)] </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target</td><td>The target tensor (values should be 0 or 1). </td></tr>
    <tr><td class="paramname">epsilon</td><td>Small value to avoid log(0) (default 1e-7). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The BCE loss value or error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03603">3603</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3603</span>                                                                                                    {</div>
<div class="line"><span class="lineno"> 3604</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">target</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 3605</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3606</span>        }</div>
<div class="line"><span class="lineno"> 3607</span>        </div>
<div class="line"><span class="lineno"> 3608</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">loss</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3609</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3610</span>        </div>
<div class="line"><span class="lineno"> 3611</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3612</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">pred</a> = <a class="code hl_class" href="classTensor.html">std::max</a>(<a class="code hl_class" href="classTensor.html">epsilon</a>, <a class="code hl_class" href="classTensor.html">std::min</a>(<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">epsilon</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]));</div>
<div class="line"><span class="lineno"> 3613</span>            <a class="code hl_class" href="classTensor.html">loss</a> += -(<a class="code hl_class" href="classTensor.html">target</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">std::log</a>(<a class="code hl_class" href="classTensor.html">pred</a>) + </div>
<div class="line"><span class="lineno"> 3614</span>                     (<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">target</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]) * <a class="code hl_class" href="classTensor.html">std::log</a>(<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">pred</a>));</div>
<div class="line"><span class="lineno"> 3615</span>        }</div>
<div class="line"><span class="lineno"> 3616</span>        </div>
<div class="line"><span class="lineno"> 3617</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">loss</a> / <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 3618</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a77397ac152988d5ed90941bac5a96c28" name="a77397ac152988d5ed90941bac5a96c28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77397ac152988d5ed90941bac5a96c28">&#9670;&#160;</a></span>block()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::block </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>start_row</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>start_col</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>num_rows</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>num_cols</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract a rectangular block (only for 2D tensors). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start_row</td><td>Starting row index </td></tr>
    <tr><td class="paramname">start_col</td><td>Starting column index </td></tr>
    <tr><td class="paramname">num_rows</td><td>Number of rows to extract </td></tr>
    <tr><td class="paramname">num_cols</td><td>Number of columns to extract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>2D tensor containing the block </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05683">5683</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5683</span>                                                                                                   {</div>
<div class="line"><span class="lineno"> 5684</span>        <a class="code hl_class" href="classTensor.html">return ::block</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)), </div>
<div class="line"><span class="lineno"> 5685</span>                       <a class="code hl_class" href="classTensor.html">start_row</a>, <a class="code hl_class" href="classTensor.html">start_col</a>, <a class="code hl_class" href="classTensor.html">num_rows</a>, <a class="code hl_class" href="classTensor.html">num_cols</a>);</div>
<div class="line"><span class="lineno"> 5686</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ecd760521443aca3613911d9af40d5a" name="a8ecd760521443aca3613911d9af40d5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ecd760521443aca3613911d9af40d5a">&#9670;&#160;</a></span>bottomRows()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::bottomRows </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract bottom n rows (only for 2D tensors). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of rows to extract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>2D tensor containing bottom n rows </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05724">5724</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5724</span>                                            {</div>
<div class="line"><span class="lineno"> 5725</span>        <a class="code hl_class" href="classTensor.html">return ::bottomRows</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)), <a class="code hl_class" href="classTensor.html">n</a>);</div>
<div class="line"><span class="lineno"> 5726</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aebe2b244763904422344add448a0c597" name="aebe2b244763904422344add448a0c597"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebe2b244763904422344add448a0c597">&#9670;&#160;</a></span>broadcast_to()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::broadcast_to </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>target_shape</em></span></td><td>)</td>
          <td> const-&gt;std::variant&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, M &gt;, <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaa">TensorError</a> &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Broadcast this tensor to a new shape. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">M</td><td>The number of dimensions in target shape </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target_shape</td><td>The target shape to broadcast to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing the broadcast tensor or an error</dd></dl>
<p>Broadcasting rules (NumPy-compatible):</p><ul>
<li>Prepend dimensions of size 1 if needed</li>
<li>For each dimension, sizes must either match or one must be 1</li>
<li>Dimensions of size 1 are "stretched" to match the target</li>
</ul>
<p>Example: </p><div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> x({3});</div>
<div class="line"><span class="keyword">auto</span> result = x.broadcast_to&lt;2&gt;({4, 3});  <span class="comment">// Shape (3,) -&gt; (4, 3)</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03419">3419</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3420</span>                                                 {</div>
<div class="line"><span class="lineno"> 3421</span>        <a class="code hl_class" href="classTensor.html">return ::broadcast_to</a>(*<span class="keyword">this</span>, <a class="code hl_class" href="classTensor.html">target_shape</a>);</div>
<div class="line"><span class="lineno"> 3422</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a62dff46109e314ef2d44683e3d4d581d" name="a62dff46109e314ef2d44683e3d4d581d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62dff46109e314ef2d44683e3d4d581d">&#9670;&#160;</a></span>ceil()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::ceil </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply ceiling function to all elements (creates new tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with ceil(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02417">2417</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2417</span>                              {</div>
<div class="line"><span class="lineno"> 2418</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::ceil</a>(<a class="code hl_class" href="classTensor.html">x</a>); });</div>
<div class="line"><span class="lineno"> 2419</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4eb83e4f5d720db5858585ff199d789e" name="a4eb83e4f5d720db5858585ff199d789e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4eb83e4f5d720db5858585ff199d789e">&#9670;&#160;</a></span>chain_rule()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::chain_rule </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>upstream_grad</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply chain rule for backpropagation. Given upstream gradient and local derivative, compute gradient for this layer. gradient = upstream_grad * local_derivative </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">upstream_grad</td><td>The gradient flowing from the next layer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing the computed gradient or an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02709">2709</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2709</span>                                                                                   {</div>
<div class="line"><span class="lineno"> 2710</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">upstream_grad</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 2711</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 2712</span>        }</div>
<div class="line"><span class="lineno"> 2713</span>        </div>
<div class="line"><span class="lineno"> 2714</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2715</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2716</span>        </div>
<div class="line"><span class="lineno"> 2717</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2718</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">upstream_grad</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 2719</span>        }</div>
<div class="line"><span class="lineno"> 2720</span>        </div>
<div class="line"><span class="lineno"> 2721</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2722</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a824a51062936324b316f066fdce66f77" name="a824a51062936324b316f066fdce66f77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a824a51062936324b316f066fdce66f77">&#9670;&#160;</a></span>clamp()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::clamp </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>min_val</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>max_val</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Clamp all elements to a range (creates new tensor). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">min_val</td><td>The minimum value. </td></tr>
    <tr><td class="paramname">max_val</td><td>The maximum value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with all elements clamped to [min_val, max_val]. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02435">2435</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2435</span>                                                   {</div>
<div class="line"><span class="lineno"> 2436</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([<a class="code hl_class" href="classTensor.html">min_val</a>, <a class="code hl_class" href="classTensor.html">max_val</a>](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { </div>
<div class="line"><span class="lineno"> 2437</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">x</a> &lt; <a class="code hl_class" href="classTensor.html">min_val</a> ? <a class="code hl_class" href="classTensor.html">min_val</a> : (<a class="code hl_class" href="classTensor.html">x</a> &gt; <a class="code hl_class" href="classTensor.html">max_val</a> ? <a class="code hl_class" href="classTensor.html">max_val</a> : <a class="code hl_class" href="classTensor.html">x</a>); </div>
<div class="line"><span class="lineno"> 2438</span>        });</div>
<div class="line"><span class="lineno"> 2439</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a265342749ca5f239466cb467bbf73277" name="a265342749ca5f239466cb467bbf73277"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a265342749ca5f239466cb467bbf73277">&#9670;&#160;</a></span>clip()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::clip </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>min_val</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>max_val</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Clip (clamp) tensor values to a specified range. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">min_val</td><td>Minimum value. </td></tr>
    <tr><td class="paramname">max_val</td><td>Maximum value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with clipped values. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03276">3276</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3276</span>                                                  {</div>
<div class="line"><span class="lineno"> 3277</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 3278</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3279</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3280</span>        </div>
<div class="line"><span class="lineno"> 3281</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3282</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::max</a>(<a class="code hl_class" href="classTensor.html">min_val</a>, <a class="code hl_class" href="classTensor.html">std::min</a>(<a class="code hl_class" href="classTensor.html">max_val</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]));</div>
<div class="line"><span class="lineno"> 3283</span>        }</div>
<div class="line"><span class="lineno"> 3284</span>        </div>
<div class="line"><span class="lineno"> 3285</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 3286</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 3287</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3288</span>            </div>
<div class="line"><span class="lineno"> 3289</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">min_val</a>, <a class="code hl_class" href="classTensor.html">max_val</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 3290</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 3291</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 3292</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>,</div>
<div class="line"><span class="lineno"> 3293</span>                                                                          <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3294</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 3295</span>                    }</div>
<div class="line"><span class="lineno"> 3296</span>                    </div>
<div class="line"><span class="lineno"> 3297</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3298</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3299</span>                        <span class="comment">// Gradient passes through only if value is within range</span></div>
<div class="line"><span class="lineno"> 3300</span>                        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt; <a class="code hl_class" href="classTensor.html">min_val</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &lt; <a class="code hl_class" href="classTensor.html">max_val</a>) {</div>
<div class="line"><span class="lineno"> 3301</span>                            <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3302</span>                        }</div>
<div class="line"><span class="lineno"> 3303</span>                    }</div>
<div class="line"><span class="lineno"> 3304</span>                    </div>
<div class="line"><span class="lineno"> 3305</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 3306</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 3307</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 3308</span>                        }</div>
<div class="line"><span class="lineno"> 3309</span>                    }</div>
<div class="line"><span class="lineno"> 3310</span>                }</div>
<div class="line"><span class="lineno"> 3311</span>            });</div>
<div class="line"><span class="lineno"> 3312</span>        }</div>
<div class="line"><span class="lineno"> 3313</span>        </div>
<div class="line"><span class="lineno"> 3314</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3315</span>    }</div>
<div class="ttc" id="aclassTensor_html_af274147e833dd1ab399ce08155ad169b"><div class="ttname"><a href="#af274147e833dd1ab399ce08155ad169b">Tensor::register_backward</a></div><div class="ttdeci">void register_backward(BackwardFunc&lt; T, N &gt; func)</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l01046">tensor.h:1046</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1dafe6c812c9cd6d5f34a31ffdad59bb" name="a1dafe6c812c9cd6d5f34a31ffdad59bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dafe6c812c9cd6d5f34a31ffdad59bb">&#9670;&#160;</a></span>clip_max()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::clip_max </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>max_val</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Clip values to a maximum threshold (creates new tensor). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">max_val</td><td>The maximum value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with all elements &lt;= max_val. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02526">2526</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2526</span>                                           {</div>
<div class="line"><span class="lineno"> 2527</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([<a class="code hl_class" href="classTensor.html">max_val</a>](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">x</a> &gt; <a class="code hl_class" href="classTensor.html">max_val</a> ? <a class="code hl_class" href="classTensor.html">max_val</a> : <a class="code hl_class" href="classTensor.html">x</a>; });</div>
<div class="line"><span class="lineno"> 2528</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5e477d9be3b8b907cbcc34efe73e31bc" name="a5e477d9be3b8b907cbcc34efe73e31bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e477d9be3b8b907cbcc34efe73e31bc">&#9670;&#160;</a></span>clip_min()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::clip_min </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>min_val</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Clip values to a minimum threshold (creates new tensor). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">min_val</td><td>The minimum value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with all elements &gt;= min_val. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02517">2517</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2517</span>                                           {</div>
<div class="line"><span class="lineno"> 2518</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([<a class="code hl_class" href="classTensor.html">min_val</a>](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">x</a> &lt; <a class="code hl_class" href="classTensor.html">min_val</a> ? <a class="code hl_class" href="classTensor.html">min_val</a> : <a class="code hl_class" href="classTensor.html">x</a>; });</div>
<div class="line"><span class="lineno"> 2519</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a42cef0c31a6dcf0846d2c6e2d24e7240" name="a42cef0c31a6dcf0846d2c6e2d24e7240"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42cef0c31a6dcf0846d2c6e2d24e7240">&#9670;&#160;</a></span>col()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::col </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>col_idx</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract a single column (only for 2D tensors). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">col_idx</td><td>Column index to extract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1D tensor containing the column </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05661">5661</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5661</span>                                           {</div>
<div class="line"><span class="lineno"> 5662</span>        <a class="code hl_class" href="classTensor.html">return ::col</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)), <a class="code hl_class" href="classTensor.html">col_idx</a>);</div>
<div class="line"><span class="lineno"> 5663</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a0af0b59b00d2f2623609ff3562f087" name="a7a0af0b59b00d2f2623609ff3562f087"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a0af0b59b00d2f2623609ff3562f087">&#9670;&#160;</a></span>concatenate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::concatenate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>axis</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Concatenate tensors along a specific axis. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to concatenate with </td></tr>
    <tr><td class="paramname">axis</td><td>The axis along which to concatenate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Concatenated tensor, or zero tensor if dimensions don't match </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04847">4847</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4847</span>                                                                           {</div>
<div class="line"><span class="lineno"> 4848</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &gt;= <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 4849</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 4850</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4851</span>        }</div>
<div class="line"><span class="lineno"> 4852</span>        </div>
<div class="line"><span class="lineno"> 4853</span>        <span class="comment">// Check that all dimensions match except the concat axis</span></div>
<div class="line"><span class="lineno"> 4854</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4855</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">i</a> != <a class="code hl_class" href="classTensor.html">axis</a> &amp;&amp; <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>] != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>]) {</div>
<div class="line"><span class="lineno"> 4856</span>                <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 4857</span>                <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4858</span>            }</div>
<div class="line"><span class="lineno"> 4859</span>        }</div>
<div class="line"><span class="lineno"> 4860</span>        </div>
<div class="line"><span class="lineno"> 4861</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 4862</span>        <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">axis</a>] = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>] + <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>];</div>
<div class="line"><span class="lineno"> 4863</span>        </div>
<div class="line"><span class="lineno"> 4864</span>        <span class="keywordtype">bool</span> <a class="code hl_class" href="classTensor.html">track_grad</a> = <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a> || <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>;</div>
<div class="line"><span class="lineno"> 4865</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_class" href="classTensor.html">track_grad</a>);</div>
<div class="line"><span class="lineno"> 4866</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4867</span>        </div>
<div class="line"><span class="lineno"> 4868</span>        <span class="comment">// Copy data from first tensor</span></div>
<div class="line"><span class="lineno"> 4869</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 4870</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">axis</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4871</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4872</span>        }</div>
<div class="line"><span class="lineno"> 4873</span>        </div>
<div class="line"><span class="lineno"> 4874</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 4875</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">axis</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4876</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4877</span>        }</div>
<div class="line"><span class="lineno"> 4878</span>        </div>
<div class="line"><span class="lineno"> 4879</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">this_axis_size</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>];</div>
<div class="line"><span class="lineno"> 4880</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">other_axis_size</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>];</div>
<div class="line"><span class="lineno"> 4881</span>        </div>
<div class="line"><span class="lineno"> 4882</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4883</span>            <span class="comment">// Copy from first tensor</span></div>
<div class="line"><span class="lineno"> 4884</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 0; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">this_axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 4885</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4886</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">this_axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4887</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dst_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * (<a class="code hl_class" href="classTensor.html">this_axis_size</a> + <a class="code hl_class" href="classTensor.html">other_axis_size</a>) * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4888</span>                    <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">dst_idx</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 4889</span>                }</div>
<div class="line"><span class="lineno"> 4890</span>            }</div>
<div class="line"><span class="lineno"> 4891</span>            </div>
<div class="line"><span class="lineno"> 4892</span>            <span class="comment">// Copy from second tensor</span></div>
<div class="line"><span class="lineno"> 4893</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 0; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">other_axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 4894</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4895</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">other_axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4896</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dst_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * (<a class="code hl_class" href="classTensor.html">this_axis_size</a> + <a class="code hl_class" href="classTensor.html">other_axis_size</a>) * <a class="code hl_class" href="classTensor.html">inner</a> + </div>
<div class="line"><span class="lineno"> 4897</span>                                    (<a class="code hl_class" href="classTensor.html">this_axis_size</a> + <a class="code hl_class" href="classTensor.html">a</a>) * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4898</span>                    <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">dst_idx</a>] = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 4899</span>                }</div>
<div class="line"><span class="lineno"> 4900</span>            }</div>
<div class="line"><span class="lineno"> 4901</span>        }</div>
<div class="line"><span class="lineno"> 4902</span>        </div>
<div class="line"><span class="lineno"> 4903</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 4904</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">track_grad</a>) {</div>
<div class="line"><span class="lineno"> 4905</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4906</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">other_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_class" href="classTensor.html">other</a>);</div>
<div class="line"><span class="lineno"> 4907</span>            </div>
<div class="line"><span class="lineno"> 4908</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">other_ptr</a>, <a class="code hl_class" href="classTensor.html">axis</a>, <a class="code hl_class" href="classTensor.html">outer</a>, <a class="code hl_class" href="classTensor.html">inner</a>, </div>
<div class="line"><span class="lineno"> 4909</span>                                     <a class="code hl_class" href="classTensor.html">this_axis_size</a>, <a class="code hl_class" href="classTensor.html">other_axis_size</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 4910</span>                <span class="comment">// Split gradient back to both tensors</span></div>
<div class="line"><span class="lineno"> 4911</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4912</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4913</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, </div>
<div class="line"><span class="lineno"> 4914</span>                                                                          <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4915</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4916</span>                    }</div>
<div class="line"><span class="lineno"> 4917</span>                    </div>
<div class="line"><span class="lineno"> 4918</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4919</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 0; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">this_axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 4920</span>                            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4921</span>                                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dst_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">this_axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4922</span>                                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * (<a class="code hl_class" href="classTensor.html">this_axis_size</a> + <a class="code hl_class" href="classTensor.html">other_axis_size</a>) * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4923</span>                                <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">dst_idx</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 4924</span>                            }</div>
<div class="line"><span class="lineno"> 4925</span>                        }</div>
<div class="line"><span class="lineno"> 4926</span>                    }</div>
<div class="line"><span class="lineno"> 4927</span>                    </div>
<div class="line"><span class="lineno"> 4928</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4929</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4930</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4931</span>                        }</div>
<div class="line"><span class="lineno"> 4932</span>                    }</div>
<div class="line"><span class="lineno"> 4933</span>                }</div>
<div class="line"><span class="lineno"> 4934</span>                </div>
<div class="line"><span class="lineno"> 4935</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4936</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4937</span>                        <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, </div>
<div class="line"><span class="lineno"> 4938</span>                                                                           <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4939</span>                        <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4940</span>                    }</div>
<div class="line"><span class="lineno"> 4941</span>                    </div>
<div class="line"><span class="lineno"> 4942</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4943</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 0; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">other_axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 4944</span>                            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4945</span>                                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dst_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">other_axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4946</span>                                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * (<a class="code hl_class" href="classTensor.html">this_axis_size</a> + <a class="code hl_class" href="classTensor.html">other_axis_size</a>) * <a class="code hl_class" href="classTensor.html">inner</a> + </div>
<div class="line"><span class="lineno"> 4947</span>                                                (<a class="code hl_class" href="classTensor.html">this_axis_size</a> + <a class="code hl_class" href="classTensor.html">a</a>) * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4948</span>                                <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">dst_idx</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 4949</span>                            }</div>
<div class="line"><span class="lineno"> 4950</span>                        }</div>
<div class="line"><span class="lineno"> 4951</span>                    }</div>
<div class="line"><span class="lineno"> 4952</span>                    </div>
<div class="line"><span class="lineno"> 4953</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4954</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4955</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4956</span>                        }</div>
<div class="line"><span class="lineno"> 4957</span>                    }</div>
<div class="line"><span class="lineno"> 4958</span>                }</div>
<div class="line"><span class="lineno"> 4959</span>            });</div>
<div class="line"><span class="lineno"> 4960</span>        }</div>
<div class="line"><span class="lineno"> 4961</span>        </div>
<div class="line"><span class="lineno"> 4962</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4963</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a7a0af0b59b00d2f2623609ff3562f087_icgraph.png" border="0" usemap="#aclassTensor_a7a0af0b59b00d2f2623609ff3562f087_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a7a0af0b59b00d2f2623609ff3562f087_icgraph" id="aclassTensor_a7a0af0b59b00d2f2623609ff3562f087_icgraph">
<area shape="rect" title=" " alt="" coords="206,31,345,57"/>
<area shape="rect" href="classTensor.html#aed3511f1720813839550315f701cb516" title=" " alt="" coords="5,5,158,32"/>
<area shape="poly" title=" " alt="" coords="190,36,158,31,158,26,191,30"/>
<area shape="rect" href="classTensor.html#a0fc4cc0c22be7a233b9c64c6677d54d5" title=" " alt="" coords="5,56,158,83"/>
<area shape="poly" title=" " alt="" coords="191,58,158,62,158,57,190,52"/>
</map>
</div>

</div>
</div>
<a id="a2b57a0f04d06e24633c240fe7b007b4a" name="a2b57a0f04d06e24633c240fe7b007b4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b57a0f04d06e24633c240fe7b007b4a">&#9670;&#160;</a></span>correlation()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::correlation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute Pearson correlation coefficient with another tensor. Treats tensors as flattened vectors. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The other tensor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The correlation coefficient [-1, 1] or error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02868">2868</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2868</span>                                                                 {</div>
<div class="line"><span class="lineno"> 2869</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>() != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>()) {</div>
<div class="line"><span class="lineno"> 2870</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 2871</span>        }</div>
<div class="line"><span class="lineno"> 2872</span>        </div>
<div class="line"><span class="lineno"> 2873</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">mean1</a> = <a class="code hl_function" href="#a84b27bf0213ab3f228c2efe5ca31eaec">mean</a>();</div>
<div class="line"><span class="lineno"> 2874</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">mean2</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_function" href="#a84b27bf0213ab3f228c2efe5ca31eaec">mean</a>();</div>
<div class="line"><span class="lineno"> 2875</span>        </div>
<div class="line"><span class="lineno"> 2876</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">diff1</a> = *<span class="keyword">this</span> - <a class="code hl_class" href="classTensor.html">mean1</a>;</div>
<div class="line"><span class="lineno"> 2877</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">diff2</a> = <a class="code hl_class" href="classTensor.html">other</a> - <a class="code hl_class" href="classTensor.html">mean2</a>;</div>
<div class="line"><span class="lineno"> 2878</span>        </div>
<div class="line"><span class="lineno"> 2879</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">cov_result</a> = <a class="code hl_class" href="classTensor.html">diff1</a> * <a class="code hl_class" href="classTensor.html">diff2</a>;</div>
<div class="line"><span class="lineno"> 2880</span>        <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">cov_tensor</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">cov_result</a>);</div>
<div class="line"><span class="lineno"> 2881</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">cov</a> = <a class="code hl_class" href="classTensor.html">cov_tensor</a>.<a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>();</div>
<div class="line"><span class="lineno"> 2882</span>        </div>
<div class="line"><span class="lineno"> 2883</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">var1_result</a> = <a class="code hl_class" href="classTensor.html">diff1</a> * <a class="code hl_class" href="classTensor.html">diff1</a>;</div>
<div class="line"><span class="lineno"> 2884</span>        <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">var1_tensor</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">var1_result</a>);</div>
<div class="line"><span class="lineno"> 2885</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">var1</a> = <a class="code hl_class" href="classTensor.html">var1_tensor</a>.<a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>();</div>
<div class="line"><span class="lineno"> 2886</span>        </div>
<div class="line"><span class="lineno"> 2887</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">var2_result</a> = <a class="code hl_class" href="classTensor.html">diff2</a> * <a class="code hl_class" href="classTensor.html">diff2</a>;</div>
<div class="line"><span class="lineno"> 2888</span>        <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">var2_tensor</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">var2_result</a>);</div>
<div class="line"><span class="lineno"> 2889</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">var2</a> = <a class="code hl_class" href="classTensor.html">var2_tensor</a>.<a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>();</div>
<div class="line"><span class="lineno"> 2890</span>        </div>
<div class="line"><span class="lineno"> 2891</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">denom</a> = <a class="code hl_class" href="classTensor.html">std::sqrt</a>(<a class="code hl_class" href="classTensor.html">var1</a> * <a class="code hl_class" href="classTensor.html">var2</a>);</div>
<div class="line"><span class="lineno"> 2892</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">denom</a> &lt; <a class="code hl_class" href="classTensor.html">std::numeric_limits&lt;T&gt;::epsilon</a>()) {</div>
<div class="line"><span class="lineno"> 2893</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::InvalidArgument</a>;</div>
<div class="line"><span class="lineno"> 2894</span>        }</div>
<div class="line"><span class="lineno"> 2895</span>        </div>
<div class="line"><span class="lineno"> 2896</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">cov</a> / <a class="code hl_class" href="classTensor.html">denom</a>;</div>
<div class="line"><span class="lineno"> 2897</span>    }</div>
<div class="ttc" id="aclassTensor_html_a3d279878b61732de2f1986dfc7de8400"><div class="ttname"><a href="#a3d279878b61732de2f1986dfc7de8400">Tensor::sum</a></div><div class="ttdeci">T sum() const</div><div class="ttdoc">Compute sum reduction along all dimensions.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l02749">tensor.h:2749</a></div></div>
<div class="ttc" id="aclassTensor_html_a84b27bf0213ab3f228c2efe5ca31eaec"><div class="ttname"><a href="#a84b27bf0213ab3f228c2efe5ca31eaec">Tensor::mean</a></div><div class="ttdeci">T mean() const</div><div class="ttdoc">Compute mean of all elements.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l02783">tensor.h:2783</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6563fb519990f052d63759c50d1febe9" name="a6563fb519990f052d63759c50d1febe9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6563fb519990f052d63759c50d1febe9">&#9670;&#160;</a></span>cos()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::cos </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply cosine function to all elements (creates new tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with cos(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02172">2172</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2172</span>                             {</div>
<div class="line"><span class="lineno"> 2173</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2174</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2175</span>        </div>
<div class="line"><span class="lineno"> 2176</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 2177</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 2178</span>                <a class="code hl_class" href="classTensor.html">ensure_on_gpu</a>();</div>
<div class="line"><span class="lineno"> 2179</span>                <a class="code hl_class" href="classTensor.html">result</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 2180</span>                <a class="code hl_class" href="classTensor.html">TensorGPU::cos_gpu_direct</a>(<a class="code hl_class" href="classTensor.html">d_data_</a>, <a class="code hl_class" href="classTensor.html">result</a>.d_data_, <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2181</span>                <a class="code hl_class" href="classTensor.html">result</a>.mark_gpu_modified();</div>
<div class="line"><span class="lineno"> 2182</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2183</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2184</span>        {</div>
<div class="line"><span class="lineno"> 2185</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2186</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::cos</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 2187</span>            }</div>
<div class="line"><span class="lineno"> 2188</span>        }</div>
<div class="line"><span class="lineno"> 2189</span>        </div>
<div class="line"><span class="lineno"> 2190</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2191</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a6563fb519990f052d63759c50d1febe9_icgraph.png" border="0" usemap="#aclassTensor_a6563fb519990f052d63759c50d1febe9_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a6563fb519990f052d63759c50d1febe9_icgraph" id="aclassTensor_a6563fb519990f052d63759c50d1febe9_icgraph">
<area shape="rect" title=" " alt="" coords="184,13,273,40"/>
<area shape="rect" href="classTensor.html#aeb435c4d428047076a5b3c3dd5ba7114" title=" " alt="" coords="5,5,136,48"/>
<area shape="poly" title=" " alt="" coords="168,29,136,29,136,24,168,24"/>
</map>
</div>

</div>
</div>
<a id="a0ee894165491bb19bf33d8282a166fde" name="a0ee894165491bb19bf33d8282a166fde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ee894165491bb19bf33d8282a166fde">&#9670;&#160;</a></span>cos_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::cos_derivative </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of cosine function. d/dx[cos(x)] = -sin(x) </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with cos derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02675">2675</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2675</span>                                        {</div>
<div class="line"><span class="lineno"> 2676</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> -<a class="code hl_class" href="classTensor.html">std::sin</a>(<a class="code hl_class" href="classTensor.html">x</a>); });</div>
<div class="line"><span class="lineno"> 2677</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a36b35209e077e06698d7b0cb5e687b95" name="a36b35209e077e06698d7b0cb5e687b95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36b35209e077e06698d7b0cb5e687b95">&#9670;&#160;</a></span>covariance()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::covariance </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>ddof</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute covariance with another tensor. Treats tensors as flattened vectors. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The other tensor. </td></tr>
    <tr><td class="paramname">ddof</td><td>Delta degrees of freedom (default 0). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The covariance or error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02840">2840</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2840</span>                                                                                 {</div>
<div class="line"><span class="lineno"> 2841</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>() != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>()) {</div>
<div class="line"><span class="lineno"> 2842</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 2843</span>        }</div>
<div class="line"><span class="lineno"> 2844</span>        </div>
<div class="line"><span class="lineno"> 2845</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2846</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">total</a> &lt;= <a class="code hl_class" href="classTensor.html">ddof</a>) {</div>
<div class="line"><span class="lineno"> 2847</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::InvalidArgument</a>;</div>
<div class="line"><span class="lineno"> 2848</span>        }</div>
<div class="line"><span class="lineno"> 2849</span>        </div>
<div class="line"><span class="lineno"> 2850</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">mean1</a> = <a class="code hl_function" href="#a84b27bf0213ab3f228c2efe5ca31eaec">mean</a>();</div>
<div class="line"><span class="lineno"> 2851</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">mean2</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_function" href="#a84b27bf0213ab3f228c2efe5ca31eaec">mean</a>();</div>
<div class="line"><span class="lineno"> 2852</span>        </div>
<div class="line"><span class="lineno"> 2853</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">diff1</a> = *<span class="keyword">this</span> - <a class="code hl_class" href="classTensor.html">mean1</a>;</div>
<div class="line"><span class="lineno"> 2854</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">diff2</a> = <a class="code hl_class" href="classTensor.html">other</a> - <a class="code hl_class" href="classTensor.html">mean2</a>;</div>
<div class="line"><span class="lineno"> 2855</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">product_result</a> = <a class="code hl_class" href="classTensor.html">diff1</a> * <a class="code hl_class" href="classTensor.html">diff2</a>;</div>
<div class="line"><span class="lineno"> 2856</span>        <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">product</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">product_result</a>);</div>
<div class="line"><span class="lineno"> 2857</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">cov</a> = <a class="code hl_class" href="classTensor.html">product</a>.<a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>();</div>
<div class="line"><span class="lineno"> 2858</span>        </div>
<div class="line"><span class="lineno"> 2859</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">cov</a> / <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">total</a> - <a class="code hl_class" href="classTensor.html">ddof</a>);</div>
<div class="line"><span class="lineno"> 2860</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a95ef6a804e30e0c4d1b26e8a784223c4" name="a95ef6a804e30e0c4d1b26e8a784223c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95ef6a804e30e0c4d1b26e8a784223c4">&#9670;&#160;</a></span>cross()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if&lt; M==1, <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; &gt; &gt;::type <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::cross </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Cross product for 3D vectors. Computes the cross product of two 3D vectors: result = this  other. The cross product is perpendicular to both input vectors and follows the right-hand rule.</p>
<p>Formula: If a = [a1, a2, a3] and b = [b1, b2, b3], then a  b = [a2*b3 - a3*b2, a3*b1 - a1*b3, a1*b2 - a2*b1]</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The other 3D vector to compute cross product with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing either a new 3D tensor with the result or an error.</dd></dl>
<div class="fragment"><div class="line"><span class="comment">// Create two 3D vectors</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> a({3});</div>
<div class="line">a[{0}] = 1.0f; a[{1}] = 0.0f; a[{2}] = 0.0f;  <span class="comment">// [1, 0, 0]</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> b({3});</div>
<div class="line">b[{0}] = 0.0f; b[{1}] = 1.0f; b[{2}] = 0.0f;  <span class="comment">// [0, 1, 0]</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Compute cross product</span></div>
<div class="line"><span class="keyword">auto</span> result_var = a.<a class="code hl_function" href="#a95ef6a804e30e0c4d1b26e8a784223c4">cross</a>(b);</div>
<div class="line"><span class="keywordflow">if</span> (std::holds_alternative&lt;<a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a>&gt;(result_var)) {</div>
<div class="line">    <span class="keyword">auto</span>&amp; result = std::get&lt;Tensor&lt;float, 1&gt;&gt;(result_var);</div>
<div class="line">    <span class="comment">// result = [0, 0, 1] (perpendicular to both a and b)</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassTensor_html_a95ef6a804e30e0c4d1b26e8a784223c4"><div class="ttname"><a href="#a95ef6a804e30e0c4d1b26e8a784223c4">Tensor::cross</a></div><div class="ttdeci">std::enable_if&lt; M==1, TensorResult&lt; Tensor&lt; T, 1 &gt; &gt; &gt;::type cross(const Tensor&lt; T, 1 &gt; &amp;other) const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l03843">tensor.h:3843</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03843">3843</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3843</span>                                           {</div>
<div class="line"><span class="lineno"> 3844</span>        <span class="keyword">static_assert</span>(<a class="code hl_class" href="classTensor.html">N</a> == 1, <span class="stringliteral">&quot;Cross product is only for 1D tensors&quot;</span>);</div>
<div class="line"><span class="lineno"> 3845</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0] != 3) {</div>
<div class="line"><span class="lineno"> 3846</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3847</span>        }</div>
<div class="line"><span class="lineno"> 3848</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0] != 3) {</div>
<div class="line"><span class="lineno"> 3849</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3850</span>        }</div>
<div class="line"><span class="lineno"> 3851</span>        </div>
<div class="line"><span class="lineno"> 3852</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 1&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>({3}, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3853</span>        </div>
<div class="line"><span class="lineno"> 3854</span>        <span class="comment">// Cross product formula: a  b = [a2*b3 - a3*b2, a3*b1 - a1*b3, a1*b2 - a2*b1]</span></div>
<div class="line"><span class="lineno"> 3855</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">a1</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0], <a class="code hl_class" href="classTensor.html">a2</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[1], <a class="code hl_class" href="classTensor.html">a3</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[2];</div>
<div class="line"><span class="lineno"> 3856</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">b1</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0], <a class="code hl_class" href="classTensor.html">b2</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[1], <a class="code hl_class" href="classTensor.html">b3</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[2];</div>
<div class="line"><span class="lineno"> 3857</span>        </div>
<div class="line"><span class="lineno"> 3858</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 3859</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 3860</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::cross_3d_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno"> 3861</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3862</span>        }</div>
<div class="line"><span class="lineno"> 3863</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3864</span>        </div>
<div class="line"><span class="lineno"> 3865</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0] = <a class="code hl_class" href="classTensor.html">a2</a> * <a class="code hl_class" href="classTensor.html">b3</a> - <a class="code hl_class" href="classTensor.html">a3</a> * <a class="code hl_class" href="classTensor.html">b2</a>;</div>
<div class="line"><span class="lineno"> 3866</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[1] = <a class="code hl_class" href="classTensor.html">a3</a> * <a class="code hl_class" href="classTensor.html">b1</a> - <a class="code hl_class" href="classTensor.html">a1</a> * <a class="code hl_class" href="classTensor.html">b3</a>;</div>
<div class="line"><span class="lineno"> 3867</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[2] = <a class="code hl_class" href="classTensor.html">a1</a> * <a class="code hl_class" href="classTensor.html">b2</a> - <a class="code hl_class" href="classTensor.html">a2</a> * <a class="code hl_class" href="classTensor.html">b1</a>;</div>
<div class="line"><span class="lineno"> 3868</span>        </div>
<div class="line"><span class="lineno"> 3869</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3870</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aead4907bc4e5e749a1dc4e535e9e33f1" name="aead4907bc4e5e749a1dc4e535e9e33f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aead4907bc4e5e749a1dc4e535e9e33f1">&#9670;&#160;</a></span>cumprod()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::cumprod </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Cumulative product along all elements (flattened view). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with cumulative products. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05403">5403</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5403</span>                                 {</div>
<div class="line"><span class="lineno"> 5404</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 5405</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 5406</span>        </div>
<div class="line"><span class="lineno"> 5407</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">total</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 5408</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0];</div>
<div class="line"><span class="lineno"> 5409</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5410</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>-1] * <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5411</span>            }</div>
<div class="line"><span class="lineno"> 5412</span>        }</div>
<div class="line"><span class="lineno"> 5413</span>        </div>
<div class="line"><span class="lineno"> 5414</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 5415</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a885a53dcbb0408b74958517747cf3868" name="a885a53dcbb0408b74958517747cf3868"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a885a53dcbb0408b74958517747cf3868">&#9670;&#160;</a></span>cumprod_axis()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::cumprod_axis </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>axis</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Cumulative product along a specific axis. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The dimension along which to compute cumulative product. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with cumulative products along the specified axis. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05467">5467</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5467</span>                                                 {</div>
<div class="line"><span class="lineno"> 5468</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &gt;= <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 5469</span>            <span class="keywordflow">throw</span> <a class="code hl_class" href="classTensor.html">std::out_of_range</a>(<span class="stringliteral">&quot;Axis out of bounds&quot;</span>);</div>
<div class="line"><span class="lineno"> 5470</span>        }</div>
<div class="line"><span class="lineno"> 5471</span>        </div>
<div class="line"><span class="lineno"> 5472</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 5473</span>        </div>
<div class="line"><span class="lineno"> 5474</span>        <span class="comment">// Compute strides</span></div>
<div class="line"><span class="lineno"> 5475</span>        <a class="code hl_class" href="classTensor.html">std::array&lt;size_t, N&gt;</a> <a class="code hl_function" href="#a938d78600782073a1ff2725066b46c85">strides</a>;</div>
<div class="line"><span class="lineno"> 5476</span>        <a class="code hl_function" href="#a938d78600782073a1ff2725066b46c85">strides</a>[<a class="code hl_class" href="classTensor.html">N</a>-1] = 1;</div>
<div class="line"><span class="lineno"> 5477</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">N</a>-1; <a class="code hl_class" href="classTensor.html">i</a>-- &gt; 0;) {</div>
<div class="line"><span class="lineno"> 5478</span>            <a class="code hl_function" href="#a938d78600782073a1ff2725066b46c85">strides</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_function" href="#a938d78600782073a1ff2725066b46c85">strides</a>[<a class="code hl_class" href="classTensor.html">i</a>+1] * <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>+1];</div>
<div class="line"><span class="lineno"> 5479</span>        }</div>
<div class="line"><span class="lineno"> 5480</span>        </div>
<div class="line"><span class="lineno"> 5481</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 5482</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">axis</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5483</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5484</span>        }</div>
<div class="line"><span class="lineno"> 5485</span>        </div>
<div class="line"><span class="lineno"> 5486</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 5487</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">axis</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5488</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5489</span>        }</div>
<div class="line"><span class="lineno"> 5490</span>        </div>
<div class="line"><span class="lineno"> 5491</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">axis_size</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>];</div>
<div class="line"><span class="lineno"> 5492</span>        </div>
<div class="line"><span class="lineno"> 5493</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 5494</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5495</span>                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">cumulative</a> = <a class="code hl_class" href="classTensor.html">T</a>(1);</div>
<div class="line"><span class="lineno"> 5496</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 0; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 5497</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 5498</span>                    <a class="code hl_class" href="classTensor.html">cumulative</a> *= <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">idx</a>];</div>
<div class="line"><span class="lineno"> 5499</span>                    <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">idx</a>] = <a class="code hl_class" href="classTensor.html">cumulative</a>;</div>
<div class="line"><span class="lineno"> 5500</span>                }</div>
<div class="line"><span class="lineno"> 5501</span>            }</div>
<div class="line"><span class="lineno"> 5502</span>        }</div>
<div class="line"><span class="lineno"> 5503</span>        </div>
<div class="line"><span class="lineno"> 5504</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 5505</span>    }</div>
<div class="ttc" id="aclassTensor_html_a938d78600782073a1ff2725066b46c85"><div class="ttname"><a href="#a938d78600782073a1ff2725066b46c85">Tensor::strides</a></div><div class="ttdeci">const TensorIndices&lt; N &gt; &amp; strides() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00672">tensor.h:672</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5784e1627743c06127dbaa1b744cba8e" name="a5784e1627743c06127dbaa1b744cba8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5784e1627743c06127dbaa1b744cba8e">&#9670;&#160;</a></span>cumsum()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::cumsum </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Cumulative sum along all elements (flattened view). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with cumulative sums. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05385">5385</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5385</span>                                {</div>
<div class="line"><span class="lineno"> 5386</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 5387</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 5388</span>        </div>
<div class="line"><span class="lineno"> 5389</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">total</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 5390</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0];</div>
<div class="line"><span class="lineno"> 5391</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5392</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>-1] + <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5393</span>            }</div>
<div class="line"><span class="lineno"> 5394</span>        }</div>
<div class="line"><span class="lineno"> 5395</span>        </div>
<div class="line"><span class="lineno"> 5396</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 5397</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad19397de13c742b72cd0829b01090dd9" name="ad19397de13c742b72cd0829b01090dd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad19397de13c742b72cd0829b01090dd9">&#9670;&#160;</a></span>cumsum_axis()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::cumsum_axis </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>axis</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Cumulative sum along a specific axis. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The dimension along which to compute cumulative sum. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with cumulative sums along the specified axis. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05422">5422</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5422</span>                                                {</div>
<div class="line"><span class="lineno"> 5423</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &gt;= <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 5424</span>            <span class="keywordflow">throw</span> <a class="code hl_class" href="classTensor.html">std::out_of_range</a>(<span class="stringliteral">&quot;Axis out of bounds&quot;</span>);</div>
<div class="line"><span class="lineno"> 5425</span>        }</div>
<div class="line"><span class="lineno"> 5426</span>        </div>
<div class="line"><span class="lineno"> 5427</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 5428</span>        </div>
<div class="line"><span class="lineno"> 5429</span>        <span class="comment">// Compute strides</span></div>
<div class="line"><span class="lineno"> 5430</span>        <a class="code hl_class" href="classTensor.html">std::array&lt;size_t, N&gt;</a> <a class="code hl_function" href="#a938d78600782073a1ff2725066b46c85">strides</a>;</div>
<div class="line"><span class="lineno"> 5431</span>        <a class="code hl_function" href="#a938d78600782073a1ff2725066b46c85">strides</a>[<a class="code hl_class" href="classTensor.html">N</a>-1] = 1;</div>
<div class="line"><span class="lineno"> 5432</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">N</a>-1; <a class="code hl_class" href="classTensor.html">i</a>-- &gt; 0;) {</div>
<div class="line"><span class="lineno"> 5433</span>            <a class="code hl_function" href="#a938d78600782073a1ff2725066b46c85">strides</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_function" href="#a938d78600782073a1ff2725066b46c85">strides</a>[<a class="code hl_class" href="classTensor.html">i</a>+1] * <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>+1];</div>
<div class="line"><span class="lineno"> 5434</span>        }</div>
<div class="line"><span class="lineno"> 5435</span>        </div>
<div class="line"><span class="lineno"> 5436</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 5437</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">axis</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5438</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5439</span>        }</div>
<div class="line"><span class="lineno"> 5440</span>        </div>
<div class="line"><span class="lineno"> 5441</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 5442</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">axis</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5443</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5444</span>        }</div>
<div class="line"><span class="lineno"> 5445</span>        </div>
<div class="line"><span class="lineno"> 5446</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">axis_size</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>];</div>
<div class="line"><span class="lineno"> 5447</span>        </div>
<div class="line"><span class="lineno"> 5448</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 5449</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5450</span>                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">cumulative</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 5451</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 0; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 5452</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 5453</span>                    <a class="code hl_class" href="classTensor.html">cumulative</a> += <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">idx</a>];</div>
<div class="line"><span class="lineno"> 5454</span>                    <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">idx</a>] = <a class="code hl_class" href="classTensor.html">cumulative</a>;</div>
<div class="line"><span class="lineno"> 5455</span>                }</div>
<div class="line"><span class="lineno"> 5456</span>            }</div>
<div class="line"><span class="lineno"> 5457</span>        }</div>
<div class="line"><span class="lineno"> 5458</span>        </div>
<div class="line"><span class="lineno"> 5459</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 5460</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8befdfb5ad9c3f2a69f8bdccc9a3787" name="ad8befdfb5ad9c3f2a69f8bdccc9a3787"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8befdfb5ad9c3f2a69f8bdccc9a3787">&#9670;&#160;</a></span>data() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T * <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::data </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00666">666</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  666</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a07bf856a863505d2960b0bfad9c3b3f4" name="a07bf856a863505d2960b0bfad9c3b3f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07bf856a863505d2960b0bfad9c3b3f4">&#9670;&#160;</a></span>data() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const T * <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::data </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get raw pointer to data (for internal use and I/O). </p><dl class="section return"><dt>Returns</dt><dd>Pointer to the underlying data array. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00665">665</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  665</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(); }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a07bf856a863505d2960b0bfad9c3b3f4_icgraph.png" border="0" usemap="#aclassTensor_a07bf856a863505d2960b0bfad9c3b3f4_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a07bf856a863505d2960b0bfad9c3b3f4_icgraph" id="aclassTensor_a07bf856a863505d2960b0bfad9c3b3f4_icgraph">
<area shape="rect" title=" " alt="" coords="449,813,542,840"/>
<area shape="rect" href="classTensor.html#ae5260fcc92739949dd584a0b931d1853" title=" " alt="" coords="214,5,401,32"/>
<area shape="poly" title=" " alt="" coords="490,798,480,632,460,393,448,273,433,168,416,88,408,62,399,46,386,35,389,31,403,42,413,60,422,87,438,167,453,272,466,392,485,631,495,798"/>
<area shape="rect" href="classTensor.html#a76c7896d6d3ec3066bfd12dbeca73f9e" title=" " alt="" coords="216,56,399,83"/>
<area shape="poly" title=" " alt="" coords="492,798,491,651,481,441,469,332,453,233,429,152,415,120,399,96,386,85,389,81,403,93,420,118,434,150,458,232,475,332,486,440,496,651,497,798"/>
<area shape="rect" href="tensor_8h.html#a1ce61bbd53890adec19f5b19f946ef26" title="Return indices that would sort the tensor (1D only)." alt="" coords="277,107,338,133"/>
<area shape="poly" title=" " alt="" coords="492,798,488,662,476,470,464,371,448,280,426,205,413,176,399,154,386,142,371,134,338,125,339,120,373,129,389,138,403,150,418,173,431,203,453,279,469,370,481,469,494,662,497,798"/>
<area shape="rect" href="tensor_8h.html#a952343525fb5d9376af0645793e8f1d4" title="Find k largest or smallest elements and their indices (1D only)." alt="" coords="62,132,109,159"/>
<area shape="poly" title=" " alt="" coords="492,798,489,669,477,488,465,395,449,312,427,243,414,217,399,198,378,184,347,173,264,158,176,151,109,148,109,143,177,146,264,153,348,168,381,180,403,194,418,214,432,241,454,310,471,395,482,487,494,669,497,798"/>
<area shape="rect" href="classTensorRandom.html#a4ab3dafd07fad48c51646b18f3941d2d" title=" " alt="" coords="236,208,378,235"/>
<area shape="poly" title=" " alt="" coords="491,798,485,681,470,518,458,436,442,360,423,298,399,255,375,237,378,233,403,252,428,296,447,359,463,435,475,518,490,680,496,798"/>
<area shape="rect" href="classTensorRandom.html#aa1a5064152168f02c6e31f37c7029517" title=" " alt="" coords="5,233,166,260"/>
<area shape="poly" title=" " alt="" coords="491,798,485,688,470,537,458,461,443,392,423,336,412,315,399,299,384,289,361,280,302,266,233,257,166,252,166,247,233,251,303,260,363,274,386,284,403,295,416,312,428,334,448,391,464,460,476,536,490,687,496,798"/>
<area shape="rect" href="namespaceloss.html#a365059b00ea1e6ec1db86710cfcf3b31" title="Binary cross entropy loss for binary classification." alt="" coords="244,309,371,352"/>
<area shape="poly" title=" " alt="" coords="490,798,480,701,463,572,436,448,419,399,399,366,386,354,370,346,373,341,389,350,403,362,423,397,441,446,468,571,485,701,495,798"/>
<area shape="rect" href="classTensorRandom.html#a13c2ca2a4729bd8252f729ca4737b561" title=" " alt="" coords="228,376,387,403"/>
<area shape="poly" title=" " alt="" coords="489,798,479,711,461,596,434,487,418,445,399,416,384,405,388,401,403,413,422,443,439,486,466,595,484,710,494,798"/>
<area shape="rect" href="classTensorRandom.html#a3cb586fc12c2fa7ae9ba9a072c460312" title=" " alt="" coords="214,427,401,453"/>
<area shape="poly" title=" " alt="" coords="488,798,476,720,457,621,431,527,416,491,399,467,384,456,387,452,403,463,420,489,436,526,462,620,481,719,493,797"/>
<area shape="rect" href="tensor_8h.html#a64dfa8c2475ed50ae00ef1d4e1c12fd2" title="Divide tensor into equal&#45;sized chunks (last chunk may be smaller)." alt="" coords="279,501,336,528"/>
<area shape="poly" title=" " alt="" coords="490,798,484,745,469,678,442,609,423,577,399,549,385,538,369,529,335,520,337,515,371,524,388,533,403,545,427,574,447,607,474,677,489,744,496,797"/>
<area shape="rect" href="tensor_8h.html#a139335a446015c5f7ad70fa3d2ccfbec" title="Split tensor into chunks along specified axis." alt="" coords="63,513,108,540"/>
<area shape="poly" title=" " alt="" coords="489,799,481,753,465,697,439,640,421,615,399,593,377,580,345,568,262,550,175,538,109,531,109,526,175,533,262,545,346,563,379,575,403,589,425,611,444,637,470,695,486,751,494,798"/>
<area shape="rect" href="classTensorRandom.html#a0e0fffdaccf3f3ef986a586a70036c46" title=" " alt="" coords="216,603,399,629"/>
<area shape="poly" title=" " alt="" coords="485,799,474,763,457,721,432,679,399,643,381,632,384,628,403,639,436,676,462,719,479,761,490,798"/>
<area shape="rect" href="namespaceloss.html#ab7fbd0200f34e3d12f66d20b681a948f" title="L1 loss (Mean Absolute Error)." alt="" coords="260,653,354,680"/>
<area shape="poly" title=" " alt="" coords="480,800,448,746,426,718,399,694,378,683,354,675,356,670,380,678,403,690,430,714,453,743,485,798"/>
<area shape="rect" href="tensor__io_8h.html#a7e2cae1250696214044c322ac0bd4a1b" title="Load a tensor from a binary file." alt="" coords="264,704,351,731"/>
<area shape="poly" title=" " alt="" coords="471,804,439,773,400,745,351,727,353,722,402,740,443,769,475,800"/>
<area shape="rect" href="classTensor.html#a754cdcbf16b91d5621e7405a2aa68f68" title=" " alt="" coords="218,755,397,781"/>
<area shape="poly" title=" " alt="" coords="442,810,400,796,361,784,363,779,402,791,444,805"/>
<area shape="rect" href="classTensor.html#a4773678cdfb3526a2bdb1079ef68b87e" title=" " alt="" coords="228,805,387,848"/>
<area shape="poly" title=" " alt="" coords="433,829,388,829,388,824,433,824"/>
<area shape="rect" href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7" title="Mean Squared Error (MSE) Loss." alt="" coords="253,872,362,899"/>
<area shape="poly" title=" " alt="" coords="444,848,402,863,363,874,361,869,400,857,442,843"/>
<area shape="rect" href="classTensorRandom.html#a32623f7c051b83056274671f87e7541a" title=" " alt="" coords="229,923,386,949"/>
<area shape="poly" title=" " alt="" coords="475,853,443,884,402,913,375,925,373,920,400,908,439,880,471,849"/>
<area shape="rect" href="tensor__io_8h.html#ad4f347ce46aff75bdad7db7e7d7eabef" title="Pretty print a tensor with formatting options." alt="" coords="284,973,330,1000"/>
<area shape="poly" title=" " alt="" coords="485,856,453,911,430,939,402,964,366,980,332,987,330,982,365,975,400,959,426,936,448,908,480,853"/>
<area shape="rect" href="classTensorRandom.html#adaa260a2571c3009e0f2a527c386b460" title=" " alt="" coords="222,1024,393,1051"/>
<area shape="poly" title=" " alt="" coords="490,856,479,892,462,935,436,977,403,1014,384,1026,381,1021,399,1010,432,974,457,932,474,890,485,854"/>
<area shape="rect" href="tensor_8h.html#ad71687cadd6e7bdae0f2d66fc9f437e1" title="Construct tensor by repeating along specified axis." alt="" coords="244,1075,370,1101"/>
<area shape="poly" title=" " alt="" coords="494,855,486,901,469,957,443,1015,425,1041,403,1065,372,1082,370,1077,399,1061,420,1038,438,1012,464,955,480,900,489,854"/>
<area shape="rect" href="tensor__io_8h.html#a8141782719cc7c7dc60b3043bbbc5366" title="Save a tensor to a file in binary format." alt="" coords="262,1125,353,1152"/>
<area shape="poly" title=" " alt="" coords="496,856,491,911,476,980,464,1017,449,1053,428,1086,403,1115,380,1130,354,1138,353,1133,378,1125,399,1111,424,1083,444,1050,459,1015,471,979,486,910,491,855"/>
<area shape="rect" href="tensor__io_8h.html#ac622682f190796d532e11f0c7b597aa0" title="Save a tensor to NumPy .npy format (version 1.0)." alt="" coords="269,1176,346,1203"/>
<area shape="poly" title=" " alt="" coords="498,856,495,919,483,1002,471,1047,455,1090,432,1130,403,1166,376,1183,347,1190,346,1185,374,1178,399,1162,428,1127,450,1088,466,1045,478,1001,490,919,493,855"/>
<area shape="rect" href="tensor__io_8h.html#add21f5804707b520f88e074026b258b3" title="Save a tensor to a text file (CSV&#45;like format)." alt="" coords="268,1227,346,1253"/>
<area shape="poly" title=" " alt="" coords="494,856,483,938,464,1046,438,1149,421,1189,403,1217,377,1233,348,1241,346,1236,375,1228,399,1213,417,1186,433,1147,459,1045,478,938,489,855"/>
<area shape="rect" href="tensor_8h.html#abcbf52cee83938743ba0195663090841" title="Binary search to find indices where elements should be inserted (1D only)." alt="" coords="259,1277,356,1304"/>
<area shape="poly" title=" " alt="" coords="495,856,485,948,468,1071,455,1133,441,1189,423,1235,403,1267,381,1282,357,1290,355,1285,379,1277,399,1263,419,1233,436,1187,450,1132,462,1070,480,948,489,855"/>
<area shape="rect" href="namespaceloss.html#a2d2c1dacdb37d834f7dc10e85cd1a742" title="Smooth L1 loss (Huber loss)." alt="" coords="235,1328,380,1355"/>
<area shape="poly" title=" " alt="" coords="495,856,487,958,471,1096,459,1166,444,1229,425,1282,403,1318,381,1333,378,1329,399,1314,420,1279,439,1228,454,1165,466,1095,482,957,490,855"/>
<area shape="rect" href="tensor_8h.html#a4bfe3189f926716838813a01b6c37038" title="Sort tensor elements and return sorted tensor (1D only)." alt="" coords="286,1379,329,1405"/>
<area shape="poly" title=" " alt="" coords="496,855,490,967,474,1120,462,1198,447,1269,427,1328,403,1368,387,1381,367,1389,330,1395,329,1390,366,1384,384,1377,399,1365,422,1326,442,1268,457,1197,469,1120,484,966,491,855"/>
<area shape="rect" href="tensor_8h.html#ac2791cd88647d71068c02d8824a38ff2" title="Repeat tensor multiple times along each dimension." alt="" coords="288,1429,327,1456"/>
<area shape="poly" title=" " alt="" coords="496,856,491,977,477,1145,465,1231,450,1310,429,1374,417,1400,403,1419,386,1432,366,1440,327,1446,327,1440,364,1435,383,1428,399,1415,412,1397,424,1372,444,1308,460,1230,472,1145,486,977,491,856"/>
<area shape="rect" href="classTensorRandom.html#a24ba0db3d6b9da25b2e6cfc6b15994b8" title=" " alt="" coords="227,1480,388,1507"/>
<area shape="poly" title=" " alt="" coords="497,856,493,986,481,1170,469,1264,453,1350,431,1421,418,1448,403,1470,389,1482,385,1477,399,1466,413,1446,426,1419,447,1348,464,1263,475,1169,488,986,492,856"/>
<area shape="rect" href="tensor_8h.html#ad136045cd6f420421ea5618b726778f3" title="Find unique elements in tensor (1D only)." alt="" coords="278,1531,337,1557"/>
<area shape="poly" title=" " alt="" coords="497,856,495,995,484,1194,472,1296,455,1390,433,1467,419,1497,403,1520,389,1532,372,1540,338,1547,337,1541,370,1535,386,1528,399,1517,414,1495,428,1465,450,1388,467,1295,478,1193,490,995,492,856"/>
<area shape="rect" href="classTensor.html#ab35759b8f0cec852e27c31cf339737b8" title=" " alt="" coords="233,1581,382,1608"/>
<area shape="poly" title=" " alt="" coords="497,855,497,1004,487,1218,475,1328,458,1430,435,1513,420,1546,403,1571,384,1586,381,1581,399,1567,415,1543,430,1511,453,1428,470,1327,481,1217,491,1003,492,855"/>
<area shape="poly" title=" " alt="" coords="262,128,110,145,109,140,261,123"/>
<area shape="poly" title=" " alt="" coords="221,234,166,240,166,235,221,228"/>
<area shape="poly" title=" " alt="" coords="340,490,330,483,307,480,287,482,277,487,275,493,281,500,277,504,270,494,273,483,286,477,307,475,332,478,343,486"/>
<area shape="poly" title=" " alt="" coords="264,520,109,528,108,523,263,514"/>
<area shape="rect" href="tensor__io_8h.html#ad797300c155fa720a2973a7d8e6d7e6b" title="Load a tensor from a file (auto&#45;detects format)." alt="" coords="63,577,108,604"/>
<area shape="poly" title=" " alt="" coords="247,711,212,694,195,675,187,655,180,636,164,618,136,604,108,596,109,591,138,599,167,614,184,633,192,653,199,672,215,690,249,706"/>
<area shape="rect" href="tensor__c_8cpp.html#a5593190a30886333c69f5323af1837d7" title=" " alt="" coords="19,628,152,655"/>
<area shape="poly" title=" " alt="" coords="248,706,213,694,165,669,134,658,136,653,167,664,215,690,249,701"/>
<area shape="rect" href="tensor__c_8cpp.html#ad4619644bf3a3c6782ca538baf857de2" title=" " alt="" coords="25,679,146,705"/>
<area shape="poly" title=" " alt="" coords="248,713,146,701,146,696,248,708"/>
<area shape="rect" href="tensor__c_8cpp.html#a48336469b05364f186cfb755e9a4b964" title=" " alt="" coords="19,729,152,756"/>
<area shape="poly" title=" " alt="" coords="248,727,153,738,153,732,248,721"/>
<area shape="rect" href="tensor__c_8cpp.html#aeb2b9f618f951ee364a412717a705231" title=" " alt="" coords="25,780,146,807"/>
<area shape="poly" title=" " alt="" coords="249,734,215,745,167,770,136,782,134,777,165,766,213,740,248,728"/>
<area shape="rect" href="classTensor.html#a3090598433576f68f34f340cd6a18089" title=" " alt="" coords="13,831,158,873"/>
<area shape="poly" title=" " alt="" coords="213,840,159,846,158,841,212,835"/>
<area shape="rect" href="tensor__io_8h.html#a223dda8ee6a3e3344a59b4f0fe19df42" title=" " alt="" coords="39,923,132,949"/>
<area shape="poly" title=" " alt="" coords="268,981,132,949,133,944,270,976"/>
<area shape="rect" href="tensor__io_8h.html#a278d10cd95a2b11a414ecd8eda1b665e" title="Convert tensor to string representation." alt="" coords="50,973,121,1000"/>
<area shape="poly" title=" " alt="" coords="269,989,122,989,122,984,269,984"/>
<area shape="rect" href="tensor__c_8cpp.html#a6bcb6552c10a49c900c884bc90502f18" title=" " alt="" coords="17,1024,154,1051"/>
<area shape="poly" title=" " alt="" coords="245,1130,212,1116,197,1103,187,1090,179,1077,164,1065,141,1054,143,1049,167,1060,182,1074,192,1087,201,1099,215,1111,248,1125"/>
<area shape="rect" href="tensor__c_8cpp.html#a5f089dd07835b1e12bace4400085be22" title=" " alt="" coords="23,1075,148,1101"/>
<area shape="poly" title=" " alt="" coords="246,1128,146,1105,148,1099,247,1122"/>
<area shape="rect" href="tensor__io_8h.html#af1dee4960bb4ee62c02499855bb66a2d" title="Save a tensor to a file with specified format." alt="" coords="61,1227,110,1253"/>
<area shape="poly" title=" " alt="" coords="248,1152,215,1166,201,1178,192,1191,182,1204,167,1217,139,1230,111,1238,110,1233,137,1225,164,1212,179,1200,187,1188,197,1175,212,1162,245,1147"/>
<area shape="rect" href="tensor__c_8cpp.html#aefb7ebf64853d118255476d31709288c" title=" " alt="" coords="17,1125,154,1152"/>
<area shape="poly" title=" " alt="" coords="246,1141,155,1141,155,1136,246,1136"/>
<area shape="rect" href="tensor__c_8cpp.html#a40689cfb9e9d6f1fa7d9fb5c90c4e41d" title=" " alt="" coords="23,1176,148,1203"/>
<area shape="poly" title=" " alt="" coords="247,1155,148,1178,146,1173,246,1150"/>
<area shape="poly" title=" " alt="" coords="254,1204,111,1237,110,1232,253,1199"/>
<area shape="poly" title=" " alt="" coords="253,1243,110,1243,110,1237,253,1237"/>
<area shape="rect" href="tensor__io_8h.html#a9e03fa16492ffad78aee9cc9f84073d9" title=" " alt="" coords="23,1277,148,1304"/>
<area shape="poly" title=" " alt="" coords="254,1255,148,1279,147,1274,252,1250"/>
</map>
</div>

</div>
</div>
<a id="ad74772ea04c239f0878e8ad8653dce5d" name="ad74772ea04c239f0878e8ad8653dce5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad74772ea04c239f0878e8ad8653dce5d">&#9670;&#160;</a></span>data_ptr() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T * <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::data_ptr </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00639">639</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  639</span>                  {</div>
<div class="line"><span class="lineno">  640</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  641</span>        <a class="code hl_class" href="classTensor.html">ensure_on_cpu</a>();  <span class="comment">// Sync from GPU if needed</span></div>
<div class="line"><span class="lineno">  642</span>        <span class="comment">// Non-const access means user might modify, so invalidate GPU</span></div>
<div class="line"><span class="lineno">  643</span>        <a class="code hl_class" href="classTensor.html">data_on_gpu_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  644</span>        <a class="code hl_class" href="classTensor.html">gpu_needs_sync_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  645</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  646</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get();</div>
<div class="line"><span class="lineno">  647</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3f3c97d177cb960a4423afc3dafc612a" name="a3f3c97d177cb960a4423afc3dafc612a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f3c97d177cb960a4423afc3dafc612a">&#9670;&#160;</a></span>data_ptr() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const T * <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::data_ptr </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00632">632</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  632</span>                              {</div>
<div class="line"><span class="lineno">  633</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  634</span>        <a class="code hl_class" href="classTensor.html">ensure_on_cpu</a>();  <span class="comment">// Sync from GPU if needed</span></div>
<div class="line"><span class="lineno">  635</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  636</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get();</div>
<div class="line"><span class="lineno">  637</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a3f3c97d177cb960a4423afc3dafc612a_icgraph.png" border="0" usemap="#aclassTensor_a3f3c97d177cb960a4423afc3dafc612a_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a3f3c97d177cb960a4423afc3dafc612a_icgraph" id="aclassTensor_a3f3c97d177cb960a4423afc3dafc612a_icgraph">
<area shape="rect" title=" " alt="" coords="659,1136,775,1163"/>
<area shape="rect" href="tensor_8h.html#abee606191f2a9544a7acbbd79094ed5b" title="Create a tensor with values in a range (NumPy arange&#45;compatible)." alt="" coords="493,5,553,32"/>
<area shape="poly" title=" " alt="" coords="712,1120,704,894,685,552,671,379,654,225,633,109,622,69,609,46,598,36,584,29,553,22,554,17,585,24,601,31,613,42,627,67,638,107,659,225,676,378,690,552,709,894,718,1120"/>
<area shape="rect" href="tensor_8h.html#a912e291f7a42f325c111def58ac98acf" title="Cast tensor to a different data type (NumPy&#45;compatible astype)." alt="" coords="493,56,553,83"/>
<area shape="poly" title=" " alt="" coords="712,1121,703,904,684,578,670,413,653,267,632,156,621,119,609,96,598,86,584,79,553,72,554,67,585,74,601,82,613,93,626,117,638,155,658,266,675,412,689,578,708,904,717,1121"/>
<area shape="rect" href="classTensor.html#a4029fcf1a134dc6add543b9bdd1c045b" title=" " alt="" coords="447,107,599,133"/>
<area shape="poly" title=" " alt="" coords="712,1120,701,915,681,607,666,452,650,315,630,210,620,175,609,154,587,136,590,132,613,150,625,173,636,209,655,314,672,452,686,607,707,914,717,1120"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Softmax.html#abda8fce936f0e7f02d1779a120db27de" title=" " alt="" coords="5,179,156,221"/>
<area shape="poly" title=" " alt="" coords="712,1121,703,923,684,632,670,485,653,356,633,260,621,228,610,210,578,192,531,181,473,175,408,173,273,180,156,192,156,187,272,175,408,168,473,169,532,175,579,187,613,206,626,226,638,258,659,356,676,484,690,631,709,923,717,1121"/>
<area shape="rect" href="tensor_8h.html#adc912199dacbff108e0d2cadfae000df" title="Extract a rectangular block from a 2D tensor." alt="" coords="497,376,549,403"/>
<area shape="poly" title=" " alt="" coords="713,1120,709,973,696,762,683,653,664,554,640,472,626,440,609,416,597,406,581,399,549,392,550,387,583,394,599,401,613,413,630,438,645,470,670,553,688,653,701,762,715,973,718,1120"/>
<area shape="rect" href="classTensorSlice.html#a1bd9b68295e8796f36452ba27a85e1fb" title=" " alt="" coords="459,427,587,453"/>
<area shape="poly" title=" " alt="" coords="713,1121,708,983,693,787,679,686,662,594,638,518,625,489,609,467,586,451,589,447,613,463,629,487,643,516,667,593,685,685,698,786,713,983,718,1121"/>
<area shape="rect" href="tensor_8h.html#aa94ca571f8bc2b76cd1bdb6fd851c556" title="Extract bottom n rows from a 2D tensor." alt="" coords="476,477,571,504"/>
<area shape="poly" title=" " alt="" coords="712,1121,706,992,690,811,676,719,659,634,636,565,624,538,609,518,592,505,570,497,572,492,594,500,613,514,628,535,641,563,664,633,681,718,695,811,711,992,718,1121"/>
<area shape="rect" href="tensor_8h.html#a34fae58316c67748882059be5f1d153c" title="Broadcast a tensor to a new shape." alt="" coords="475,528,571,555"/>
<area shape="poly" title=" " alt="" coords="712,1121,704,1002,686,836,673,751,656,674,635,611,623,587,609,569,592,555,571,548,572,543,594,551,613,565,627,584,640,609,661,673,678,750,692,835,709,1001,717,1120"/>
<area shape="rect" href="namespacelinalg.html#a12137fd985ff57d9e9396c8f6919383e" title="Cholesky decomposition: A = L * L^T for symmetric positive definite matrices." alt="" coords="441,579,605,605"/>
<area shape="poly" title=" " alt="" coords="711,1121,702,1011,683,860,670,784,653,714,633,658,609,619,595,608,598,604,613,616,638,655,658,713,675,783,688,859,707,1010,717,1120"/>
<area shape="rect" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74" title="Extract a single column from a 2D tensor." alt="" coords="504,629,542,656"/>
<area shape="poly" title=" " alt="" coords="711,1121,700,1020,680,885,666,816,650,755,631,704,609,670,595,659,577,651,542,645,543,640,579,646,597,654,613,666,636,702,655,753,671,815,685,884,705,1019,716,1120"/>
<area shape="rect" href="classTensorSlice.html#a2ab23ac1938c1cc469bd2da5eb61d35c" title=" " alt="" coords="466,680,580,707"/>
<area shape="poly" title=" " alt="" coords="710,1121,698,1030,677,910,647,795,629,751,609,720,596,710,580,703,582,698,599,705,613,717,634,748,652,793,682,909,703,1029,715,1120"/>
<area shape="rect" href="tensor_8h.html#a3331b6cf4ac182d022336e4d068a0e58" title="Create a copy of a tensor (NumPy&#45;compatible)." alt="" coords="498,731,548,757"/>
<area shape="poly" title=" " alt="" coords="714,1121,712,1050,698,956,685,906,667,857,642,812,609,771,596,761,580,754,548,747,549,742,582,749,599,756,613,767,646,809,672,855,690,905,704,955,717,1050,719,1121"/>
<area shape="rect" href="tensor_8h.html#a43014e3309494c3851da86be3a162194" title="Extract the diagonal of a 2D tensor." alt="" coords="500,781,546,808"/>
<area shape="poly" title=" " alt="" coords="713,1120,707,1059,692,978,679,936,661,894,638,856,610,822,595,812,579,805,546,798,547,793,580,799,598,807,613,818,642,853,666,892,684,934,697,977,712,1058,718,1120"/>
<area shape="rect" href="tensor_8h.html#ae66ddfcd20907014f524982e01698d82" title="Create a diagonal matrix from a 1D tensor." alt="" coords="479,832,567,859"/>
<area shape="poly" title=" " alt="" coords="711,1121,702,1067,685,1001,655,932,634,900,610,873,590,860,567,852,569,847,592,855,613,869,639,897,660,929,690,999,708,1066,716,1120"/>
<area shape="rect" href="namespacelinalg.html#a4f401211bb16058dcce20c796bda8dd2" title="Compute dot product of two vectors." alt="" coords="484,883,562,909"/>
<area shape="poly" title=" " alt="" coords="708,1121,697,1078,678,1024,649,970,631,945,610,923,587,910,561,902,563,897,589,905,613,919,635,942,654,967,683,1022,702,1076,713,1120"/>
<area shape="rect" href="namespacelinalg.html#a7141076f8e6b39635853e8368a13c4ea" title="Compute eigenvalues and eigenvectors for symmetric matrices." alt="" coords="458,933,588,960"/>
<area shape="poly" title=" " alt="" coords="704,1122,690,1088,670,1048,643,1008,610,974,587,962,590,957,613,970,648,1005,675,1045,695,1086,709,1120"/>
<area shape="rect" href="tensor_8h.html#a04c7965d0b8f08cfdb84580050e9e0b5" title="Extract first n elements from a 1D tensor." alt="" coords="498,984,548,1011"/>
<area shape="poly" title=" " alt="" coords="697,1124,660,1077,636,1053,610,1032,578,1015,547,1005,549,1000,580,1010,613,1027,640,1049,664,1074,701,1121"/>
<area shape="rect" href="namespacelinalg.html#abc25aee98d873c690a7d8a88277e7219" title="Compute inverse of a square matrix." alt="" coords="245,1097,346,1124"/>
<area shape="poly" title=" " alt="" coords="652,1134,611,1127,467,1114,346,1112,347,1107,468,1109,612,1121,653,1129"/>
<area shape="rect" href="namespacetensor4d_1_1nn.html#ac2a195a98fc946944abd82c47d997189" title="Convert label to one&#45;hot encoded vector." alt="" coords="459,1288,587,1331"/>
<area shape="poly" title=" " alt="" coords="700,1177,663,1224,613,1271,583,1290,580,1285,610,1267,659,1221,696,1174"/>
<area shape="rect" href="tensor_8h.html#a0d1116cdf6624cb52514979cd1869e55" title="Extract leftmost n columns from a 2D tensor." alt="" coords="490,1355,556,1381"/>
<area shape="poly" title=" " alt="" coords="711,1178,698,1216,677,1261,650,1306,613,1345,586,1360,557,1367,556,1362,584,1355,610,1341,645,1303,673,1258,693,1214,706,1177"/>
<area shape="rect" href="tensor_8h.html#a47fb1071bbaf297c2b7804f3a16cbce0" title="Create a tensor with evenly spaced values (NumPy linspace&#45;compatible)." alt="" coords="488,1405,558,1432"/>
<area shape="poly" title=" " alt="" coords="714,1179,704,1226,685,1284,656,1344,636,1371,613,1395,587,1411,559,1418,558,1413,585,1406,610,1391,632,1368,651,1341,680,1282,699,1225,709,1178"/>
<area shape="rect" href="tensor_8h.html#ac9b881e42d5eeb214b4ca87579eaaffc" title="Create a tensor with values spaced evenly on a log scale." alt="" coords="486,1456,560,1483"/>
<area shape="poly" title=" " alt="" coords="717,1178,709,1234,692,1306,679,1344,662,1381,640,1416,613,1446,588,1461,561,1469,560,1464,586,1456,610,1442,636,1412,657,1378,674,1342,687,1305,704,1233,711,1177"/>
<area shape="rect" href="namespacelinalg.html#a8405b084d692b1fc7f685f40425a0970" title="Solve least squares problem: minimize ||Ax &#45; b||" alt="" coords="37,1173,124,1200"/>
<area shape="poly" title=" " alt="" coords="675,1172,612,1195,499,1218,409,1228,319,1225,203,1215,124,1200,125,1195,204,1209,319,1220,409,1222,498,1213,611,1189,674,1167"/>
<area shape="rect" href="namespacelinalg.html#a299049265c4cb34923444e82e56f381f" title="Compute LU decomposition with partial pivoting: P*A = L*U." alt="" coords="462,1136,584,1163"/>
<area shape="poly" title=" " alt="" coords="644,1152,585,1152,585,1147,644,1147"/>
<area shape="rect" href="namespacelinalg.html#a49a644f54af36b484886d433da564a1f" title="Solve linear system Ax = b." alt="" coords="250,1173,340,1200"/>
<area shape="poly" title=" " alt="" coords="653,1169,612,1177,537,1185,463,1189,341,1190,341,1185,463,1184,537,1180,611,1172,652,1164"/>
<area shape="rect" href="namespacelinalg.html#a6ee776536e47c3e57b3b24ed6225bff2" title=" " alt="" coords="244,1040,346,1067"/>
<area shape="poly" title=" " alt="" coords="678,1131,646,1115,611,1101,540,1083,468,1071,346,1058,347,1053,469,1066,541,1078,612,1096,648,1110,680,1126"/>
<area shape="rect" href="namespacelinalg.html#a57a91e9770c813128f00c0a1ea674012" title=" " alt="" coords="472,1507,574,1533"/>
<area shape="poly" title=" " alt="" coords="718,1179,714,1244,699,1329,686,1374,667,1418,644,1460,613,1497,596,1509,576,1517,574,1512,593,1504,610,1493,639,1457,663,1416,681,1372,694,1328,709,1243,713,1178"/>
<area shape="rect" href="classTensor.html#aeb3f6a9bf8ee28d46a887238a9d3d460" title=" " alt="" coords="435,1557,611,1584"/>
<area shape="poly" title=" " alt="" coords="714,1179,701,1263,679,1373,650,1478,632,1519,613,1547,597,1559,594,1555,609,1543,628,1516,645,1476,674,1372,696,1262,709,1178"/>
<area shape="rect" href="namespacelinalg.html#a16562e1c4018bf2a58455158a8022fb9" title="Compute the L2 norm (Euclidean norm) of a vector." alt="" coords="479,1608,567,1635"/>
<area shape="poly" title=" " alt="" coords="715,1178,704,1272,683,1398,653,1518,634,1565,613,1598,592,1612,568,1620,567,1615,590,1608,609,1594,630,1563,648,1516,678,1397,698,1272,710,1178"/>
<area shape="rect" href="tensor_8h.html#aa8d30c4d06f085bf8078c8644030c633" title="Normalize tensor using L1 norm (sum of absolute values)." alt="" coords="476,1659,570,1685"/>
<area shape="poly" title=" " alt="" coords="716,1178,706,1282,686,1422,672,1494,656,1558,636,1612,613,1648,594,1663,572,1670,570,1665,592,1658,609,1645,632,1609,651,1557,667,1492,681,1422,701,1281,711,1178"/>
<area shape="rect" href="tensor_8h.html#a7718d2096a1190de7777bc65f9a86deb" title="Normalize tensor using L2 norm (Euclidean norm)." alt="" coords="476,1709,570,1736"/>
<area shape="poly" title=" " alt="" coords="717,1178,708,1292,689,1447,676,1526,659,1598,638,1658,613,1699,594,1713,572,1721,570,1716,591,1709,609,1696,633,1656,654,1597,671,1525,684,1446,703,1291,711,1178"/>
<area shape="rect" href="tensor_8h.html#a1782e0dff417e1292f8a6f1e3e1975f1" title="Min&#45;Max normalization: scales values to [min_val, max_val] range." alt="" coords="458,1760,588,1787"/>
<area shape="poly" title=" " alt="" coords="717,1179,710,1301,693,1472,679,1559,662,1639,640,1704,627,1730,613,1750,590,1766,587,1761,609,1746,623,1727,635,1702,657,1637,674,1558,687,1471,705,1301,712,1178"/>
<area shape="rect" href="tensor_8h.html#a57c931d0d77f610850f315fdd9acef39" title="Z&#45;score normalization (standardization): (x &#45; mean) / std." alt="" coords="462,1811,585,1837"/>
<area shape="poly" title=" " alt="" coords="718,1178,712,1310,696,1496,682,1591,665,1679,642,1751,628,1779,613,1800,601,1811,586,1818,584,1813,598,1807,609,1797,624,1776,637,1749,660,1677,677,1590,691,1495,706,1310,712,1178"/>
<area shape="rect" href="namespacelinalg.html#a3395139856f5efebaa58f3bc9c4ed3bd" title="QR decomposition: A = QR." alt="" coords="462,1861,585,1888"/>
<area shape="poly" title=" " alt="" coords="718,1178,714,1319,699,1520,686,1624,668,1719,644,1797,630,1828,613,1851,601,1862,586,1869,584,1864,598,1857,609,1848,625,1825,639,1795,663,1717,680,1623,694,1520,708,1319,713,1178"/>
<area shape="rect" href="tensor_8h.html#a280a6c1ac0d132b0a98af81c1fe371d8" title="Reshape a tensor (returns variant for error handling)." alt="" coords="480,1912,566,1939"/>
<area shape="poly" title=" " alt="" coords="718,1178,715,1328,702,1544,689,1656,671,1759,646,1843,631,1876,613,1902,592,1917,567,1925,566,1920,590,1913,609,1898,626,1874,641,1841,665,1757,684,1655,697,1544,710,1328,713,1178"/>
<area shape="rect" href="tensor_8h.html#a3798be100af6c60da8c8489ba3ac808a" title="Extract rightmost n columns from a 2D tensor." alt="" coords="486,1963,560,1989"/>
<area shape="poly" title=" " alt="" coords="719,1178,717,1337,705,1568,692,1688,674,1798,648,1889,632,1925,613,1953,589,1969,561,1977,560,1972,587,1965,609,1949,627,1922,643,1888,668,1797,687,1688,700,1568,712,1337,713,1178"/>
<area shape="rect" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee" title="Extract a single row from a 2D tensor." alt="" coords="502,259,544,285"/>
<area shape="poly" title=" " alt="" coords="714,1121,713,954,710,835,703,707,690,579,671,462,645,365,628,327,609,299,595,288,579,280,544,275,545,269,580,275,598,283,613,296,633,325,650,363,676,461,695,578,708,707,715,835,719,954,719,1121"/>
<area shape="rect" href="namespacetensor4d_1_1nn.html#ab2f304e755860ad8c80d7c67cfe953b2" title="Compute softmax Jacobian for batched input (batch_size x num_classes)." alt="" coords="221,229,370,272"/>
<area shape="poly" title=" " alt="" coords="712,1121,703,930,683,651,669,511,652,388,632,296,621,266,609,249,582,230,551,217,518,211,484,209,416,216,357,231,355,226,415,211,484,204,519,205,553,212,585,225,613,245,626,263,637,295,658,387,675,510,689,650,708,930,717,1120"/>
<area shape="rect" href="classTensorSlice.html#a97f65d9035ab3c07afba7640a2507deb" title=" " alt="" coords="464,2013,582,2040"/>
<area shape="poly" title=" " alt="" coords="719,1178,719,1345,715,1464,708,1592,695,1720,676,1838,650,1936,633,1974,613,2003,600,2015,584,2022,582,2017,597,2010,609,2000,628,1971,645,1934,671,1837,690,1720,703,1592,710,1463,713,1345,714,1178"/>
<area shape="rect" href="classTensorSlice.html#ab59881da676b46fd6be88b2b7361e981" title=" " alt="" coords="461,2064,585,2091"/>
<area shape="poly" title=" " alt="" coords="717,1178,706,1367,684,1645,670,1785,653,1908,635,2001,624,2034,613,2054,601,2064,587,2072,585,2067,598,2060,609,2050,619,2031,629,2000,648,1907,665,1784,679,1644,700,1367,712,1178"/>
<area shape="rect" href="namespacetensor4d_1_1nn.html#af4ed0870610368776140c66a749f99ab" title="Compute the Jacobian matrix of softmax for a single row." alt="" coords="449,309,597,352"/>
<area shape="poly" title=" " alt="" coords="713,1120,710,966,696,740,683,623,665,516,641,427,626,392,609,366,596,353,600,350,613,362,631,390,646,425,670,515,689,622,702,740,715,965,718,1120"/>
<area shape="rect" href="classTensor.html#ac15f7a77f31ef7862dd9909c9ad97160" title=" " alt="" coords="438,2115,608,2141"/>
<area shape="poly" title=" " alt="" coords="717,1178,707,1376,686,1670,672,1818,655,1949,636,2049,625,2083,613,2104,600,2116,596,2112,609,2101,620,2081,630,2048,650,1948,666,1818,681,1670,701,1376,712,1178"/>
<area shape="rect" href="namespacelinalg.html#a2e81c90534586128fa4bcae3bb042175" title="Singular Value Decomposition: A = U * Sigma * V^T." alt="" coords="456,2165,590,2192"/>
<area shape="poly" title=" " alt="" coords="717,1178,708,1386,687,1696,673,1852,656,1991,637,2096,625,2132,613,2155,592,2171,589,2167,609,2152,621,2130,631,2095,651,1990,668,1852,682,1695,702,1385,712,1178"/>
<area shape="rect" href="tensor_8h.html#a90d629271a42d730c36b7be1f66deae8" title="Extract last n elements from a 1D tensor." alt="" coords="504,2216,542,2243"/>
<area shape="poly" title=" " alt="" coords="717,1178,708,1395,689,1721,675,1886,658,2032,638,2144,626,2182,613,2206,598,2219,579,2227,543,2232,543,2227,578,2221,595,2214,609,2202,621,2180,632,2143,653,2032,670,1886,684,1721,703,1395,712,1178"/>
<area shape="rect" href="tensor_8h.html#a1cb2cae503ca515b1780c72fd05b21db" title="Extract top n rows from a 2D tensor." alt="" coords="486,2267,560,2293"/>
<area shape="poly" title=" " alt="" coords="718,1178,709,1405,690,1747,676,1921,659,2074,638,2191,627,2231,613,2256,589,2274,561,2281,560,2276,587,2269,609,2253,622,2229,633,2190,654,2073,671,1920,685,1747,704,1404,712,1178"/>
<area shape="rect" href="classMemoryPool.html#a980db306a49ce0f4b149198a99b6d24e" title="Clear all pooled memory." alt="" coords="230,351,360,377"/>
<area shape="poly" title=" " alt="" coords="481,387,361,374,361,369,482,382"/>
<area shape="rect" href="classMemoryPool.html#a842e63c49f94b807e42b8ed5897bd1bb" title="Destructor &#45; frees all pooled memory." alt="" coords="204,401,387,428"/>
<area shape="poly" title=" " alt="" coords="482,397,388,407,387,402,481,391"/>
<area shape="rect" href="tensor__c_8cpp.html#ae83aa792d547c4137efbfed451c7357c" title=" " alt="" coords="215,553,376,580"/>
<area shape="poly" title=" " alt="" coords="425,584,376,578,377,573,426,579"/>
<area shape="rect" href="tensor__c_8cpp.html#a255ee6f1fd55dc24865fd759cda653c9" title=" " alt="" coords="221,604,370,631"/>
<area shape="poly" title=" " alt="" coords="426,605,370,612,370,606,425,600"/>
<area shape="poly" title=" " alt="" coords="446,1139,346,1122,347,1117,447,1134"/>
<area shape="poly" title=" " alt="" coords="447,1164,342,1182,341,1177,446,1159"/>
<area shape="poly" title=" " alt="" coords="234,1189,125,1189,125,1184,234,1184"/>
<area shape="poly" title=" " alt="" coords="232,1075,205,1088,143,1132,97,1175,93,1171,139,1128,202,1083,230,1070"/>
<area shape="poly" title=" " alt="" coords="486,271,370,260,370,255,487,266"/>
<area shape="poly" title=" " alt="" coords="206,232,155,220,157,215,207,227"/>
<area shape="poly" title=" " alt="" coords="445,306,358,275,359,270,447,301"/>
</map>
</div>

</div>
</div>
<a id="ae5b52299c11f3ba81e781cb008542285" name="ae5b52299c11f3ba81e781cb008542285"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5b52299c11f3ba81e781cb008542285">&#9670;&#160;</a></span>detach()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::detach </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Detach this tensor from the computation graph. </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with the same data but no gradient tracking. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01032">1032</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1032</span>                                {</div>
<div class="line"><span class="lineno"> 1033</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1034</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1035</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1036</span>        <a class="code hl_class" href="classTensor.html">ensure_on_cpu</a>();  <span class="comment">// Critical: Sync from GPU before copying!</span></div>
<div class="line"><span class="lineno"> 1037</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1038</span>        <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_class" href="classTensor.html">total</a>, <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno"> 1039</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1040</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_ae5b52299c11f3ba81e781cb008542285_icgraph.png" border="0" usemap="#aclassTensor_ae5b52299c11f3ba81e781cb008542285_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_ae5b52299c11f3ba81e781cb008542285_icgraph" id="aclassTensor_ae5b52299c11f3ba81e781cb008542285_icgraph">
<area shape="rect" title=" " alt="" coords="219,265,326,292"/>
<area shape="rect" href="namespaceloss.html#a365059b00ea1e6ec1db86710cfcf3b31" title="Binary cross entropy loss for binary classification." alt="" coords="24,5,152,48"/>
<area shape="poly" title=" " alt="" coords="262,251,251,209,232,159,205,107,169,62,151,49,154,44,173,58,210,104,237,157,256,208,268,249"/>
<area shape="rect" href="namespaceloss.html#ab7fbd0200f34e3d12f66d20b681a948f" title="L1 loss (Mean Absolute Error)." alt="" coords="41,72,135,99"/>
<area shape="poly" title=" " alt="" coords="259,252,246,220,226,182,201,145,169,113,153,103,135,96,137,91,155,98,172,109,205,141,231,179,251,217,264,250"/>
<area shape="rect" href="classTensor.html#a834720ab65874a6c5503f7670c4f22fe" title=" " alt="" coords="23,123,153,165"/>
<area shape="poly" title=" " alt="" coords="249,255,214,217,169,180,149,168,152,164,172,175,218,213,253,252"/>
<area shape="rect" href="classTensor.html#a88d5a081d321cbd88ca46ed42ca1112c" title=" " alt="" coords="10,189,166,216"/>
<area shape="poly" title=" " alt="" coords="232,260,170,230,138,219,140,214,172,226,234,255"/>
<area shape="rect" href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7" title="Mean Squared Error (MSE) Loss." alt="" coords="33,240,143,267"/>
<area shape="poly" title=" " alt="" coords="203,272,143,263,143,258,204,267"/>
<area shape="rect" href="classTensor.html#af352346a629f774750b12c97234979a9" title=" " alt="" coords="5,291,171,317"/>
<area shape="poly" title=" " alt="" coords="204,291,172,295,171,290,203,285"/>
<area shape="rect" href="classTensor.html#a74db7588a7150d94b620ad63de1f5980" title=" " alt="" coords="21,341,155,368"/>
<area shape="poly" title=" " alt="" coords="234,302,172,332,140,343,138,338,170,327,232,297"/>
<area shape="rect" href="classTensor.html#afff455663faa35d6cfa72aa03f689e94" title=" " alt="" coords="9,392,167,419"/>
<area shape="poly" title=" " alt="" coords="254,306,218,345,172,382,148,394,145,389,169,378,215,341,250,302"/>
<area shape="rect" href="namespaceloss.html#a2d2c1dacdb37d834f7dc10e85cd1a742" title="Smooth L1 loss (Huber loss)." alt="" coords="16,443,160,469"/>
<area shape="poly" title=" " alt="" coords="262,307,228,370,203,404,172,433,152,444,149,440,169,429,199,400,224,367,258,305"/>
<area shape="rect" href="classTensor.html#a4ae322784a9d62e8db2c073f5e2395f7" title=" " alt="" coords="8,493,168,520"/>
<area shape="poly" title=" " alt="" coords="267,308,255,347,236,394,209,442,172,483,154,495,151,491,169,479,205,439,232,392,250,345,262,306"/>
</map>
</div>

</div>
</div>
<a id="af46e252ac24e0557b28c177bd9070596" name="af46e252ac24e0557b28c177bd9070596"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af46e252ac24e0557b28c177bd9070596">&#9670;&#160;</a></span>diag()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::diag </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract diagonal elements (only for 2D tensors). </p>
<dl class="section return"><dt>Returns</dt><dd>1D tensor containing diagonal elements </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05670">5670</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5670</span>                              {</div>
<div class="line"><span class="lineno"> 5671</span>        <a class="code hl_class" href="classTensor.html">return ::diag</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)));</div>
<div class="line"><span class="lineno"> 5672</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a03d314303958ffc5644796d8025cd012" name="a03d314303958ffc5644796d8025cd012"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03d314303958ffc5644796d8025cd012">&#9670;&#160;</a></span>dims()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::dims </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the dimensions of the tensor. </p><dl class="section return"><dt>Returns</dt><dd>An array containing the size of each dimension. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00854">854</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  854</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="adfb14d7fcd29dddd0d1a790719f57b6d" name="adfb14d7fcd29dddd0d1a790719f57b6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfb14d7fcd29dddd0d1a790719f57b6d">&#9670;&#160;</a></span>dot() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if&lt; M==1, <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt; &gt;::type <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::dot </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Dot product for 1D tensors (vector dot product). Computes the sum of element-wise products. Uses GPU acceleration if available and enabled. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The other 1D tensor to compute dot product with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing either the scalar result or an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03655">3655</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3655</span>                                         {</div>
<div class="line"><span class="lineno"> 3656</span>        <span class="keyword">static_assert</span>(<a class="code hl_class" href="classTensor.html">N</a> == 1, <span class="stringliteral">&quot;This dot product is only for 1D tensors&quot;</span>);</div>
<div class="line"><span class="lineno"> 3657</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0] != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0]) {</div>
<div class="line"><span class="lineno"> 3658</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3659</span>        }</div>
<div class="line"><span class="lineno"> 3660</span>        </div>
<div class="line"><span class="lineno"> 3661</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">result</a> = <a class="code hl_class" href="classTensor.html">T</a>();</div>
<div class="line"><span class="lineno"> 3662</span>        </div>
<div class="line"><span class="lineno"> 3663</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 3664</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 3665</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::dot_1d_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), &amp;<a class="code hl_class" href="classTensor.html">result</a>, <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0]);</div>
<div class="line"><span class="lineno"> 3666</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3667</span>        }</div>
<div class="line"><span class="lineno"> 3668</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3669</span>        </div>
<div class="line"><span class="lineno"> 3670</span><span class="preprocessor">#ifdef USE_BLAS</span></div>
<div class="line"><span class="lineno"> 3671</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 3672</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">blas_dot&lt;T&gt;</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0], <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), 1, <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), 1);</div>
<div class="line"><span class="lineno"> 3673</span>        }</div>
<div class="line"><span class="lineno"> 3674</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3675</span>        </div>
<div class="line"><span class="lineno"> 3676</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0]; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3677</span>            <a class="code hl_class" href="classTensor.html">result</a> += <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3678</span>        }</div>
<div class="line"><span class="lineno"> 3679</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3680</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f852881c836e20e6a16469980d7f9b0" name="a2f852881c836e20e6a16469980d7f9b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f852881c836e20e6a16469980d7f9b0">&#9670;&#160;</a></span>dot() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if&lt; M==2, <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; &gt; &gt;::type <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::dot </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Dot product for 2D tensors (matrix multiplication). Computes C = A  B where A is (m  n) and B is (n  p), resulting in C (m  p). Uses GPU acceleration if available, otherwise uses parallel CPU execution. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The other 2D tensor (matrix) to multiply with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing either a new tensor with the result or an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03691">3691</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3691</span>                                         {</div>
<div class="line"><span class="lineno"> 3692</span>        <span class="keyword">static_assert</span>(<a class="code hl_class" href="classTensor.html">N</a> == 2, <span class="stringliteral">&quot;This dot product is only for 2D tensors&quot;</span>);</div>
<div class="line"><span class="lineno"> 3693</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[1] != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0]) {</div>
<div class="line"><span class="lineno"> 3694</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3695</span>        }</div>
<div class="line"><span class="lineno"> 3696</span>        </div>
<div class="line"><span class="lineno"> 3697</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">m</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0];</div>
<div class="line"><span class="lineno"> 3698</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">n</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[1];</div>
<div class="line"><span class="lineno"> 3699</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">p</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[1];</div>
<div class="line"><span class="lineno"> 3700</span>        </div>
<div class="line"><span class="lineno"> 3701</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>({<a class="code hl_class" href="classTensor.html">m</a>, <a class="code hl_class" href="classTensor.html">p</a>}, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3702</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>());</div>
<div class="line"><span class="lineno"> 3703</span>        </div>
<div class="line"><span class="lineno"> 3704</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 3705</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 3706</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::dot_2d_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">m</a>, <a class="code hl_class" href="classTensor.html">n</a>, <a class="code hl_class" href="classTensor.html">p</a>);</div>
<div class="line"><span class="lineno"> 3707</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3708</span>        }</div>
<div class="line"><span class="lineno"> 3709</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3710</span>        </div>
<div class="line"><span class="lineno"> 3711</span><span class="preprocessor">#ifdef USE_BLAS</span></div>
<div class="line"><span class="lineno"> 3712</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 3713</span>            <span class="comment">// BLAS gemm: C = alpha * A * B + beta * C</span></div>
<div class="line"><span class="lineno"> 3714</span>            <span class="comment">// A is mn, B is np, C is mp</span></div>
<div class="line"><span class="lineno"> 3715</span>            <a class="code hl_class" href="classTensor.html">blas_gemm&lt;T&gt;</a>(<a class="code hl_class" href="classTensor.html">CblasRowMajor</a>, <a class="code hl_class" href="classTensor.html">CblasNoTrans</a>, <a class="code hl_class" href="classTensor.html">CblasNoTrans</a>,</div>
<div class="line"><span class="lineno"> 3716</span>                        <a class="code hl_class" href="classTensor.html">m</a>, <a class="code hl_class" href="classTensor.html">p</a>, <a class="code hl_class" href="classTensor.html">n</a>, <a class="code hl_class" href="classTensor.html">T</a>(1), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">n</a>,</div>
<div class="line"><span class="lineno"> 3717</span>                        <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">p</a>, <a class="code hl_class" href="classTensor.html">T</a>(0), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">p</a>);</div>
<div class="line"><span class="lineno"> 3718</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3719</span>        }</div>
<div class="line"><span class="lineno"> 3720</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3721</span>        </div>
<div class="line"><span class="lineno"> 3722</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">row_range</a> = <a class="code hl_class" href="classTensor.html">std::views::iota</a>(<span class="keywordtype">size_t</span>(0), <a class="code hl_class" href="classTensor.html">m</a>);</div>
<div class="line"><span class="lineno"> 3723</span>        <a class="code hl_class" href="classTensor.html">std::for_each</a>(<a class="code hl_class" href="classTensor.html">std::execution::par</a>, <a class="code hl_class" href="classTensor.html">row_range</a>.begin(), <a class="code hl_class" href="classTensor.html">row_range</a>.end(), </div>
<div class="line"><span class="lineno"> 3724</span>                      [&amp;](<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3725</span>            for (size_t j = 0; j &lt; p; ++j) {</div>
<div class="line"><span class="lineno"> 3726</span>                T sum = T();</div>
<div class="line"><span class="lineno"> 3727</span>                for (size_t k = 0; k &lt; n; ++k) {</div>
<div class="line"><span class="lineno"> 3728</span>                    sum += (*this)[{i, k}] * other[{k, j}];</div>
<div class="line"><span class="lineno"> 3729</span>                }</div>
<div class="line"><span class="lineno"> 3730</span>                result[{i, j}] = sum;</div>
<div class="line"><span class="lineno"> 3731</span>            }</div>
<div class="line"><span class="lineno"> 3732</span>        });</div>
<div class="line"><span class="lineno"> 3733</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3734</span>    }</div>
<div class="ttc" id="aclassTensor_html_a234f74cd16bd13561f7963ba29efb163"><div class="ttname"><a href="#a234f74cd16bd13561f7963ba29efb163">Tensor::fill</a></div><div class="ttdeci">void fill(const T &amp;value)</div><div class="ttdoc">Fill the tensor with a specified value.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00842">tensor.h:842</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae29eec9ab673b7d33a191f9e18b57f6b" name="ae29eec9ab673b7d33a191f9e18b57f6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae29eec9ab673b7d33a191f9e18b57f6b">&#9670;&#160;</a></span>dot() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, size_t P&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if&lt;(M &gt;=3), <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N+P-2 &gt; &gt; &gt;::type <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::dot </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, P &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Generalized dot product for N-D tensors (N &gt;= 3). Performs tensor contraction over the last axis of this tensor and the first axis of the other tensor. For tensors A with shape (..., k) and B with shape (k, ...), the result has shape (...A[:-1], ...B[1:]). Uses GPU acceleration if available, otherwise uses parallel CPU execution.</p>
<p>Example: A(2,3,4)  B(4,5,6) = C(2,3,5,6)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The other N-D tensor to contract with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing either a new tensor with the result or an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03751">3751</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3751</span>                                         {</div>
<div class="line"><span class="lineno"> 3752</span>        <span class="keyword">static_assert</span>(<a class="code hl_class" href="classTensor.html">N</a> &gt;= 3 || <a class="code hl_class" href="classTensor.html">P</a> &gt;= 1, <span class="stringliteral">&quot;This dot product is for higher dimensional tensors&quot;</span>);</div>
<div class="line"><span class="lineno"> 3753</span>        </div>
<div class="line"><span class="lineno"> 3754</span>        <span class="comment">// Check that the last dimension of this matches first dimension of other</span></div>
<div class="line"><span class="lineno"> 3755</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">N</a> - 1] != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0]) {</div>
<div class="line"><span class="lineno"> 3756</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::ContractionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3757</span>        }</div>
<div class="line"><span class="lineno"> 3758</span>        </div>
<div class="line"><span class="lineno"> 3759</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">contract_dim</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">N</a> - 1];</div>
<div class="line"><span class="lineno"> 3760</span>        </div>
<div class="line"><span class="lineno"> 3761</span>        <span class="comment">// Calculate output dimensions: all dims of this except last,</span></div>
<div class="line"><span class="lineno"> 3762</span>        <span class="comment">// plus all dims of other except first</span></div>
<div class="line"><span class="lineno"> 3763</span>        <a class="code hl_class" href="classTensor.html">TensorIndices</a>&lt;<a class="code hl_class" href="classTensor.html">N</a> + <a class="code hl_class" href="classTensor.html">P</a> - 2&gt; <a class="code hl_class" href="classTensor.html">result_dims</a>;</div>
<div class="line"><span class="lineno"> 3764</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a> - 1; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3765</span>            <a class="code hl_class" href="classTensor.html">result_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3766</span>        }</div>
<div class="line"><span class="lineno"> 3767</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">P</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3768</span>            <a class="code hl_class" href="classTensor.html">result_dims</a>[<a class="code hl_class" href="classTensor.html">N</a> - 1 + <a class="code hl_class" href="classTensor.html">i</a> - 1] = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3769</span>        }</div>
<div class="line"><span class="lineno"> 3770</span>        </div>
<div class="line"><span class="lineno"> 3771</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor</a>&lt;<a class="code hl_class" href="classTensor.html">T</a>, <a class="code hl_class" href="classTensor.html">N</a> + <a class="code hl_class" href="classTensor.html">P</a> - 2&gt; <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">result_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3772</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>());</div>
<div class="line"><span class="lineno"> 3773</span>        </div>
<div class="line"><span class="lineno"> 3774</span>        <span class="comment">// Calculate strides for output indexing</span></div>
<div class="line"><span class="lineno"> 3775</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer_size</a> = 1;  <span class="comment">// Product of all dims except last in this tensor</span></div>
<div class="line"><span class="lineno"> 3776</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a> - 1; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3777</span>            <a class="code hl_class" href="classTensor.html">outer_size</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3778</span>        }</div>
<div class="line"><span class="lineno"> 3779</span>        </div>
<div class="line"><span class="lineno"> 3780</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner_size</a> = 1;  <span class="comment">// Product of all dims except first in other tensor</span></div>
<div class="line"><span class="lineno"> 3781</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">P</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3782</span>            <a class="code hl_class" href="classTensor.html">inner_size</a> *= <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3783</span>        }</div>
<div class="line"><span class="lineno"> 3784</span>        </div>
<div class="line"><span class="lineno"> 3785</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 3786</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 3787</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::dot_nd_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(),</div>
<div class="line"><span class="lineno"> 3788</span>                                  <a class="code hl_class" href="classTensor.html">outer_size</a>, <a class="code hl_class" href="classTensor.html">contract_dim</a>, <a class="code hl_class" href="classTensor.html">inner_size</a>);</div>
<div class="line"><span class="lineno"> 3789</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3790</span>        }</div>
<div class="line"><span class="lineno"> 3791</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3792</span>        </div>
<div class="line"><span class="lineno"> 3793</span>        <span class="comment">// Perform contraction with parallel execution</span></div>
<div class="line"><span class="lineno"> 3794</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">outer_range</a> = <a class="code hl_class" href="classTensor.html">std::views::iota</a>(<span class="keywordtype">size_t</span>(0), <a class="code hl_class" href="classTensor.html">outer_size</a>);</div>
<div class="line"><span class="lineno"> 3795</span>        <a class="code hl_class" href="classTensor.html">std::for_each</a>(<a class="code hl_class" href="classTensor.html">std::execution::par</a>, <a class="code hl_class" href="classTensor.html">outer_range</a>.begin(), <a class="code hl_class" href="classTensor.html">outer_range</a>.end(), </div>
<div class="line"><span class="lineno"> 3796</span>            [&amp;](<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a>) {</div>
<div class="line"><span class="lineno"> 3797</span>                for (size_t inner = 0; inner &lt; inner_size; ++inner) {</div>
<div class="line"><span class="lineno"> 3798</span>                    T sum = T();</div>
<div class="line"><span class="lineno"> 3799</span>                    for (size_t k = 0; k &lt; contract_dim; ++k) {</div>
<div class="line"><span class="lineno"> 3800</span>                        <span class="comment">// Calculate flat indices for input tensors</span></div>
<div class="line"><span class="lineno"> 3801</span>                        size_t idx_this = outer * contract_dim + k;</div>
<div class="line"><span class="lineno"> 3802</span>                        size_t idx_other = k * inner_size + inner;</div>
<div class="line"><span class="lineno"> 3803</span>                        sum += data_[idx_this] * other.data_[idx_other];</div>
<div class="line"><span class="lineno"> 3804</span>                    }</div>
<div class="line"><span class="lineno"> 3805</span>                    <span class="comment">// Calculate flat index for output tensor</span></div>
<div class="line"><span class="lineno"> 3806</span>                    size_t idx_result = outer * inner_size + inner;</div>
<div class="line"><span class="lineno"> 3807</span>                    result.data_[idx_result] = sum;</div>
<div class="line"><span class="lineno"> 3808</span>                }</div>
<div class="line"><span class="lineno"> 3809</span>            });</div>
<div class="line"><span class="lineno"> 3810</span>        </div>
<div class="line"><span class="lineno"> 3811</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3812</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a452fb091d4b50605c931485385d29aac" name="a452fb091d4b50605c931485385d29aac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a452fb091d4b50605c931485385d29aac">&#9670;&#160;</a></span>eq()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::eq </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>epsilon</em></span><span class="paramdefsep"> = </span><span class="paramdefval">std::numeric_limits&lt;T&gt;::epsilon()</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise equality comparison. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to compare with. </td></tr>
    <tr><td class="paramname">epsilon</td><td>Tolerance for floating-point comparison. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03230">3230</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3230</span>                                                                                                {</div>
<div class="line"><span class="lineno"> 3231</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 3232</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3233</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 3234</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3235</span>        }</div>
<div class="line"><span class="lineno"> 3236</span>        </div>
<div class="line"><span class="lineno"> 3237</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3238</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3239</span>        </div>
<div class="line"><span class="lineno"> 3240</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3241</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_class" href="classTensor.html">std::abs</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] - <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]) &lt; <a class="code hl_class" href="classTensor.html">epsilon</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3242</span>        }</div>
<div class="line"><span class="lineno"> 3243</span>        </div>
<div class="line"><span class="lineno"> 3244</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3245</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afa7d4923af4f40166ac5dec4a893b74e" name="afa7d4923af4f40166ac5dec4a893b74e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa7d4923af4f40166ac5dec4a893b74e">&#9670;&#160;</a></span>erf()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::erf </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply error function (erf) to all elements (creates new tensor). The error function is used in probability and statistics. </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with erf(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02466">2466</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2466</span>                             {</div>
<div class="line"><span class="lineno"> 2467</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::erf</a>(<a class="code hl_class" href="classTensor.html">x</a>); });</div>
<div class="line"><span class="lineno"> 2468</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae94340cb4134b887428082dc683fe2b2" name="ae94340cb4134b887428082dc683fe2b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae94340cb4134b887428082dc683fe2b2">&#9670;&#160;</a></span>exp()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::exp </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply exponential function to all elements (creates new tensor). </p>
<p>Computes e^x for each element. Uses GPU acceleration when available. Supports automatic differentiation.</p>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with exp(x) applied to all elements</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_exp"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> matrix({2, 2});</div>
<div class="line">matrix.fill(1.0f);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> result = matrix.exp();  <span class="comment">// All elements  2.718</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// With autograd:</span></div>
<div class="line"><a class="code hl_class" href="classTensor.html">Tensor&lt;float, 1&gt;</a> x({3}, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line">x.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(0.0f);</div>
<div class="line"><span class="keyword">auto</span> y = x.exp().sum();  <span class="comment">// sum(exp(x))</span></div>
<div class="line">y.backward();</div>
<div class="line"><span class="comment">// x.grad() contains derivatives</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01986">1986</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1986</span>                             {</div>
<div class="line"><span class="lineno"> 1987</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1988</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1989</span>        </div>
<div class="line"><span class="lineno"> 1990</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1991</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1992</span>                <a class="code hl_class" href="classTensor.html">ensure_on_gpu</a>();</div>
<div class="line"><span class="lineno"> 1993</span>                <a class="code hl_class" href="classTensor.html">result</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 1994</span>                <a class="code hl_class" href="classTensor.html">TensorGPU::exp_gpu_direct</a>(<a class="code hl_class" href="classTensor.html">d_data_</a>, <a class="code hl_class" href="classTensor.html">result</a>.d_data_, <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1995</span>                <a class="code hl_class" href="classTensor.html">result</a>.mark_gpu_modified();</div>
<div class="line"><span class="lineno"> 1996</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1997</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1998</span>        {</div>
<div class="line"><span class="lineno"> 1999</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2000</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::exp</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 2001</span>            }</div>
<div class="line"><span class="lineno"> 2002</span>        }</div>
<div class="line"><span class="lineno"> 2003</span>        </div>
<div class="line"><span class="lineno"> 2004</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2005</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_ae94340cb4134b887428082dc683fe2b2_icgraph.png" border="0" usemap="#aclassTensor_ae94340cb4134b887428082dc683fe2b2_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_ae94340cb4134b887428082dc683fe2b2_icgraph" id="aclassTensor_ae94340cb4134b887428082dc683fe2b2_icgraph">
<area shape="rect" title="Apply exponential function to all elements (creates new tensor)." alt="" coords="188,13,277,40"/>
<area shape="rect" href="classTensor.html#aadc56fba91e522ff5de95202106be9db" title=" " alt="" coords="5,5,140,48"/>
<area shape="poly" title=" " alt="" coords="172,29,140,29,140,24,172,24"/>
</map>
</div>

</div>
</div>
<a id="aadc56fba91e522ff5de95202106be9db" name="aadc56fba91e522ff5de95202106be9db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadc56fba91e522ff5de95202106be9db">&#9670;&#160;</a></span>exp_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::exp_derivative </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of exponential function. d/dx[exp(x)] = exp(x) </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with exp derivative (same as exp). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02627">2627</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2627</span>                                        {</div>
<div class="line"><span class="lineno"> 2628</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#ae94340cb4134b887428082dc683fe2b2">exp</a>();</div>
<div class="line"><span class="lineno"> 2629</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab64cb0dcc82a371720c3bfc7f2265ece" name="ab64cb0dcc82a371720c3bfc7f2265ece"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab64cb0dcc82a371720c3bfc7f2265ece">&#9670;&#160;</a></span>expm1()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::expm1 </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply expm1 function to all elements (creates new tensor). Computes exp(x) - 1 in a numerically stable way for small x. </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with expm1(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02484">2484</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2484</span>                               {</div>
<div class="line"><span class="lineno"> 2485</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::expm1</a>(<a class="code hl_class" href="classTensor.html">x</a>); });</div>
<div class="line"><span class="lineno"> 2486</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a234f74cd16bd13561f7963ba29efb163" name="a234f74cd16bd13561f7963ba29efb163"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a234f74cd16bd13561f7963ba29efb163">&#9670;&#160;</a></span>fill()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::fill </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>value</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fill the tensor with a specified value. </p>
<p>Sets all elements in the tensor to the same value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>The value to fill the tensor with</td></tr>
  </table>
  </dd>
</dl>
<h1 class="doxsection"><a class="anchor" id="example_fill"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> matrix({3, 3});</div>
<div class="line">matrix.fill(5.0f);  <span class="comment">// All elements are now 5.0</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00842">842</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  842</span>                              {</div>
<div class="line"><span class="lineno">  843</span>        <a class="code hl_class" href="classTensor.html">std::fill</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>(), <a class="code hl_class" href="classTensor.html">value</a>);</div>
<div class="line"><span class="lineno">  844</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  845</span>        <a class="code hl_class" href="classTensor.html">data_on_gpu_</a> = <span class="keyword">false</span>;  <span class="comment">// CPU data is now authoritative</span></div>
<div class="line"><span class="lineno">  846</span>        <a class="code hl_class" href="classTensor.html">gpu_needs_sync_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  847</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  848</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a234f74cd16bd13561f7963ba29efb163_icgraph.png" border="0" usemap="#aclassTensor_a234f74cd16bd13561f7963ba29efb163_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a234f74cd16bd13561f7963ba29efb163_icgraph" id="aclassTensor_a234f74cd16bd13561f7963ba29efb163_icgraph">
<area shape="rect" title="Fill the tensor with a specified value." alt="" coords="656,563,738,589"/>
<area shape="rect" href="namespacelinalg.html#a1df90002eef905350589edef7a4ace1b" title=" " alt="" coords="476,5,560,32"/>
<area shape="poly" title=" " alt="" coords="692,547,687,437,673,287,662,211,647,141,629,84,606,46,585,31,560,23,561,18,587,26,610,42,634,82,652,140,667,210,678,286,692,437,698,547"/>
<area shape="rect" href="tensor_8h.html#ae66ddfcd20907014f524982e01698d82" title="Create a diagonal matrix from a 1D tensor." alt="" coords="474,56,562,83"/>
<area shape="poly" title=" " alt="" coords="692,547,685,447,670,311,658,243,644,181,627,131,606,96,586,82,562,75,563,70,588,77,610,93,632,128,649,180,664,242,675,311,690,446,697,547"/>
<area shape="rect" href="classTensor.html#a452fb091d4b50605c931485385d29aac" title=" " alt="" coords="454,107,582,133"/>
<area shape="poly" title=" " alt="" coords="691,548,683,457,666,337,641,222,625,177,606,147,581,131,584,126,610,143,630,175,646,220,672,336,688,456,696,547"/>
<area shape="rect" href="tensor_8h.html#a8a0e6e335b72a473208ce2c8f17b4a6e" title="Create an identity matrix (NumPy eye&#45;compatible)." alt="" coords="497,157,539,184"/>
<area shape="poly" title=" " alt="" coords="690,547,680,466,663,361,638,262,623,224,606,198,592,187,574,179,539,173,540,168,576,174,594,182,610,194,628,221,643,260,668,360,686,465,695,547"/>
<area shape="rect" href="namespacelinalg.html#a6ee776536e47c3e57b3b24ed6225bff2" title=" " alt="" coords="467,208,569,235"/>
<area shape="poly" title=" " alt="" coords="694,547,692,485,681,405,670,363,655,321,634,283,607,249,589,236,569,229,571,224,592,232,610,245,638,280,660,319,675,361,687,404,698,485,700,547"/>
<area shape="rect" href="tensor__c_8cpp.html#a47d70db99aa0a5e3874682316e4e173e" title=" " alt="" coords="450,259,587,285"/>
<area shape="poly" title=" " alt="" coords="693,547,688,494,675,427,664,393,649,359,630,327,607,299,586,286,589,281,610,295,634,324,654,356,669,391,680,426,693,493,698,547"/>
<area shape="rect" href="tensor__c_8cpp.html#a83628a7a4557aa438413f22c5b0cf244" title=" " alt="" coords="448,309,589,336"/>
<area shape="poly" title=" " alt="" coords="690,548,683,504,668,451,643,396,626,372,607,350,588,338,591,333,610,346,631,368,648,394,673,449,688,503,696,547"/>
<area shape="rect" href="tensor__c_8cpp.html#a1a72f081df9afd553ef6af18324322b6" title=" " alt="" coords="456,360,580,387"/>
<area shape="poly" title=" " alt="" coords="687,548,676,514,660,474,637,434,607,401,579,386,582,381,610,397,641,431,665,472,681,512,692,547"/>
<area shape="rect" href="tensor__c_8cpp.html#a6b1e7f8c3cd8c831827661bdf87c9bfa" title=" " alt="" coords="454,411,582,437"/>
<area shape="poly" title=" " alt="" coords="681,550,652,499,631,473,607,452,581,438,584,434,610,447,635,470,656,496,686,547"/>
<area shape="rect" href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7" title="Mean Squared Error (MSE) Loss." alt="" coords="464,461,573,488"/>
<area shape="poly" title=" " alt="" coords="671,553,642,527,607,502,572,488,574,483,610,498,646,522,675,550"/>
<area shape="rect" href="classTensor.html#aab0bca33fa0dbe68308c0a828cec9f44" title=" " alt="" coords="454,512,582,539"/>
<area shape="poly" title=" " alt="" coords="640,563,608,553,568,542,569,537,609,548,642,558"/>
<area shape="rect" href="tensor_8h.html#a37ee39b629ca93dc83259b6c8591d0d9" title="Create a tensor filled with ones (NumPy&#45;compatible)." alt="" coords="494,563,543,589"/>
<area shape="poly" title=" " alt="" coords="641,579,543,579,543,573,641,573"/>
<area shape="rect" href="classTensor.html#a26deab87b696076f055af17f4386b4d0" title=" " alt="" coords="434,613,602,640"/>
<area shape="poly" title=" " alt="" coords="642,594,609,604,569,615,568,610,608,599,640,589"/>
<area shape="rect" href="classTensor.html#a2cab1fc8ca70e8d2fa4bce5ff88fabe1" title=" " alt="" coords="430,664,606,691"/>
<area shape="poly" title=" " alt="" coords="675,602,646,630,610,654,583,666,581,661,607,650,642,625,671,599"/>
<area shape="rect" href="namespacetensor4d_1_1nn.html#af4ed0870610368776140c66a749f99ab" title="Compute the Jacobian matrix of softmax for a single row." alt="" coords="444,715,592,757"/>
<area shape="poly" title=" " alt="" coords="685,605,655,655,634,682,610,705,591,716,589,712,607,701,630,678,651,652,681,602"/>
<area shape="rect" href="classTensor.html#a06eeff8ce7f54262b935b324bcb6833e" title=" " alt="" coords="428,781,608,808"/>
<area shape="poly" title=" " alt="" coords="693,605,684,642,668,687,644,733,610,771,592,783,589,779,607,767,639,729,663,685,679,641,688,604"/>
<area shape="rect" href="classTensor.html#ac20a4679e14de6f68e148b447496adfc" title=" " alt="" coords="434,832,603,859"/>
<area shape="poly" title=" " alt="" coords="696,605,690,652,675,711,650,770,632,798,610,822,593,834,590,829,607,818,628,794,645,768,670,709,684,651,691,605"/>
<area shape="rect" href="classTensor.html#ac15f7a77f31ef7862dd9909c9ad97160" title=" " alt="" coords="434,883,603,909"/>
<area shape="poly" title=" " alt="" coords="698,605,695,661,682,733,671,770,656,807,636,842,610,873,594,884,591,880,607,869,631,839,651,805,666,769,677,731,689,660,693,605"/>
<area shape="rect" href="tensor__c_8cpp.html#a6c7566970a435f965c674f01e5bdba09" title=" " alt="" coords="450,933,587,960"/>
<area shape="poly" title=" " alt="" coords="695,605,684,680,666,774,641,864,627,899,610,923,589,938,586,933,606,919,622,896,636,862,661,773,679,679,689,604"/>
<area shape="rect" href="tensor__c_8cpp.html#a87b984c2cf077d9da06fe364caddd4da" title=" " alt="" coords="448,984,589,1011"/>
<area shape="poly" title=" " alt="" coords="696,605,686,690,669,800,644,904,629,945,610,974,591,988,588,983,606,970,624,943,639,903,664,799,681,689,690,605"/>
<area shape="rect" href="tensor__c_8cpp.html#ad2106718d1bf483b3daeefd07f1961f2" title=" " alt="" coords="456,1035,580,1061"/>
<area shape="poly" title=" " alt="" coords="697,605,689,699,673,824,661,887,647,944,630,992,610,1024,597,1035,582,1042,580,1038,594,1031,606,1021,626,989,642,943,656,886,668,823,683,698,691,604"/>
<area shape="rect" href="tensor__c_8cpp.html#a7a2d55aad07eba8741646b6c305c4352" title=" " alt="" coords="454,1085,582,1112"/>
<area shape="poly" title=" " alt="" coords="697,605,691,708,676,849,665,920,650,985,632,1038,610,1075,584,1092,581,1088,606,1071,628,1036,645,983,660,919,671,848,685,708,692,605"/>
<area shape="rect" href="tensor_8h.html#a249e6ed21f6e3540a11b62433237175a" title="Create a tensor filled with zeros (NumPy&#45;compatible)." alt="" coords="492,1136,545,1163"/>
<area shape="poly" title=" " alt="" coords="698,605,693,718,679,874,668,953,653,1025,634,1084,610,1126,596,1137,579,1145,546,1152,545,1146,578,1140,593,1133,606,1122,629,1082,648,1024,663,952,674,873,687,718,692,605"/>
<area shape="rect" href="namespacelinalg.html#a6b7af062b5a9642d788fcc084335b39c" title=" " alt="" coords="222,157,362,184"/>
<area shape="poly" title=" " alt="" coords="451,209,354,187,355,182,452,204"/>
<area shape="rect" href="namespacelinalg.html#a8405b084d692b1fc7f685f40425a0970" title="Solve least squares problem: minimize ||Ax &#45; b||" alt="" coords="248,208,336,235"/>
<area shape="poly" title=" " alt="" coords="452,224,336,224,336,219,452,219"/>
<area shape="rect" href="namespacelinalg.html#a6ff4392ae10b75895ce02443bf3c77d6" title="Compute Moore&#45;Penrose pseudo&#45;inverse using SVD." alt="" coords="250,259,334,285"/>
<area shape="poly" title=" " alt="" coords="453,239,334,265,333,260,451,233"/>
<area shape="rect" href="tensor__c_8cpp.html#ac4676f00843bcb11305f402265e7b747" title=" " alt="" coords="12,157,149,184"/>
<area shape="poly" title=" " alt="" coords="232,210,139,187,140,182,234,205"/>
<area shape="rect" href="tensor__c_8cpp.html#ab0ed3244c40a7734ca7af5affd241c6d" title=" " alt="" coords="18,208,143,235"/>
<area shape="poly" title=" " alt="" coords="233,224,143,224,143,219,233,219"/>
<area shape="rect" href="tensor__c_8cpp.html#ad0eab2342bda5d725085476abc7c50b6" title=" " alt="" coords="14,259,147,285"/>
<area shape="poly" title=" " alt="" coords="235,275,148,275,148,269,235,269"/>
<area shape="rect" href="tensor__c_8cpp.html#acf74b6d7b42a82859c1fbec640125775" title=" " alt="" coords="20,309,141,336"/>
<area shape="poly" title=" " alt="" coords="236,288,140,311,139,306,234,283"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Sigmoid.html#a41e695161d280883a0002fe199efdf98" title=" " alt="" coords="218,488,366,531"/>
<area shape="poly" title=" " alt="" coords="478,568,427,553,363,534,365,529,429,548,479,563"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Tanh.html#a8211c640d2b962ecad7a5c29203e663c" title=" " alt="" coords="225,555,359,597"/>
<area shape="poly" title=" " alt="" coords="478,579,360,579,360,573,478,573"/>
<area shape="rect" href="classTensor.html#afff455663faa35d6cfa72aa03f689e94" title=" " alt="" coords="213,621,371,648"/>
<area shape="poly" title=" " alt="" coords="479,589,347,623,346,618,477,584"/>
<area shape="rect" href="namespacetensor4d_1_1nn.html#ab2f304e755860ad8c80d7c67cfe953b2" title="Compute softmax Jacobian for batched input (batch_size x num_classes)." alt="" coords="218,715,366,757"/>
<area shape="poly" title=" " alt="" coords="429,739,367,739,367,733,429,733"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Softmax.html#abda8fce936f0e7f02d1779a120db27de" title=" " alt="" coords="5,715,156,757"/>
<area shape="poly" title=" " alt="" coords="202,739,156,739,156,733,202,733"/>
<area shape="rect" href="classTensor.html#adf1fcb0ddd0ef2db3003401db519ec1c" title=" " alt="" coords="204,807,380,833"/>
<area shape="poly" title=" " alt="" coords="418,837,380,833,381,827,418,831"/>
<area shape="rect" href="classTensor.html#aeb3f6a9bf8ee28d46a887238a9d3d460" title=" " alt="" coords="204,857,380,884"/>
<area shape="poly" title=" " alt="" coords="418,859,381,863,380,858,418,854"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1ReLU.html#ac991c01d3b1607d533183075fb02f354" title=" " alt="" coords="224,1099,360,1141"/>
<area shape="poly" title=" " alt="" coords="476,1147,360,1131,360,1126,476,1141"/>
<area shape="rect" href="classTensor.html#a74db7588a7150d94b620ad63de1f5980" title=" " alt="" coords="225,1165,359,1192"/>
<area shape="poly" title=" " alt="" coords="476,1157,360,1173,359,1167,476,1152"/>
</map>
</div>

</div>
</div>
<a id="a858dee8116e109f0a56d072d3774d9dd" name="a858dee8116e109f0a56d072d3774d9dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a858dee8116e109f0a56d072d3774d9dd">&#9670;&#160;</a></span>fill_rows()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::fill_rows </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; T &gt; &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>start_row</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fill rows from vector of vectors (2D tensors only). </p>
<p>Efficiently copies multiple rows from std::vector&lt;std::vector&lt;T&gt;&gt;. Useful for batch data preparation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b" title="Type alias for 1D vectors.">Vector</a> of row vectors to copy </td></tr>
    <tr><td class="paramname">start_row</td><td>Starting row index in tensor (default: 0)</td></tr>
  </table>
  </dd>
</dl>
<h1 class="doxsection"><a class="anchor" id="example_fill_rows"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> batch({batch_size, num_features});</div>
<div class="line">std::vector&lt;std::vector&lt;float&gt;&gt; images = load_images();</div>
<div class="line">batch.fill_rows(images, 0);  <span class="comment">// Fill from row 0</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05956">5956</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5956</span>                                                                              {</div>
<div class="line"><span class="lineno"> 5957</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">num_cols</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[1];</div>
<div class="line"><span class="lineno"> 5958</span>        <a class="code hl_class" href="classTensor.html">T</a>* <a class="code hl_class" href="classTensor.html">tensor_ptr</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get();</div>
<div class="line"><span class="lineno"> 5959</span>        </div>
<div class="line"><span class="lineno"> 5960</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>.size() &amp;&amp; (<a class="code hl_class" href="classTensor.html">start_row</a> + <a class="code hl_class" href="classTensor.html">i</a>) &lt; <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0]; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5961</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[<a class="code hl_class" href="classTensor.html">i</a>].<a class="code hl_class" href="classTensor.html">size</a>() != <a class="code hl_class" href="classTensor.html">num_cols</a>) {</div>
<div class="line"><span class="lineno"> 5962</span>                <span class="keywordflow">continue</span>;  <span class="comment">// Skip rows with incorrect size</span></div>
<div class="line"><span class="lineno"> 5963</span>            }</div>
<div class="line"><span class="lineno"> 5964</span>            </div>
<div class="line"><span class="lineno"> 5965</span>            <a class="code hl_class" href="classTensor.html">T</a>* <a class="code hl_class" href="classTensor.html">row_ptr</a> = <a class="code hl_class" href="classTensor.html">tensor_ptr</a> + (<a class="code hl_class" href="classTensor.html">start_row</a> + <a class="code hl_class" href="classTensor.html">i</a>) * <a class="code hl_class" href="classTensor.html">num_cols</a>;</div>
<div class="line"><span class="lineno"> 5966</span>            <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[<a class="code hl_class" href="classTensor.html">i</a>].<a class="code hl_class" href="classTensor.html">begin</a>(), <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[<a class="code hl_class" href="classTensor.html">i</a>].<a class="code hl_class" href="classTensor.html">end</a>(), <a class="code hl_class" href="classTensor.html">row_ptr</a>);</div>
<div class="line"><span class="lineno"> 5967</span>        }</div>
<div class="line"><span class="lineno"> 5968</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a354f1c9709ae8089a859608564fc4f" name="a5a354f1c9709ae8089a859608564fc4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a354f1c9709ae8089a859608564fc4f">&#9670;&#160;</a></span>flatten()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::flatten </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Flatten tensor to 1D. </p><dl class="section return"><dt>Returns</dt><dd>A 1D tensor containing all elements in row-major order</dd></dl>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> A({3, 4});</div>
<div class="line"><span class="keyword">auto</span> B = A.flatten();  <span class="comment">// Tensor&lt;float, 1&gt; with 12 elements</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05563">5563</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5563</span>                                 {</div>
<div class="line"><span class="lineno"> 5564</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 5565</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 1&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>({<a class="code hl_class" href="classTensor.html">total</a>}, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 5566</span>        <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_class" href="classTensor.html">total</a>, <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno"> 5567</span>        </div>
<div class="line"><span class="lineno"> 5568</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 5569</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6047a6a731e93d59e92073e997969cc7" name="a6047a6a731e93d59e92073e997969cc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6047a6a731e93d59e92073e997969cc7">&#9670;&#160;</a></span>floor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::floor </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply floor function to all elements (creates new tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with floor(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02425">2425</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2425</span>                               {</div>
<div class="line"><span class="lineno"> 2426</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::floor</a>(<a class="code hl_class" href="classTensor.html">x</a>); });</div>
<div class="line"><span class="lineno"> 2427</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a545dc641f3e77533b2ba7478eb869a3a" name="a545dc641f3e77533b2ba7478eb869a3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a545dc641f3e77533b2ba7478eb869a3a">&#9670;&#160;</a></span>fused_scalar_mul_sub()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::fused_scalar_mul_sub </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fused operation: this -= scalar * other. </p>
<p>Optimized for <a class="el" href="classSGD.html" title="SGD (Stochastic Gradient Descent) optimizer with optional momentum.">SGD</a> weight updates: weights -= learning_rate * gradients Avoids temporary tensor allocation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>Scaling factor </td></tr>
    <tr><td class="paramname">other</td><td><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> to scale and subtract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor for chaining</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_fused_scalar_mul_sub"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> weights({output_size, input_size});</div>
<div class="line"><a class="code hl_class" href="classTensor.html">Tensor&lt;float, 2&gt;</a> gradients({output_size, input_size});</div>
<div class="line">weights.<a class="code hl_function" href="#a545dc641f3e77533b2ba7478eb869a3a">fused_scalar_mul_sub</a>(0.01f, gradients);  <span class="comment">// weights -= 0.01 * gradients</span></div>
<div class="ttc" id="aclassTensor_html_a545dc641f3e77533b2ba7478eb869a3a"><div class="ttname"><a href="#a545dc641f3e77533b2ba7478eb869a3a">Tensor::fused_scalar_mul_sub</a></div><div class="ttdeci">Tensor&lt; T, N &gt; &amp; fused_scalar_mul_sub(T scalar, const Tensor&lt; T, N &gt; &amp;other)</div><div class="ttdoc">Fused operation: this -= scalar * other.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l05913">tensor.h:5913</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05913">5913</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5913</span>                                                                            {</div>
<div class="line"><span class="lineno"> 5914</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 5915</span>            <span class="keywordflow">return</span> *<span class="keyword">this</span>;  <span class="comment">// Dimensions must match</span></div>
<div class="line"><span class="lineno"> 5916</span>        }</div>
<div class="line"><span class="lineno"> 5917</span>        </div>
<div class="line"><span class="lineno"> 5918</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 5919</span>        <a class="code hl_class" href="classTensor.html">T</a>* <a class="code hl_class" href="classTensor.html">this_ptr</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get();</div>
<div class="line"><span class="lineno"> 5920</span>        <span class="keyword">const</span> <a class="code hl_class" href="classTensor.html">T</a>* <a class="code hl_class" href="classTensor.html">other_ptr</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get();</div>
<div class="line"><span class="lineno"> 5921</span>        </div>
<div class="line"><span class="lineno"> 5922</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 5923</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 5924</span>            <span class="comment">// Could add GPU kernel for this operation</span></div>
<div class="line"><span class="lineno"> 5925</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5926</span>                <a class="code hl_class" href="classTensor.html">this_ptr</a>[<a class="code hl_class" href="classTensor.html">i</a>] -= <a class="code hl_class" href="classTensor.html">scalar</a> * <a class="code hl_class" href="classTensor.html">other_ptr</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5927</span>            }</div>
<div class="line"><span class="lineno"> 5928</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5929</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 5930</span>        {</div>
<div class="line"><span class="lineno"> 5931</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5932</span>                <a class="code hl_class" href="classTensor.html">this_ptr</a>[<a class="code hl_class" href="classTensor.html">i</a>] -= <a class="code hl_class" href="classTensor.html">scalar</a> * <a class="code hl_class" href="classTensor.html">other_ptr</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5933</span>            }</div>
<div class="line"><span class="lineno"> 5934</span>        }</div>
<div class="line"><span class="lineno"> 5935</span>        </div>
<div class="line"><span class="lineno"> 5936</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 5937</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c0ac5752345f4abb81ebe4fa78411fd" name="a8c0ac5752345f4abb81ebe4fa78411fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c0ac5752345f4abb81ebe4fa78411fd">&#9670;&#160;</a></span>grad() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; * <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::grad </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the gradient tensor. </p><dl class="section return"><dt>Returns</dt><dd>Pointer to gradient tensor (nullptr if not tracking gradients). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00950">950</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  950</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>.get(); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae20c5c5722bd41013f11b326f9e50b2f" name="ae20c5c5722bd41013f11b326f9e50b2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae20c5c5722bd41013f11b326f9e50b2f">&#9670;&#160;</a></span>grad() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; * <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::grad </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00951">951</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  951</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>.get(); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a89cf45ee5d7ddfdf69a387c2345039c7" name="a89cf45ee5d7ddfdf69a387c2345039c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89cf45ee5d7ddfdf69a387c2345039c7">&#9670;&#160;</a></span>head()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 1&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::head </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract first n elements (only for 1D tensors). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of elements to extract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1D tensor containing first n elements </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05694">5694</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5694</span>                                      {</div>
<div class="line"><span class="lineno"> 5695</span>        <a class="code hl_class" href="classTensor.html">return ::head</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 1&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)), <a class="code hl_class" href="classTensor.html">n</a>);</div>
<div class="line"><span class="lineno"> 5696</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aed3511f1720813839550315f701cb516" name="aed3511f1720813839550315f701cb516"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed3511f1720813839550315f701cb516">&#9670;&#160;</a></span>hstack()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::hstack </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensors</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Horizontal stack (stack along second dimension) - convenience method for 2D tensors. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tensors</td><td><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b" title="Type alias for 1D vectors.">Vector</a> of tensors to stack horizontally. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor stacked horizontally. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03533">3533</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3533</span>                                                                       {</div>
<div class="line"><span class="lineno"> 3534</span>        <span class="keyword">static_assert</span>(<a class="code hl_class" href="classTensor.html">N</a> &gt;= 2, <span class="stringliteral">&quot;hstack requires at least 2D tensors&quot;</span>);</div>
<div class="line"><span class="lineno"> 3535</span>        </div>
<div class="line"><span class="lineno"> 3536</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">tensors</a>.empty()) {</div>
<div class="line"><span class="lineno"> 3537</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 3538</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3539</span>        }</div>
<div class="line"><span class="lineno"> 3540</span>        </div>
<div class="line"><span class="lineno"> 3541</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">tensors</a>.size() == 1) {</div>
<div class="line"><span class="lineno"> 3542</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">tensors</a>[0]);</div>
<div class="line"><span class="lineno"> 3543</span>        }</div>
<div class="line"><span class="lineno"> 3544</span>        </div>
<div class="line"><span class="lineno"> 3545</span>        <span class="comment">// Start with first tensor and concatenate the rest</span></div>
<div class="line"><span class="lineno"> 3546</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">tensors</a>[0]);</div>
<div class="line"><span class="lineno"> 3547</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">tensors</a>.size(); ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3548</span>            <a class="code hl_class" href="classTensor.html">result</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a7a0af0b59b00d2f2623609ff3562f087">concatenate</a>(<a class="code hl_class" href="classTensor.html">tensors</a>[<a class="code hl_class" href="classTensor.html">i</a>], 1);</div>
<div class="line"><span class="lineno"> 3549</span>        }</div>
<div class="line"><span class="lineno"> 3550</span>        </div>
<div class="line"><span class="lineno"> 3551</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3552</span>    }</div>
<div class="ttc" id="aclassTensor_html_a7a0af0b59b00d2f2623609ff3562f087"><div class="ttname"><a href="#a7a0af0b59b00d2f2623609ff3562f087">Tensor::concatenate</a></div><div class="ttdeci">Tensor&lt; T, N &gt; concatenate(const Tensor&lt; T, N &gt; &amp;other, size_t axis) const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l04847">tensor.h:4847</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3090598433576f68f34f340cd6a18089" name="a3090598433576f68f34f340cd6a18089"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3090598433576f68f34f340cd6a18089">&#9670;&#160;</a></span>index_select()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::index_select </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mask</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Boolean indexing: extract elements where mask is true (non-zero). This is similar to masked_select but emphasized for indexing operations. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mask</td><td>Boolean-like tensor (0 or non-zero values). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A 1D tensor containing selected values. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05013">5013</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5013</span>                                                              {</div>
<div class="line"><span class="lineno"> 5014</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a4773678cdfb3526a2bdb1079ef68b87e">masked_select</a>(<a class="code hl_class" href="classTensor.html">mask</a>);</div>
<div class="line"><span class="lineno"> 5015</span>    }</div>
<div class="ttc" id="aclassTensor_html_a4773678cdfb3526a2bdb1079ef68b87e"><div class="ttname"><a href="#a4773678cdfb3526a2bdb1079ef68b87e">Tensor::masked_select</a></div><div class="ttdeci">Tensor&lt; T, 1 &gt; masked_select(const Tensor&lt; M, N &gt; &amp;mask) const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l03347">tensor.h:3347</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aae15047e75bb7e0734b82eceea1cd009" name="aae15047e75bb7e0734b82eceea1cd009"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae15047e75bb7e0734b82eceea1cd009">&#9670;&#160;</a></span>is_leaf()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::is_leaf </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if this is a leaf tensor. </p><dl class="section return"><dt>Returns</dt><dd>True if this is a leaf tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00944">944</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  944</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5aac0c5222fc09da3327d08ee2c3a2ed" name="a5aac0c5222fc09da3327d08ee2c3a2ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5aac0c5222fc09da3327d08ee2c3a2ed">&#9670;&#160;</a></span>isfinite()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::isfinite </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if elements are finite (creates boolean-like tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with 1 where finite, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02508">2508</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2508</span>                                  {</div>
<div class="line"><span class="lineno"> 2509</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::isfinite</a>(<a class="code hl_class" href="classTensor.html">x</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0); });</div>
<div class="line"><span class="lineno"> 2510</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac56c689ad6c5077e9cb9792a552a8d38" name="ac56c689ad6c5077e9cb9792a552a8d38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac56c689ad6c5077e9cb9792a552a8d38">&#9670;&#160;</a></span>isinf()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::isinf </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if elements are infinite (creates boolean-like tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with 1 where infinite, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02500">2500</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2500</span>                               {</div>
<div class="line"><span class="lineno"> 2501</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::isinf</a>(<a class="code hl_class" href="classTensor.html">x</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0); });</div>
<div class="line"><span class="lineno"> 2502</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a703855e2cfaff43769ef254a3dbce50c" name="a703855e2cfaff43769ef254a3dbce50c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a703855e2cfaff43769ef254a3dbce50c">&#9670;&#160;</a></span>isnan()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::isnan </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if elements are NaN (creates boolean-like tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with 1 where NaN, 0 otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02492">2492</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2492</span>                               {</div>
<div class="line"><span class="lineno"> 2493</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::isnan</a>(<a class="code hl_class" href="classTensor.html">x</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0); });</div>
<div class="line"><span class="lineno"> 2494</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa33851e29d0df735e3fab0002a119602" name="aa33851e29d0df735e3fab0002a119602"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa33851e29d0df735e3fab0002a119602">&#9670;&#160;</a></span>leaky_relu_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::leaky_relu_derivative </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>alpha</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(0.01)</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of Leaky ReLU function. d/dx[LeakyReLU(x)] = 1 if x &gt; 0, else alpha </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alpha</td><td>The slope for negative values (default 0.01). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with Leaky ReLU derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02618">2618</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2618</span>                                                                {</div>
<div class="line"><span class="lineno"> 2619</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([<a class="code hl_class" href="classTensor.html">alpha</a>](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">x</a> &gt; <a class="code hl_class" href="classTensor.html">T</a>(0) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">alpha</a>; });</div>
<div class="line"><span class="lineno"> 2620</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aff781405a45c8ec01fde149ecba560b6" name="aff781405a45c8ec01fde149ecba560b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff781405a45c8ec01fde149ecba560b6">&#9670;&#160;</a></span>leftCols()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::leftCols </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract leftmost n columns (only for 2D tensors). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of columns to extract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>2D tensor containing leftmost n columns </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05734">5734</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5734</span>                                          {</div>
<div class="line"><span class="lineno"> 5735</span>        <a class="code hl_class" href="classTensor.html">return ::leftCols</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)), <a class="code hl_class" href="classTensor.html">n</a>);</div>
<div class="line"><span class="lineno"> 5736</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4ca468e14a70671e0258c613612bc506" name="a4ca468e14a70671e0258c613612bc506"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ca468e14a70671e0258c613612bc506">&#9670;&#160;</a></span>log()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::log </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply natural logarithm to all elements (creates new tensor). </p>
<p>Computes ln(x) for each element. Uses GPU acceleration when available.</p>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with log(x) applied to all elements </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Elements must be positive (log of non-positive values is undefined)</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_log"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> vec({4});</div>
<div class="line">vec.fill(2.718f);  <span class="comment">// e</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> result = vec.log();  <span class="comment">// All elements  1.0</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Useful for log-space computations</span></div>
<div class="line"><span class="keyword">auto</span> log_probs = probs.log();</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02026">2026</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2026</span>                             {</div>
<div class="line"><span class="lineno"> 2027</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2028</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2029</span>        </div>
<div class="line"><span class="lineno"> 2030</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 2031</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 2032</span>                <a class="code hl_class" href="classTensor.html">ensure_on_gpu</a>();</div>
<div class="line"><span class="lineno"> 2033</span>                <a class="code hl_class" href="classTensor.html">result</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 2034</span>                <a class="code hl_class" href="classTensor.html">TensorGPU::log_gpu_direct</a>(<a class="code hl_class" href="classTensor.html">d_data_</a>, <a class="code hl_class" href="classTensor.html">result</a>.d_data_, <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2035</span>                <a class="code hl_class" href="classTensor.html">result</a>.mark_gpu_modified();</div>
<div class="line"><span class="lineno"> 2036</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2037</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2038</span>        {</div>
<div class="line"><span class="lineno"> 2039</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2040</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::log</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 2041</span>            }</div>
<div class="line"><span class="lineno"> 2042</span>        }</div>
<div class="line"><span class="lineno"> 2043</span>        </div>
<div class="line"><span class="lineno"> 2044</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2045</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7375a160ffb9b310d78c1f7f5a44c956" name="a7375a160ffb9b310d78c1f7f5a44c956"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7375a160ffb9b310d78c1f7f5a44c956">&#9670;&#160;</a></span>log1p()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::log1p </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply log1p function to all elements (creates new tensor). Computes log(1 + x) in a numerically stable way for small x. </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with log1p(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02475">2475</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2475</span>                               {</div>
<div class="line"><span class="lineno"> 2476</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::log1p</a>(<a class="code hl_class" href="classTensor.html">x</a>); });</div>
<div class="line"><span class="lineno"> 2477</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1c578c4b3e0f4a8d2fc16b67e84815b5" name="a1c578c4b3e0f4a8d2fc16b67e84815b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c578c4b3e0f4a8d2fc16b67e84815b5">&#9670;&#160;</a></span>log_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::log_derivative </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of natural logarithm. d/dx[log(x)] = 1/x </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with log derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02636">2636</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2636</span>                                        {</div>
<div class="line"><span class="lineno"> 2637</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">T</a>(1) / <a class="code hl_class" href="classTensor.html">x</a>; });</div>
<div class="line"><span class="lineno"> 2638</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a834720ab65874a6c5503f7670c4f22fe" name="a834720ab65874a6c5503f7670c4f22fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a834720ab65874a6c5503f7670c4f22fe">&#9670;&#160;</a></span>log_softmax()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::log_softmax </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>axis</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Log-softmax operation (numerically stable). log_softmax(x) = log(softmax(x)) = x - log(sum(exp(x))) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The axis to apply log-softmax along </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> with log-softmax applied </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04403">4403</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4403</span>                                                  {</div>
<div class="line"><span class="lineno"> 4404</span>        <span class="comment">// More numerically stable than log(softmax(x))</span></div>
<div class="line"><span class="lineno"> 4405</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &lt; 0) {</div>
<div class="line"><span class="lineno"> 4406</span>            <a class="code hl_class" href="classTensor.html">axis</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) + <a class="code hl_class" href="classTensor.html">axis</a>;</div>
<div class="line"><span class="lineno"> 4407</span>        }</div>
<div class="line"><span class="lineno"> 4408</span>        </div>
<div class="line"><span class="lineno"> 4409</span>        <span class="comment">// log_softmax(x) = x - max(x) - log(sum(exp(x - max(x))))</span></div>
<div class="line"><span class="lineno"> 4410</span>        <span class="comment">// This avoids computing softmax explicitly</span></div>
<div class="line"><span class="lineno"> 4411</span>        </div>
<div class="line"><span class="lineno"> 4412</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">ax</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">axis</a>);</div>
<div class="line"><span class="lineno"> 4413</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4414</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4415</span>        </div>
<div class="line"><span class="lineno"> 4416</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 4417</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">ax</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4418</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4419</span>        }</div>
<div class="line"><span class="lineno"> 4420</span>        </div>
<div class="line"><span class="lineno"> 4421</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">softmax_dim</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">ax</a>];</div>
<div class="line"><span class="lineno"> 4422</span>        </div>
<div class="line"><span class="lineno"> 4423</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 4424</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">ax</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4425</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4426</span>        }</div>
<div class="line"><span class="lineno"> 4427</span>        </div>
<div class="line"><span class="lineno"> 4428</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4429</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4430</span>                <span class="comment">// Find max</span></div>
<div class="line"><span class="lineno"> 4431</span>                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_class" href="classTensor.html">std::numeric_limits&lt;T&gt;::lowest</a>();</div>
<div class="line"><span class="lineno"> 4432</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">s</a> = 0; <a class="code hl_class" href="classTensor.html">s</a> &lt; <a class="code hl_class" href="classTensor.html">softmax_dim</a>; ++<a class="code hl_class" href="classTensor.html">s</a>) {</div>
<div class="line"><span class="lineno"> 4433</span>                    <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 4434</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">linear_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">softmax_dim</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">s</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4435</span>                    </div>
<div class="line"><span class="lineno"> 4436</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">linear_idx</a>;</div>
<div class="line"><span class="lineno"> 4437</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 4438</span>                        <a class="code hl_class" href="classTensor.html">idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4439</span>                        <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4440</span>                    }</div>
<div class="line"><span class="lineno"> 4441</span>                    </div>
<div class="line"><span class="lineno"> 4442</span>                    <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_class" href="classTensor.html">std::max</a>(<a class="code hl_class" href="classTensor.html">max_val</a>, (*<span class="keyword">this</span>)[<a class="code hl_class" href="classTensor.html">idx</a>]);</div>
<div class="line"><span class="lineno"> 4443</span>                }</div>
<div class="line"><span class="lineno"> 4444</span>                </div>
<div class="line"><span class="lineno"> 4445</span>                <span class="comment">// Compute log(sum(exp(x - max)))</span></div>
<div class="line"><span class="lineno"> 4446</span>                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">log_sum_exp</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 4447</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">s</a> = 0; <a class="code hl_class" href="classTensor.html">s</a> &lt; <a class="code hl_class" href="classTensor.html">softmax_dim</a>; ++<a class="code hl_class" href="classTensor.html">s</a>) {</div>
<div class="line"><span class="lineno"> 4448</span>                    <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 4449</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">linear_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">softmax_dim</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">s</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4450</span>                    </div>
<div class="line"><span class="lineno"> 4451</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">linear_idx</a>;</div>
<div class="line"><span class="lineno"> 4452</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 4453</span>                        <a class="code hl_class" href="classTensor.html">idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4454</span>                        <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4455</span>                    }</div>
<div class="line"><span class="lineno"> 4456</span>                    </div>
<div class="line"><span class="lineno"> 4457</span>                    <a class="code hl_class" href="classTensor.html">log_sum_exp</a> += <a class="code hl_class" href="classTensor.html">std::exp</a>((*<span class="keyword">this</span>)[<a class="code hl_class" href="classTensor.html">idx</a>] - <a class="code hl_class" href="classTensor.html">max_val</a>);</div>
<div class="line"><span class="lineno"> 4458</span>                }</div>
<div class="line"><span class="lineno"> 4459</span>                <a class="code hl_class" href="classTensor.html">log_sum_exp</a> = <a class="code hl_class" href="classTensor.html">std::log</a>(<a class="code hl_class" href="classTensor.html">log_sum_exp</a>);</div>
<div class="line"><span class="lineno"> 4460</span>                </div>
<div class="line"><span class="lineno"> 4461</span>                <span class="comment">// Compute result: x - max - log_sum_exp</span></div>
<div class="line"><span class="lineno"> 4462</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">s</a> = 0; <a class="code hl_class" href="classTensor.html">s</a> &lt; <a class="code hl_class" href="classTensor.html">softmax_dim</a>; ++<a class="code hl_class" href="classTensor.html">s</a>) {</div>
<div class="line"><span class="lineno"> 4463</span>                    <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 4464</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">linear_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">softmax_dim</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">s</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4465</span>                    </div>
<div class="line"><span class="lineno"> 4466</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">linear_idx</a>;</div>
<div class="line"><span class="lineno"> 4467</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 4468</span>                        <a class="code hl_class" href="classTensor.html">idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4469</span>                        <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4470</span>                    }</div>
<div class="line"><span class="lineno"> 4471</span>                    </div>
<div class="line"><span class="lineno"> 4472</span>                    <a class="code hl_class" href="classTensor.html">result</a>[<a class="code hl_class" href="classTensor.html">idx</a>] = (*this)[<a class="code hl_class" href="classTensor.html">idx</a>] - <a class="code hl_class" href="classTensor.html">max_val</a> - <a class="code hl_class" href="classTensor.html">log_sum_exp</a>;</div>
<div class="line"><span class="lineno"> 4473</span>                }</div>
<div class="line"><span class="lineno"> 4474</span>            }</div>
<div class="line"><span class="lineno"> 4475</span>        }</div>
<div class="line"><span class="lineno"> 4476</span>        </div>
<div class="line"><span class="lineno"> 4477</span>        <span class="comment">// Backward pass for log_softmax</span></div>
<div class="line"><span class="lineno"> 4478</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4479</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">output_copy</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#ae5b52299c11f3ba81e781cb008542285">detach</a>();</div>
<div class="line"><span class="lineno"> 4480</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4481</span>            </div>
<div class="line"><span class="lineno"> 4482</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">output_copy</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 4483</span>                <span class="comment">// d/dx[log_softmax(x)] = 1 - softmax(x) for diagonal</span></div>
<div class="line"><span class="lineno"> 4484</span>                <span class="comment">// Gradient: grad_input = grad_output - softmax(x) * sum(grad_output)</span></div>
<div class="line"><span class="lineno"> 4485</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4486</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4487</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4488</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4489</span>                    }</div>
<div class="line"><span class="lineno"> 4490</span>                    </div>
<div class="line"><span class="lineno"> 4491</span>                    <span class="comment">// Compute softmax from log_softmax</span></div>
<div class="line"><span class="lineno"> 4492</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4493</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4494</span>                        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">softmax_val</a> = <a class="code hl_class" href="classTensor.html">std::exp</a>(<a class="code hl_class" href="classTensor.html">output_copy</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 4495</span>                        </div>
<div class="line"><span class="lineno"> 4496</span>                        <span class="comment">// Compute sum of gradients (simplified for now)</span></div>
<div class="line"><span class="lineno"> 4497</span>                        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">grad_sum</a> = <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4498</span>                        </div>
<div class="line"><span class="lineno"> 4499</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>] - <a class="code hl_class" href="classTensor.html">softmax_val</a> * <a class="code hl_class" href="classTensor.html">grad_sum</a>;</div>
<div class="line"><span class="lineno"> 4500</span>                    }</div>
<div class="line"><span class="lineno"> 4501</span>                    </div>
<div class="line"><span class="lineno"> 4502</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4503</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4504</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4505</span>                        }</div>
<div class="line"><span class="lineno"> 4506</span>                    }</div>
<div class="line"><span class="lineno"> 4507</span>                }</div>
<div class="line"><span class="lineno"> 4508</span>            });</div>
<div class="line"><span class="lineno"> 4509</span>        }</div>
<div class="line"><span class="lineno"> 4510</span>        </div>
<div class="line"><span class="lineno"> 4511</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4512</span>    }</div>
<div class="ttc" id="aclassTensor_html_ae5b52299c11f3ba81e781cb008542285"><div class="ttname"><a href="#ae5b52299c11f3ba81e781cb008542285">Tensor::detach</a></div><div class="ttdeci">Tensor&lt; T, N &gt; detach() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l01032">tensor.h:1032</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a834720ab65874a6c5503f7670c4f22fe_icgraph.png" border="0" usemap="#aclassTensor_a834720ab65874a6c5503f7670c4f22fe_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a834720ab65874a6c5503f7670c4f22fe_icgraph" id="aclassTensor_a834720ab65874a6c5503f7670c4f22fe_icgraph">
<area shape="rect" title=" " alt="" coords="220,5,359,32"/>
<area shape="rect" href="namespaceloss.html#a75edef9d102d2ab811b15c50f13c4eee" title="Cross entropy loss for multi&#45;class classification." alt="" coords="5,5,172,32"/>
<area shape="poly" title=" " alt="" coords="204,21,172,21,172,16,204,16"/>
</map>
</div>

</div>
</div>
<a id="a314dfaedc4f6b2dc8e3b44bbc5381eb3" name="a314dfaedc4f6b2dc8e3b44bbc5381eb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">&#9670;&#160;</a></span>map()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename Func&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::map </td>
          <td>(</td>
          <td class="paramtype">Func</td>          <td class="paramname"><span class="paramname"><em>func</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply a function to each element of the tensor (creates new tensor). </p>
<p>Maps a custom function over all elements, creating a new tensor with the results. The function should accept a single element of type T and return a value of type T.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Func</td><td>Function type (can be lambda, function pointer, or functor) </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">func</td><td>The function to apply to each element </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with the function applied to all elements</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_map"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> matrix({2, 3});</div>
<div class="line">matrix.fill(2.0f);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Square each element</span></div>
<div class="line"><span class="keyword">auto</span> squared = matrix.map([](<span class="keywordtype">float</span> x) { <span class="keywordflow">return</span> x * x; });</div>
<div class="line"><span class="comment">// squared contains all 4.0</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Apply custom function</span></div>
<div class="line"><span class="keyword">auto</span> result = matrix.map([](<span class="keywordtype">float</span> x) { <span class="keywordflow">return</span> std::sqrt(x) + 1.0f; });</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Can also use function pointers</span></div>
<div class="line"><span class="keyword">auto</span> exponential = matrix.map(std::exp&lt;float&gt;);</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01917">1917</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1917</span>                                      {</div>
<div class="line"><span class="lineno"> 1918</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1919</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1920</span>        </div>
<div class="line"><span class="lineno"> 1921</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1922</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">func</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 1923</span>        }</div>
<div class="line"><span class="lineno"> 1924</span>        </div>
<div class="line"><span class="lineno"> 1925</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1926</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a314dfaedc4f6b2dc8e3b44bbc5381eb3_icgraph.png" border="0" usemap="#aclassTensor_a314dfaedc4f6b2dc8e3b44bbc5381eb3_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a314dfaedc4f6b2dc8e3b44bbc5381eb3_icgraph" id="aclassTensor_a314dfaedc4f6b2dc8e3b44bbc5381eb3_icgraph">
<area shape="rect" title="Apply a function to each element of the tensor (creates new tensor)." alt="" coords="219,763,312,789"/>
<area shape="rect" href="classTensor.html#a694440b236a5cfb314e68adec066a9c6" title=" " alt="" coords="21,5,155,32"/>
<area shape="poly" title=" " alt="" coords="262,747,260,601,249,391,238,282,221,183,198,101,184,70,169,46,154,34,157,30,173,42,189,67,204,100,227,182,243,282,255,390,266,601,267,747"/>
<area shape="rect" href="classTensor.html#a62dff46109e314ef2d44683e3d4d581d" title=" " alt="" coords="21,56,155,83"/>
<area shape="poly" title=" " alt="" coords="261,748,259,611,247,416,235,315,219,224,197,148,183,119,169,96,154,84,157,80,173,93,188,116,202,146,224,222,240,315,252,415,264,611,267,747"/>
<area shape="rect" href="classTensor.html#a824a51062936324b316f066fdce66f77" title=" " alt="" coords="14,107,162,133"/>
<area shape="poly" title=" " alt="" coords="261,747,257,619,243,440,232,348,216,263,195,194,182,167,169,147,155,136,158,132,173,144,187,165,200,192,221,262,237,347,249,439,262,619,266,747"/>
<area shape="rect" href="classTensor.html#a1dafe6c812c9cd6d5f34a31ffdad59bb" title=" " alt="" coords="5,157,171,184"/>
<area shape="poly" title=" " alt="" coords="261,747,255,628,240,464,228,380,213,303,193,240,181,216,169,198,155,187,158,182,173,194,186,214,198,238,218,302,234,379,246,463,260,628,266,747"/>
<area shape="rect" href="classTensor.html#a5e477d9be3b8b907cbcc34efe73e31bc" title=" " alt="" coords="7,208,169,235"/>
<area shape="poly" title=" " alt="" coords="260,748,253,638,237,489,225,413,210,344,191,287,169,248,155,237,158,233,173,245,196,285,215,342,230,412,243,488,258,638,265,747"/>
<area shape="rect" href="classTensor.html#a0ee894165491bb19bf33d8282a166fde" title=" " alt="" coords="21,259,155,301"/>
<area shape="poly" title=" " alt="" coords="259,748,249,651,232,522,205,398,188,349,169,315,154,302,157,298,173,312,193,347,210,396,237,521,255,650,264,747"/>
<area shape="rect" href="namespacetensor4d_1_1nn.html#a7682f7b06565fe530c833139aa5c52cd" title="Compute cross&#45;entropy loss between predictions and targets." alt="" coords="21,325,155,368"/>
<area shape="poly" title=" " alt="" coords="258,748,246,664,227,555,201,450,186,410,169,382,154,369,157,365,173,378,190,407,206,449,233,554,252,663,263,747"/>
<area shape="rect" href="classTensor.html#afa7d4923af4f40166ac5dec4a893b74e" title=" " alt="" coords="24,392,152,419"/>
<area shape="poly" title=" " alt="" coords="262,747,260,683,248,598,236,554,219,510,197,469,169,433,151,420,154,416,173,429,202,466,224,508,241,552,253,597,265,682,268,747"/>
<area shape="rect" href="classTensor.html#ab64cb0dcc82a371720c3bfc7f2265ece" title=" " alt="" coords="12,443,164,469"/>
<area shape="poly" title=" " alt="" coords="261,747,255,692,241,621,229,583,214,547,194,513,169,483,153,472,156,468,172,479,198,510,218,545,234,582,246,619,261,691,266,747"/>
<area shape="rect" href="classTensor.html#a6047a6a731e93d59e92073e997969cc7" title=" " alt="" coords="19,493,157,520"/>
<area shape="poly" title=" " alt="" coords="258,748,250,701,234,643,208,585,190,558,169,534,153,523,156,518,172,530,194,554,213,582,239,642,256,700,264,747"/>
<area shape="rect" href="classTensor.html#a5aac0c5222fc09da3327d08ee2c3a2ed" title=" " alt="" coords="12,544,164,571"/>
<area shape="poly" title=" " alt="" coords="255,749,245,711,227,667,202,623,169,585,151,573,154,569,172,581,207,620,232,665,250,710,261,747"/>
<area shape="rect" href="classTensor.html#ac56c689ad6c5077e9cb9792a552a8d38" title=" " alt="" coords="19,595,157,621"/>
<area shape="poly" title=" " alt="" coords="251,750,219,692,196,661,169,635,149,624,152,620,172,631,200,658,224,689,255,747"/>
<area shape="rect" href="classTensor.html#a703855e2cfaff43769ef254a3dbce50c" title=" " alt="" coords="16,645,160,672"/>
<area shape="poly" title=" " alt="" coords="242,752,210,718,169,686,145,675,148,670,172,682,214,714,246,749"/>
<area shape="rect" href="classTensor.html#aa33851e29d0df735e3fab0002a119602" title=" " alt="" coords="16,696,160,739"/>
<area shape="poly" title=" " alt="" coords="207,760,154,742,156,737,209,755"/>
<area shape="rect" href="classTensor.html#a7375a160ffb9b310d78c1f7f5a44c956" title=" " alt="" coords="16,763,160,789"/>
<area shape="poly" title=" " alt="" coords="203,779,161,779,161,773,203,773"/>
<area shape="rect" href="classTensor.html#a1c578c4b3e0f4a8d2fc16b67e84815b5" title=" " alt="" coords="23,813,153,856"/>
<area shape="poly" title=" " alt="" coords="209,797,155,816,153,811,208,792"/>
<area shape="rect" href="classTensor.html#acf750ad4eaebe934c9422566ccb63081" title=" " alt="" coords="19,880,157,923"/>
<area shape="poly" title=" " alt="" coords="245,803,213,837,172,870,152,882,149,877,169,866,209,833,242,799"/>
<area shape="rect" href="classTensor.html#a780523f1c499b857930f305b22aae9aa" title=" " alt="" coords="21,947,155,989"/>
<area shape="poly" title=" " alt="" coords="256,805,225,870,201,906,172,937,156,948,153,944,169,933,197,902,220,868,252,803"/>
<area shape="rect" href="classTensor.html#a2daa379012cbb23c00fe3ac60bde0122" title=" " alt="" coords="15,1013,161,1040"/>
<area shape="poly" title=" " alt="" coords="263,805,253,849,237,902,210,956,193,981,172,1003,155,1015,152,1011,169,999,189,978,206,953,232,900,248,847,257,804"/>
<area shape="rect" href="classTensor.html#aa711e60597e988054c669e131ddce774" title=" " alt="" coords="9,1064,167,1107"/>
<area shape="poly" title=" " alt="" coords="265,805,258,857,242,923,215,992,196,1025,173,1054,158,1065,155,1061,169,1050,191,1022,210,990,237,921,252,856,259,804"/>
<area shape="rect" href="classTensor.html#a369fb30e582324d1331132a5b29884b9" title=" " alt="" coords="9,1131,167,1173"/>
<area shape="poly" title=" " alt="" coords="267,805,263,869,250,952,238,997,222,1041,200,1083,173,1120,159,1132,156,1128,169,1117,196,1080,217,1039,233,995,245,951,258,868,262,805"/>
<area shape="rect" href="classTensor.html#a8effb9d585936f292d45c090fa06a96b" title=" " alt="" coords="19,1197,157,1224"/>
<area shape="poly" title=" " alt="" coords="264,805,253,892,235,1006,208,1115,192,1157,173,1187,158,1199,154,1195,169,1184,187,1155,203,1113,230,1005,248,891,258,805"/>
<area shape="rect" href="classTensor.html#ae0c783450c731955dab75dcb1e697319" title=" " alt="" coords="8,1248,168,1291"/>
<area shape="poly" title=" " alt="" coords="264,805,255,901,237,1029,210,1154,193,1203,173,1238,160,1249,156,1245,169,1234,188,1201,205,1152,231,1028,249,900,259,804"/>
<area shape="rect" href="classTensor.html#a958bad1db0d0a6867d12c75957d2de17" title=" " alt="" coords="20,1315,156,1357"/>
<area shape="poly" title=" " alt="" coords="265,805,257,913,241,1062,229,1137,213,1206,195,1264,173,1304,158,1318,154,1314,169,1301,190,1262,208,1205,223,1136,235,1061,252,913,260,805"/>
<area shape="rect" href="classTensor.html#aeede6504125b5aeff52c1a56dfbee125" title=" " alt="" coords="12,1381,164,1408"/>
<area shape="poly" title=" " alt="" coords="266,805,261,926,247,1095,235,1181,219,1260,198,1326,186,1351,173,1371,158,1383,155,1379,169,1368,182,1349,193,1324,214,1259,229,1180,241,1094,256,925,261,804"/>
<area shape="rect" href="classTensor.html#a0ccbe9aa15ebe52d33cb890388bdf1ca" title=" " alt="" coords="22,1432,154,1459"/>
<area shape="poly" title=" " alt="" coords="266,805,263,936,250,1120,238,1214,222,1301,200,1372,187,1400,173,1422,156,1435,152,1431,169,1418,183,1397,195,1370,216,1299,233,1213,244,1119,257,935,261,805"/>
<area shape="rect" href="classTensor.html#a7cc09049ddf2fb131becaefe19b7725a" title=" " alt="" coords="22,1483,154,1525"/>
<area shape="poly" title=" " alt="" coords="267,805,263,944,250,1142,239,1245,222,1339,201,1417,188,1448,173,1472,156,1487,153,1483,169,1469,183,1446,196,1415,217,1338,233,1244,245,1142,258,943,261,805"/>
<area shape="rect" href="classTensor.html#ab400f3516df53eb4e6547a850335571e" title=" " alt="" coords="19,1549,157,1592"/>
<area shape="poly" title=" " alt="" coords="267,805,265,955,254,1174,243,1287,226,1391,203,1478,189,1512,173,1539,160,1552,156,1548,169,1536,184,1510,198,1476,221,1390,237,1286,249,1173,260,955,262,805"/>
<area shape="rect" href="classTensor.html#afa485f1ec713acb3499de0a08659fc4a" title=" " alt="" coords="12,1616,164,1659"/>
<area shape="poly" title=" " alt="" coords="267,805,267,967,258,1205,247,1329,230,1443,205,1539,190,1576,173,1606,161,1617,157,1614,169,1602,185,1574,200,1537,224,1442,241,1328,252,1205,262,967,262,805"/>
</map>
</div>

</div>
</div>
<a id="a1ee81db1a8ee83fe46fd9af9563812fd" name="a1ee81db1a8ee83fe46fd9af9563812fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ee81db1a8ee83fe46fd9af9563812fd">&#9670;&#160;</a></span>map_inplace()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename Func&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::map_inplace </td>
          <td>(</td>
          <td class="paramtype">Func</td>          <td class="paramname"><span class="paramname"><em>func</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply a function to each element of the tensor (in-place). </p>
<p>Maps a custom function over all elements, modifying the tensor in-place. More memory-efficient than <a class="el" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3" title="Apply a function to each element of the tensor (creates new tensor).">map()</a> when you don't need to preserve the original.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Func</td><td>Function type (can be lambda, function pointer, or functor) </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">func</td><td>The function to apply to each element </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor (for method chaining)</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_map_inplace"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> vec({5});</div>
<div class="line">vec.fill(3.0f);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Double all elements in-place</span></div>
<div class="line">vec.map_inplace([](<span class="keywordtype">float</span> x) { <span class="keywordflow">return</span> x * 2.0f; });</div>
<div class="line"><span class="comment">// vec now contains all 6.0</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Chain multiple operations</span></div>
<div class="line">vec.map_inplace([](<span class="keywordtype">float</span> x) { <span class="keywordflow">return</span> x + 1.0f; })</div>
<div class="line">   .<a class="code hl_function" href="#a1ee81db1a8ee83fe46fd9af9563812fd">map_inplace</a>([](<span class="keywordtype">float</span> x) { <span class="keywordflow">return</span> x * x; });</div>
<div class="ttc" id="aclassTensor_html_a1ee81db1a8ee83fe46fd9af9563812fd"><div class="ttname"><a href="#a1ee81db1a8ee83fe46fd9af9563812fd">Tensor::map_inplace</a></div><div class="ttdeci">Tensor&lt; T, N &gt; &amp; map_inplace(Func func)</div><div class="ttdoc">Apply a function to each element of the tensor (in-place).</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l01953">tensor.h:1953</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01953">1953</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1953</span>                                         {</div>
<div class="line"><span class="lineno"> 1954</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1955</span>        </div>
<div class="line"><span class="lineno"> 1956</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1957</span>            <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">func</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 1958</span>        }</div>
<div class="line"><span class="lineno"> 1959</span>        </div>
<div class="line"><span class="lineno"> 1960</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1961</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a754cdcbf16b91d5621e7405a2aa68f68" name="a754cdcbf16b91d5621e7405a2aa68f68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a754cdcbf16b91d5621e7405a2aa68f68">&#9670;&#160;</a></span>masked_fill()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::masked_fill </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; M, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mask</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>fill_value</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Masked fill: replace values where mask is true (non-zero) with fill_value. </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">M</td><td>The mask tensor element type (typically bool or numeric). </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mask</td><td>Boolean-like tensor (0 or non-zero values). </td></tr>
    <tr><td class="paramname">fill_value</td><td>Value to fill where mask is non-zero. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with masked values filled. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03325">3325</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3325</span>                                                                           {</div>
<div class="line"><span class="lineno"> 3326</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">mask</a>.<a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>()) {</div>
<div class="line"><span class="lineno"> 3327</span>            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 3328</span>        }</div>
<div class="line"><span class="lineno"> 3329</span>        </div>
<div class="line"><span class="lineno"> 3330</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3331</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3332</span>        </div>
<div class="line"><span class="lineno"> 3333</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3334</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_class" href="classTensor.html">mask</a>.<a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>()[<a class="code hl_class" href="classTensor.html">i</a>] != <a class="code hl_class" href="classTensor.html">M</a>(0)) ? <a class="code hl_class" href="classTensor.html">fill_value</a> : <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3335</span>        }</div>
<div class="line"><span class="lineno"> 3336</span>        </div>
<div class="line"><span class="lineno"> 3337</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3338</span>    }</div>
<div class="ttc" id="aclassTensor_html_a03d314303958ffc5644796d8025cd012"><div class="ttname"><a href="#a03d314303958ffc5644796d8025cd012">Tensor::dims</a></div><div class="ttdeci">TensorIndices&lt; N &gt; dims() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00854">tensor.h:854</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4773678cdfb3526a2bdb1079ef68b87e" name="a4773678cdfb3526a2bdb1079ef68b87e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4773678cdfb3526a2bdb1079ef68b87e">&#9670;&#160;</a></span>masked_select()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::masked_select </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; M, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mask</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Masked select: return 1D tensor of values where mask is true (non-zero). </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">M</td><td>The mask tensor element type (typically bool or numeric). </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mask</td><td>Boolean-like tensor (0 or non-zero values). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A 1D tensor containing selected values. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03347">3347</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3347</span>                                                               {</div>
<div class="line"><span class="lineno"> 3348</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">mask</a>.<a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>()) {</div>
<div class="line"><span class="lineno"> 3349</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 1&gt;</a>({0}, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3350</span>        }</div>
<div class="line"><span class="lineno"> 3351</span>        </div>
<div class="line"><span class="lineno"> 3352</span>        <span class="comment">// Count how many values to select</span></div>
<div class="line"><span class="lineno"> 3353</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3354</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">count</a> = 0;</div>
<div class="line"><span class="lineno"> 3355</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3356</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">mask</a>.<a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>()[<a class="code hl_class" href="classTensor.html">i</a>] != <a class="code hl_class" href="classTensor.html">M</a>(0)) {</div>
<div class="line"><span class="lineno"> 3357</span>                <a class="code hl_class" href="classTensor.html">count</a>++;</div>
<div class="line"><span class="lineno"> 3358</span>            }</div>
<div class="line"><span class="lineno"> 3359</span>        }</div>
<div class="line"><span class="lineno"> 3360</span>        </div>
<div class="line"><span class="lineno"> 3361</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 1&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>({<a class="code hl_class" href="classTensor.html">count</a>}, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3362</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">idx</a> = 0;</div>
<div class="line"><span class="lineno"> 3363</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3364</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">mask</a>.<a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>()[<a class="code hl_class" href="classTensor.html">i</a>] != <a class="code hl_class" href="classTensor.html">M</a>(0)) {</div>
<div class="line"><span class="lineno"> 3365</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">idx</a>++] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3366</span>            }</div>
<div class="line"><span class="lineno"> 3367</span>        }</div>
<div class="line"><span class="lineno"> 3368</span>        </div>
<div class="line"><span class="lineno"> 3369</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3370</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a88d5a081d321cbd88ca46ed42ca1112c" name="a88d5a081d321cbd88ca46ed42ca1112c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88d5a081d321cbd88ca46ed42ca1112c">&#9670;&#160;</a></span>matmul()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if&lt; M==2, <a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; &gt; &gt;::type <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::matmul </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc" title="Type alias for 2D matrices.">Matrix</a> multiplication with autograd support (matmul). </p>
<p>Performs standard matrix multiplication: A(m,n) @ B(n,p) = C(m,p)</p>
<p>This is the fundamental operation for neural network layers. Uses optimized implementations (BLAS/GPU) when available. Supports automatic differentiation for training neural networks.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">M</td><td>Template parameter ensuring N==2 (2D tensors only) </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to multiply with (must have compatible dimensions) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Result tensor or <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa2664c241558d7674e8ed4d5f63d2e463" title="Tensor dimensions do not match for the operation.">TensorError::DimensionMismatch</a> if incompatible</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_matmul"></a>
Example</h1>
<div class="fragment"><div class="line"><span class="comment">// Linear layer: output = input @ weights</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> input({32, 784}, <span class="keyword">true</span>, <span class="keyword">true</span>);   <span class="comment">// batch=32, features=784</span></div>
<div class="line"><a class="code hl_class" href="classTensor.html">Tensor&lt;float, 2&gt;</a> weights({784, 128}, <span class="keyword">true</span>, <span class="keyword">true</span>); <span class="comment">// 784 -&gt; 128 hidden units</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> output_result = input.<a class="code hl_function" href="#a88d5a081d321cbd88ca46ed42ca1112c">matmul</a>(weights);</div>
<div class="line"><span class="keywordflow">if</span> (std::holds_alternative&lt;<a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a>&gt;(output_result)) {</div>
<div class="line">    <span class="keyword">auto</span>&amp; output = std::get&lt;Tensor&lt;float, 2&gt;&gt;(output_result);</div>
<div class="line">    <span class="comment">// output shape: (32, 128)</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Full neural network layer with bias:</span></div>
<div class="line"><span class="keyword">auto</span> hidden = input.matmul(W1) + b1;  <span class="comment">// Broadcasting b1</span></div>
<div class="line"><span class="keyword">auto</span> activated = std::get&lt;Tensor&lt;float, 2&gt;&gt;(hidden).<a class="code hl_function" href="#a74db7588a7150d94b620ad63de1f5980">relu</a>();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Multi-layer network with autograd:</span></div>
<div class="line"><span class="keyword">auto</span> h1_result = input.matmul(W1);</div>
<div class="line"><span class="keyword">auto</span>&amp; h1 = std::get&lt;Tensor&lt;float, 2&gt;&gt;(h1_result);</div>
<div class="line"><span class="keyword">auto</span> h1_act = (h1 + b1).<a class="code hl_function" href="#a74db7588a7150d94b620ad63de1f5980">relu</a>();</div>
<div class="line"><span class="keyword">auto</span> h2_result = h1_act.matmul(W2);</div>
<div class="line"><span class="keyword">auto</span>&amp; h2 = std::get&lt;Tensor&lt;float, 2&gt;&gt;(h2_result);</div>
<div class="line"><span class="keyword">auto</span> output = h2 + b2;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Compute gradients:</span></div>
<div class="line"><span class="keyword">auto</span> loss = <a class="code hl_function" href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7">loss::mse_loss</a>(output, targets);</div>
<div class="line">loss.backward();</div>
<div class="line"><span class="comment">// Now W1.grad(), W2.grad(), etc. contain gradients</span></div>
<div class="ttc" id="aclassTensor_html_a74db7588a7150d94b620ad63de1f5980"><div class="ttname"><a href="#a74db7588a7150d94b620ad63de1f5980">Tensor::relu</a></div><div class="ttdeci">Tensor&lt; T, N &gt; relu() const</div><div class="ttdoc">Apply ReLU (Rectified Linear Unit) to all elements (creates new tensor).</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l02364">tensor.h:2364</a></div></div>
<div class="ttc" id="aclassTensor_html_a88d5a081d321cbd88ca46ed42ca1112c"><div class="ttname"><a href="#a88d5a081d321cbd88ca46ed42ca1112c">Tensor::matmul</a></div><div class="ttdeci">std::enable_if&lt; M==2, TensorResult&lt; Tensor&lt; T, 2 &gt; &gt; &gt;::type matmul(const Tensor&lt; T, 2 &gt; &amp;other) const</div><div class="ttdoc">Matrix multiplication with autograd support (matmul).</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l03921">tensor.h:3921</a></div></div>
<div class="ttc" id="anamespaceloss_html_aff5180b0c38ddd16d08f058205c01ef7"><div class="ttname"><a href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7">loss::mse_loss</a></div><div class="ttdeci">Tensor&lt; T, N &gt; mse_loss(const Tensor&lt; T, N &gt; &amp;predictions, const Tensor&lt; T, N &gt; &amp;targets, const std::string &amp;reduction)</div><div class="ttdoc">Mean Squared Error (MSE) Loss.</div><div class="ttdef"><b>Definition</b> <a href="loss__functions_8h_source.html#l00087">loss_functions.h:87</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03921">3921</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3921</span>                                            {</div>
<div class="line"><span class="lineno"> 3922</span>        <span class="keyword">static_assert</span>(<a class="code hl_class" href="classTensor.html">N</a> == 2, <span class="stringliteral">&quot;matmul requires 2D tensors&quot;</span>);</div>
<div class="line"><span class="lineno"> 3923</span>        </div>
<div class="line"><span class="lineno"> 3924</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[1] != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0]) {</div>
<div class="line"><span class="lineno"> 3925</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3926</span>        }</div>
<div class="line"><span class="lineno"> 3927</span>        </div>
<div class="line"><span class="lineno"> 3928</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">m</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0];</div>
<div class="line"><span class="lineno"> 3929</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">n</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[1];</div>
<div class="line"><span class="lineno"> 3930</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">p</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[1];</div>
<div class="line"><span class="lineno"> 3931</span>        </div>
<div class="line"><span class="lineno"> 3932</span>        <span class="keywordtype">bool</span> <a class="code hl_class" href="classTensor.html">track_grad</a> = <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a> || <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>;</div>
<div class="line"><span class="lineno"> 3933</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>({<a class="code hl_class" href="classTensor.html">m</a>, <a class="code hl_class" href="classTensor.html">p</a>}, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_class" href="classTensor.html">track_grad</a>);</div>
<div class="line"><span class="lineno"> 3934</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3935</span>        </div>
<div class="line"><span class="lineno"> 3936</span>        <span class="comment">// Forward pass - use cuBLAS for GPU, BLAS for CPU</span></div>
<div class="line"><span class="lineno"> 3937</span><span class="preprocessor">#ifdef USE_CUBLAS</span></div>
<div class="line"><span class="lineno"> 3938</span>        <span class="comment">// Use cuBLAS for GPU matrix multiplication</span></div>
<div class="line"><span class="lineno"> 3939</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 3940</span>            <span class="comment">// Ensure data is on GPU</span></div>
<div class="line"><span class="lineno"> 3941</span>            <a class="code hl_class" href="classTensor.html">ensure_on_gpu</a>();</div>
<div class="line"><span class="lineno"> 3942</span>            <a class="code hl_class" href="classTensor.html">other</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 3943</span>            <a class="code hl_class" href="classTensor.html">result</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 3944</span>            </div>
<div class="line"><span class="lineno"> 3945</span>            <span class="comment">// cuBLAS uses column-major layout, but we use row-major</span></div>
<div class="line"><span class="lineno"> 3946</span>            <span class="comment">// To compute C = A * B (row-major), we compute:</span></div>
<div class="line"><span class="lineno"> 3947</span>            <span class="comment">// C^T = B^T * A^T (column-major)</span></div>
<div class="line"><span class="lineno"> 3948</span>            <span class="comment">// So we swap A and B in the call</span></div>
<div class="line"><span class="lineno"> 3949</span>            </div>
<div class="line"><span class="lineno"> 3950</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">alpha</a> = <a class="code hl_class" href="classTensor.html">T</a>(1);</div>
<div class="line"><span class="lineno"> 3951</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">beta</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3952</span>            </div>
<div class="line"><span class="lineno"> 3953</span>            <a class="code hl_class" href="classTensor.html">cublasHandle_t</a> <a class="code hl_class" href="classTensor.html">handle</a> = <a class="code hl_class" href="classTensor.html">tensor4d::detail::CublasHandle::get</a>();</div>
<div class="line"><span class="lineno"> 3954</span>            <a class="code hl_class" href="classTensor.html">cublasStatus_t</a> <a class="code hl_class" href="classTensor.html">status</a>;</div>
<div class="line"><span class="lineno"> 3955</span>            </div>
<div class="line"><span class="lineno"> 3956</span>            <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<a class="code hl_class" href="classTensor.html">std::is_same_v&lt;T, float&gt;</a>) {</div>
<div class="line"><span class="lineno"> 3957</span>                <a class="code hl_class" href="classTensor.html">status</a> = <a class="code hl_class" href="classTensor.html">cublasSgemm</a>(<a class="code hl_class" href="classTensor.html">handle</a>,</div>
<div class="line"><span class="lineno"> 3958</span>                           <a class="code hl_class" href="classTensor.html">CUBLAS_OP_N</a>, <a class="code hl_class" href="classTensor.html">CUBLAS_OP_N</a>,</div>
<div class="line"><span class="lineno"> 3959</span>                           <a class="code hl_class" href="classTensor.html">p</a>, <a class="code hl_class" href="classTensor.html">m</a>, <a class="code hl_class" href="classTensor.html">n</a>,              <span class="comment">// Dimensions swapped for col-major</span></div>
<div class="line"><span class="lineno"> 3960</span>                           &amp;<a class="code hl_class" href="classTensor.html">alpha</a>,</div>
<div class="line"><span class="lineno"> 3961</span>                           <a class="code hl_class" href="classTensor.html">other</a>.d_data_, <a class="code hl_class" href="classTensor.html">p</a>,     <span class="comment">// B (treated as B^T in col-major)</span></div>
<div class="line"><span class="lineno"> 3962</span>                           <a class="code hl_class" href="classTensor.html">d_data_</a>, <a class="code hl_class" href="classTensor.html">n</a>,           <span class="comment">// A (treated as A^T in col-major)</span></div>
<div class="line"><span class="lineno"> 3963</span>                           &amp;<a class="code hl_class" href="classTensor.html">beta</a>,</div>
<div class="line"><span class="lineno"> 3964</span>                           <a class="code hl_class" href="classTensor.html">result</a>.d_data_, <a class="code hl_class" href="classTensor.html">p</a>);   <span class="comment">// C (treated as C^T in col-major)</span></div>
<div class="line"><span class="lineno"> 3965</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<a class="code hl_class" href="classTensor.html">std::is_same_v&lt;T, double&gt;</a>) {</div>
<div class="line"><span class="lineno"> 3966</span>                <a class="code hl_class" href="classTensor.html">status</a> = <a class="code hl_class" href="classTensor.html">cublasDgemm</a>(<a class="code hl_class" href="classTensor.html">handle</a>,</div>
<div class="line"><span class="lineno"> 3967</span>                           <a class="code hl_class" href="classTensor.html">CUBLAS_OP_N</a>, <a class="code hl_class" href="classTensor.html">CUBLAS_OP_N</a>,</div>
<div class="line"><span class="lineno"> 3968</span>                           <a class="code hl_class" href="classTensor.html">p</a>, <a class="code hl_class" href="classTensor.html">m</a>, <a class="code hl_class" href="classTensor.html">n</a>,</div>
<div class="line"><span class="lineno"> 3969</span>                           &amp;<a class="code hl_class" href="classTensor.html">alpha</a>,</div>
<div class="line"><span class="lineno"> 3970</span>                           <a class="code hl_class" href="classTensor.html">other</a>.d_data_, <a class="code hl_class" href="classTensor.html">p</a>,</div>
<div class="line"><span class="lineno"> 3971</span>                           <a class="code hl_class" href="classTensor.html">d_data_</a>, <a class="code hl_class" href="classTensor.html">n</a>,</div>
<div class="line"><span class="lineno"> 3972</span>                           &amp;<a class="code hl_class" href="classTensor.html">beta</a>,</div>
<div class="line"><span class="lineno"> 3973</span>                           <a class="code hl_class" href="classTensor.html">result</a>.d_data_, <a class="code hl_class" href="classTensor.html">p</a>);</div>
<div class="line"><span class="lineno"> 3974</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3975</span>                <span class="keywordflow">throw</span> <a class="code hl_class" href="classTensor.html">std::runtime_error</a>(<span class="stringliteral">&quot;cuBLAS only supports float and double types&quot;</span>);</div>
<div class="line"><span class="lineno"> 3976</span>            }</div>
<div class="line"><span class="lineno"> 3977</span>            </div>
<div class="line"><span class="lineno"> 3978</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">status</a> != <a class="code hl_class" href="classTensor.html">CUBLAS_STATUS_SUCCESS</a>) {</div>
<div class="line"><span class="lineno"> 3979</span>                <span class="keywordflow">throw</span> <a class="code hl_class" href="classTensor.html">std::runtime_error</a>(<span class="stringliteral">&quot;cuBLAS gemm failed with status: &quot;</span> + <a class="code hl_class" href="classTensor.html">std::to_string</a>(<a class="code hl_class" href="classTensor.html">status</a>));</div>
<div class="line"><span class="lineno"> 3980</span>            }</div>
<div class="line"><span class="lineno"> 3981</span>            </div>
<div class="line"><span class="lineno"> 3982</span>            <a class="code hl_class" href="classTensor.html">result</a>.mark_gpu_modified();</div>
<div class="line"><span class="lineno"> 3983</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3984</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3985</span><span class="preprocessor">#ifdef USE_BLAS</span></div>
<div class="line"><span class="lineno"> 3986</span>        <span class="comment">// Fallback to CPU BLAS</span></div>
<div class="line"><span class="lineno"> 3987</span>        {</div>
<div class="line"><span class="lineno"> 3988</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 3989</span>            </div>
<div class="line"><span class="lineno"> 3990</span>            <span class="comment">// Sync GPU tensors to CPU if needed</span></div>
<div class="line"><span class="lineno"> 3991</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) <a class="code hl_class" href="classTensor.html">ensure_on_cpu</a>();</div>
<div class="line"><span class="lineno"> 3992</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) <a class="code hl_class" href="classTensor.html">other</a>.ensure_on_cpu();</div>
<div class="line"><span class="lineno"> 3993</span>            </div>
<div class="line"><span class="lineno"> 3994</span>            <a class="code hl_class" href="classTensor.html">blas_gemm&lt;T&gt;</a>(<a class="code hl_class" href="classTensor.html">CblasRowMajor</a>, <a class="code hl_class" href="classTensor.html">CblasNoTrans</a>, <a class="code hl_class" href="classTensor.html">CblasNoTrans</a>,</div>
<div class="line"><span class="lineno"> 3995</span>                        <a class="code hl_class" href="classTensor.html">m</a>, <a class="code hl_class" href="classTensor.html">p</a>, <a class="code hl_class" href="classTensor.html">n</a>, <a class="code hl_class" href="classTensor.html">T</a>(1), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">n</a>,</div>
<div class="line"><span class="lineno"> 3996</span>                        <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">p</a>, <a class="code hl_class" href="classTensor.html">T</a>(0), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">p</a>);</div>
<div class="line"><span class="lineno"> 3997</span>        }</div>
<div class="line"><span class="lineno"> 3998</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 3999</span>        <span class="comment">// Naive fallback for when neither cuBLAS nor BLAS is available</span></div>
<div class="line"><span class="lineno"> 4000</span>        {</div>
<div class="line"><span class="lineno"> 4001</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4002</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">m</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4003</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">j</a> = 0; <a class="code hl_class" href="classTensor.html">j</a> &lt; <a class="code hl_class" href="classTensor.html">p</a>; ++<a class="code hl_class" href="classTensor.html">j</a>) {</div>
<div class="line"><span class="lineno"> 4004</span>                    <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 4005</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">k</a> = 0; <a class="code hl_class" href="classTensor.html">k</a> &lt; <a class="code hl_class" href="classTensor.html">n</a>; ++<a class="code hl_class" href="classTensor.html">k</a>) {</div>
<div class="line"><span class="lineno"> 4006</span>                        <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> += (*this)[{<a class="code hl_class" href="classTensor.html">i</a>, <a class="code hl_class" href="classTensor.html">k</a>}] * <a class="code hl_class" href="classTensor.html">other</a>[{<a class="code hl_class" href="classTensor.html">k</a>, <a class="code hl_class" href="classTensor.html">j</a>}];</div>
<div class="line"><span class="lineno"> 4007</span>                    }</div>
<div class="line"><span class="lineno"> 4008</span>                    <a class="code hl_class" href="classTensor.html">result</a>[{<a class="code hl_class" href="classTensor.html">i</a>, <a class="code hl_class" href="classTensor.html">j</a>}] = <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>;</div>
<div class="line"><span class="lineno"> 4009</span>                }</div>
<div class="line"><span class="lineno"> 4010</span>            }</div>
<div class="line"><span class="lineno"> 4011</span>        }</div>
<div class="line"><span class="lineno"> 4012</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4013</span>        </div>
<div class="line"><span class="lineno"> 4014</span>        <span class="comment">// Setup backward pass for autograd</span></div>
<div class="line"><span class="lineno"> 4015</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">track_grad</a>) {</div>
<div class="line"><span class="lineno"> 4016</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a> <a class="code hl_class" href="classTensor.html">self_copy</a> = this-&gt;<a class="code hl_function" href="#ae5b52299c11f3ba81e781cb008542285">detach</a>();</div>
<div class="line"><span class="lineno"> 4017</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a> <a class="code hl_class" href="classTensor.html">other_copy</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_function" href="#ae5b52299c11f3ba81e781cb008542285">detach</a>();</div>
<div class="line"><span class="lineno"> 4018</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4019</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>* <a class="code hl_class" href="classTensor.html">other_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_class" href="classTensor.html">other</a>);</div>
<div class="line"><span class="lineno"> 4020</span>            </div>
<div class="line"><span class="lineno"> 4021</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">other_ptr</a>, <a class="code hl_class" href="classTensor.html">self_copy</a>, <a class="code hl_class" href="classTensor.html">other_copy</a>, <a class="code hl_class" href="classTensor.html">m</a>, <a class="code hl_class" href="classTensor.html">n</a>, <a class="code hl_class" href="classTensor.html">p</a>]</div>
<div class="line"><span class="lineno"> 4022</span>                                    (<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 4023</span>                <span class="comment">// Gradient for matmul:</span></div>
<div class="line"><span class="lineno"> 4024</span>                <span class="comment">// If C = A @ B, then:</span></div>
<div class="line"><span class="lineno"> 4025</span>                <span class="comment">// dL/dA = dL/dC @ B^T</span></div>
<div class="line"><span class="lineno"> 4026</span>                <span class="comment">// dL/dB = A^T @ dL/dC</span></div>
<div class="line"><span class="lineno"> 4027</span>                </div>
<div class="line"><span class="lineno"> 4028</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4029</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4030</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, 2&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4031</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4032</span>                    }</div>
<div class="line"><span class="lineno"> 4033</span>                    </div>
<div class="line"><span class="lineno"> 4034</span>                    <span class="comment">// dL/dA = grad @ other^T</span></div>
<div class="line"><span class="lineno"> 4035</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">m</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4036</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">k</a> = 0; <a class="code hl_class" href="classTensor.html">k</a> &lt; <a class="code hl_class" href="classTensor.html">n</a>; ++<a class="code hl_class" href="classTensor.html">k</a>) {</div>
<div class="line"><span class="lineno"> 4037</span>                            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 4038</span>                            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">j</a> = 0; <a class="code hl_class" href="classTensor.html">j</a> &lt; <a class="code hl_class" href="classTensor.html">p</a>; ++<a class="code hl_class" href="classTensor.html">j</a>) {</div>
<div class="line"><span class="lineno"> 4039</span>                                <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>[{<a class="code hl_class" href="classTensor.html">i</a>, <a class="code hl_class" href="classTensor.html">j</a>}] * <a class="code hl_class" href="classTensor.html">other_copy</a>[{<a class="code hl_class" href="classTensor.html">k</a>, <a class="code hl_class" href="classTensor.html">j</a>}];</div>
<div class="line"><span class="lineno"> 4040</span>                            }</div>
<div class="line"><span class="lineno"> 4041</span>                            (*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>)[{<a class="code hl_class" href="classTensor.html">i</a>, <a class="code hl_class" href="classTensor.html">k</a>}] += <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>;</div>
<div class="line"><span class="lineno"> 4042</span>                        }</div>
<div class="line"><span class="lineno"> 4043</span>                    }</div>
<div class="line"><span class="lineno"> 4044</span>                    </div>
<div class="line"><span class="lineno"> 4045</span>                    <span class="comment">// Propagate further if not leaf</span></div>
<div class="line"><span class="lineno"> 4046</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4047</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4048</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4049</span>                        }</div>
<div class="line"><span class="lineno"> 4050</span>                    }</div>
<div class="line"><span class="lineno"> 4051</span>                }</div>
<div class="line"><span class="lineno"> 4052</span>                </div>
<div class="line"><span class="lineno"> 4053</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4054</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4055</span>                        <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, 2&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4056</span>                        <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4057</span>                    }</div>
<div class="line"><span class="lineno"> 4058</span>                    </div>
<div class="line"><span class="lineno"> 4059</span>                    <span class="comment">// dL/dB = self^T @ grad</span></div>
<div class="line"><span class="lineno"> 4060</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">k</a> = 0; <a class="code hl_class" href="classTensor.html">k</a> &lt; <a class="code hl_class" href="classTensor.html">n</a>; ++<a class="code hl_class" href="classTensor.html">k</a>) {</div>
<div class="line"><span class="lineno"> 4061</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">j</a> = 0; <a class="code hl_class" href="classTensor.html">j</a> &lt; <a class="code hl_class" href="classTensor.html">p</a>; ++<a class="code hl_class" href="classTensor.html">j</a>) {</div>
<div class="line"><span class="lineno"> 4062</span>                            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 4063</span>                            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">m</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4064</span>                                <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> += <a class="code hl_class" href="classTensor.html">self_copy</a>[{<a class="code hl_class" href="classTensor.html">i</a>, <a class="code hl_class" href="classTensor.html">k</a>}] * <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>[{<a class="code hl_class" href="classTensor.html">i</a>, <a class="code hl_class" href="classTensor.html">j</a>}];</div>
<div class="line"><span class="lineno"> 4065</span>                            }</div>
<div class="line"><span class="lineno"> 4066</span>                            (*<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>)[{<a class="code hl_class" href="classTensor.html">k</a>, <a class="code hl_class" href="classTensor.html">j</a>}] += <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>;</div>
<div class="line"><span class="lineno"> 4067</span>                        }</div>
<div class="line"><span class="lineno"> 4068</span>                    }</div>
<div class="line"><span class="lineno"> 4069</span>                    </div>
<div class="line"><span class="lineno"> 4070</span>                    <span class="comment">// Propagate further if not leaf</span></div>
<div class="line"><span class="lineno"> 4071</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4072</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4073</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4074</span>                        }</div>
<div class="line"><span class="lineno"> 4075</span>                    }</div>
<div class="line"><span class="lineno"> 4076</span>                }</div>
<div class="line"><span class="lineno"> 4077</span>            });</div>
<div class="line"><span class="lineno"> 4078</span>        }</div>
<div class="line"><span class="lineno"> 4079</span>        </div>
<div class="line"><span class="lineno"> 4080</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4081</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a88d5a081d321cbd88ca46ed42ca1112c_icgraph.png" border="0" usemap="#aclassTensor_a88d5a081d321cbd88ca46ed42ca1112c_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a88d5a081d321cbd88ca46ed42ca1112c_icgraph" id="aclassTensor_a88d5a081d321cbd88ca46ed42ca1112c_icgraph">
<area shape="rect" title="Matrix multiplication with autograd support (matmul)." alt="" coords="204,80,315,107"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Linear.html#a5364162aed6bb8c7758d88142ac74c1b" title=" " alt="" coords="12,5,149,48"/>
<area shape="poly" title=" " alt="" coords="206,77,139,51,141,46,208,72"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Softmax.html#abda8fce936f0e7f02d1779a120db27de" title=" " alt="" coords="5,72,156,115"/>
<area shape="poly" title=" " alt="" coords="188,96,156,96,156,91,188,91"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Linear.html#a0af1f08655e4b88cc7adc4e7d8a323e3" title=" " alt="" coords="12,139,149,181"/>
<area shape="poly" title=" " alt="" coords="208,115,141,141,139,136,206,110"/>
</map>
</div>

</div>
</div>
<a id="a421ff1c638234245b00425702d3f23aa" name="a421ff1c638234245b00425702d3f23aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a421ff1c638234245b00425702d3f23aa">&#9670;&#160;</a></span>max()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::max </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute max value of all elements. </p><dl class="section return"><dt>Returns</dt><dd>The maximum value. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02961">2961</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2961</span>                  {</div>
<div class="line"><span class="lineno"> 2962</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2963</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0];</div>
<div class="line"><span class="lineno"> 2964</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2965</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt; <a class="code hl_class" href="classTensor.html">max_val</a>) {</div>
<div class="line"><span class="lineno"> 2966</span>                <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 2967</span>            }</div>
<div class="line"><span class="lineno"> 2968</span>        }</div>
<div class="line"><span class="lineno"> 2969</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">max_val</a>;</div>
<div class="line"><span class="lineno"> 2970</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a421ff1c638234245b00425702d3f23aa_icgraph.png" border="0" usemap="#aclassTensor_a421ff1c638234245b00425702d3f23aa_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a421ff1c638234245b00425702d3f23aa_icgraph" id="aclassTensor_a421ff1c638234245b00425702d3f23aa_icgraph">
<area shape="rect" title=" " alt="" coords="234,5,327,32"/>
<area shape="rect" href="classTensor.html#a06eeff8ce7f54262b935b324bcb6833e" title=" " alt="" coords="5,5,186,32"/>
<area shape="poly" title=" " alt="" coords="218,21,186,21,186,16,218,16"/>
</map>
</div>

</div>
</div>
<a id="a84b27bf0213ab3f228c2efe5ca31eaec" name="a84b27bf0213ab3f228c2efe5ca31eaec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84b27bf0213ab3f228c2efe5ca31eaec">&#9670;&#160;</a></span>mean()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::mean </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute mean of all elements. </p>
<p>Calculates the arithmetic mean (average) of all tensor elements.</p>
<dl class="section return"><dt>Returns</dt><dd>The mean value as a scalar</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_mean"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>({2, 3});</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{0, 0}] = 1.0f;</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{0, 1}] = 2.0f;</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{0, 2}] = 3.0f;</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{1, 0}] = 4.0f;</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{1, 1}] = 5.0f;</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{1, 2}] = 6.0f;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">float</span> avg = <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>.mean();  <span class="comment">// Returns 3.5 = (1+2+3+4+5+6)/6</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Useful for normalization:</span></div>
<div class="line"><span class="keyword">auto</span> centered = <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a> - <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>.mean();  <span class="comment">// Center around zero</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02783">2783</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2783</span>                   {</div>
<div class="line"><span class="lineno"> 2784</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>() / <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>());</div>
<div class="line"><span class="lineno"> 2785</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a84b27bf0213ab3f228c2efe5ca31eaec_icgraph.png" border="0" usemap="#aclassTensor_a84b27bf0213ab3f228c2efe5ca31eaec_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a84b27bf0213ab3f228c2efe5ca31eaec_icgraph" id="aclassTensor_a84b27bf0213ab3f228c2efe5ca31eaec_icgraph">
<area shape="rect" title="Compute mean of all elements." alt="" coords="230,81,330,108"/>
<area shape="rect" href="classTensor.html#a2b57a0f04d06e24633c240fe7b007b4a" title=" " alt="" coords="7,5,180,32"/>
<area shape="poly" title=" " alt="" coords="241,76,181,46,148,35,150,30,183,42,243,71"/>
<area shape="rect" href="classTensor.html#a36b35209e077e06698d7b0cb5e687b95" title=" " alt="" coords="5,56,182,83"/>
<area shape="poly" title=" " alt="" coords="214,88,182,84,182,79,215,83"/>
<area shape="rect" href="classTensor.html#ab319628634a6c30afddd1a331d9c22e8" title=" " alt="" coords="9,107,178,133"/>
<area shape="poly" title=" " alt="" coords="214,106,179,111,178,106,214,101"/>
<area shape="rect" href="classTensor.html#ac24ac40382bfcce441f59645c4b73257" title=" " alt="" coords="12,157,175,184"/>
<area shape="poly" title=" " alt="" coords="243,118,183,148,150,159,148,154,181,143,241,114"/>
</map>
</div>

</div>
</div>
<a id="adf1fcb0ddd0ef2db3003401db519ec1c" name="adf1fcb0ddd0ef2db3003401db519ec1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf1fcb0ddd0ef2db3003401db519ec1c">&#9670;&#160;</a></span>mean_axis() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::mean_axis </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>axis</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>keepdims</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Mean reduction along a specific axis with autograd support. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The axis to average along (-1 for last axis) </td></tr>
    <tr><td class="paramname">keepdims</td><td>Whether to keep the reduced dimension </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reduced tensor </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04213">4213</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4213</span>                                                                  {</div>
<div class="line"><span class="lineno"> 4214</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">sum_result</a> = <a class="code hl_function" href="#ac20a4679e14de6f68e148b447496adfc">sum_axis</a>(<a class="code hl_class" href="classTensor.html">axis</a>, <a class="code hl_class" href="classTensor.html">keepdims</a>);</div>
<div class="line"><span class="lineno"> 4215</span>        </div>
<div class="line"><span class="lineno"> 4216</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &lt; 0) {</div>
<div class="line"><span class="lineno"> 4217</span>            <a class="code hl_class" href="classTensor.html">axis</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) + <a class="code hl_class" href="classTensor.html">axis</a>;</div>
<div class="line"><span class="lineno"> 4218</span>        }</div>
<div class="line"><span class="lineno"> 4219</span>        </div>
<div class="line"><span class="lineno"> 4220</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">count</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>]);</div>
<div class="line"><span class="lineno"> 4221</span>        </div>
<div class="line"><span class="lineno"> 4222</span>        <span class="comment">// Divide by count</span></div>
<div class="line"><span class="lineno"> 4223</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a> = <a class="code hl_class" href="classTensor.html">sum_result</a> * (<a class="code hl_class" href="classTensor.html">T</a>(1) / <a class="code hl_class" href="classTensor.html">count</a>);</div>
<div class="line"><span class="lineno"> 4224</span>        </div>
<div class="line"><span class="lineno"> 4225</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4226</span>    }</div>
<div class="ttc" id="aclassTensor_html_ac20a4679e14de6f68e148b447496adfc"><div class="ttname"><a href="#ac20a4679e14de6f68e148b447496adfc">Tensor::sum_axis</a></div><div class="ttdeci">Tensor&lt; T, N &gt; sum_axis(int axis, bool keepdims=false) const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l04089">tensor.h:4089</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_adf1fcb0ddd0ef2db3003401db519ec1c_icgraph.png" border="0" usemap="#aclassTensor_adf1fcb0ddd0ef2db3003401db519ec1c_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_adf1fcb0ddd0ef2db3003401db519ec1c_icgraph" id="aclassTensor_adf1fcb0ddd0ef2db3003401db519ec1c_icgraph">
<area shape="rect" title=" " alt="" coords="235,13,366,40"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1BatchNorm1d.html#a8e589b2051e3a2c38b1a0feccc33bdb2" title=" " alt="" coords="5,5,187,48"/>
<area shape="poly" title=" " alt="" coords="219,29,187,29,187,24,219,24"/>
</map>
</div>

</div>
</div>
<a id="aeb3f6a9bf8ee28d46a887238a9d3d460" name="aeb3f6a9bf8ee28d46a887238a9d3d460"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb3f6a9bf8ee28d46a887238a9d3d460">&#9670;&#160;</a></span>mean_axis() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::mean_axis </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>axis</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>keepdims</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Mean reduction along a specific axis. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The dimension along which to compute the mean. </td></tr>
    <tr><td class="paramname">keepdims</td><td>Whether to keep the reduced dimension (size 1) or remove it. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with the mean along the specified axis. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05190">5190</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5190</span>                                                                     {</div>
<div class="line"><span class="lineno"> 5191</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &gt;= <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 5192</span>            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 5193</span>        }</div>
<div class="line"><span class="lineno"> 5194</span>        </div>
<div class="line"><span class="lineno"> 5195</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a> = <a class="code hl_function" href="#ac20a4679e14de6f68e148b447496adfc">sum_axis</a>(<a class="code hl_class" href="classTensor.html">axis</a>, <a class="code hl_class" href="classTensor.html">keepdims</a>);</div>
<div class="line"><span class="lineno"> 5196</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">divisor</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>]);</div>
<div class="line"><span class="lineno"> 5197</span>        </div>
<div class="line"><span class="lineno"> 5198</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 5199</span>        </div>
<div class="line"><span class="lineno"> 5200</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 5201</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 5202</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::div_scalar_gpu</a>(<a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), <a class="code hl_class" href="classTensor.html">divisor</a>, <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 5203</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 5204</span>        }</div>
<div class="line"><span class="lineno"> 5205</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 5206</span> </div>
<div class="line"><span class="lineno"> 5207</span><span class="preprocessor">#ifdef USE_BLAS</span></div>
<div class="line"><span class="lineno"> 5208</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">std::is_same_v&lt;T, float&gt;</a>) {</div>
<div class="line"><span class="lineno"> 5209</span>            <a class="code hl_class" href="classTensor.html">cblas_sscal</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">total</a>), 1.0f / <a class="code hl_class" href="classTensor.html">divisor</a>, </div>
<div class="line"><span class="lineno"> 5210</span>                       <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">float</span>*<span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>()), 1);</div>
<div class="line"><span class="lineno"> 5211</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 5212</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">std::is_same_v&lt;T, double&gt;</a>) {</div>
<div class="line"><span class="lineno"> 5213</span>            <a class="code hl_class" href="classTensor.html">cblas_dscal</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">total</a>), 1.0 / <a class="code hl_class" href="classTensor.html">divisor</a>,</div>
<div class="line"><span class="lineno"> 5214</span>                       <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">double</span>*<span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>()), 1);</div>
<div class="line"><span class="lineno"> 5215</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 5216</span>        }</div>
<div class="line"><span class="lineno"> 5217</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 5218</span>        </div>
<div class="line"><span class="lineno"> 5219</span>        <span class="comment">// CPU fallback</span></div>
<div class="line"><span class="lineno"> 5220</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5221</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] /= <a class="code hl_class" href="classTensor.html">divisor</a>;</div>
<div class="line"><span class="lineno"> 5222</span>        }</div>
<div class="line"><span class="lineno"> 5223</span>        </div>
<div class="line"><span class="lineno"> 5224</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 5225</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1704d259280947373cbcbe3d1ca14854" name="a1704d259280947373cbcbe3d1ca14854"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1704d259280947373cbcbe3d1ca14854">&#9670;&#160;</a></span>median()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::median </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute median of all elements. Note: This creates a sorted copy of the data. </p><dl class="section return"><dt>Returns</dt><dd>The median value. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02904">2904</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2904</span>                     {</div>
<div class="line"><span class="lineno"> 2905</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2906</span>        <a class="code hl_class" href="classTensor.html">std::vector&lt;T&gt;</a> <a class="code hl_class" href="classTensor.html">sorted_data</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2907</span>        <a class="code hl_class" href="classTensor.html">std::sort</a>(<a class="code hl_class" href="classTensor.html">sorted_data</a>.begin(), <a class="code hl_class" href="classTensor.html">sorted_data</a>.end());</div>
<div class="line"><span class="lineno"> 2908</span>        </div>
<div class="line"><span class="lineno"> 2909</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">total</a> % 2 == 0) {</div>
<div class="line"><span class="lineno"> 2910</span>            <span class="keywordflow">return</span> (<a class="code hl_class" href="classTensor.html">sorted_data</a>[<a class="code hl_class" href="classTensor.html">total</a>/2 - 1] + <a class="code hl_class" href="classTensor.html">sorted_data</a>[<a class="code hl_class" href="classTensor.html">total</a>/2]) / <a class="code hl_class" href="classTensor.html">T</a>(2);</div>
<div class="line"><span class="lineno"> 2911</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2912</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">sorted_data</a>[<a class="code hl_class" href="classTensor.html">total</a>/2];</div>
<div class="line"><span class="lineno"> 2913</span>        }</div>
<div class="line"><span class="lineno"> 2914</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a20cb276f18c104077f75c6f712e4107b" name="a20cb276f18c104077f75c6f712e4107b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20cb276f18c104077f75c6f712e4107b">&#9670;&#160;</a></span>min()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::min </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute min value of all elements. </p><dl class="section return"><dt>Returns</dt><dd>The minimum value. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02946">2946</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2946</span>                  {</div>
<div class="line"><span class="lineno"> 2947</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2948</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">min_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[0];</div>
<div class="line"><span class="lineno"> 2949</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2950</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &lt; <a class="code hl_class" href="classTensor.html">min_val</a>) {</div>
<div class="line"><span class="lineno"> 2951</span>                <a class="code hl_class" href="classTensor.html">min_val</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 2952</span>            }</div>
<div class="line"><span class="lineno"> 2953</span>        }</div>
<div class="line"><span class="lineno"> 2954</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">min_val</a>;</div>
<div class="line"><span class="lineno"> 2955</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a20cb276f18c104077f75c6f712e4107b_icgraph.png" border="0" usemap="#aclassTensor_a20cb276f18c104077f75c6f712e4107b_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a20cb276f18c104077f75c6f712e4107b_icgraph" id="aclassTensor_a20cb276f18c104077f75c6f712e4107b_icgraph">
<area shape="rect" title=" " alt="" coords="234,5,323,32"/>
<area shape="rect" href="classTensor.html#a06eeff8ce7f54262b935b324bcb6833e" title=" " alt="" coords="5,5,186,32"/>
<area shape="poly" title=" " alt="" coords="218,21,186,21,186,16,218,16"/>
</map>
</div>

</div>
</div>
<a id="a3091aa5abf57a0e2a900a25443f50dd8" name="a3091aa5abf57a0e2a900a25443f50dd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3091aa5abf57a0e2a900a25443f50dd8">&#9670;&#160;</a></span>mse_loss()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;<a class="el" href="#a73e9357327da350df1da748ebeeefdaf">::mse_loss</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>target</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute MSE (Mean Squared Error) loss. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target</td><td>The target tensor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The MSE value or error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03563">3563</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3563</span>                                                               {</div>
<div class="line"><span class="lineno"> 3564</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">target</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 3565</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3566</span>        }</div>
<div class="line"><span class="lineno"> 3567</span>        </div>
<div class="line"><span class="lineno"> 3568</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">diff_result</a> = *<span class="keyword">this</span> - <a class="code hl_class" href="classTensor.html">target</a>;</div>
<div class="line"><span class="lineno"> 3569</span>        <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">diff</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">diff_result</a>);</div>
<div class="line"><span class="lineno"> 3570</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">squared_result</a> = <a class="code hl_class" href="classTensor.html">diff</a> * <a class="code hl_class" href="classTensor.html">diff</a>;</div>
<div class="line"><span class="lineno"> 3571</span>        <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">squared</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">squared_result</a>);</div>
<div class="line"><span class="lineno"> 3572</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">loss</a> = <a class="code hl_class" href="classTensor.html">squared</a>.<a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>();</div>
<div class="line"><span class="lineno"> 3573</span>        </div>
<div class="line"><span class="lineno"> 3574</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">loss</a> / <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>());</div>
<div class="line"><span class="lineno"> 3575</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a06009b18adaea5bd8fa428a5ccbef2d2" name="a06009b18adaea5bd8fa428a5ccbef2d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06009b18adaea5bd8fa428a5ccbef2d2">&#9670;&#160;</a></span>mse_loss_gradient()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::mse_loss_gradient </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>target</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute gradient of MSE loss with respect to predictions. d/dx[MSE] = 2 * (prediction - target) / n </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target</td><td>The target tensor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The gradient tensor or error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03583">3583</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3583</span>                                                                                   {</div>
<div class="line"><span class="lineno"> 3584</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">target</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 3585</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 3586</span>        }</div>
<div class="line"><span class="lineno"> 3587</span>        </div>
<div class="line"><span class="lineno"> 3588</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">scale</a> = <a class="code hl_class" href="classTensor.html">T</a>(2) / <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>());</div>
<div class="line"><span class="lineno"> 3589</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">diff_result</a> = *<span class="keyword">this</span> - <a class="code hl_class" href="classTensor.html">target</a>;</div>
<div class="line"><span class="lineno"> 3590</span>        <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">diff</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">diff_result</a>);</div>
<div class="line"><span class="lineno"> 3591</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a> = <a class="code hl_class" href="classTensor.html">diff</a> * <a class="code hl_class" href="classTensor.html">scale</a>;</div>
<div class="line"><span class="lineno"> 3592</span>        </div>
<div class="line"><span class="lineno"> 3593</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3594</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aab0bca33fa0dbe68308c0a828cec9f44" name="aab0bca33fa0dbe68308c0a828cec9f44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab0bca33fa0dbe68308c0a828cec9f44">&#9670;&#160;</a></span>ne()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::ne </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>epsilon</em></span><span class="paramdefsep"> = </span><span class="paramdefval">std::numeric_limits&lt;T&gt;::epsilon()</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise inequality comparison. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to compare with. </td></tr>
    <tr><td class="paramname">epsilon</td><td>Tolerance for floating-point comparison. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03253">3253</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3253</span>                                                                                                {</div>
<div class="line"><span class="lineno"> 3254</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 3255</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3256</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(1));</div>
<div class="line"><span class="lineno"> 3257</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3258</span>        }</div>
<div class="line"><span class="lineno"> 3259</span>        </div>
<div class="line"><span class="lineno"> 3260</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3261</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3262</span>        </div>
<div class="line"><span class="lineno"> 3263</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3264</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_class" href="classTensor.html">std::abs</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] - <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]) &gt;= <a class="code hl_class" href="classTensor.html">epsilon</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3265</span>        }</div>
<div class="line"><span class="lineno"> 3266</span>        </div>
<div class="line"><span class="lineno"> 3267</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3268</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab319628634a6c30afddd1a331d9c22e8" name="ab319628634a6c30afddd1a331d9c22e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab319628634a6c30afddd1a331d9c22e8">&#9670;&#160;</a></span>normalize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::normalize </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>ddof</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Normalize tensor to have zero mean and unit variance (z-score normalization). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ddof</td><td>Delta degrees of freedom for standard deviation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new normalized tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03028">3028</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3028</span>                                                  {</div>
<div class="line"><span class="lineno"> 3029</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">m</a> = <a class="code hl_function" href="#a84b27bf0213ab3f228c2efe5ca31eaec">mean</a>();</div>
<div class="line"><span class="lineno"> 3030</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">s</a> = <a class="code hl_function" href="#a0cda55fce732dcb563b598ff636d8758">std</a>(<a class="code hl_class" href="classTensor.html">ddof</a>);</div>
<div class="line"><span class="lineno"> 3031</span>        </div>
<div class="line"><span class="lineno"> 3032</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">s</a> &lt; <a class="code hl_class" href="classTensor.html">std::numeric_limits&lt;T&gt;::epsilon</a>()) {</div>
<div class="line"><span class="lineno"> 3033</span>            <span class="comment">// If std is zero, just center the data</span></div>
<div class="line"><span class="lineno"> 3034</span>            <span class="keywordflow">return</span> *<span class="keyword">this</span> - <a class="code hl_class" href="classTensor.html">m</a>;</div>
<div class="line"><span class="lineno"> 3035</span>        }</div>
<div class="line"><span class="lineno"> 3036</span>        </div>
<div class="line"><span class="lineno"> 3037</span>        <span class="keywordflow">return</span> (*<span class="keyword">this</span> - <a class="code hl_class" href="classTensor.html">m</a>) / <a class="code hl_class" href="classTensor.html">s</a>;</div>
<div class="line"><span class="lineno"> 3038</span>    }</div>
<div class="ttc" id="aclassTensor_html_a0cda55fce732dcb563b598ff636d8758"><div class="ttname"><a href="#a0cda55fce732dcb563b598ff636d8758">Tensor::std</a></div><div class="ttdeci">T std(size_t ddof=0) const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l02829">tensor.h:2829</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acfd498e431d2689e191c1e9cb8d600fb" name="acfd498e431d2689e191c1e9cb8d600fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfd498e431d2689e191c1e9cb8d600fb">&#9670;&#160;</a></span>offset()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::offset </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>indices</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the flat offset for given multi-dimensional indices. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">indices</td><td>An array of indices for each dimension. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The corresponding flat offset in the data array. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00547">547</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  547</span>                                                         {</div>
<div class="line"><span class="lineno">  548</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">off</a> = 0;</div>
<div class="line"><span class="lineno">  549</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno">  550</span>            <a class="code hl_class" href="classTensor.html">off</a> += <a class="code hl_class" href="classTensor.html">indices</a>[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_variable" href="#af6821d656bfc94c60fe4cd256c1d7402">strides_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno">  551</span>        }</div>
<div class="line"><span class="lineno">  552</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">off</a>;</div>
<div class="line"><span class="lineno">  553</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_acfd498e431d2689e191c1e9cb8d600fb_icgraph.png" border="0" usemap="#aclassTensor_acfd498e431d2689e191c1e9cb8d600fb_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_acfd498e431d2689e191c1e9cb8d600fb_icgraph" id="aclassTensor_acfd498e431d2689e191c1e9cb8d600fb_icgraph">
<area shape="rect" title=" " alt="" coords="222,31,322,57"/>
<area shape="rect" href="classTensor.html#acd343a064481a9fc4a0c8f3d17fc489c" title=" " alt="" coords="5,5,174,32"/>
<area shape="poly" title=" " alt="" coords="206,38,174,33,174,28,207,32"/>
<area shape="rect" href="classTensor.html#a9f1420cd0be3272bdb3b9a3f53d58c76" title=" " alt="" coords="5,56,174,83"/>
<area shape="poly" title=" " alt="" coords="207,56,174,60,174,55,206,50"/>
</map>
</div>

</div>
</div>
<a id="a808dc758321fc810256e3efd13042c98" name="a808dc758321fc810256e3efd13042c98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a808dc758321fc810256e3efd13042c98">&#9670;&#160;</a></span>operator*() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator* </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise multiplication with scalar (creates new tensor). Supports automatic differentiation. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to multiply all elements with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with the result. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01627">1627</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1627</span>                                                  {</div>
<div class="line"><span class="lineno"> 1628</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 1629</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1630</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1631</span>        </div>
<div class="line"><span class="lineno"> 1632</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1633</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1634</span>            <a class="code hl_class" href="classTensor.html">ensure_on_cpu</a>();  <span class="comment">// Sync from GPU before scalar operations</span></div>
<div class="line"><span class="lineno"> 1635</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::mul_scalar_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">scalar</a>, <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1636</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1637</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1638</span>        {</div>
<div class="line"><span class="lineno"> 1639</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1640</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">scalar</a>;</div>
<div class="line"><span class="lineno"> 1641</span>            }</div>
<div class="line"><span class="lineno"> 1642</span>        }</div>
<div class="line"><span class="lineno"> 1643</span>        </div>
<div class="line"><span class="lineno"> 1644</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 1645</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 1646</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 1647</span>            </div>
<div class="line"><span class="lineno"> 1648</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">scalar</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 1649</span>                <span class="comment">// Gradient of multiplication with scalar: d/dx(x*c) = c</span></div>
<div class="line"><span class="lineno"> 1650</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 1651</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 1652</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1653</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 1654</span>                    }</div>
<div class="line"><span class="lineno"> 1655</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1656</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1657</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">scalar</a>;</div>
<div class="line"><span class="lineno"> 1658</span>                    }</div>
<div class="line"><span class="lineno"> 1659</span>                    </div>
<div class="line"><span class="lineno"> 1660</span>                    <span class="comment">// If self is not a leaf, propagate gradients further</span></div>
<div class="line"><span class="lineno"> 1661</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 1662</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 1663</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 1664</span>                        }</div>
<div class="line"><span class="lineno"> 1665</span>                    }</div>
<div class="line"><span class="lineno"> 1666</span>                }</div>
<div class="line"><span class="lineno"> 1667</span>            });</div>
<div class="line"><span class="lineno"> 1668</span>        }</div>
<div class="line"><span class="lineno"> 1669</span>        </div>
<div class="line"><span class="lineno"> 1670</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1671</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af352346a629f774750b12c97234979a9" name="af352346a629f774750b12c97234979a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af352346a629f774750b12c97234979a9">&#9670;&#160;</a></span>operator*() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator* </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise multiplication with another tensor (creates new tensor). Supports automatic differentiation. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to multiply with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing either a new tensor with the result or an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01494">1494</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1494</span>                                                                          {</div>
<div class="line"><span class="lineno"> 1495</span>        <span class="comment">// Check if shapes match exactly</span></div>
<div class="line"><span class="lineno"> 1496</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> == <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 1497</span>            <span class="comment">// Fast path: exact shape match  </span></div>
<div class="line"><span class="lineno"> 1498</span>            <span class="keywordtype">bool</span> <a class="code hl_class" href="classTensor.html">track_grad</a> = <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a> || <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>;</div>
<div class="line"><span class="lineno"> 1499</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_class" href="classTensor.html">track_grad</a>);</div>
<div class="line"><span class="lineno"> 1500</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1501</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1502</span>            </div>
<div class="line"><span class="lineno"> 1503</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1504</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1505</span>                <a class="code hl_class" href="classTensor.html">ensure_on_gpu</a>();</div>
<div class="line"><span class="lineno"> 1506</span>                <a class="code hl_class" href="classTensor.html">other</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 1507</span>                <a class="code hl_class" href="classTensor.html">result</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 1508</span>                <a class="code hl_class" href="classTensor.html">TensorGPU::mul_gpu_direct</a>(<a class="code hl_class" href="classTensor.html">d_data_</a>, <a class="code hl_class" href="classTensor.html">other</a>.d_data_, <a class="code hl_class" href="classTensor.html">result</a>.d_data_, <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1509</span>                <a class="code hl_class" href="classTensor.html">result</a>.mark_gpu_modified();</div>
<div class="line"><span class="lineno"> 1510</span>            } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1511</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1512</span>            {</div>
<div class="line"><span class="lineno"> 1513</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1514</span>                    <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1515</span>                }</div>
<div class="line"><span class="lineno"> 1516</span>            }</div>
<div class="line"><span class="lineno"> 1517</span>            </div>
<div class="line"><span class="lineno"> 1518</span>            <span class="comment">// Setup backward pass (existing code continues)</span></div>
<div class="line"><span class="lineno"> 1519</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">track_grad</a>) {</div>
<div class="line"><span class="lineno"> 1520</span>                <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">self_copy</a> = this-&gt;<a class="code hl_function" href="#ae5b52299c11f3ba81e781cb008542285">detach</a>();</div>
<div class="line"><span class="lineno"> 1521</span>                <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">other_copy</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_function" href="#ae5b52299c11f3ba81e781cb008542285">detach</a>();</div>
<div class="line"><span class="lineno"> 1522</span>                <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 1523</span>                <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">other_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_class" href="classTensor.html">other</a>);</div>
<div class="line"><span class="lineno"> 1524</span>                </div>
<div class="line"><span class="lineno"> 1525</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">other_ptr</a>, <a class="code hl_class" href="classTensor.html">self_copy</a>, <a class="code hl_class" href="classTensor.html">other_copy</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 1526</span>                    <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 1527</span>                        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 1528</span>                            <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1529</span>                            <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 1530</span>                        }</div>
<div class="line"><span class="lineno"> 1531</span>                        </div>
<div class="line"><span class="lineno"> 1532</span>                        <span class="comment">// Optimized using tensor operations</span></div>
<div class="line"><span class="lineno"> 1533</span>                        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">grad_result</a> = <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a> * <a class="code hl_class" href="classTensor.html">other_copy</a>;</div>
<div class="line"><span class="lineno"> 1534</span>                        <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">grad_contrib</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">grad_result</a>);</div>
<div class="line"><span class="lineno"> 1535</span>                        </div>
<div class="line"><span class="lineno"> 1536</span>                        <span class="comment">// Accumulate gradients using tensor addition</span></div>
<div class="line"><span class="lineno"> 1537</span>                        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">grad_sum_result</a> = *<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> + <a class="code hl_class" href="classTensor.html">grad_contrib</a>;</div>
<div class="line"><span class="lineno"> 1538</span>                        *<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">grad_sum_result</a>);</div>
<div class="line"><span class="lineno"> 1539</span>                        </div>
<div class="line"><span class="lineno"> 1540</span>                        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 1541</span>                            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 1542</span>                                <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 1543</span>                            }</div>
<div class="line"><span class="lineno"> 1544</span>                        }</div>
<div class="line"><span class="lineno"> 1545</span>                    }</div>
<div class="line"><span class="lineno"> 1546</span>                    </div>
<div class="line"><span class="lineno"> 1547</span>                    <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 1548</span>                        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 1549</span>                            <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1550</span>                            <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 1551</span>                        }</div>
<div class="line"><span class="lineno"> 1552</span>                        </div>
<div class="line"><span class="lineno"> 1553</span>                        <span class="comment">// Optimized using tensor operations</span></div>
<div class="line"><span class="lineno"> 1554</span>                        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">grad_result</a> = <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a> * <a class="code hl_class" href="classTensor.html">self_copy</a>;</div>
<div class="line"><span class="lineno"> 1555</span>                        <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">grad_contrib</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">grad_result</a>);</div>
<div class="line"><span class="lineno"> 1556</span>                        </div>
<div class="line"><span class="lineno"> 1557</span>                        <span class="comment">// Accumulate gradients using tensor addition</span></div>
<div class="line"><span class="lineno"> 1558</span>                        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">grad_sum_result</a> = *<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> + <a class="code hl_class" href="classTensor.html">grad_contrib</a>;</div>
<div class="line"><span class="lineno"> 1559</span>                        *<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">grad_sum_result</a>);</div>
<div class="line"><span class="lineno"> 1560</span>                        </div>
<div class="line"><span class="lineno"> 1561</span>                        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 1562</span>                            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 1563</span>                                <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 1564</span>                            }</div>
<div class="line"><span class="lineno"> 1565</span>                        }</div>
<div class="line"><span class="lineno"> 1566</span>                    }</div>
<div class="line"><span class="lineno"> 1567</span>                });</div>
<div class="line"><span class="lineno"> 1568</span>            }</div>
<div class="line"><span class="lineno"> 1569</span>            </div>
<div class="line"><span class="lineno"> 1570</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1571</span>        }</div>
<div class="line"><span class="lineno"> 1572</span>        </div>
<div class="line"><span class="lineno"> 1573</span>        <span class="comment">// Try broadcasting</span></div>
<div class="line"><span class="lineno"> 1574</span>        <a class="code hl_class" href="classTensor.html">std::string</a> <a class="code hl_class" href="classTensor.html">error_msg</a>;</div>
<div class="line"><span class="lineno"> 1575</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="tensor_8h.html#af558fb1fbf98a2d78e5a85123c232d9f">are_broadcastable</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, &amp;<a class="code hl_class" href="classTensor.html">error_msg</a>)) {</div>
<div class="line"><span class="lineno"> 1576</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 1577</span>        }</div>
<div class="line"><span class="lineno"> 1578</span>        </div>
<div class="line"><span class="lineno"> 1579</span>        <span class="comment">// Determine broadcast shape</span></div>
<div class="line"><span class="lineno"> 1580</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">broadcast_shape</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 1581</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1582</span>            <a class="code hl_class" href="classTensor.html">broadcast_shape</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::max</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>], <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 1583</span>        }</div>
<div class="line"><span class="lineno"> 1584</span>        </div>
<div class="line"><span class="lineno"> 1585</span>        <span class="keywordtype">bool</span> <a class="code hl_class" href="classTensor.html">track_grad</a> = <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a> || <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>;</div>
<div class="line"><span class="lineno"> 1586</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">broadcast_shape</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_class" href="classTensor.html">track_grad</a>);</div>
<div class="line"><span class="lineno"> 1587</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1588</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1589</span>        </div>
<div class="line"><span class="lineno"> 1590</span>        <span class="comment">// Perform broadcasted multiplication</span></div>
<div class="line"><span class="lineno"> 1591</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1592</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">coords</a>;</div>
<div class="line"><span class="lineno"> 1593</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">idx</a> = <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 1594</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">d</a> = <a class="code hl_class" href="classTensor.html">N</a>; <a class="code hl_class" href="classTensor.html">d</a> &gt; 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 1595</span>                <a class="code hl_class" href="classTensor.html">coords</a>[<a class="code hl_class" href="classTensor.html">d</a> - 1] = <a class="code hl_class" href="classTensor.html">idx</a> % <a class="code hl_class" href="classTensor.html">broadcast_shape</a>[<a class="code hl_class" href="classTensor.html">d</a> - 1];</div>
<div class="line"><span class="lineno"> 1596</span>                <a class="code hl_class" href="classTensor.html">idx</a> /= <a class="code hl_class" href="classTensor.html">broadcast_shape</a>[<a class="code hl_class" href="classTensor.html">d</a> - 1];</div>
<div class="line"><span class="lineno"> 1597</span>            }</div>
<div class="line"><span class="lineno"> 1598</span>            </div>
<div class="line"><span class="lineno"> 1599</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">self_idx</a> = 0, <a class="code hl_class" href="classTensor.html">other_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 1600</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">self_stride</a> = 1, <a class="code hl_class" href="classTensor.html">other_stride</a> = 1;</div>
<div class="line"><span class="lineno"> 1601</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">d</a> = <a class="code hl_class" href="classTensor.html">N</a>; <a class="code hl_class" href="classTensor.html">d</a> &gt; 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 1602</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dim</a> = <a class="code hl_class" href="classTensor.html">d</a> - 1;</div>
<div class="line"><span class="lineno"> 1603</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">self_coord</a> = (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a>] == 1) ? 0 : <a class="code hl_class" href="classTensor.html">coords</a>[<a class="code hl_class" href="classTensor.html">dim</a>];</div>
<div class="line"><span class="lineno"> 1604</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">other_coord</a> = (<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a>] == 1) ? 0 : <a class="code hl_class" href="classTensor.html">coords</a>[<a class="code hl_class" href="classTensor.html">dim</a>];</div>
<div class="line"><span class="lineno"> 1605</span>                </div>
<div class="line"><span class="lineno"> 1606</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">dim</a> + 1 &lt; <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 1607</span>                    <a class="code hl_class" href="classTensor.html">self_stride</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a> + 1];</div>
<div class="line"><span class="lineno"> 1608</span>                    <a class="code hl_class" href="classTensor.html">other_stride</a> *= <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a> + 1];</div>
<div class="line"><span class="lineno"> 1609</span>                }</div>
<div class="line"><span class="lineno"> 1610</span>                </div>
<div class="line"><span class="lineno"> 1611</span>                <a class="code hl_class" href="classTensor.html">self_idx</a> += <a class="code hl_class" href="classTensor.html">self_coord</a> * <a class="code hl_class" href="classTensor.html">self_stride</a>;</div>
<div class="line"><span class="lineno"> 1612</span>                <a class="code hl_class" href="classTensor.html">other_idx</a> += <a class="code hl_class" href="classTensor.html">other_coord</a> * <a class="code hl_class" href="classTensor.html">other_stride</a>;</div>
<div class="line"><span class="lineno"> 1613</span>            }</div>
<div class="line"><span class="lineno"> 1614</span>            </div>
<div class="line"><span class="lineno"> 1615</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">self_idx</a>] * <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">other_idx</a>];</div>
<div class="line"><span class="lineno"> 1616</span>        }</div>
<div class="line"><span class="lineno"> 1617</span>        </div>
<div class="line"><span class="lineno"> 1618</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1619</span>    }</div>
<div class="ttc" id="atensor_8h_html_af558fb1fbf98a2d78e5a85123c232d9f"><div class="ttname"><a href="tensor_8h.html#af558fb1fbf98a2d78e5a85123c232d9f">are_broadcastable</a></div><div class="ttdeci">bool are_broadcastable(const TensorIndices&lt; N1 &gt; &amp;shape1, const TensorIndices&lt; N2 &gt; &amp;shape2, std::string *error_msg)</div><div class="ttdoc">Check if two tensor shapes are broadcastable.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l06772">tensor.h:6772</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a29213c270a7d4b9f44f27f4cec4246bf" name="a29213c270a7d4b9f44f27f4cec4246bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29213c270a7d4b9f44f27f4cec4246bf">&#9670;&#160;</a></span>operator*=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator*= </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise multiplication with scalar (in-place). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to multiply all elements with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01704">1704</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1704</span>                                              {</div>
<div class="line"><span class="lineno"> 1705</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1706</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1707</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1708</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::mul_scalar_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">scalar</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1709</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1710</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1711</span>        {</div>
<div class="line"><span class="lineno"> 1712</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1713</span>                <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] *= <a class="code hl_class" href="classTensor.html">scalar</a>;</div>
<div class="line"><span class="lineno"> 1714</span>            }</div>
<div class="line"><span class="lineno"> 1715</span>        }</div>
<div class="line"><span class="lineno"> 1716</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1717</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4a0f41f0cbce7ad6637c457a68ff3e32" name="a4a0f41f0cbce7ad6637c457a68ff3e32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a0f41f0cbce7ad6637c457a68ff3e32">&#9670;&#160;</a></span>operator*=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator*= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise multiplication with another tensor (in-place). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to multiply with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>If dimensions don't match, the operation is skipped. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01679">1679</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1679</span>                                                        {</div>
<div class="line"><span class="lineno"> 1680</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 1681</span>            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1682</span>        }</div>
<div class="line"><span class="lineno"> 1683</span>        </div>
<div class="line"><span class="lineno"> 1684</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1685</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1686</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1687</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::mul_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1688</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1689</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1690</span>        {</div>
<div class="line"><span class="lineno"> 1691</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1692</span>                <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] *= <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1693</span>            }</div>
<div class="line"><span class="lineno"> 1694</span>        }</div>
<div class="line"><span class="lineno"> 1695</span>        </div>
<div class="line"><span class="lineno"> 1696</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1697</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aab73fe3969bc9ab6b35a89c3787f2a22" name="aab73fe3969bc9ab6b35a89c3787f2a22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab73fe3969bc9ab6b35a89c3787f2a22">&#9670;&#160;</a></span>operator+() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator+ </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise addition with scalar (creates new tensor). Supports automatic differentiation. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to add to all elements. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with the result. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01251">1251</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1251</span>                                                  {</div>
<div class="line"><span class="lineno"> 1252</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 1253</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1254</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1255</span>        </div>
<div class="line"><span class="lineno"> 1256</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1257</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1258</span>            <a class="code hl_class" href="classTensor.html">ensure_on_cpu</a>();  <span class="comment">// Sync from GPU before scalar operations</span></div>
<div class="line"><span class="lineno"> 1259</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::add_scalar_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">scalar</a>, <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1260</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1261</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1262</span>        {</div>
<div class="line"><span class="lineno"> 1263</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1264</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] + <a class="code hl_class" href="classTensor.html">scalar</a>;</div>
<div class="line"><span class="lineno"> 1265</span>            }</div>
<div class="line"><span class="lineno"> 1266</span>        }</div>
<div class="line"><span class="lineno"> 1267</span>        </div>
<div class="line"><span class="lineno"> 1268</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 1269</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 1270</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 1271</span>            </div>
<div class="line"><span class="lineno"> 1272</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 1273</span>                <span class="comment">// Gradient of addition with scalar: d/dx(x+c) = 1</span></div>
<div class="line"><span class="lineno"> 1274</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 1275</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 1276</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1277</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 1278</span>                    }</div>
<div class="line"><span class="lineno"> 1279</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1280</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1281</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1282</span>                    }</div>
<div class="line"><span class="lineno"> 1283</span>                    </div>
<div class="line"><span class="lineno"> 1284</span>                    <span class="comment">// If self is not a leaf, propagate gradients further</span></div>
<div class="line"><span class="lineno"> 1285</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 1286</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 1287</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 1288</span>                        }</div>
<div class="line"><span class="lineno"> 1289</span>                    }</div>
<div class="line"><span class="lineno"> 1290</span>                }</div>
<div class="line"><span class="lineno"> 1291</span>            });</div>
<div class="line"><span class="lineno"> 1292</span>        }</div>
<div class="line"><span class="lineno"> 1293</span>        </div>
<div class="line"><span class="lineno"> 1294</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1295</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1947fa453cc8c0a746b26d2481bb6b39" name="a1947fa453cc8c0a746b26d2481bb6b39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1947fa453cc8c0a746b26d2481bb6b39">&#9670;&#160;</a></span>operator+() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator+ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Element-wise addition with another tensor (creates new tensor). </p>
<p>Performs element-wise addition of two tensors. Supports automatic differentiation and will track gradients if either input requires gradients.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to add </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing either a new tensor with the result or <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa2664c241558d7674e8ed4d5f63d2e463" title="Tensor dimensions do not match for the operation.">TensorError::DimensionMismatch</a></dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_add"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> A({2, 3});</div>
<div class="line"><a class="code hl_class" href="classTensor.html">Tensor&lt;float, 2&gt;</a> B({2, 3});</div>
<div class="line">A.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(1.0f);</div>
<div class="line">B.fill(2.0f);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> result = A + B;  <span class="comment">// Returns TensorResult&lt;Tensor&lt;float, 2&gt;&gt;</span></div>
<div class="line"><span class="keywordflow">if</span> (std::holds_alternative&lt;<a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a>&gt;(result)) {</div>
<div class="line">    <span class="keyword">auto</span>&amp; C = std::get&lt;Tensor&lt;float, 2&gt;&gt;(result);</div>
<div class="line">    <span class="comment">// C[{i, j}] == 3.0 for all i, j</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// With autograd:</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> x({3}, <span class="keyword">true</span>, <span class="keyword">true</span>);  <span class="comment">// requires_grad=true</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> y({3}, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="keyword">auto</span> z_result = x + y;</div>
<div class="line"><span class="keyword">auto</span>&amp; z = std::get&lt;Tensor&lt;float, 1&gt;&gt;(z_result);</div>
<div class="line">z.backward();  <span class="comment">// Computes gradients</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01080">1080</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1080</span>                                                                          {</div>
<div class="line"><span class="lineno"> 1081</span>        <span class="comment">// Check if shapes match exactly</span></div>
<div class="line"><span class="lineno"> 1082</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> == <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 1083</span>            <span class="comment">// Fast path: exact shape match</span></div>
<div class="line"><span class="lineno"> 1084</span>            <span class="keywordtype">bool</span> <a class="code hl_class" href="classTensor.html">track_grad</a> = <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a> || <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>;</div>
<div class="line"><span class="lineno"> 1085</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_class" href="classTensor.html">track_grad</a>);</div>
<div class="line"><span class="lineno"> 1086</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1087</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1088</span>            </div>
<div class="line"><span class="lineno"> 1089</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1090</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1091</span>                <a class="code hl_class" href="classTensor.html">ensure_on_gpu</a>();</div>
<div class="line"><span class="lineno"> 1092</span>                <a class="code hl_class" href="classTensor.html">other</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 1093</span>                <a class="code hl_class" href="classTensor.html">result</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 1094</span>                <a class="code hl_class" href="classTensor.html">TensorGPU::add_gpu_direct</a>(<a class="code hl_class" href="classTensor.html">d_data_</a>, <a class="code hl_class" href="classTensor.html">other</a>.d_data_, <a class="code hl_class" href="classTensor.html">result</a>.d_data_, <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1095</span>                <a class="code hl_class" href="classTensor.html">result</a>.mark_gpu_modified();</div>
<div class="line"><span class="lineno"> 1096</span>            } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1097</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1098</span>            {</div>
<div class="line"><span class="lineno"> 1099</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1100</span>                    <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] + <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1101</span>                }</div>
<div class="line"><span class="lineno"> 1102</span>            }</div>
<div class="line"><span class="lineno"> 1103</span>            </div>
<div class="line"><span class="lineno"> 1104</span>            <span class="comment">// Setup backward pass (existing code continues below)</span></div>
<div class="line"><span class="lineno"> 1105</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">track_grad</a>) {</div>
<div class="line"><span class="lineno"> 1106</span>                <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 1107</span>                <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">other_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_class" href="classTensor.html">other</a>);</div>
<div class="line"><span class="lineno"> 1108</span>                </div>
<div class="line"><span class="lineno"> 1109</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">other_ptr</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 1110</span>                    <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 1111</span>                        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 1112</span>                            <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1113</span>                            <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 1114</span>                        }</div>
<div class="line"><span class="lineno"> 1115</span>                        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1116</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1117</span>                            <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1118</span>                        }</div>
<div class="line"><span class="lineno"> 1119</span>                        </div>
<div class="line"><span class="lineno"> 1120</span>                        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 1121</span>                            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 1122</span>                                <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 1123</span>                            }</div>
<div class="line"><span class="lineno"> 1124</span>                        }</div>
<div class="line"><span class="lineno"> 1125</span>                    }</div>
<div class="line"><span class="lineno"> 1126</span>                    </div>
<div class="line"><span class="lineno"> 1127</span>                    <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 1128</span>                        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 1129</span>                            <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1130</span>                            <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 1131</span>                        }</div>
<div class="line"><span class="lineno"> 1132</span>                        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1133</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1134</span>                            <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1135</span>                        }</div>
<div class="line"><span class="lineno"> 1136</span>                        </div>
<div class="line"><span class="lineno"> 1137</span>                        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 1138</span>                            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 1139</span>                                <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 1140</span>                            }</div>
<div class="line"><span class="lineno"> 1141</span>                        }</div>
<div class="line"><span class="lineno"> 1142</span>                    }</div>
<div class="line"><span class="lineno"> 1143</span>                });</div>
<div class="line"><span class="lineno"> 1144</span>            }</div>
<div class="line"><span class="lineno"> 1145</span>            </div>
<div class="line"><span class="lineno"> 1146</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1147</span>        }</div>
<div class="line"><span class="lineno"> 1148</span>        </div>
<div class="line"><span class="lineno"> 1149</span>        <span class="comment">// Try broadcasting</span></div>
<div class="line"><span class="lineno"> 1150</span>        <a class="code hl_class" href="classTensor.html">std::string</a> <a class="code hl_class" href="classTensor.html">error_msg</a>;</div>
<div class="line"><span class="lineno"> 1151</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="tensor_8h.html#af558fb1fbf98a2d78e5a85123c232d9f">are_broadcastable</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, &amp;<a class="code hl_class" href="classTensor.html">error_msg</a>)) {</div>
<div class="line"><span class="lineno"> 1152</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 1153</span>        }</div>
<div class="line"><span class="lineno"> 1154</span>        </div>
<div class="line"><span class="lineno"> 1155</span>        <span class="comment">// Determine broadcast shape</span></div>
<div class="line"><span class="lineno"> 1156</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">broadcast_shape</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 1157</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1158</span>            <a class="code hl_class" href="classTensor.html">broadcast_shape</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::max</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>], <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 1159</span>        }</div>
<div class="line"><span class="lineno"> 1160</span>        </div>
<div class="line"><span class="lineno"> 1161</span>        <span class="comment">// Create result with broadcast shape</span></div>
<div class="line"><span class="lineno"> 1162</span>        <span class="keywordtype">bool</span> <a class="code hl_class" href="classTensor.html">track_grad</a> = <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a> || <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>;</div>
<div class="line"><span class="lineno"> 1163</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">broadcast_shape</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_class" href="classTensor.html">track_grad</a>);</div>
<div class="line"><span class="lineno"> 1164</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1165</span>        </div>
<div class="line"><span class="lineno"> 1166</span>        <span class="comment">// Perform broadcasted addition</span></div>
<div class="line"><span class="lineno"> 1167</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1168</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1169</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">coords</a>;</div>
<div class="line"><span class="lineno"> 1170</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">idx</a> = <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 1171</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">d</a> = <a class="code hl_class" href="classTensor.html">N</a>; <a class="code hl_class" href="classTensor.html">d</a> &gt; 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 1172</span>                <a class="code hl_class" href="classTensor.html">coords</a>[<a class="code hl_class" href="classTensor.html">d</a> - 1] = <a class="code hl_class" href="classTensor.html">idx</a> % <a class="code hl_class" href="classTensor.html">broadcast_shape</a>[<a class="code hl_class" href="classTensor.html">d</a> - 1];</div>
<div class="line"><span class="lineno"> 1173</span>                <a class="code hl_class" href="classTensor.html">idx</a> /= <a class="code hl_class" href="classTensor.html">broadcast_shape</a>[<a class="code hl_class" href="classTensor.html">d</a> - 1];</div>
<div class="line"><span class="lineno"> 1174</span>            }</div>
<div class="line"><span class="lineno"> 1175</span>            </div>
<div class="line"><span class="lineno"> 1176</span>            <span class="comment">// Map to source indices</span></div>
<div class="line"><span class="lineno"> 1177</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">self_idx</a> = 0, <a class="code hl_class" href="classTensor.html">other_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 1178</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">self_stride</a> = 1, <a class="code hl_class" href="classTensor.html">other_stride</a> = 1;</div>
<div class="line"><span class="lineno"> 1179</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">d</a> = <a class="code hl_class" href="classTensor.html">N</a>; <a class="code hl_class" href="classTensor.html">d</a> &gt; 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 1180</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dim</a> = <a class="code hl_class" href="classTensor.html">d</a> - 1;</div>
<div class="line"><span class="lineno"> 1181</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">self_coord</a> = (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a>] == 1) ? 0 : <a class="code hl_class" href="classTensor.html">coords</a>[<a class="code hl_class" href="classTensor.html">dim</a>];</div>
<div class="line"><span class="lineno"> 1182</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">other_coord</a> = (<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a>] == 1) ? 0 : <a class="code hl_class" href="classTensor.html">coords</a>[<a class="code hl_class" href="classTensor.html">dim</a>];</div>
<div class="line"><span class="lineno"> 1183</span>                </div>
<div class="line"><span class="lineno"> 1184</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">dim</a> + 1 &lt; <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 1185</span>                    <a class="code hl_class" href="classTensor.html">self_stride</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a> + 1];</div>
<div class="line"><span class="lineno"> 1186</span>                    <a class="code hl_class" href="classTensor.html">other_stride</a> *= <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a> + 1];</div>
<div class="line"><span class="lineno"> 1187</span>                }</div>
<div class="line"><span class="lineno"> 1188</span>                </div>
<div class="line"><span class="lineno"> 1189</span>                <a class="code hl_class" href="classTensor.html">self_idx</a> += <a class="code hl_class" href="classTensor.html">self_coord</a> * <a class="code hl_class" href="classTensor.html">self_stride</a>;</div>
<div class="line"><span class="lineno"> 1190</span>                <a class="code hl_class" href="classTensor.html">other_idx</a> += <a class="code hl_class" href="classTensor.html">other_coord</a> * <a class="code hl_class" href="classTensor.html">other_stride</a>;</div>
<div class="line"><span class="lineno"> 1191</span>            }</div>
<div class="line"><span class="lineno"> 1192</span>            </div>
<div class="line"><span class="lineno"> 1193</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">self_idx</a>] + <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">other_idx</a>];</div>
<div class="line"><span class="lineno"> 1194</span>        }</div>
<div class="line"><span class="lineno"> 1195</span>        </div>
<div class="line"><span class="lineno"> 1196</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 1197</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">track_grad</a>) {</div>
<div class="line"><span class="lineno"> 1198</span>            <span class="comment">// Capture pointers to input tensors</span></div>
<div class="line"><span class="lineno"> 1199</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 1200</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">other_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(&amp;<a class="code hl_class" href="classTensor.html">other</a>);</div>
<div class="line"><span class="lineno"> 1201</span>            </div>
<div class="line"><span class="lineno"> 1202</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">other_ptr</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 1203</span>                <span class="comment">// Gradient of addition: d/dx(x+y) = 1, d/dy(x+y) = 1</span></div>
<div class="line"><span class="lineno"> 1204</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 1205</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 1206</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1207</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 1208</span>                    }</div>
<div class="line"><span class="lineno"> 1209</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1210</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1211</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1212</span>                    }</div>
<div class="line"><span class="lineno"> 1213</span>                    </div>
<div class="line"><span class="lineno"> 1214</span>                    <span class="comment">// If self is not a leaf, propagate gradients further</span></div>
<div class="line"><span class="lineno"> 1215</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 1216</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 1217</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 1218</span>                        }</div>
<div class="line"><span class="lineno"> 1219</span>                    }</div>
<div class="line"><span class="lineno"> 1220</span>                }</div>
<div class="line"><span class="lineno"> 1221</span>                </div>
<div class="line"><span class="lineno"> 1222</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 1223</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 1224</span>                        <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1225</span>                        <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 1226</span>                    }</div>
<div class="line"><span class="lineno"> 1227</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1228</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1229</span>                        <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1230</span>                    }</div>
<div class="line"><span class="lineno"> 1231</span>                    </div>
<div class="line"><span class="lineno"> 1232</span>                    <span class="comment">// If other is not a leaf, propagate gradients further</span></div>
<div class="line"><span class="lineno"> 1233</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 1234</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 1235</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">other_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 1236</span>                        }</div>
<div class="line"><span class="lineno"> 1237</span>                    }</div>
<div class="line"><span class="lineno"> 1238</span>                }</div>
<div class="line"><span class="lineno"> 1239</span>            });</div>
<div class="line"><span class="lineno"> 1240</span>        }</div>
<div class="line"><span class="lineno"> 1241</span>        </div>
<div class="line"><span class="lineno"> 1242</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1243</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4613cd0a8fdde8d4e067384adcba7015" name="a4613cd0a8fdde8d4e067384adcba7015"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4613cd0a8fdde8d4e067384adcba7015">&#9670;&#160;</a></span>operator+=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator+= </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise addition with scalar (in-place). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to add to all elements. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01328">1328</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1328</span>                                              {</div>
<div class="line"><span class="lineno"> 1329</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1330</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1331</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1332</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::add_scalar_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">scalar</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1333</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1334</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1335</span>        {</div>
<div class="line"><span class="lineno"> 1336</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1337</span>                <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_class" href="classTensor.html">scalar</a>;</div>
<div class="line"><span class="lineno"> 1338</span>            }</div>
<div class="line"><span class="lineno"> 1339</span>        }</div>
<div class="line"><span class="lineno"> 1340</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1341</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afe3aaaf08972bed6b0ea4b7b0eb03689" name="afe3aaaf08972bed6b0ea4b7b0eb03689"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe3aaaf08972bed6b0ea4b7b0eb03689">&#9670;&#160;</a></span>operator+=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator+= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise addition with another tensor (in-place). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to add. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>If dimensions don't match, the operation is skipped. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01303">1303</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1303</span>                                                        {</div>
<div class="line"><span class="lineno"> 1304</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 1305</span>            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1306</span>        }</div>
<div class="line"><span class="lineno"> 1307</span>        </div>
<div class="line"><span class="lineno"> 1308</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1309</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1310</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1311</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::add_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1312</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1313</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1314</span>        {</div>
<div class="line"><span class="lineno"> 1315</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1316</span>                <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1317</span>            }</div>
<div class="line"><span class="lineno"> 1318</span>        }</div>
<div class="line"><span class="lineno"> 1319</span>        </div>
<div class="line"><span class="lineno"> 1320</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1321</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a79cd53c980f1a1dde80fc6eeba73743a" name="a79cd53c980f1a1dde80fc6eeba73743a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79cd53c980f1a1dde80fc6eeba73743a">&#9670;&#160;</a></span>operator-() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator- </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Unary negation operator (creates new tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with all elements negated. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01868">1868</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1868</span>                                   {</div>
<div class="line"><span class="lineno"> 1869</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1870</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1871</span>        </div>
<div class="line"><span class="lineno"> 1872</span>        <span class="comment">// Copy data first</span></div>
<div class="line"><span class="lineno"> 1873</span>        <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_class" href="classTensor.html">total</a>, <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno"> 1874</span>        </div>
<div class="line"><span class="lineno"> 1875</span>        <span class="comment">// Negate in place using optimized operations</span></div>
<div class="line"><span class="lineno"> 1876</span><span class="preprocessor">#ifdef USE_BLAS</span></div>
<div class="line"><span class="lineno"> 1877</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1878</span>            <a class="code hl_class" href="classTensor.html">blas_scal</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">total</a>), <a class="code hl_class" href="classTensor.html">T</a>(-1), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), 1);</div>
<div class="line"><span class="lineno"> 1879</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1880</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1881</span>        {</div>
<div class="line"><span class="lineno"> 1882</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1883</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = -<a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1884</span>            }</div>
<div class="line"><span class="lineno"> 1885</span>        }</div>
<div class="line"><span class="lineno"> 1886</span>        </div>
<div class="line"><span class="lineno"> 1887</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1888</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0b67c5a06ac74ab08db3f00e400e61af" name="a0b67c5a06ac74ab08db3f00e400e61af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b67c5a06ac74ab08db3f00e400e61af">&#9670;&#160;</a></span>operator-() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator- </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise subtraction with scalar (creates new tensor). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to subtract from all elements. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with the result. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01424">1424</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1424</span>                                                  {</div>
<div class="line"><span class="lineno"> 1425</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1426</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1427</span>        </div>
<div class="line"><span class="lineno"> 1428</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1429</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1430</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::sub_scalar_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">scalar</a>, <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1431</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1432</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1433</span>        {</div>
<div class="line"><span class="lineno"> 1434</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1435</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] - <a class="code hl_class" href="classTensor.html">scalar</a>;</div>
<div class="line"><span class="lineno"> 1436</span>            }</div>
<div class="line"><span class="lineno"> 1437</span>        }</div>
<div class="line"><span class="lineno"> 1438</span>        </div>
<div class="line"><span class="lineno"> 1439</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1440</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad2e51c1fbe247b637e415e60c3993ea9" name="ad2e51c1fbe247b637e415e60c3993ea9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2e51c1fbe247b637e415e60c3993ea9">&#9670;&#160;</a></span>operator-() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator- </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise subtraction with another tensor (creates new tensor). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to subtract. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing either a new tensor with the result or an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01348">1348</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1348</span>                                                                          {</div>
<div class="line"><span class="lineno"> 1349</span>        <span class="comment">// Check if shapes match exactly</span></div>
<div class="line"><span class="lineno"> 1350</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> == <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 1351</span>            <span class="comment">// Fast path: exact shape match</span></div>
<div class="line"><span class="lineno"> 1352</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1353</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1354</span>            </div>
<div class="line"><span class="lineno"> 1355</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1356</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1357</span>                <a class="code hl_class" href="classTensor.html">ensure_on_gpu</a>();</div>
<div class="line"><span class="lineno"> 1358</span>                <a class="code hl_class" href="classTensor.html">other</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 1359</span>                <a class="code hl_class" href="classTensor.html">result</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 1360</span>                <a class="code hl_class" href="classTensor.html">TensorGPU::sub_gpu_direct</a>(<a class="code hl_class" href="classTensor.html">d_data_</a>, <a class="code hl_class" href="classTensor.html">other</a>.d_data_, <a class="code hl_class" href="classTensor.html">result</a>.d_data_, <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1361</span>                <a class="code hl_class" href="classTensor.html">result</a>.mark_gpu_modified();</div>
<div class="line"><span class="lineno"> 1362</span>            } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1363</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1364</span>            {</div>
<div class="line"><span class="lineno"> 1365</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1366</span>                    <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] - <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1367</span>                }</div>
<div class="line"><span class="lineno"> 1368</span>            }</div>
<div class="line"><span class="lineno"> 1369</span>            </div>
<div class="line"><span class="lineno"> 1370</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1371</span>        }</div>
<div class="line"><span class="lineno"> 1372</span>        </div>
<div class="line"><span class="lineno"> 1373</span>        <span class="comment">// Try broadcasting</span></div>
<div class="line"><span class="lineno"> 1374</span>        <a class="code hl_class" href="classTensor.html">std::string</a> <a class="code hl_class" href="classTensor.html">error_msg</a>;</div>
<div class="line"><span class="lineno"> 1375</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="tensor_8h.html#af558fb1fbf98a2d78e5a85123c232d9f">are_broadcastable</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, &amp;<a class="code hl_class" href="classTensor.html">error_msg</a>)) {</div>
<div class="line"><span class="lineno"> 1376</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 1377</span>        }</div>
<div class="line"><span class="lineno"> 1378</span>        </div>
<div class="line"><span class="lineno"> 1379</span>        <span class="comment">// Determine broadcast shape</span></div>
<div class="line"><span class="lineno"> 1380</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">broadcast_shape</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 1381</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1382</span>            <a class="code hl_class" href="classTensor.html">broadcast_shape</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::max</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>], <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 1383</span>        }</div>
<div class="line"><span class="lineno"> 1384</span>        </div>
<div class="line"><span class="lineno"> 1385</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">broadcast_shape</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1386</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1387</span>        </div>
<div class="line"><span class="lineno"> 1388</span>        <span class="comment">// Perform broadcasted subtraction</span></div>
<div class="line"><span class="lineno"> 1389</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1390</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">coords</a>;</div>
<div class="line"><span class="lineno"> 1391</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">idx</a> = <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 1392</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">d</a> = <a class="code hl_class" href="classTensor.html">N</a>; <a class="code hl_class" href="classTensor.html">d</a> &gt; 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 1393</span>                <a class="code hl_class" href="classTensor.html">coords</a>[<a class="code hl_class" href="classTensor.html">d</a> - 1] = <a class="code hl_class" href="classTensor.html">idx</a> % <a class="code hl_class" href="classTensor.html">broadcast_shape</a>[<a class="code hl_class" href="classTensor.html">d</a> - 1];</div>
<div class="line"><span class="lineno"> 1394</span>                <a class="code hl_class" href="classTensor.html">idx</a> /= <a class="code hl_class" href="classTensor.html">broadcast_shape</a>[<a class="code hl_class" href="classTensor.html">d</a> - 1];</div>
<div class="line"><span class="lineno"> 1395</span>            }</div>
<div class="line"><span class="lineno"> 1396</span>            </div>
<div class="line"><span class="lineno"> 1397</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">self_idx</a> = 0, <a class="code hl_class" href="classTensor.html">other_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 1398</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">self_stride</a> = 1, <a class="code hl_class" href="classTensor.html">other_stride</a> = 1;</div>
<div class="line"><span class="lineno"> 1399</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">d</a> = <a class="code hl_class" href="classTensor.html">N</a>; <a class="code hl_class" href="classTensor.html">d</a> &gt; 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 1400</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dim</a> = <a class="code hl_class" href="classTensor.html">d</a> - 1;</div>
<div class="line"><span class="lineno"> 1401</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">self_coord</a> = (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a>] == 1) ? 0 : <a class="code hl_class" href="classTensor.html">coords</a>[<a class="code hl_class" href="classTensor.html">dim</a>];</div>
<div class="line"><span class="lineno"> 1402</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">other_coord</a> = (<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a>] == 1) ? 0 : <a class="code hl_class" href="classTensor.html">coords</a>[<a class="code hl_class" href="classTensor.html">dim</a>];</div>
<div class="line"><span class="lineno"> 1403</span>                </div>
<div class="line"><span class="lineno"> 1404</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">dim</a> + 1 &lt; <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 1405</span>                    <a class="code hl_class" href="classTensor.html">self_stride</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a> + 1];</div>
<div class="line"><span class="lineno"> 1406</span>                    <a class="code hl_class" href="classTensor.html">other_stride</a> *= <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a> + 1];</div>
<div class="line"><span class="lineno"> 1407</span>                }</div>
<div class="line"><span class="lineno"> 1408</span>                </div>
<div class="line"><span class="lineno"> 1409</span>                <a class="code hl_class" href="classTensor.html">self_idx</a> += <a class="code hl_class" href="classTensor.html">self_coord</a> * <a class="code hl_class" href="classTensor.html">self_stride</a>;</div>
<div class="line"><span class="lineno"> 1410</span>                <a class="code hl_class" href="classTensor.html">other_idx</a> += <a class="code hl_class" href="classTensor.html">other_coord</a> * <a class="code hl_class" href="classTensor.html">other_stride</a>;</div>
<div class="line"><span class="lineno"> 1411</span>            }</div>
<div class="line"><span class="lineno"> 1412</span>            </div>
<div class="line"><span class="lineno"> 1413</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">self_idx</a>] - <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">other_idx</a>];</div>
<div class="line"><span class="lineno"> 1414</span>        }</div>
<div class="line"><span class="lineno"> 1415</span>        </div>
<div class="line"><span class="lineno"> 1416</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1417</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a42121a48ea8b32bcfb25e3b59834bc5c" name="a42121a48ea8b32bcfb25e3b59834bc5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42121a48ea8b32bcfb25e3b59834bc5c">&#9670;&#160;</a></span>operator-=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator-= </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise subtraction with scalar (in-place). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to subtract from all elements. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01473">1473</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1473</span>                                              {</div>
<div class="line"><span class="lineno"> 1474</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1475</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1476</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1477</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::sub_scalar_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">scalar</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1478</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1479</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1480</span>        {</div>
<div class="line"><span class="lineno"> 1481</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1482</span>                <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] -= <a class="code hl_class" href="classTensor.html">scalar</a>;</div>
<div class="line"><span class="lineno"> 1483</span>            }</div>
<div class="line"><span class="lineno"> 1484</span>        }</div>
<div class="line"><span class="lineno"> 1485</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1486</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a57e4d2c4f4d08e48b1a1c0abe573c39c" name="a57e4d2c4f4d08e48b1a1c0abe573c39c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57e4d2c4f4d08e48b1a1c0abe573c39c">&#9670;&#160;</a></span>operator-=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator-= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise subtraction with another tensor (in-place). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to subtract. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>If dimensions don't match, the operation is skipped. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01448">1448</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1448</span>                                                        {</div>
<div class="line"><span class="lineno"> 1449</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 1450</span>            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1451</span>        }</div>
<div class="line"><span class="lineno"> 1452</span>        </div>
<div class="line"><span class="lineno"> 1453</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1454</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1455</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1456</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::sub_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1457</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1458</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1459</span>        {</div>
<div class="line"><span class="lineno"> 1460</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1461</span>                <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] -= <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1462</span>            }</div>
<div class="line"><span class="lineno"> 1463</span>        }</div>
<div class="line"><span class="lineno"> 1464</span>        </div>
<div class="line"><span class="lineno"> 1465</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1466</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aecba99a38d50cec2aa5009513481e2d1" name="aecba99a38d50cec2aa5009513481e2d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecba99a38d50cec2aa5009513481e2d1">&#9670;&#160;</a></span>operator/() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator/ </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise division with scalar (creates new tensor). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to divide all elements by. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with the result. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01800">1800</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1800</span>                                                  {</div>
<div class="line"><span class="lineno"> 1801</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1802</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1803</span>        </div>
<div class="line"><span class="lineno"> 1804</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1805</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1806</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::div_scalar_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">scalar</a>, <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1807</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1808</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1809</span>        {</div>
<div class="line"><span class="lineno"> 1810</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1811</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] / <a class="code hl_class" href="classTensor.html">scalar</a>;</div>
<div class="line"><span class="lineno"> 1812</span>            }</div>
<div class="line"><span class="lineno"> 1813</span>        }</div>
<div class="line"><span class="lineno"> 1814</span>        </div>
<div class="line"><span class="lineno"> 1815</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1816</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e414490131d73889ccb977cc4ef047b" name="a0e414490131d73889ccb977cc4ef047b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e414490131d73889ccb977cc4ef047b">&#9670;&#160;</a></span>operator/() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator/ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise division with another tensor (creates new tensor). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to divide by. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A variant containing either a new tensor with the result or an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01724">1724</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1724</span>                                                                          {</div>
<div class="line"><span class="lineno"> 1725</span>        <span class="comment">// Check if shapes match exactly</span></div>
<div class="line"><span class="lineno"> 1726</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> == <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 1727</span>            <span class="comment">// Fast path: exact shape match</span></div>
<div class="line"><span class="lineno"> 1728</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1729</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1730</span>            </div>
<div class="line"><span class="lineno"> 1731</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1732</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1733</span>                <a class="code hl_class" href="classTensor.html">ensure_on_gpu</a>();</div>
<div class="line"><span class="lineno"> 1734</span>                <a class="code hl_class" href="classTensor.html">other</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 1735</span>                <a class="code hl_class" href="classTensor.html">result</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 1736</span>                <a class="code hl_class" href="classTensor.html">TensorGPU::div_gpu_direct</a>(<a class="code hl_class" href="classTensor.html">d_data_</a>, <a class="code hl_class" href="classTensor.html">other</a>.d_data_, <a class="code hl_class" href="classTensor.html">result</a>.d_data_, <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1737</span>                <a class="code hl_class" href="classTensor.html">result</a>.mark_gpu_modified();</div>
<div class="line"><span class="lineno"> 1738</span>            } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1739</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1740</span>            {</div>
<div class="line"><span class="lineno"> 1741</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1742</span>                    <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] / <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1743</span>                }</div>
<div class="line"><span class="lineno"> 1744</span>            }</div>
<div class="line"><span class="lineno"> 1745</span>            </div>
<div class="line"><span class="lineno"> 1746</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1747</span>        }</div>
<div class="line"><span class="lineno"> 1748</span>        </div>
<div class="line"><span class="lineno"> 1749</span>        <span class="comment">// Try broadcasting</span></div>
<div class="line"><span class="lineno"> 1750</span>        <a class="code hl_class" href="classTensor.html">std::string</a> <a class="code hl_class" href="classTensor.html">error_msg</a>;</div>
<div class="line"><span class="lineno"> 1751</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="tensor_8h.html#af558fb1fbf98a2d78e5a85123c232d9f">are_broadcastable</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, &amp;<a class="code hl_class" href="classTensor.html">error_msg</a>)) {</div>
<div class="line"><span class="lineno"> 1752</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 1753</span>        }</div>
<div class="line"><span class="lineno"> 1754</span>        </div>
<div class="line"><span class="lineno"> 1755</span>        <span class="comment">// Determine broadcast shape</span></div>
<div class="line"><span class="lineno"> 1756</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">broadcast_shape</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 1757</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1758</span>            <a class="code hl_class" href="classTensor.html">broadcast_shape</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::max</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>], <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 1759</span>        }</div>
<div class="line"><span class="lineno"> 1760</span>        </div>
<div class="line"><span class="lineno"> 1761</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">broadcast_shape</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 1762</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1763</span>        </div>
<div class="line"><span class="lineno"> 1764</span>        <span class="comment">// Perform broadcasted division</span></div>
<div class="line"><span class="lineno"> 1765</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1766</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">coords</a>;</div>
<div class="line"><span class="lineno"> 1767</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">idx</a> = <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 1768</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">d</a> = <a class="code hl_class" href="classTensor.html">N</a>; <a class="code hl_class" href="classTensor.html">d</a> &gt; 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 1769</span>                <a class="code hl_class" href="classTensor.html">coords</a>[<a class="code hl_class" href="classTensor.html">d</a> - 1] = <a class="code hl_class" href="classTensor.html">idx</a> % <a class="code hl_class" href="classTensor.html">broadcast_shape</a>[<a class="code hl_class" href="classTensor.html">d</a> - 1];</div>
<div class="line"><span class="lineno"> 1770</span>                <a class="code hl_class" href="classTensor.html">idx</a> /= <a class="code hl_class" href="classTensor.html">broadcast_shape</a>[<a class="code hl_class" href="classTensor.html">d</a> - 1];</div>
<div class="line"><span class="lineno"> 1771</span>            }</div>
<div class="line"><span class="lineno"> 1772</span>            </div>
<div class="line"><span class="lineno"> 1773</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">self_idx</a> = 0, <a class="code hl_class" href="classTensor.html">other_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 1774</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">self_stride</a> = 1, <a class="code hl_class" href="classTensor.html">other_stride</a> = 1;</div>
<div class="line"><span class="lineno"> 1775</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">d</a> = <a class="code hl_class" href="classTensor.html">N</a>; <a class="code hl_class" href="classTensor.html">d</a> &gt; 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 1776</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dim</a> = <a class="code hl_class" href="classTensor.html">d</a> - 1;</div>
<div class="line"><span class="lineno"> 1777</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">self_coord</a> = (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a>] == 1) ? 0 : <a class="code hl_class" href="classTensor.html">coords</a>[<a class="code hl_class" href="classTensor.html">dim</a>];</div>
<div class="line"><span class="lineno"> 1778</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">other_coord</a> = (<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a>] == 1) ? 0 : <a class="code hl_class" href="classTensor.html">coords</a>[<a class="code hl_class" href="classTensor.html">dim</a>];</div>
<div class="line"><span class="lineno"> 1779</span>                </div>
<div class="line"><span class="lineno"> 1780</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">dim</a> + 1 &lt; <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 1781</span>                    <a class="code hl_class" href="classTensor.html">self_stride</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a> + 1];</div>
<div class="line"><span class="lineno"> 1782</span>                    <a class="code hl_class" href="classTensor.html">other_stride</a> *= <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a> + 1];</div>
<div class="line"><span class="lineno"> 1783</span>                }</div>
<div class="line"><span class="lineno"> 1784</span>                </div>
<div class="line"><span class="lineno"> 1785</span>                <a class="code hl_class" href="classTensor.html">self_idx</a> += <a class="code hl_class" href="classTensor.html">self_coord</a> * <a class="code hl_class" href="classTensor.html">self_stride</a>;</div>
<div class="line"><span class="lineno"> 1786</span>                <a class="code hl_class" href="classTensor.html">other_idx</a> += <a class="code hl_class" href="classTensor.html">other_coord</a> * <a class="code hl_class" href="classTensor.html">other_stride</a>;</div>
<div class="line"><span class="lineno"> 1787</span>            }</div>
<div class="line"><span class="lineno"> 1788</span>            </div>
<div class="line"><span class="lineno"> 1789</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">self_idx</a>] / <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">other_idx</a>];</div>
<div class="line"><span class="lineno"> 1790</span>        }</div>
<div class="line"><span class="lineno"> 1791</span>        </div>
<div class="line"><span class="lineno"> 1792</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 1793</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af5d1375e8ccabc8e28631c6caf597699" name="af5d1375e8ccabc8e28631c6caf597699"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5d1375e8ccabc8e28631c6caf597699">&#9670;&#160;</a></span>operator/=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator/= </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise division with scalar (in-place). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to divide all elements by. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01849">1849</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1849</span>                                              {</div>
<div class="line"><span class="lineno"> 1850</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1851</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1852</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1853</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::div_scalar_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">scalar</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1854</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1855</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1856</span>        {</div>
<div class="line"><span class="lineno"> 1857</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1858</span>                <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] /= <a class="code hl_class" href="classTensor.html">scalar</a>;</div>
<div class="line"><span class="lineno"> 1859</span>            }</div>
<div class="line"><span class="lineno"> 1860</span>        }</div>
<div class="line"><span class="lineno"> 1861</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1862</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad83f8e7f5e6a51fe67a6ec3a25662f63" name="ad83f8e7f5e6a51fe67a6ec3a25662f63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad83f8e7f5e6a51fe67a6ec3a25662f63">&#9670;&#160;</a></span>operator/=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator/= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise division with another tensor (in-place). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to divide by. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this tensor. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>If dimensions don't match, the operation is skipped. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01824">1824</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1824</span>                                                        {</div>
<div class="line"><span class="lineno"> 1825</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 1826</span>            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1827</span>        }</div>
<div class="line"><span class="lineno"> 1828</span>        </div>
<div class="line"><span class="lineno"> 1829</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 1830</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 1831</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 1832</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::div_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 1833</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1834</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1835</span>        {</div>
<div class="line"><span class="lineno"> 1836</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 1837</span>                <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] /= <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 1838</span>            }</div>
<div class="line"><span class="lineno"> 1839</span>        }</div>
<div class="line"><span class="lineno"> 1840</span>        </div>
<div class="line"><span class="lineno"> 1841</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 1842</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="acaa2ad71d3cd141fd3f0a506e492d56c" name="acaa2ad71d3cd141fd3f0a506e492d56c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaa2ad71d3cd141fd3f0a506e492d56c">&#9670;&#160;</a></span>operator&lt;() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator&lt; </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise comparison: less than scalar. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to compare with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03099">3099</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3137</span>                                                  {</div>
<div class="line"><span class="lineno"> 3138</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3139</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3140</span>        </div>
<div class="line"><span class="lineno"> 3141</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3142</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &lt; <a class="code hl_class" href="classTensor.html">scalar</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3143</span>        }</div>
<div class="line"><span class="lineno"> 3144</span>        </div>
<div class="line"><span class="lineno"> 3145</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3146</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4a37be92854759ae7891294f57666127" name="a4a37be92854759ae7891294f57666127"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a37be92854759ae7891294f57666127">&#9670;&#160;</a></span>operator&lt;() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator&lt; </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise comparison: less than. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to compare with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03099">3099</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3115</span>                                                            {</div>
<div class="line"><span class="lineno"> 3116</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 3117</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3118</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 3119</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3120</span>        }</div>
<div class="line"><span class="lineno"> 3121</span>        </div>
<div class="line"><span class="lineno"> 3122</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3123</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3124</span>        </div>
<div class="line"><span class="lineno"> 3125</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3126</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &lt; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3127</span>        }</div>
<div class="line"><span class="lineno"> 3128</span>        </div>
<div class="line"><span class="lineno"> 3129</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3130</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af1bf02c8d1a0a04ded404de0493982f2" name="af1bf02c8d1a0a04ded404de0493982f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1bf02c8d1a0a04ded404de0493982f2">&#9670;&#160;</a></span>operator&lt;=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator&lt;= </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise comparison: less than or equal scalar. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to compare with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03175">3175</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3213</span>                                                   {</div>
<div class="line"><span class="lineno"> 3214</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3215</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3216</span>        </div>
<div class="line"><span class="lineno"> 3217</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3218</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &lt;= <a class="code hl_class" href="classTensor.html">scalar</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3219</span>        }</div>
<div class="line"><span class="lineno"> 3220</span>        </div>
<div class="line"><span class="lineno"> 3221</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3222</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a563d023db0ab1338f2831ba24813f835" name="a563d023db0ab1338f2831ba24813f835"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a563d023db0ab1338f2831ba24813f835">&#9670;&#160;</a></span>operator&lt;=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator&lt;= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise comparison: less than or equal. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to compare with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03175">3175</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3191</span>                                                             {</div>
<div class="line"><span class="lineno"> 3192</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 3193</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3194</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 3195</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3196</span>        }</div>
<div class="line"><span class="lineno"> 3197</span>        </div>
<div class="line"><span class="lineno"> 3198</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3199</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3200</span>        </div>
<div class="line"><span class="lineno"> 3201</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3202</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &lt;= <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3203</span>        }</div>
<div class="line"><span class="lineno"> 3204</span>        </div>
<div class="line"><span class="lineno"> 3205</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3206</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a129f7f00cdc80a5ad067a8eb3c910290" name="a129f7f00cdc80a5ad067a8eb3c910290"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a129f7f00cdc80a5ad067a8eb3c910290">&#9670;&#160;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a> &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Assignment operator for deep copying the tensor. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to copy from. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to the assigned tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00759">759</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  759</span>                                           {</div>
<div class="line"><span class="lineno">  760</span>        <span class="keywordflow">if</span> (<span class="keyword">this</span> != &amp;<a class="code hl_class" href="classTensor.html">other</a>) {</div>
<div class="line"><span class="lineno">  761</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  762</span>            <span class="comment">// Free existing GPU memory</span></div>
<div class="line"><span class="lineno">  763</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">d_data_</a>) {</div>
<div class="line"><span class="lineno">  764</span>                <a class="code hl_class" href="classTensor.html">cuda_free_wrapper</a>(<a class="code hl_class" href="classTensor.html">d_data_</a>);</div>
<div class="line"><span class="lineno">  765</span>                <a class="code hl_class" href="classTensor.html">d_data_</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  766</span>            }</div>
<div class="line"><span class="lineno">  767</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  768</span>            </div>
<div class="line"><span class="lineno">  769</span>            <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno">  770</span>            <a class="code hl_variable" href="#af6821d656bfc94c60fe4cd256c1d7402">strides_</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#af6821d656bfc94c60fe4cd256c1d7402">strides_</a>;</div>
<div class="line"><span class="lineno">  771</span>            <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>;</div>
<div class="line"><span class="lineno">  772</span>            <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>;</div>
<div class="line"><span class="lineno">  773</span>            <a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a>;</div>
<div class="line"><span class="lineno">  774</span>            <a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a> = <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>;</div>
<div class="line"><span class="lineno">  775</span>            </div>
<div class="line"><span class="lineno">  776</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno">  777</span>            <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;T[]&gt;</a>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno">  778</span>            </div>
<div class="line"><span class="lineno">  779</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  780</span>            <a class="code hl_class" href="classTensor.html">data_on_gpu_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  781</span>            <a class="code hl_class" href="classTensor.html">gpu_needs_sync_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  782</span>            </div>
<div class="line"><span class="lineno">  783</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno">  784</span>                <span class="comment">// Ensure source has latest data on CPU</span></div>
<div class="line"><span class="lineno">  785</span>                <a class="code hl_class" href="classTensor.html">other</a>.ensure_on_cpu();</div>
<div class="line"><span class="lineno">  786</span>                <span class="comment">// Copy from CPU</span></div>
<div class="line"><span class="lineno">  787</span>                <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_class" href="classTensor.html">total</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno">  788</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  789</span>                <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_class" href="classTensor.html">total</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno">  790</span>            }</div>
<div class="line"><span class="lineno">  791</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  792</span>            <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_class" href="classTensor.html">total</a>, <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno">  793</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  794</span>            </div>
<div class="line"><span class="lineno">  795</span>            <span class="comment">// Copy gradient if it exists</span></div>
<div class="line"><span class="lineno">  796</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno">  797</span>                <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(*<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno">  798</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  799</span>                <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>.reset();</div>
<div class="line"><span class="lineno">  800</span>            }</div>
<div class="line"><span class="lineno">  801</span>        }</div>
<div class="line"><span class="lineno">  802</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno">  803</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a214d0fc69786dddb10d1b334845b29f9" name="a214d0fc69786dddb10d1b334845b29f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a214d0fc69786dddb10d1b334845b29f9">&#9670;&#160;</a></span>operator&gt;() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator&gt; </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise comparison: greater than scalar. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to compare with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03099">3099</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3099</span>                                                  {</div>
<div class="line"><span class="lineno"> 3100</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3101</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3102</span>        </div>
<div class="line"><span class="lineno"> 3103</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3104</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt; <a class="code hl_class" href="classTensor.html">scalar</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3105</span>        }</div>
<div class="line"><span class="lineno"> 3106</span>        </div>
<div class="line"><span class="lineno"> 3107</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3108</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a26deab87b696076f055af17f4386b4d0" name="a26deab87b696076f055af17f4386b4d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26deab87b696076f055af17f4386b4d0">&#9670;&#160;</a></span>operator&gt;() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator&gt; </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise comparison: greater than. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to compare with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03077">3077</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3077</span>                                                            {</div>
<div class="line"><span class="lineno"> 3078</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 3079</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3080</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 3081</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3082</span>        }</div>
<div class="line"><span class="lineno"> 3083</span>        </div>
<div class="line"><span class="lineno"> 3084</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3085</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3086</span>        </div>
<div class="line"><span class="lineno"> 3087</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3088</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt; <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3089</span>        }</div>
<div class="line"><span class="lineno"> 3090</span>        </div>
<div class="line"><span class="lineno"> 3091</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3092</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac107bd4eaca6b12fe51303a692e9ea81" name="ac107bd4eaca6b12fe51303a692e9ea81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac107bd4eaca6b12fe51303a692e9ea81">&#9670;&#160;</a></span>operator&gt;=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator&gt;= </td>
          <td>(</td>
          <td class="paramtype">const T &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise comparison: greater than or equal scalar. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scalar</td><td>The scalar value to compare with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03175">3175</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3175</span>                                                   {</div>
<div class="line"><span class="lineno"> 3176</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3177</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3178</span>        </div>
<div class="line"><span class="lineno"> 3179</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3180</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt;= <a class="code hl_class" href="classTensor.html">scalar</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3181</span>        }</div>
<div class="line"><span class="lineno"> 3182</span>        </div>
<div class="line"><span class="lineno"> 3183</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3184</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2cab1fc8ca70e8d2fa4bce5ff88fabe1" name="a2cab1fc8ca70e8d2fa4bce5ff88fabe1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cab1fc8ca70e8d2fa4bce5ff88fabe1">&#9670;&#160;</a></span>operator&gt;=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator&gt;= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Element-wise comparison: greater than or equal. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The tensor to compare with. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new boolean-like tensor (0 or 1). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03153">3153</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3153</span>                                                             {</div>
<div class="line"><span class="lineno"> 3154</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>) {</div>
<div class="line"><span class="lineno"> 3155</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3156</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 3157</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3158</span>        }</div>
<div class="line"><span class="lineno"> 3159</span>        </div>
<div class="line"><span class="lineno"> 3160</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3161</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3162</span>        </div>
<div class="line"><span class="lineno"> 3163</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3164</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = (<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt;= <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 3165</span>        }</div>
<div class="line"><span class="lineno"> 3166</span>        </div>
<div class="line"><span class="lineno"> 3167</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3168</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="acd343a064481a9fc4a0c8f3d17fc489c" name="acd343a064481a9fc4a0c8f3d17fc489c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd343a064481a9fc4a0c8f3d17fc489c">&#9670;&#160;</a></span>operator[]() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator[] </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>indices</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Indexing operator to access elements. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">indices</td><td>An array of indices for each dimension. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to the element at the specified indices. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00810">810</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  810</span>                                                   {</div>
<div class="line"><span class="lineno">  811</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  812</span>        <a class="code hl_class" href="classTensor.html">ensure_on_cpu</a>();  <span class="comment">// Sync from GPU if needed</span></div>
<div class="line"><span class="lineno">  813</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  814</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_function" href="#acfd498e431d2689e191c1e9cb8d600fb">offset</a>(<a class="code hl_class" href="classTensor.html">indices</a>)];</div>
<div class="line"><span class="lineno">  815</span>    }</div>
<div class="ttc" id="aclassTensor_html_acfd498e431d2689e191c1e9cb8d600fb"><div class="ttname"><a href="#acfd498e431d2689e191c1e9cb8d600fb">Tensor::offset</a></div><div class="ttdeci">size_t offset(const TensorIndices&lt; N &gt; &amp;indices) const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00547">tensor.h:547</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9f1420cd0be3272bdb3b9a3f53d58c76" name="a9f1420cd0be3272bdb3b9a3f53d58c76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f1420cd0be3272bdb3b9a3f53d58c76">&#9670;&#160;</a></span>operator[]() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const T &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::operator[] </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>indices</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Const version of the indexing operator. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">indices</td><td>An array of indices for each dimension. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A const reference to the element at the specified indices. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00822">822</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  822</span>                                                               {</div>
<div class="line"><span class="lineno">  823</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  824</span>        <a class="code hl_class" href="classTensor.html">ensure_on_cpu</a>();  <span class="comment">// Sync from GPU if needed</span></div>
<div class="line"><span class="lineno">  825</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  826</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_function" href="#acfd498e431d2689e191c1e9cb8d600fb">offset</a>(<a class="code hl_class" href="classTensor.html">indices</a>)];</div>
<div class="line"><span class="lineno">  827</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2429005aeaabb920c7cc943f044dd9d8" name="a2429005aeaabb920c7cc943f044dd9d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2429005aeaabb920c7cc943f044dd9d8">&#9670;&#160;</a></span>permute()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::permute </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>axes</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Permute (rearrange) dimensions. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axes</td><td>New order of dimensions (must be a permutation of 0..N-1) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> with permuted dimensions, or zero tensor if axes is invalid </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04658">4658</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4658</span>                                                             {</div>
<div class="line"><span class="lineno"> 4659</span>        <span class="comment">// Validate that axes is a permutation</span></div>
<div class="line"><span class="lineno"> 4660</span>        <a class="code hl_class" href="classTensor.html">std::array&lt;bool, N&gt;</a> <a class="code hl_class" href="classTensor.html">seen</a> = {<span class="keyword">false</span>};</div>
<div class="line"><span class="lineno"> 4661</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4662</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axes</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt;= <a class="code hl_class" href="classTensor.html">N</a> || <a class="code hl_class" href="classTensor.html">seen</a>[<a class="code hl_class" href="classTensor.html">axes</a>[<a class="code hl_class" href="classTensor.html">i</a>]]) {</div>
<div class="line"><span class="lineno"> 4663</span>                <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 4664</span>                <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4665</span>            }</div>
<div class="line"><span class="lineno"> 4666</span>            <a class="code hl_class" href="classTensor.html">seen</a>[<a class="code hl_class" href="classTensor.html">axes</a>[<a class="code hl_class" href="classTensor.html">i</a>]] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4667</span>        }</div>
<div class="line"><span class="lineno"> 4668</span>        </div>
<div class="line"><span class="lineno"> 4669</span>        <span class="comment">// Compute new dimensions</span></div>
<div class="line"><span class="lineno"> 4670</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a>;</div>
<div class="line"><span class="lineno"> 4671</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4672</span>            <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axes</a>[<a class="code hl_class" href="classTensor.html">i</a>]];</div>
<div class="line"><span class="lineno"> 4673</span>        }</div>
<div class="line"><span class="lineno"> 4674</span>        </div>
<div class="line"><span class="lineno"> 4675</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4676</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4677</span>        </div>
<div class="line"><span class="lineno"> 4678</span>        <span class="comment">// Permute data</span></div>
<div class="line"><span class="lineno"> 4679</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4680</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">idx</a> = 0; <a class="code hl_class" href="classTensor.html">idx</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">idx</a>) {</div>
<div class="line"><span class="lineno"> 4681</span>            <span class="comment">// Convert linear index to multi-dimensional indices</span></div>
<div class="line"><span class="lineno"> 4682</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">src_idx</a>;</div>
<div class="line"><span class="lineno"> 4683</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 4684</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">N</a>-1; <a class="code hl_class" href="classTensor.html">i</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4685</span>                <a class="code hl_class" href="classTensor.html">src_idx</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4686</span>                <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4687</span>            }</div>
<div class="line"><span class="lineno"> 4688</span>            </div>
<div class="line"><span class="lineno"> 4689</span>            <span class="comment">// Permute indices</span></div>
<div class="line"><span class="lineno"> 4690</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">dst_idx</a>;</div>
<div class="line"><span class="lineno"> 4691</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4692</span>                <a class="code hl_class" href="classTensor.html">dst_idx</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">src_idx</a>[<a class="code hl_class" href="classTensor.html">axes</a>[<a class="code hl_class" href="classTensor.html">i</a>]];</div>
<div class="line"><span class="lineno"> 4693</span>            }</div>
<div class="line"><span class="lineno"> 4694</span>            </div>
<div class="line"><span class="lineno"> 4695</span>            <a class="code hl_class" href="classTensor.html">result</a>[<a class="code hl_class" href="classTensor.html">dst_idx</a>] = (*this)[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 4696</span>        }</div>
<div class="line"><span class="lineno"> 4697</span>        </div>
<div class="line"><span class="lineno"> 4698</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 4699</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4700</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">inv_axes</a>;</div>
<div class="line"><span class="lineno"> 4701</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4702</span>                <a class="code hl_class" href="classTensor.html">inv_axes</a>[<a class="code hl_class" href="classTensor.html">axes</a>[<a class="code hl_class" href="classTensor.html">i</a>]] = <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4703</span>            }</div>
<div class="line"><span class="lineno"> 4704</span>            </div>
<div class="line"><span class="lineno"> 4705</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4706</span>            </div>
<div class="line"><span class="lineno"> 4707</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">inv_axes</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 4708</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4709</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4710</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, </div>
<div class="line"><span class="lineno"> 4711</span>                                                                          <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4712</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4713</span>                    }</div>
<div class="line"><span class="lineno"> 4714</span>                    </div>
<div class="line"><span class="lineno"> 4715</span>                    <span class="comment">// Gradient flows back with inverse permutation</span></div>
<div class="line"><span class="lineno"> 4716</span>                    <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">grad_permuted</a> = <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.permute(<a class="code hl_class" href="classTensor.html">inv_axes</a>);</div>
<div class="line"><span class="lineno"> 4717</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4718</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4719</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_class" href="classTensor.html">grad_permuted</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4720</span>                    }</div>
<div class="line"><span class="lineno"> 4721</span>                    </div>
<div class="line"><span class="lineno"> 4722</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4723</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4724</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4725</span>                        }</div>
<div class="line"><span class="lineno"> 4726</span>                    }</div>
<div class="line"><span class="lineno"> 4727</span>                }</div>
<div class="line"><span class="lineno"> 4728</span>            });</div>
<div class="line"><span class="lineno"> 4729</span>        }</div>
<div class="line"><span class="lineno"> 4730</span>        </div>
<div class="line"><span class="lineno"> 4731</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4732</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aed782eb734b3ef0dd50e5355e3d883c8" name="aed782eb734b3ef0dd50e5355e3d883c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed782eb734b3ef0dd50e5355e3d883c8">&#9670;&#160;</a></span>pow()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::pow </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>exponent</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply power function to all elements (creates new tensor). </p>
<p>Computes x^exponent for each element. Uses GPU acceleration when available. Supports automatic differentiation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exponent</td><td>The exponent to raise each element to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with pow(x, exponent) applied to all elements</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_pow"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> vec({3});</div>
<div class="line">vec.fill(2.0f);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> squared = vec.pow(2.0f);    <span class="comment">// All elements = 4.0</span></div>
<div class="line"><span class="keyword">auto</span> cubed = vec.pow(3.0f);      <span class="comment">// All elements = 8.0</span></div>
<div class="line"><span class="keyword">auto</span> rooted = vec.pow(0.5f);     <span class="comment">// All elements  1.414 (square root)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// With autograd:</span></div>
<div class="line"><a class="code hl_class" href="classTensor.html">Tensor&lt;float, 1&gt;</a> x({5}, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line">x.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(2.0f);</div>
<div class="line"><span class="keyword">auto</span> y = x.pow(3.0f).sum();  <span class="comment">// sum(x)</span></div>
<div class="line">y.backward();</div>
<div class="line"><span class="comment">// x.grad() contains 3*x</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02114">2114</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2114</span>                                       {</div>
<div class="line"><span class="lineno"> 2115</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2116</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2117</span>        </div>
<div class="line"><span class="lineno"> 2118</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 2119</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 2120</span>                <a class="code hl_class" href="classTensor.html">ensure_on_gpu</a>();</div>
<div class="line"><span class="lineno"> 2121</span>                <a class="code hl_class" href="classTensor.html">result</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 2122</span>                <a class="code hl_class" href="classTensor.html">TensorGPU::pow_gpu_direct</a>(<a class="code hl_class" href="classTensor.html">d_data_</a>, <a class="code hl_class" href="classTensor.html">exponent</a>, <a class="code hl_class" href="classTensor.html">result</a>.d_data_, <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2123</span>                <a class="code hl_class" href="classTensor.html">result</a>.mark_gpu_modified();</div>
<div class="line"><span class="lineno"> 2124</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2125</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2126</span>        {</div>
<div class="line"><span class="lineno"> 2127</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2128</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::pow</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>], <a class="code hl_class" href="classTensor.html">exponent</a>);</div>
<div class="line"><span class="lineno"> 2129</span>            }</div>
<div class="line"><span class="lineno"> 2130</span>        }</div>
<div class="line"><span class="lineno"> 2131</span>        </div>
<div class="line"><span class="lineno"> 2132</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2133</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="acf750ad4eaebe934c9422566ccb63081" name="acf750ad4eaebe934c9422566ccb63081"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf750ad4eaebe934c9422566ccb63081">&#9670;&#160;</a></span>pow_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::pow_derivative </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>exponent</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of power function. d/dx[x^n] = n * x^(n-1) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exponent</td><td>The exponent used in the power function. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with power derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02655">2655</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2655</span>                                                  {</div>
<div class="line"><span class="lineno"> 2656</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([<a class="code hl_class" href="classTensor.html">exponent</a>](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { </div>
<div class="line"><span class="lineno"> 2657</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">exponent</a> * <a class="code hl_class" href="classTensor.html">std::pow</a>(<a class="code hl_class" href="classTensor.html">x</a>, <a class="code hl_class" href="classTensor.html">exponent</a> - <a class="code hl_class" href="classTensor.html">T</a>(1)); </div>
<div class="line"><span class="lineno"> 2658</span>        });</div>
<div class="line"><span class="lineno"> 2659</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afc82c153b9df7088bd28dedb89cf7855" name="afc82c153b9df7088bd28dedb89cf7855"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc82c153b9df7088bd28dedb89cf7855">&#9670;&#160;</a></span>prod()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::prod </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Product of all elements. </p><dl class="section return"><dt>Returns</dt><dd>The product of all tensor elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05511">5511</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5511</span>                   {</div>
<div class="line"><span class="lineno"> 5512</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">result</a> = <a class="code hl_class" href="classTensor.html">T</a>(1);</div>
<div class="line"><span class="lineno"> 5513</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 5514</span>        </div>
<div class="line"><span class="lineno"> 5515</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5516</span>            <a class="code hl_class" href="classTensor.html">result</a> *= <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5517</span>        }</div>
<div class="line"><span class="lineno"> 5518</span>        </div>
<div class="line"><span class="lineno"> 5519</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 5520</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aedbf41ac61911d6ac3dcd6fc32b89f2c" name="aedbf41ac61911d6ac3dcd6fc32b89f2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedbf41ac61911d6ac3dcd6fc32b89f2c">&#9670;&#160;</a></span>put()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::put </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; size_t &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>indices</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>values</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set elements at specific flat indices (fancy indexing assignment). Treats the tensor as a flattened 1D array and sets values at the given indices. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">indices</td><td><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b" title="Type alias for 1D vectors.">Vector</a> of flat indices to set. </td></tr>
    <tr><td class="paramname">values</td><td><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b" title="Type alias for 1D vectors.">Vector</a> of values to set (must match indices size). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04996">4996</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4996</span>                                                                           {</div>
<div class="line"><span class="lineno"> 4997</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">count</a> = <a class="code hl_class" href="classTensor.html">std::min</a>(<a class="code hl_class" href="classTensor.html">indices</a>.size(), <a class="code hl_class" href="classTensor.html">values</a>.size());</div>
<div class="line"><span class="lineno"> 4998</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4999</span>        </div>
<div class="line"><span class="lineno"> 5000</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">count</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5001</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">indices</a>[<a class="code hl_class" href="classTensor.html">i</a>] &lt; <a class="code hl_class" href="classTensor.html">total</a>) {</div>
<div class="line"><span class="lineno"> 5002</span>                <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">indices</a>[<a class="code hl_class" href="classTensor.html">i</a>]] = <a class="code hl_class" href="classTensor.html">values</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5003</span>            }</div>
<div class="line"><span class="lineno"> 5004</span>        }</div>
<div class="line"><span class="lineno"> 5005</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a33b18c3717d32fa9bf3bc40a988523fe" name="a33b18c3717d32fa9bf3bc40a988523fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33b18c3717d32fa9bf3bc40a988523fe">&#9670;&#160;</a></span>quantile()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::quantile </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>q</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute quantile of all elements. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>Quantile value between 0 and 1 (e.g., 0.25 for 25th percentile). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The quantile value or error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02921">2921</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2921</span>                                        {</div>
<div class="line"><span class="lineno"> 2922</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">q</a> &lt; <a class="code hl_class" href="classTensor.html">T</a>(0) || <a class="code hl_class" href="classTensor.html">q</a> &gt; <a class="code hl_class" href="classTensor.html">T</a>(1)) {</div>
<div class="line"><span class="lineno"> 2923</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::InvalidArgument</a>;</div>
<div class="line"><span class="lineno"> 2924</span>        }</div>
<div class="line"><span class="lineno"> 2925</span>        </div>
<div class="line"><span class="lineno"> 2926</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2927</span>        <a class="code hl_class" href="classTensor.html">std::vector&lt;T&gt;</a> <a class="code hl_class" href="classTensor.html">sorted_data</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2928</span>        <a class="code hl_class" href="classTensor.html">std::sort</a>(<a class="code hl_class" href="classTensor.html">sorted_data</a>.begin(), <a class="code hl_class" href="classTensor.html">sorted_data</a>.end());</div>
<div class="line"><span class="lineno"> 2929</span>        </div>
<div class="line"><span class="lineno"> 2930</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">pos</a> = <a class="code hl_class" href="classTensor.html">q</a> * <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">total</a> - 1);</div>
<div class="line"><span class="lineno"> 2931</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">lower</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">pos</a>);</div>
<div class="line"><span class="lineno"> 2932</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">upper</a> = <a class="code hl_class" href="classTensor.html">lower</a> + 1;</div>
<div class="line"><span class="lineno"> 2933</span>        </div>
<div class="line"><span class="lineno"> 2934</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">upper</a> &gt;= <a class="code hl_class" href="classTensor.html">total</a>) {</div>
<div class="line"><span class="lineno"> 2935</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">sorted_data</a>[<a class="code hl_class" href="classTensor.html">total</a> - 1];</div>
<div class="line"><span class="lineno"> 2936</span>        }</div>
<div class="line"><span class="lineno"> 2937</span>        </div>
<div class="line"><span class="lineno"> 2938</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">frac</a> = <a class="code hl_class" href="classTensor.html">pos</a> - <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">lower</a>);</div>
<div class="line"><span class="lineno"> 2939</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">sorted_data</a>[<a class="code hl_class" href="classTensor.html">lower</a>] * (<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">frac</a>) + <a class="code hl_class" href="classTensor.html">sorted_data</a>[<a class="code hl_class" href="classTensor.html">upper</a>] * <a class="code hl_class" href="classTensor.html">frac</a>;</div>
<div class="line"><span class="lineno"> 2940</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad49398c4c5d1a5440b154eea6e3a2720" name="ad49398c4c5d1a5440b154eea6e3a2720"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad49398c4c5d1a5440b154eea6e3a2720">&#9670;&#160;</a></span>rand_uniform()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::rand_uniform </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>min</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(0)</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>max</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(1)</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fill tensor with random values from uniform distribution. </p>
<p>Uses direct pointer access for efficient initialization.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">min</td><td>Minimum value (default: 0.0) </td></tr>
    <tr><td class="paramname">max</td><td>Maximum value (default: 1.0)</td></tr>
  </table>
  </dd>
</dl>
<h1 class="doxsection"><a class="anchor" id="example_rand_uniform"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> dropout_mask({batch_size, features});</div>
<div class="line">dropout_mask.rand_uniform(0.0f, 1.0f);</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05883">5883</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5883</span>                                                  {</div>
<div class="line"><span class="lineno"> 5884</span>        <a class="code hl_class" href="classTensor.html">std::random_device</a> <a class="code hl_class" href="classTensor.html">rd</a>;</div>
<div class="line"><span class="lineno"> 5885</span>        <a class="code hl_class" href="classTensor.html">std::mt19937</a> <a class="code hl_class" href="classTensor.html">gen</a>(<a class="code hl_class" href="classTensor.html">rd</a>());</div>
<div class="line"><span class="lineno"> 5886</span>        <a class="code hl_class" href="classTensor.html">std::uniform_real_distribution&lt;T&gt;</a> <a class="code hl_class" href="classTensor.html">dist</a>(<a class="code hl_function" href="#a20cb276f18c104077f75c6f712e4107b">min</a>, <a class="code hl_function" href="#a421ff1c638234245b00425702d3f23aa">max</a>);</div>
<div class="line"><span class="lineno"> 5887</span>        </div>
<div class="line"><span class="lineno"> 5888</span>        <a class="code hl_class" href="classTensor.html">T</a>* <a class="code hl_function" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get();</div>
<div class="line"><span class="lineno"> 5889</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 5890</span>        </div>
<div class="line"><span class="lineno"> 5891</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5892</span>            <a class="code hl_function" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">dist</a>(<a class="code hl_class" href="classTensor.html">gen</a>);</div>
<div class="line"><span class="lineno"> 5893</span>        }</div>
<div class="line"><span class="lineno"> 5894</span>    }</div>
<div class="ttc" id="aclassTensor_html_a20cb276f18c104077f75c6f712e4107b"><div class="ttname"><a href="#a20cb276f18c104077f75c6f712e4107b">Tensor::min</a></div><div class="ttdeci">T min() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l02946">tensor.h:2946</a></div></div>
<div class="ttc" id="aclassTensor_html_a421ff1c638234245b00425702d3f23aa"><div class="ttname"><a href="#a421ff1c638234245b00425702d3f23aa">Tensor::max</a></div><div class="ttdeci">T max() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l02961">tensor.h:2961</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeb090a8d70264aca77202fd451cae051" name="aeb090a8d70264aca77202fd451cae051"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb090a8d70264aca77202fd451cae051">&#9670;&#160;</a></span>randn()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::randn </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>mean</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(0)</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>stddev</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(1)</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fill tensor with random values from normal distribution. </p>
<p>Uses direct pointer access for efficient initialization.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mean</td><td>Mean of the distribution (default: 0.0) </td></tr>
    <tr><td class="paramname">stddev</td><td>Standard deviation (default: 1.0)</td></tr>
  </table>
  </dd>
</dl>
<h1 class="doxsection"><a class="anchor" id="example_randn"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> weights({hidden_size, input_size});</div>
<div class="line">weights.randn(0.0f, 0.01f);  <span class="comment">// Initialize with small random values</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05856">5856</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5856</span>                                               {</div>
<div class="line"><span class="lineno"> 5857</span>        <a class="code hl_class" href="classTensor.html">std::random_device</a> <a class="code hl_class" href="classTensor.html">rd</a>;</div>
<div class="line"><span class="lineno"> 5858</span>        <a class="code hl_class" href="classTensor.html">std::mt19937</a> <a class="code hl_class" href="classTensor.html">gen</a>(<a class="code hl_class" href="classTensor.html">rd</a>());</div>
<div class="line"><span class="lineno"> 5859</span>        <a class="code hl_class" href="classTensor.html">std::normal_distribution&lt;T&gt;</a> <a class="code hl_class" href="classTensor.html">dist</a>(<a class="code hl_function" href="#a84b27bf0213ab3f228c2efe5ca31eaec">mean</a>, <a class="code hl_class" href="classTensor.html">stddev</a>);</div>
<div class="line"><span class="lineno"> 5860</span>        </div>
<div class="line"><span class="lineno"> 5861</span>        <a class="code hl_class" href="classTensor.html">T</a>* <a class="code hl_function" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get();</div>
<div class="line"><span class="lineno"> 5862</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 5863</span>        </div>
<div class="line"><span class="lineno"> 5864</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5865</span>            <a class="code hl_function" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">dist</a>(<a class="code hl_class" href="classTensor.html">gen</a>);</div>
<div class="line"><span class="lineno"> 5866</span>        }</div>
<div class="line"><span class="lineno"> 5867</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af274147e833dd1ab399ce08155ad169b" name="af274147e833dd1ab399ce08155ad169b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af274147e833dd1ab399ce08155ad169b">&#9670;&#160;</a></span>register_backward()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::register_backward </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tensor_8h.html#a1e846f46f87b55f57de12d6aa70eda1e">BackwardFunc</a>&lt; T, N &gt;</td>          <td class="paramname"><span class="paramname"><em>func</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Register a backward function for this tensor. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">func</td><td>The function to call during backward pass. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l01046">1046</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1046</span>                                                    {</div>
<div class="line"><span class="lineno"> 1047</span>        <a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.push_back(<a class="code hl_class" href="classTensor.html">func</a>);</div>
<div class="line"><span class="lineno"> 1048</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_af274147e833dd1ab399ce08155ad169b_icgraph.png" border="0" usemap="#aclassTensor_af274147e833dd1ab399ce08155ad169b_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_af274147e833dd1ab399ce08155ad169b_icgraph" id="aclassTensor_af274147e833dd1ab399ce08155ad169b_icgraph">
<area shape="rect" title=" " alt="" coords="462,427,636,453"/>
<area shape="rect" href="classTensor.html#a265342749ca5f239466cb467bbf73277" title=" " alt="" coords="255,5,388,32"/>
<area shape="poly" title=" " alt="" coords="544,411,537,338,517,239,500,187,477,135,448,88,412,46,387,31,390,26,416,42,453,85,482,133,505,185,522,238,542,337,550,411"/>
<area shape="rect" href="classTensor.html#a7a0af0b59b00d2f2623609ff3562f087" title=" " alt="" coords="230,56,414,83"/>
<area shape="poly" title=" " alt="" coords="543,411,532,346,510,261,493,217,472,173,445,132,412,97,395,85,398,81,416,93,449,129,476,170,498,214,515,260,538,345,548,411"/>
<area shape="rect" href="classTensor.html#a834720ab65874a6c5503f7670c4f22fe" title=" " alt="" coords="257,107,387,149"/>
<area shape="poly" title=" " alt="" coords="539,412,524,360,499,293,462,224,439,192,412,163,386,147,389,142,416,159,443,188,467,221,504,291,530,358,544,411"/>
<area shape="rect" href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7" title="Mean Squared Error (MSE) Loss." alt="" coords="267,173,376,200"/>
<area shape="poly" title=" " alt="" coords="537,413,520,369,494,315,458,260,437,236,412,214,395,204,376,197,378,192,397,199,416,210,440,232,462,257,498,312,525,367,542,411"/>
<area shape="rect" href="classTensor.html#a808dc758321fc810256e3efd13042c98" title=" " alt="" coords="239,224,404,251"/>
<area shape="poly" title=" " alt="" coords="532,414,513,380,486,339,452,299,413,265,391,254,393,249,415,260,456,295,490,336,518,377,537,411"/>
<area shape="rect" href="classTensor.html#af352346a629f774750b12c97234979a9" title=" " alt="" coords="239,275,404,301"/>
<area shape="poly" title=" " alt="" coords="526,416,477,365,446,338,413,316,387,304,389,300,415,311,450,334,481,361,530,413"/>
<area shape="rect" href="classTensor.html#aab73fe3969bc9ab6b35a89c3787f2a22" title=" " alt="" coords="238,325,406,352"/>
<area shape="poly" title=" " alt="" coords="513,420,467,393,413,366,380,355,382,350,415,362,469,388,516,416"/>
<area shape="rect" href="classTensor.html#a1947fa453cc8c0a746b26d2481bb6b39" title=" " alt="" coords="238,376,406,403"/>
<area shape="poly" title=" " alt="" coords="470,425,384,406,386,401,472,420"/>
<area shape="rect" href="classTensor.html#a2429005aeaabb920c7cc943f044dd9d8" title=" " alt="" coords="242,427,402,453"/>
<area shape="poly" title=" " alt="" coords="446,443,403,443,403,437,446,437"/>
<area shape="rect" href="classTensor.html#a74db7588a7150d94b620ad63de1f5980" title=" " alt="" coords="255,477,389,504"/>
<area shape="poly" title=" " alt="" coords="472,460,386,479,384,474,470,455"/>
<area shape="rect" href="classTensor.html#af7f0645bcaf472ac0f6214d2b1effd40" title=" " alt="" coords="242,528,402,555"/>
<area shape="poly" title=" " alt="" coords="516,464,469,492,415,518,382,530,380,525,413,514,467,487,513,460"/>
<area shape="rect" href="classTensor.html#afff455663faa35d6cfa72aa03f689e94" title=" " alt="" coords="243,579,401,605"/>
<area shape="poly" title=" " alt="" coords="530,467,481,519,450,546,415,569,389,580,387,576,413,564,446,542,477,515,526,464"/>
<area shape="rect" href="classTensor.html#a4ae322784a9d62e8db2c073f5e2395f7" title=" " alt="" coords="242,629,402,656"/>
<area shape="poly" title=" " alt="" coords="537,469,518,503,490,544,456,585,415,620,393,631,391,626,413,615,452,581,486,541,513,500,532,466"/>
<area shape="rect" href="classTensor.html#a46d44bb69fc3f0b7376ea35e21903b97" title=" " alt="" coords="241,680,403,707"/>
<area shape="poly" title=" " alt="" coords="542,469,525,513,498,568,462,623,440,648,416,670,396,682,393,677,412,666,437,644,458,620,494,565,520,511,537,467"/>
<area shape="rect" href="classTensor.html#ac20a4679e14de6f68e148b447496adfc" title=" " alt="" coords="237,731,406,757"/>
<area shape="poly" title=" " alt="" coords="545,469,531,522,506,590,468,661,444,693,416,721,397,732,394,728,412,717,440,689,464,658,501,588,526,521,540,468"/>
<area shape="rect" href="classTensor.html#aed9419fabd015e2c1c35ff6723c1600a" title=" " alt="" coords="237,781,407,808"/>
<area shape="poly" title=" " alt="" coords="547,469,536,532,513,613,496,656,474,698,448,737,416,771,398,783,395,779,412,767,444,734,470,695,491,654,508,611,531,531,542,468"/>
<area shape="rect" href="classTensor.html#ac953ca944380b138ad1e524a1124070f" title=" " alt="" coords="234,832,410,859"/>
<area shape="poly" title=" " alt="" coords="549,469,541,540,520,635,503,686,480,735,451,781,416,822,399,834,396,829,412,818,447,778,476,733,498,684,515,634,536,539,544,469"/>
<area shape="rect" href="classTensor.html#adf1fcb0ddd0ef2db3003401db519ec1c" title=" " alt="" coords="5,705,182,732"/>
<area shape="poly" title=" " alt="" coords="222,736,182,731,182,726,222,730"/>
<area shape="rect" href="classTensor.html#aeb3f6a9bf8ee28d46a887238a9d3d460" title=" " alt="" coords="5,756,182,783"/>
<area shape="poly" title=" " alt="" coords="222,758,182,762,182,757,222,752"/>
</map>
</div>

</div>
</div>
<a id="a74db7588a7150d94b620ad63de1f5980" name="a74db7588a7150d94b620ad63de1f5980"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74db7588a7150d94b620ad63de1f5980">&#9670;&#160;</a></span>relu()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::relu </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply ReLU (Rectified Linear Unit) to all elements (creates new tensor). </p>
<p>Computes ReLU(x) = max(0, x) for each element. Most widely used activation function in deep learning due to its simplicity and effectiveness in preventing vanishing gradients.</p>
<p>Properties:</p><ul>
<li>Non-linearity without saturation for positive values</li>
<li>Sparse activation (outputs 0 for negative inputs)</li>
<li>Computationally efficient</li>
</ul>
<p>Supports automatic differentiation.</p>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with ReLU(x) applied to all elements</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_relu"></a>
Example</h1>
<div class="fragment"><div class="line"><span class="comment">// Hidden layer in neural network</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> hidden({32, 128}, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="keyword">auto</span> activated = hidden.relu();  <span class="comment">// Apply ReLU activation</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Full network layer example:</span></div>
<div class="line"><span class="keyword">auto</span> layer1 = (input.matmul(W1) + b1).relu();</div>
<div class="line"><span class="keyword">auto</span> layer2 = (layer1.matmul(W2) + b2).relu();</div>
<div class="line"><span class="keyword">auto</span> output = layer2.matmul(W3) + b3;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// With autograd:</span></div>
<div class="line"><span class="keyword">auto</span> <a class="code hl_namespace" href="namespaceloss.html">loss</a> = <a class="code hl_function" href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7">loss::mse_loss</a>(output, target);</div>
<div class="line"><a class="code hl_namespace" href="namespaceloss.html">loss</a>.backward();  <span class="comment">// Gradients flow through ReLU layers</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02364">2364</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2364</span>                              {</div>
<div class="line"><span class="lineno"> 2365</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 2366</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2367</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2368</span>        </div>
<div class="line"><span class="lineno"> 2369</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 2370</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 2371</span>                <a class="code hl_class" href="classTensor.html">ensure_on_gpu</a>();</div>
<div class="line"><span class="lineno"> 2372</span>                <a class="code hl_class" href="classTensor.html">result</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 2373</span>                <a class="code hl_class" href="classTensor.html">TensorGPU::relu_gpu_direct</a>(<a class="code hl_class" href="classTensor.html">d_data_</a>, <a class="code hl_class" href="classTensor.html">result</a>.d_data_, <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2374</span>                <a class="code hl_class" href="classTensor.html">result</a>.mark_gpu_modified();</div>
<div class="line"><span class="lineno"> 2375</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2376</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2377</span>        {</div>
<div class="line"><span class="lineno"> 2378</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2379</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] &gt; <a class="code hl_class" href="classTensor.html">T</a>(0) ? <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2380</span>            }</div>
<div class="line"><span class="lineno"> 2381</span>        }</div>
<div class="line"><span class="lineno"> 2382</span>        </div>
<div class="line"><span class="lineno"> 2383</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 2384</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 2385</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">input_copy</a> = this-&gt;<a class="code hl_function" href="#ae5b52299c11f3ba81e781cb008542285">detach</a>();</div>
<div class="line"><span class="lineno"> 2386</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2387</span>            </div>
<div class="line"><span class="lineno"> 2388</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">input_copy</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 2389</span>                <span class="comment">// Gradient of ReLU: d/dx[ReLU(x)] = 1 if x &gt; 0, else 0</span></div>
<div class="line"><span class="lineno"> 2390</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 2391</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 2392</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2393</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 2394</span>                    }</div>
<div class="line"><span class="lineno"> 2395</span>                    </div>
<div class="line"><span class="lineno"> 2396</span>                    <span class="comment">// Optimized using tensor operations - create mask</span></div>
<div class="line"><span class="lineno"> 2397</span>                    <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_function" href="tensor_8h.html#a249e6ed21f6e3540a11b62433237175a">zeros</a>(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2398</span>                    <a class="code hl_class" href="classTensor.html">zeros</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 2399</span>                    <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">mask</a> = <a class="code hl_class" href="classTensor.html">input_copy</a> &gt; <a class="code hl_class" href="classTensor.html">zeros</a>;</div>
<div class="line"><span class="lineno"> 2400</span>                    <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">grad_result</a> = <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a> * <a class="code hl_class" href="classTensor.html">mask</a>;</div>
<div class="line"><span class="lineno"> 2401</span>                    <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">grad_contrib</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">grad_result</a>);</div>
<div class="line"><span class="lineno"> 2402</span>                    </div>
<div class="line"><span class="lineno"> 2403</span>                    <span class="comment">// Accumulate gradients using tensor addition</span></div>
<div class="line"><span class="lineno"> 2404</span>                    <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">grad_sum_result</a> = *<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> + <a class="code hl_class" href="classTensor.html">grad_contrib</a>;</div>
<div class="line"><span class="lineno"> 2405</span>                    *<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">grad_sum_result</a>);</div>
<div class="line"><span class="lineno"> 2406</span>                }</div>
<div class="line"><span class="lineno"> 2407</span>            });</div>
<div class="line"><span class="lineno"> 2408</span>        }</div>
<div class="line"><span class="lineno"> 2409</span>        </div>
<div class="line"><span class="lineno"> 2410</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2411</span>    }</div>
<div class="ttc" id="atensor_8h_html_a249e6ed21f6e3540a11b62433237175a"><div class="ttname"><a href="tensor_8h.html#a249e6ed21f6e3540a11b62433237175a">zeros</a></div><div class="ttdeci">Tensor&lt; T, N &gt; zeros(const TensorIndices&lt; N &gt; &amp;shape, bool use_gpu=true)</div><div class="ttdoc">Create a tensor filled with zeros (NumPy-compatible).</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l06971">tensor.h:6971</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a74db7588a7150d94b620ad63de1f5980_icgraph.png" border="0" usemap="#aclassTensor_a74db7588a7150d94b620ad63de1f5980_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a74db7588a7150d94b620ad63de1f5980_icgraph" id="aclassTensor_a74db7588a7150d94b620ad63de1f5980_icgraph">
<area shape="rect" title="Apply ReLU (Rectified Linear Unit) to all elements (creates new tensor)." alt="" coords="189,13,278,40"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1ReLU.html#a07b3b9bee90208e9510c4cc740639689" title=" " alt="" coords="5,5,141,48"/>
<area shape="poly" title=" " alt="" coords="173,29,141,29,141,24,173,24"/>
</map>
</div>

</div>
</div>
<a id="a780523f1c499b857930f305b22aae9aa" name="a780523f1c499b857930f305b22aae9aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a780523f1c499b857930f305b22aae9aa">&#9670;&#160;</a></span>relu_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::relu_derivative </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of ReLU function. d/dx[ReLU(x)] = 1 if x &gt; 0, else 0 </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with ReLU derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02608">2608</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2608</span>                                         {</div>
<div class="line"><span class="lineno"> 2609</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">x</a> &gt; <a class="code hl_class" href="classTensor.html">T</a>(0) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0); });</div>
<div class="line"><span class="lineno"> 2610</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9905069af5b17d1a5d1c16ec6f0a80fa" name="a9905069af5b17d1a5d1c16ec6f0a80fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9905069af5b17d1a5d1c16ec6f0a80fa">&#9670;&#160;</a></span>repeat()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::repeat </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>repeats</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Repeat tensor along dimensions. Each dimension is repeated the specified number of times. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">repeats</td><td>Number of times to repeat along each dimension </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with repeated elements</dd></dl>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> A({2, 3});</div>
<div class="line">A.fill(1.0f);</div>
<div class="line"><span class="keyword">auto</span> B = A.repeat({2, 3});  <span class="comment">// Result is {4, 9} with repeated values</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05583">5583</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5583</span>                                                               {</div>
<div class="line"><span class="lineno"> 5584</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a>;</div>
<div class="line"><span class="lineno"> 5585</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5586</span>            <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">repeats</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5587</span>        }</div>
<div class="line"><span class="lineno"> 5588</span>        </div>
<div class="line"><span class="lineno"> 5589</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 5590</span>        </div>
<div class="line"><span class="lineno"> 5591</span>        <span class="comment">// Helper function to convert flat index to multi-dimensional indices</span></div>
<div class="line"><span class="lineno"> 5592</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">flat_to_indices</a> = [](<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">flat</a>, <span class="keyword">const</span> <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a>&amp; <a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>) {</div>
<div class="line"><span class="lineno"> 5593</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">indices</a>;</div>
<div class="line"><span class="lineno"> 5594</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">N</a> - 1; <a class="code hl_class" href="classTensor.html">i</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5595</span>                <a class="code hl_class" href="classTensor.html">indices</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">flat</a> % <a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5596</span>                <a class="code hl_class" href="classTensor.html">flat</a> /= <a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5597</span>            }</div>
<div class="line"><span class="lineno"> 5598</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">indices</a>;</div>
<div class="line"><span class="lineno"> 5599</span>        };</div>
<div class="line"><span class="lineno"> 5600</span>        </div>
<div class="line"><span class="lineno"> 5601</span>        <span class="comment">// Helper function to convert multi-dimensional indices to flat index</span></div>
<div class="line"><span class="lineno"> 5602</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">indices_to_flat</a> = [](<span class="keyword">const</span> <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a>&amp; <a class="code hl_class" href="classTensor.html">indices</a>, <span class="keyword">const</span> <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a>&amp; <a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>) {</div>
<div class="line"><span class="lineno"> 5603</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">flat</a> = 0;</div>
<div class="line"><span class="lineno"> 5604</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">multiplier</a> = 1;</div>
<div class="line"><span class="lineno"> 5605</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">N</a> - 1; <a class="code hl_class" href="classTensor.html">i</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5606</span>                <a class="code hl_class" href="classTensor.html">flat</a> += <a class="code hl_class" href="classTensor.html">indices</a>[<a class="code hl_class" href="classTensor.html">i</a>] * <a class="code hl_class" href="classTensor.html">multiplier</a>;</div>
<div class="line"><span class="lineno"> 5607</span>                <a class="code hl_class" href="classTensor.html">multiplier</a> *= <a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5608</span>            }</div>
<div class="line"><span class="lineno"> 5609</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">flat</a>;</div>
<div class="line"><span class="lineno"> 5610</span>        };</div>
<div class="line"><span class="lineno"> 5611</span>        </div>
<div class="line"><span class="lineno"> 5612</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total_new</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 5613</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total_new</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5614</span>            <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">new_indices</a> = <a class="code hl_class" href="classTensor.html">flat_to_indices</a>(<a class="code hl_class" href="classTensor.html">i</a>, <a class="code hl_class" href="classTensor.html">new_dims</a>);</div>
<div class="line"><span class="lineno"> 5615</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">src_indices</a>;</div>
<div class="line"><span class="lineno"> 5616</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">j</a> = 0; <a class="code hl_class" href="classTensor.html">j</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">j</a>) {</div>
<div class="line"><span class="lineno"> 5617</span>                <a class="code hl_class" href="classTensor.html">src_indices</a>[<a class="code hl_class" href="classTensor.html">j</a>] = <a class="code hl_class" href="classTensor.html">new_indices</a>[<a class="code hl_class" href="classTensor.html">j</a>] % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">j</a>];</div>
<div class="line"><span class="lineno"> 5618</span>            }</div>
<div class="line"><span class="lineno"> 5619</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">indices_to_flat</a>(<a class="code hl_class" href="classTensor.html">src_indices</a>, <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>);</div>
<div class="line"><span class="lineno"> 5620</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 5621</span>        }</div>
<div class="line"><span class="lineno"> 5622</span>        </div>
<div class="line"><span class="lineno"> 5623</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 5624</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a947326cf96b1bf3423b40861e1213ab8" name="a947326cf96b1bf3423b40861e1213ab8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a947326cf96b1bf3423b40861e1213ab8">&#9670;&#160;</a></span>requires_grad()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::requires_grad </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if this tensor requires gradients. </p><dl class="section return"><dt>Returns</dt><dd>True if gradients are being tracked. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00938">938</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  938</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>; }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a947326cf96b1bf3423b40861e1213ab8_icgraph.png" border="0" usemap="#aclassTensor_a947326cf96b1bf3423b40861e1213ab8_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a947326cf96b1bf3423b40861e1213ab8_icgraph" id="aclassTensor_a947326cf96b1bf3423b40861e1213ab8_icgraph">
<area shape="rect" title=" " alt="" coords="220,148,366,175"/>
<area shape="rect" href="namespaceloss.html#a365059b00ea1e6ec1db86710cfcf3b31" title="Binary cross entropy loss for binary classification." alt="" coords="25,5,152,48"/>
<area shape="poly" title=" " alt="" coords="266,139,223,100,170,62,149,51,151,46,173,58,226,96,269,135"/>
<area shape="rect" href="namespaceloss.html#a75edef9d102d2ab811b15c50f13c4eee" title="Cross entropy loss for multi&#45;class classification." alt="" coords="5,72,172,99"/>
<area shape="poly" title=" " alt="" coords="246,144,171,113,137,102,139,97,173,108,248,139"/>
<area shape="rect" href="namespaceloss.html#ab7fbd0200f34e3d12f66d20b681a948f" title="L1 loss (Mean Absolute Error)." alt="" coords="41,123,136,149"/>
<area shape="poly" title=" " alt="" coords="204,153,135,144,136,139,205,148"/>
<area shape="rect" href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7" title="Mean Squared Error (MSE) Loss." alt="" coords="34,173,143,200"/>
<area shape="poly" title=" " alt="" coords="205,175,144,183,143,177,204,170"/>
<area shape="rect" href="namespacelinalg.html#afbe723a0bf8fb7dc2d98815c1ea724b2" title="Normalize a vector to unit length." alt="" coords="31,224,146,251"/>
<area shape="poly" title=" " alt="" coords="248,184,173,215,139,226,137,221,171,209,246,179"/>
<area shape="rect" href="namespaceloss.html#a2d2c1dacdb37d834f7dc10e85cd1a742" title="Smooth L1 loss (Huber loss)." alt="" coords="16,275,161,301"/>
<area shape="poly" title=" " alt="" coords="270,188,227,227,173,265,147,276,145,272,170,260,224,223,266,184"/>
</map>
</div>

</div>
</div>
<a id="af7f0645bcaf472ac0f6214d2b1effd40" name="af7f0645bcaf472ac0f6214d2b1effd40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7f0645bcaf472ac0f6214d2b1effd40">&#9670;&#160;</a></span>reshape()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, M &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::reshape </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>new_dims</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Reshape tensor to new dimensions without copying data. Total size must remain the same. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">new_dims</td><td>New dimensions </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reshaped tensor (view of same data), or zero tensor if size doesn't match </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04523">4523</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4523</span>                                                                 {</div>
<div class="line"><span class="lineno"> 4524</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">new_total</a> = 1;</div>
<div class="line"><span class="lineno"> 4525</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">M</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4526</span>            <a class="code hl_class" href="classTensor.html">new_total</a> *= <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4527</span>        }</div>
<div class="line"><span class="lineno"> 4528</span>        </div>
<div class="line"><span class="lineno"> 4529</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">new_total</a> != <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>()) {</div>
<div class="line"><span class="lineno"> 4530</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;M&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 4531</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, M&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4532</span>        }</div>
<div class="line"><span class="lineno"> 4533</span>        </div>
<div class="line"><span class="lineno"> 4534</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, M&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4535</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4536</span>        </div>
<div class="line"><span class="lineno"> 4537</span>        <span class="comment">// Copy data</span></div>
<div class="line"><span class="lineno"> 4538</span>        <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno"> 4539</span>        </div>
<div class="line"><span class="lineno"> 4540</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 4541</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4542</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">orig_dims</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 4543</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4544</span>            </div>
<div class="line"><span class="lineno"> 4545</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">orig_dims</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, M&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 4546</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4547</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4548</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">orig_dims</a>, </div>
<div class="line"><span class="lineno"> 4549</span>                                                                          <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4550</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4551</span>                    }</div>
<div class="line"><span class="lineno"> 4552</span>                    </div>
<div class="line"><span class="lineno"> 4553</span>                    <span class="comment">// Gradient flows back with same reshape</span></div>
<div class="line"><span class="lineno"> 4554</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4555</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4556</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4557</span>                    }</div>
<div class="line"><span class="lineno"> 4558</span>                    </div>
<div class="line"><span class="lineno"> 4559</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4560</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4561</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4562</span>                        }</div>
<div class="line"><span class="lineno"> 4563</span>                    }</div>
<div class="line"><span class="lineno"> 4564</span>                }</div>
<div class="line"><span class="lineno"> 4565</span>            });</div>
<div class="line"><span class="lineno"> 4566</span>        }</div>
<div class="line"><span class="lineno"> 4567</span>        </div>
<div class="line"><span class="lineno"> 4568</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4569</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa25623075f40e0244dd4c2a649e2b3d5" name="aa25623075f40e0244dd4c2a649e2b3d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa25623075f40e0244dd4c2a649e2b3d5">&#9670;&#160;</a></span>rightCols()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::rightCols </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract rightmost n columns (only for 2D tensors). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of columns to extract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>2D tensor containing rightmost n columns </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05744">5744</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5744</span>                                           {</div>
<div class="line"><span class="lineno"> 5745</span>        <a class="code hl_class" href="classTensor.html">return ::rightCols</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)), <a class="code hl_class" href="classTensor.html">n</a>);</div>
<div class="line"><span class="lineno"> 5746</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2daa379012cbb23c00fe3ac60bde0122" name="a2daa379012cbb23c00fe3ac60bde0122"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2daa379012cbb23c00fe3ac60bde0122">&#9670;&#160;</a></span>round()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::round </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply round function to all elements (creates new tensor). Rounds to nearest integer value. </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with round(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02457">2457</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2457</span>                               {</div>
<div class="line"><span class="lineno"> 2458</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::round</a>(<a class="code hl_class" href="classTensor.html">x</a>); });</div>
<div class="line"><span class="lineno"> 2459</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4ff4d01c7fdd48791ebe12a02dbeb655" name="a4ff4d01c7fdd48791ebe12a02dbeb655"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ff4d01c7fdd48791ebe12a02dbeb655">&#9670;&#160;</a></span>row()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::row </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>row_idx</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract a single row (only for 2D tensors). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">row_idx</td><td>Row index to extract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1D tensor containing the row </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05651">5651</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5651</span>                                           {</div>
<div class="line"><span class="lineno"> 5652</span>        <a class="code hl_class" href="classTensor.html">return ::row</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)), <a class="code hl_class" href="classTensor.html">row_idx</a>);</div>
<div class="line"><span class="lineno"> 5653</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a54c613dc9fe3b552a5e9de8966408fd9" name="a54c613dc9fe3b552a5e9de8966408fd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54c613dc9fe3b552a5e9de8966408fd9">&#9670;&#160;</a></span>select()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = (N &gt; 1 ? N - 1 : 1)&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if_t&lt;(N &gt; 1), <a class="el" href="classTensor.html">Tensor</a>&lt; T, M &gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::select </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>dim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>index</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Select a specific index along a dimension, reducing that dimension. For example, selecting row 2 from a 2D tensor returns a 1D tensor. Only available for tensors with N &gt; 1. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dim</td><td>The dimension along which to select. </td></tr>
    <tr><td class="paramname">index</td><td>The index to select in that dimension. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A tensor with dimension N-1. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05026">5026</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5026</span>                                                                                 {</div>
<div class="line"><span class="lineno"> 5027</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">dim</a> &gt;= <a class="code hl_class" href="classTensor.html">N</a> || <a class="code hl_class" href="classTensor.html">index</a> &gt;= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a>]) {</div>
<div class="line"><span class="lineno"> 5028</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;M&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 5029</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, M&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 5030</span>        }</div>
<div class="line"><span class="lineno"> 5031</span>        </div>
<div class="line"><span class="lineno"> 5032</span>        <span class="comment">// Calculate new dimensions (removing the selected dimension)</span></div>
<div class="line"><span class="lineno"> 5033</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;M&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a>;</div>
<div class="line"><span class="lineno"> 5034</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">new_idx</a> = 0;</div>
<div class="line"><span class="lineno"> 5035</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5036</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">i</a> != <a class="code hl_class" href="classTensor.html">dim</a>) {</div>
<div class="line"><span class="lineno"> 5037</span>                <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">new_idx</a>++] = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5038</span>            }</div>
<div class="line"><span class="lineno"> 5039</span>        }</div>
<div class="line"><span class="lineno"> 5040</span>        </div>
<div class="line"><span class="lineno"> 5041</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, M&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 5042</span>        </div>
<div class="line"><span class="lineno"> 5043</span>        <span class="comment">// Copy selected slice</span></div>
<div class="line"><span class="lineno"> 5044</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">result_total</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 5045</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">stride</a> = <a class="code hl_variable" href="#af6821d656bfc94c60fe4cd256c1d7402">strides_</a>[<a class="code hl_class" href="classTensor.html">dim</a>];</div>
<div class="line"><span class="lineno"> 5046</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dim_size</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">dim</a>];</div>
<div class="line"><span class="lineno"> 5047</span>        </div>
<div class="line"><span class="lineno"> 5048</span>        <span class="comment">// Calculate outer and inner sizes</span></div>
<div class="line"><span class="lineno"> 5049</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 5050</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">dim</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5051</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5052</span>        }</div>
<div class="line"><span class="lineno"> 5053</span>        </div>
<div class="line"><span class="lineno"> 5054</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 5055</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">dim</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5056</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5057</span>        }</div>
<div class="line"><span class="lineno"> 5058</span>        </div>
<div class="line"><span class="lineno"> 5059</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 5060</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5061</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">dim_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">index</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 5062</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dst_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 5063</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">dst_idx</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 5064</span>            }</div>
<div class="line"><span class="lineno"> 5065</span>        }</div>
<div class="line"><span class="lineno"> 5066</span>        </div>
<div class="line"><span class="lineno"> 5067</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 5068</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aba945884d7b2221e4a6b35e7916ae0d9" name="aba945884d7b2221e4a6b35e7916ae0d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba945884d7b2221e4a6b35e7916ae0d9">&#9670;&#160;</a></span>set_requires_grad()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::set_requires_grad </td>
          <td>(</td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>requires_grad</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Enable gradient tracking for this tensor. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">requires_grad</td><td>Whether to require gradients. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00926">926</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  926</span>                                               {</div>
<div class="line"><span class="lineno">  927</span>        <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a> = <a class="code hl_function" href="#a947326cf96b1bf3423b40861e1213ab8">requires_grad</a>;</div>
<div class="line"><span class="lineno">  928</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a> &amp;&amp; !<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno">  929</span>            <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  930</span>            <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno">  931</span>        }</div>
<div class="line"><span class="lineno">  932</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a80b3ffaf92ed36f02d6f4d4230b5d2a0" name="a80b3ffaf92ed36f02d6f4d4230b5d2a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80b3ffaf92ed36f02d6f4d4230b5d2a0">&#9670;&#160;</a></span>shape()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::shape </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the shape of the tensor (alias for dims). </p><dl class="section return"><dt>Returns</dt><dd>An array containing the size of each dimension. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00860">860</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  860</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>; }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a80b3ffaf92ed36f02d6f4d4230b5d2a0_icgraph.png" border="0" usemap="#aclassTensor_a80b3ffaf92ed36f02d6f4d4230b5d2a0_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a80b3ffaf92ed36f02d6f4d4230b5d2a0_icgraph" id="aclassTensor_a80b3ffaf92ed36f02d6f4d4230b5d2a0_icgraph">
<area shape="rect" title=" " alt="" coords="433,215,536,241"/>
<area shape="rect" href="tensor_8h.html#a912e291f7a42f325c111def58ac98acf" title="Cast tensor to a different data type (NumPy&#45;compatible astype)." alt="" coords="264,5,324,32"/>
<area shape="poly" title=" " alt="" coords="473,200,461,165,442,123,417,81,383,46,355,31,324,24,326,18,357,26,387,42,421,78,447,120,466,163,478,198"/>
<area shape="rect" href="namespacetensor4d_1_1nn.html#aabc59d678ea2b307e86f063f32102470" title="Compute classification accuracy." alt="" coords="219,56,370,99"/>
<area shape="poly" title=" " alt="" coords="465,203,430,157,408,133,383,113,364,101,367,97,387,108,412,130,435,154,469,200"/>
<area shape="rect" href="tensor_8h.html#a3331b6cf4ac182d022336e4d068a0e58" title="Create a copy of a tensor (NumPy&#45;compatible)." alt="" coords="270,123,319,149"/>
<area shape="poly" title=" " alt="" coords="453,207,421,184,384,164,350,151,319,143,320,138,352,146,386,159,424,180,456,203"/>
<area shape="rect" href="namespacetensor4d_1_1nn.html#a7682f7b06565fe530c833139aa5c52cd" title="Compute cross&#45;entropy loss between predictions and targets." alt="" coords="228,173,361,216"/>
<area shape="poly" title=" " alt="" coords="417,219,361,209,362,204,418,214"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1BatchNorm1d.html#a8e589b2051e3a2c38b1a0feccc33bdb2" title=" " alt="" coords="204,240,385,283"/>
<area shape="poly" title=" " alt="" coords="418,242,386,248,385,243,417,237"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Dropout.html#aff0f87aa27d1aceca0bbcc6b0655ce24" title=" " alt="" coords="221,307,368,349"/>
<area shape="poly" title=" " alt="" coords="455,253,386,297,361,309,359,304,384,292,452,249"/>
<area shape="rect" href="tensor__c_8cpp.html#a81380d5f848afe3d498bedfc93332493" title=" " alt="" coords="228,373,361,416"/>
<area shape="poly" title=" " alt="" coords="472,257,438,310,414,339,387,363,363,378,360,373,383,359,410,335,433,307,467,254"/>
<area shape="rect" href="namespacetensor4d_1_1nn.html#ab2f304e755860ad8c80d7c67cfe953b2" title="Compute softmax Jacobian for batched input (batch_size x num_classes)." alt="" coords="220,440,368,483"/>
<area shape="poly" title=" " alt="" coords="479,257,467,295,449,342,422,389,387,430,371,442,368,437,383,426,418,386,444,339,462,294,474,255"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Softmax.html#abda8fce936f0e7f02d1779a120db27de" title=" " alt="" coords="5,440,156,483"/>
<area shape="poly" title=" " alt="" coords="204,464,156,464,156,459,204,459"/>
</map>
</div>

</div>
</div>
<a id="afff455663faa35d6cfa72aa03f689e94" name="afff455663faa35d6cfa72aa03f689e94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afff455663faa35d6cfa72aa03f689e94">&#9670;&#160;</a></span>sigmoid()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sigmoid </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply sigmoid function to all elements (creates new tensor). </p>
<p>Computes sigmoid(x) = 1 / (1 + exp(-x)) for each element. Commonly used as activation function in neural networks, especially for binary classification in output layers.</p>
<p>Range: (0, 1) - useful for representing probabilities. Supports automatic differentiation.</p>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with sigmoid(x) applied to all elements</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_sigmoid"></a>
Example</h1>
<div class="fragment"><div class="line"><span class="comment">// Binary classification output layer</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> logits({32, 1}, <span class="keyword">true</span>, <span class="keyword">true</span>);  <span class="comment">// batch_size=32</span></div>
<div class="line"><span class="keyword">auto</span> probs = logits.sigmoid();  <span class="comment">// Convert to probabilities in (0, 1)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// With autograd:</span></div>
<div class="line"><span class="keyword">auto</span> <a class="code hl_namespace" href="namespaceloss.html">loss</a> = <a class="code hl_function" href="namespaceloss.html#a365059b00ea1e6ec1db86710cfcf3b31">loss::binary_cross_entropy</a>(probs, targets);</div>
<div class="line"><a class="code hl_namespace" href="namespaceloss.html">loss</a>.backward();  <span class="comment">// Computes gradient through sigmoid</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Gating mechanism (like in LSTM)</span></div>
<div class="line"><span class="keyword">auto</span> forget_gate = (W_f.matmul(x) + b_f).sigmoid();</div>
<div class="ttc" id="anamespaceloss_html_a365059b00ea1e6ec1db86710cfcf3b31"><div class="ttname"><a href="namespaceloss.html#a365059b00ea1e6ec1db86710cfcf3b31">loss::binary_cross_entropy</a></div><div class="ttdeci">Tensor&lt; T, 1 &gt; binary_cross_entropy(const Tensor&lt; T, N &gt; &amp;predictions, const Tensor&lt; T, N &gt; &amp;targets, const std::string &amp;reduction)</div><div class="ttdoc">Binary cross entropy loss for binary classification.</div><div class="ttdef"><b>Definition</b> <a href="loss__functions_8h_source.html#l00212">loss_functions.h:212</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02273">2273</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2273</span>                                 {</div>
<div class="line"><span class="lineno"> 2274</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 2275</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2276</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2277</span>        </div>
<div class="line"><span class="lineno"> 2278</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 2279</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 2280</span>                <a class="code hl_class" href="classTensor.html">ensure_on_gpu</a>();</div>
<div class="line"><span class="lineno"> 2281</span>                <a class="code hl_class" href="classTensor.html">result</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 2282</span>                <a class="code hl_class" href="classTensor.html">TensorGPU::sigmoid_gpu_direct</a>(<a class="code hl_class" href="classTensor.html">d_data_</a>, <a class="code hl_class" href="classTensor.html">result</a>.d_data_, <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2283</span>                <a class="code hl_class" href="classTensor.html">result</a>.mark_gpu_modified();</div>
<div class="line"><span class="lineno"> 2284</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2285</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2286</span>        {</div>
<div class="line"><span class="lineno"> 2287</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2288</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">T</a>(1) / (<a class="code hl_class" href="classTensor.html">T</a>(1) + <a class="code hl_class" href="classTensor.html">std::exp</a>(-<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]));</div>
<div class="line"><span class="lineno"> 2289</span>            }</div>
<div class="line"><span class="lineno"> 2290</span>        }</div>
<div class="line"><span class="lineno"> 2291</span>        </div>
<div class="line"><span class="lineno"> 2292</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 2293</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 2294</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">output_copy</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#ae5b52299c11f3ba81e781cb008542285">detach</a>();</div>
<div class="line"><span class="lineno"> 2295</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2296</span>            </div>
<div class="line"><span class="lineno"> 2297</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">output_copy</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 2298</span>                <span class="comment">// Gradient of sigmoid: d/dx[sigmoid(x)] = sigmoid(x) * (1 - sigmoid(x))</span></div>
<div class="line"><span class="lineno"> 2299</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 2300</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 2301</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2302</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 2303</span>                    }</div>
<div class="line"><span class="lineno"> 2304</span>                    </div>
<div class="line"><span class="lineno"> 2305</span>                    <span class="comment">// Optimized using tensor operations</span></div>
<div class="line"><span class="lineno"> 2306</span>                    <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_function" href="tensor_8h.html#a37ee39b629ca93dc83259b6c8591d0d9">ones</a>(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2307</span>                    <a class="code hl_class" href="classTensor.html">ones</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(1));</div>
<div class="line"><span class="lineno"> 2308</span>                    <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">one_minus_sig_result</a> = <a class="code hl_class" href="classTensor.html">ones</a> - <a class="code hl_class" href="classTensor.html">output_copy</a>;</div>
<div class="line"><span class="lineno"> 2309</span>                    <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">one_minus_sig</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">one_minus_sig_result</a>);</div>
<div class="line"><span class="lineno"> 2310</span>                    <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">sig_prod_result</a> = <a class="code hl_class" href="classTensor.html">output_copy</a> * <a class="code hl_class" href="classTensor.html">one_minus_sig</a>;</div>
<div class="line"><span class="lineno"> 2311</span>                    <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">sig_prod</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">sig_prod_result</a>);</div>
<div class="line"><span class="lineno"> 2312</span>                    <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">grad_result</a> = <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a> * <a class="code hl_class" href="classTensor.html">sig_prod</a>;</div>
<div class="line"><span class="lineno"> 2313</span>                    <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">grad_contrib</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">grad_result</a>);</div>
<div class="line"><span class="lineno"> 2314</span>                    </div>
<div class="line"><span class="lineno"> 2315</span>                    <span class="comment">// Accumulate gradients using tensor addition</span></div>
<div class="line"><span class="lineno"> 2316</span>                    <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">grad_sum_result</a> = *<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> + <a class="code hl_class" href="classTensor.html">grad_contrib</a>;</div>
<div class="line"><span class="lineno"> 2317</span>                    *<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">grad_sum_result</a>);</div>
<div class="line"><span class="lineno"> 2318</span>                    </div>
<div class="line"><span class="lineno"> 2319</span>                    <span class="comment">// If self is not a leaf, propagate gradients further</span></div>
<div class="line"><span class="lineno"> 2320</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 2321</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 2322</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 2323</span>                        }</div>
<div class="line"><span class="lineno"> 2324</span>                    }</div>
<div class="line"><span class="lineno"> 2325</span>                }</div>
<div class="line"><span class="lineno"> 2326</span>            });</div>
<div class="line"><span class="lineno"> 2327</span>        }</div>
<div class="line"><span class="lineno"> 2328</span>        </div>
<div class="line"><span class="lineno"> 2329</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2330</span>    }</div>
<div class="ttc" id="atensor_8h_html_a37ee39b629ca93dc83259b6c8591d0d9"><div class="ttname"><a href="tensor_8h.html#a37ee39b629ca93dc83259b6c8591d0d9">ones</a></div><div class="ttdeci">Tensor&lt; T, N &gt; ones(const TensorIndices&lt; N &gt; &amp;shape, bool use_gpu=true)</div><div class="ttdoc">Create a tensor filled with ones (NumPy-compatible).</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l06986">tensor.h:6986</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_afff455663faa35d6cfa72aa03f689e94_icgraph.png" border="0" usemap="#aclassTensor_afff455663faa35d6cfa72aa03f689e94_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_afff455663faa35d6cfa72aa03f689e94_icgraph" id="aclassTensor_afff455663faa35d6cfa72aa03f689e94_icgraph">
<area shape="rect" title="Apply sigmoid function to all elements (creates new tensor)." alt="" coords="202,13,315,40"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Sigmoid.html#a5bde4d78573f5ea7c6c5e4d624bda3fb" title=" " alt="" coords="5,5,154,48"/>
<area shape="poly" title=" " alt="" coords="186,29,154,29,154,24,186,24"/>
</map>
</div>

</div>
</div>
<a id="aa711e60597e988054c669e131ddce774" name="aa711e60597e988054c669e131ddce774"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa711e60597e988054c669e131ddce774">&#9670;&#160;</a></span>sigmoid_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sigmoid_derivative </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of sigmoid function with respect to input. Given output y = sigmoid(x), computes dy/dx = y * (1 - y) This is more numerically stable when you have the sigmoid output. </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with sigmoid derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02566">2566</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2566</span>                                            {</div>
<div class="line"><span class="lineno"> 2567</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">y</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">y</a> * (<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">y</a>); });</div>
<div class="line"><span class="lineno"> 2568</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a369fb30e582324d1331132a5b29884b9" name="a369fb30e582324d1331132a5b29884b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a369fb30e582324d1331132a5b29884b9">&#9670;&#160;</a></span>sigmoid_derivative_from_input()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sigmoid_derivative_from_input </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of sigmoid from input values. Given input x, computes d/dx[sigmoid(x)] = sigmoid(x) * (1 - sigmoid(x)) </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with sigmoid derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02575">2575</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2575</span>                                                       {</div>
<div class="line"><span class="lineno"> 2576</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) {</div>
<div class="line"><span class="lineno"> 2577</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">sig</a> = <a class="code hl_class" href="classTensor.html">T</a>(1) / (<a class="code hl_class" href="classTensor.html">T</a>(1) + <a class="code hl_class" href="classTensor.html">std::exp</a>(-<a class="code hl_class" href="classTensor.html">x</a>));</div>
<div class="line"><span class="lineno"> 2578</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">sig</a> * (<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">sig</a>);</div>
<div class="line"><span class="lineno"> 2579</span>        });</div>
<div class="line"><span class="lineno"> 2580</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8effb9d585936f292d45c090fa06a96b" name="a8effb9d585936f292d45c090fa06a96b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8effb9d585936f292d45c090fa06a96b">&#9670;&#160;</a></span>sign()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sign </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply sign function to all elements (creates new tensor). Returns -1 for negative values, 0 for zero, and +1 for positive values. </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with sign(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02446">2446</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2446</span>                              {</div>
<div class="line"><span class="lineno"> 2447</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { </div>
<div class="line"><span class="lineno"> 2448</span>            <span class="keywordflow">return</span> (<a class="code hl_class" href="classTensor.html">x</a> &gt; <a class="code hl_class" href="classTensor.html">T</a>(0)) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : ((<a class="code hl_class" href="classTensor.html">x</a> &lt; <a class="code hl_class" href="classTensor.html">T</a>(0)) ? <a class="code hl_class" href="classTensor.html">T</a>(-1) : <a class="code hl_class" href="classTensor.html">T</a>(0)); </div>
<div class="line"><span class="lineno"> 2449</span>        });</div>
<div class="line"><span class="lineno"> 2450</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9340456b98f6f4da7fad1b80f9f81712" name="a9340456b98f6f4da7fad1b80f9f81712"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9340456b98f6f4da7fad1b80f9f81712">&#9670;&#160;</a></span>sin()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sin </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply sine function to all elements (creates new tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with sin(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02147">2147</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2147</span>                             {</div>
<div class="line"><span class="lineno"> 2148</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2149</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2150</span>        </div>
<div class="line"><span class="lineno"> 2151</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 2152</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 2153</span>                <a class="code hl_class" href="classTensor.html">ensure_on_gpu</a>();</div>
<div class="line"><span class="lineno"> 2154</span>                <a class="code hl_class" href="classTensor.html">result</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 2155</span>                <a class="code hl_class" href="classTensor.html">TensorGPU::sin_gpu_direct</a>(<a class="code hl_class" href="classTensor.html">d_data_</a>, <a class="code hl_class" href="classTensor.html">result</a>.d_data_, <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2156</span>                <a class="code hl_class" href="classTensor.html">result</a>.mark_gpu_modified();</div>
<div class="line"><span class="lineno"> 2157</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2158</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2159</span>        {</div>
<div class="line"><span class="lineno"> 2160</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2161</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::sin</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 2162</span>            }</div>
<div class="line"><span class="lineno"> 2163</span>        }</div>
<div class="line"><span class="lineno"> 2164</span>        </div>
<div class="line"><span class="lineno"> 2165</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2166</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aeb435c4d428047076a5b3c3dd5ba7114" name="aeb435c4d428047076a5b3c3dd5ba7114"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb435c4d428047076a5b3c3dd5ba7114">&#9670;&#160;</a></span>sin_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sin_derivative </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of sine function. d/dx[sin(x)] = cos(x) </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with sin derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02666">2666</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2666</span>                                        {</div>
<div class="line"><span class="lineno"> 2667</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a6563fb519990f052d63759c50d1febe9">cos</a>();</div>
<div class="line"><span class="lineno"> 2668</span>    }</div>
<div class="ttc" id="aclassTensor_html_a6563fb519990f052d63759c50d1febe9"><div class="ttname"><a href="#a6563fb519990f052d63759c50d1febe9">Tensor::cos</a></div><div class="ttdeci">Tensor&lt; T, N &gt; cos() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l02172">tensor.h:2172</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4ae322784a9d62e8db2c073f5e2395f7" name="a4ae322784a9d62e8db2c073f5e2395f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ae322784a9d62e8db2c073f5e2395f7">&#9670;&#160;</a></span>softmax()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::softmax </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>axis</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Softmax operation with autograd support. </p>
<p>Applies softmax normalization along a specified axis: softmax(x_i) = exp(x_i) / sum(exp(x_j))</p>
<p>Converts logits to probabilities that sum to 1. Uses numerically stable implementation (subtracts max before exp) to prevent overflow.</p>
<p>Essential for multi-class classification output layers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The axis to apply softmax along (default: -1 = last axis) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> with softmax applied, or zero tensor if axis is out of range</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_softmax"></a>
Example</h1>
<div class="fragment"><div class="line"><span class="comment">// Multi-class classification (10 classes, batch size 32)</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> logits({32, 10}, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="keyword">auto</span> probs = logits.softmax(-1);  <span class="comment">// Apply along class dimension</span></div>
<div class="line"><span class="comment">// Each row now sums to 1.0 and represents class probabilities</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// With loss computation:</span></div>
<div class="line"><span class="keyword">auto</span> <a class="code hl_namespace" href="namespaceloss.html">loss</a> = <a class="code hl_function" href="namespaceloss.html#a75edef9d102d2ab811b15c50f13c4eee">loss::cross_entropy_loss</a>(logits, targets);</div>
<div class="line"><a class="code hl_namespace" href="namespaceloss.html">loss</a>.backward();  <span class="comment">// Gradient flows through softmax</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Attention mechanism example:</span></div>
<div class="line"><span class="keyword">auto</span> scores = query.matmul(key.transpose());  <span class="comment">// Attention scores</span></div>
<div class="line"><span class="keyword">auto</span> attention_weights = scores.softmax(-1);   <span class="comment">// Normalize scores</span></div>
<div class="line"><span class="keyword">auto</span> context = attention_weights.matmul(value);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Temperature scaling for controlling confidence:</span></div>
<div class="line"><span class="keywordtype">float</span> temperature = 2.0f;</div>
<div class="line"><span class="keyword">auto</span> calibrated_probs = (logits / temperature).<a class="code hl_function" href="#a4ae322784a9d62e8db2c073f5e2395f7">softmax</a>(-1);</div>
<div class="ttc" id="aclassTensor_html_a4ae322784a9d62e8db2c073f5e2395f7"><div class="ttname"><a href="#a4ae322784a9d62e8db2c073f5e2395f7">Tensor::softmax</a></div><div class="ttdeci">Tensor&lt; T, N &gt; softmax(int axis=-1) const</div><div class="ttdoc">Softmax operation with autograd support.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l04263">tensor.h:4263</a></div></div>
<div class="ttc" id="anamespaceloss_html_a75edef9d102d2ab811b15c50f13c4eee"><div class="ttname"><a href="namespaceloss.html#a75edef9d102d2ab811b15c50f13c4eee">loss::cross_entropy_loss</a></div><div class="ttdeci">Tensor&lt; T, 1 &gt; cross_entropy_loss(const Tensor&lt; T, N &gt; &amp;logits, const Tensor&lt; T, N &gt; &amp;targets, const std::string &amp;reduction)</div><div class="ttdoc">Cross entropy loss for multi-class classification.</div><div class="ttdef"><b>Definition</b> <a href="loss__functions_8h_source.html#l00159">loss_functions.h:159</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04263">4263</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4263</span>                                              {</div>
<div class="line"><span class="lineno"> 4264</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &lt; 0) {</div>
<div class="line"><span class="lineno"> 4265</span>            <a class="code hl_class" href="classTensor.html">axis</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) + <a class="code hl_class" href="classTensor.html">axis</a>;</div>
<div class="line"><span class="lineno"> 4266</span>        }</div>
<div class="line"><span class="lineno"> 4267</span>        </div>
<div class="line"><span class="lineno"> 4268</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis &lt; 0 || axis &gt;</a>= <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>)) {</div>
<div class="line"><span class="lineno"> 4269</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 4270</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4271</span>        }</div>
<div class="line"><span class="lineno"> 4272</span>        </div>
<div class="line"><span class="lineno"> 4273</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">ax</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">axis</a>);</div>
<div class="line"><span class="lineno"> 4274</span>        </div>
<div class="line"><span class="lineno"> 4275</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4276</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4277</span>        </div>
<div class="line"><span class="lineno"> 4278</span>        <span class="comment">// Compute softmax with numerical stability (subtract max)</span></div>
<div class="line"><span class="lineno"> 4279</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 4280</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">ax</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4281</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4282</span>        }</div>
<div class="line"><span class="lineno"> 4283</span>        </div>
<div class="line"><span class="lineno"> 4284</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">softmax_dim</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">ax</a>];</div>
<div class="line"><span class="lineno"> 4285</span>        </div>
<div class="line"><span class="lineno"> 4286</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 4287</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">ax</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4288</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4289</span>        }</div>
<div class="line"><span class="lineno"> 4290</span>        </div>
<div class="line"><span class="lineno"> 4291</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4292</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4293</span>                <span class="comment">// Find max for numerical stability</span></div>
<div class="line"><span class="lineno"> 4294</span>                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_class" href="classTensor.html">std::numeric_limits&lt;T&gt;::lowest</a>();</div>
<div class="line"><span class="lineno"> 4295</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">s</a> = 0; <a class="code hl_class" href="classTensor.html">s</a> &lt; <a class="code hl_class" href="classTensor.html">softmax_dim</a>; ++<a class="code hl_class" href="classTensor.html">s</a>) {</div>
<div class="line"><span class="lineno"> 4296</span>                    <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 4297</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">linear_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">softmax_dim</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">s</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4298</span>                    </div>
<div class="line"><span class="lineno"> 4299</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">linear_idx</a>;</div>
<div class="line"><span class="lineno"> 4300</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 4301</span>                        <a class="code hl_class" href="classTensor.html">idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4302</span>                        <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4303</span>                    }</div>
<div class="line"><span class="lineno"> 4304</span>                    </div>
<div class="line"><span class="lineno"> 4305</span>                    <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_class" href="classTensor.html">std::max</a>(<a class="code hl_class" href="classTensor.html">max_val</a>, (*<span class="keyword">this</span>)[<a class="code hl_class" href="classTensor.html">idx</a>]);</div>
<div class="line"><span class="lineno"> 4306</span>                }</div>
<div class="line"><span class="lineno"> 4307</span>                </div>
<div class="line"><span class="lineno"> 4308</span>                <span class="comment">// Compute exp(x - max) and sum</span></div>
<div class="line"><span class="lineno"> 4309</span>                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">sum_exp</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 4310</span>                <a class="code hl_class" href="classTensor.html">std::vector&lt;T&gt;</a> <a class="code hl_class" href="classTensor.html">exp_vals</a>(<a class="code hl_class" href="classTensor.html">softmax_dim</a>);</div>
<div class="line"><span class="lineno"> 4311</span>                </div>
<div class="line"><span class="lineno"> 4312</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">s</a> = 0; <a class="code hl_class" href="classTensor.html">s</a> &lt; <a class="code hl_class" href="classTensor.html">softmax_dim</a>; ++<a class="code hl_class" href="classTensor.html">s</a>) {</div>
<div class="line"><span class="lineno"> 4313</span>                    <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 4314</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">linear_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">softmax_dim</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">s</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4315</span>                    </div>
<div class="line"><span class="lineno"> 4316</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">linear_idx</a>;</div>
<div class="line"><span class="lineno"> 4317</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 4318</span>                        <a class="code hl_class" href="classTensor.html">idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4319</span>                        <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4320</span>                    }</div>
<div class="line"><span class="lineno"> 4321</span>                    </div>
<div class="line"><span class="lineno"> 4322</span>                    <a class="code hl_class" href="classTensor.html">exp_vals</a>[<a class="code hl_class" href="classTensor.html">s</a>] = <a class="code hl_class" href="classTensor.html">std::exp</a>((*<span class="keyword">this</span>)[<a class="code hl_class" href="classTensor.html">idx</a>] - <a class="code hl_class" href="classTensor.html">max_val</a>);</div>
<div class="line"><span class="lineno"> 4323</span>                    <a class="code hl_class" href="classTensor.html">sum_exp</a> += <a class="code hl_class" href="classTensor.html">exp_vals</a>[<a class="code hl_class" href="classTensor.html">s</a>];</div>
<div class="line"><span class="lineno"> 4324</span>                }</div>
<div class="line"><span class="lineno"> 4325</span>                </div>
<div class="line"><span class="lineno"> 4326</span>                <span class="comment">// Normalize</span></div>
<div class="line"><span class="lineno"> 4327</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">s</a> = 0; <a class="code hl_class" href="classTensor.html">s</a> &lt; <a class="code hl_class" href="classTensor.html">softmax_dim</a>; ++<a class="code hl_class" href="classTensor.html">s</a>) {</div>
<div class="line"><span class="lineno"> 4328</span>                    <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 4329</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">linear_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">softmax_dim</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">s</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4330</span>                    </div>
<div class="line"><span class="lineno"> 4331</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">linear_idx</a>;</div>
<div class="line"><span class="lineno"> 4332</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 4333</span>                        <a class="code hl_class" href="classTensor.html">idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4334</span>                        <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4335</span>                    }</div>
<div class="line"><span class="lineno"> 4336</span>                    </div>
<div class="line"><span class="lineno"> 4337</span>                    <a class="code hl_class" href="classTensor.html">result</a>[<a class="code hl_class" href="classTensor.html">idx</a>] = <a class="code hl_class" href="classTensor.html">exp_vals</a>[<a class="code hl_class" href="classTensor.html">s</a>] / <a class="code hl_class" href="classTensor.html">sum_exp</a>;</div>
<div class="line"><span class="lineno"> 4338</span>                }</div>
<div class="line"><span class="lineno"> 4339</span>            }</div>
<div class="line"><span class="lineno"> 4340</span>        }</div>
<div class="line"><span class="lineno"> 4341</span>        </div>
<div class="line"><span class="lineno"> 4342</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 4343</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4344</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">output_copy</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#ae5b52299c11f3ba81e781cb008542285">detach</a>();</div>
<div class="line"><span class="lineno"> 4345</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4346</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">softmax_axis</a> = <a class="code hl_class" href="classTensor.html">ax</a>;</div>
<div class="line"><span class="lineno"> 4347</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">self_dims</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 4348</span>            </div>
<div class="line"><span class="lineno"> 4349</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">output_copy</a>, <a class="code hl_class" href="classTensor.html">softmax_axis</a>, <a class="code hl_class" href="classTensor.html">self_dims</a>, <a class="code hl_class" href="classTensor.html">outer</a>, <a class="code hl_class" href="classTensor.html">softmax_dim</a>, <a class="code hl_class" href="classTensor.html">inner</a>]</div>
<div class="line"><span class="lineno"> 4350</span>                                    (<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 4351</span>                <span class="comment">// Gradient of softmax:</span></div>
<div class="line"><span class="lineno"> 4352</span>                <span class="comment">// dsoftmax_i/dx_j = softmax_i * (_ij - softmax_j)</span></div>
<div class="line"><span class="lineno"> 4353</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4354</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4355</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4356</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4357</span>                    }</div>
<div class="line"><span class="lineno"> 4358</span>                    </div>
<div class="line"><span class="lineno"> 4359</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4360</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4361</span>                            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">s</a> = 0; <a class="code hl_class" href="classTensor.html">s</a> &lt; <a class="code hl_class" href="classTensor.html">softmax_dim</a>; ++<a class="code hl_class" href="classTensor.html">s</a>) {</div>
<div class="line"><span class="lineno"> 4362</span>                                <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx_s</a>;</div>
<div class="line"><span class="lineno"> 4363</span>                                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">linear_s</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">softmax_dim</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">s</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4364</span>                                </div>
<div class="line"><span class="lineno"> 4365</span>                                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">linear_s</a>;</div>
<div class="line"><span class="lineno"> 4366</span>                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 4367</span>                                    <a class="code hl_class" href="classTensor.html">idx_s</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_class" href="classTensor.html">self_dims</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4368</span>                                    <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_class" href="classTensor.html">self_dims</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4369</span>                                }</div>
<div class="line"><span class="lineno"> 4370</span>                                </div>
<div class="line"><span class="lineno"> 4371</span>                                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 4372</span>                                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">j</a> = 0; <a class="code hl_class" href="classTensor.html">j</a> &lt; <a class="code hl_class" href="classTensor.html">softmax_dim</a>; ++<a class="code hl_class" href="classTensor.html">j</a>) {</div>
<div class="line"><span class="lineno"> 4373</span>                                    <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx_j</a> = <a class="code hl_class" href="classTensor.html">idx_s</a>;</div>
<div class="line"><span class="lineno"> 4374</span>                                    <a class="code hl_class" href="classTensor.html">idx_j</a>[<a class="code hl_class" href="classTensor.html">softmax_axis</a>] = <a class="code hl_class" href="classTensor.html">j</a>;</div>
<div class="line"><span class="lineno"> 4375</span>                                    </div>
<div class="line"><span class="lineno"> 4376</span>                                    <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">delta_ij</a> = (<a class="code hl_class" href="classTensor.html">s</a> == <a class="code hl_class" href="classTensor.html">j</a>) ? <a class="code hl_class" href="classTensor.html">T</a>(1) : <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 4377</span>                                    <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>[<a class="code hl_class" href="classTensor.html">idx_j</a>] * (<a class="code hl_class" href="classTensor.html">delta_ij</a> - <a class="code hl_class" href="classTensor.html">output_copy</a>[<a class="code hl_class" href="classTensor.html">idx_j</a>]);</div>
<div class="line"><span class="lineno"> 4378</span>                                }</div>
<div class="line"><span class="lineno"> 4379</span>                                </div>
<div class="line"><span class="lineno"> 4380</span>                                (*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>)[<a class="code hl_class" href="classTensor.html">idx_s</a>] += <a class="code hl_class" href="classTensor.html">output_copy</a>[<a class="code hl_class" href="classTensor.html">idx_s</a>] * <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>;</div>
<div class="line"><span class="lineno"> 4381</span>                            }</div>
<div class="line"><span class="lineno"> 4382</span>                        }</div>
<div class="line"><span class="lineno"> 4383</span>                    }</div>
<div class="line"><span class="lineno"> 4384</span>                    </div>
<div class="line"><span class="lineno"> 4385</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4386</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4387</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4388</span>                        }</div>
<div class="line"><span class="lineno"> 4389</span>                    }</div>
<div class="line"><span class="lineno"> 4390</span>                }</div>
<div class="line"><span class="lineno"> 4391</span>            });</div>
<div class="line"><span class="lineno"> 4392</span>        }</div>
<div class="line"><span class="lineno"> 4393</span>        </div>
<div class="line"><span class="lineno"> 4394</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4395</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae0c783450c731955dab75dcb1e697319" name="ae0c783450c731955dab75dcb1e697319"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0c783450c731955dab75dcb1e697319">&#9670;&#160;</a></span>softmax_gradient_diagonal()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::softmax_gradient_diagonal </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute gradient of softmax function (for classification). This computes the Jacobian diagonal for each output with respect to itself. For output y_i = softmax(x)_i, computes dy_i/dx_i = y_i * (1 - y_i) Note: Full softmax Jacobian requires matrix output. </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with softmax gradient diagonal. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02698">2698</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2698</span>                                                   {</div>
<div class="line"><span class="lineno"> 2699</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">y</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">y</a> * (<a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">y</a>); });</div>
<div class="line"><span class="lineno"> 2700</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a65eedb0d5f6932449b64d798c9dd9b5d" name="a65eedb0d5f6932449b64d798c9dd9b5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65eedb0d5f6932449b64d798c9dd9b5d">&#9670;&#160;</a></span>softmax_rows()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::softmax_rows </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply softmax activation along rows (axis=1) for 2D tensors. </p>
<p>Computes softmax(x) = exp(x - max(x)) / sum(exp(x - max(x))) row-wise. Numerically stable implementation using max subtraction.</p>
<dl class="section return"><dt>Returns</dt><dd>New tensor with softmax applied to each row</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_softmax"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> logits({batch_size, num_classes});</div>
<div class="line"><span class="keyword">auto</span> probs = logits.softmax_rows();  <span class="comment">// Convert to probabilities</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05767">5767</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5767</span>                                      {</div>
<div class="line"><span class="lineno"> 5768</span>        <span class="keyword">auto</span> <a class="code hl_function" href="#a80b3ffaf92ed36f02d6f4d4230b5d2a0">shape</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 5769</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">batch_size</a> = <a class="code hl_function" href="#a80b3ffaf92ed36f02d6f4d4230b5d2a0">shape</a>[0];</div>
<div class="line"><span class="lineno"> 5770</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">num_classes</a> = <a class="code hl_function" href="#a80b3ffaf92ed36f02d6f4d4230b5d2a0">shape</a>[1];</div>
<div class="line"><span class="lineno"> 5771</span>        </div>
<div class="line"><span class="lineno"> 5772</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_function" href="#a80b3ffaf92ed36f02d6f4d4230b5d2a0">shape</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 5773</span>        <span class="keyword">const</span> <a class="code hl_class" href="classTensor.html">T</a>* <a class="code hl_class" href="classTensor.html">input_ptr</a> = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get();</div>
<div class="line"><span class="lineno"> 5774</span>        <a class="code hl_class" href="classTensor.html">T</a>* <a class="code hl_class" href="classTensor.html">output_ptr</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get();</div>
<div class="line"><span class="lineno"> 5775</span>        </div>
<div class="line"><span class="lineno"> 5776</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">batch_size</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5777</span>            <span class="keyword">const</span> <a class="code hl_class" href="classTensor.html">T</a>* <a class="code hl_class" href="classTensor.html">row_in</a> = <a class="code hl_class" href="classTensor.html">input_ptr</a> + <a class="code hl_class" href="classTensor.html">i</a> * <a class="code hl_class" href="classTensor.html">num_classes</a>;</div>
<div class="line"><span class="lineno"> 5778</span>            <a class="code hl_class" href="classTensor.html">T</a>* <a class="code hl_class" href="classTensor.html">row_out</a> = <a class="code hl_class" href="classTensor.html">output_ptr</a> + <a class="code hl_class" href="classTensor.html">i</a> * <a class="code hl_class" href="classTensor.html">num_classes</a>;</div>
<div class="line"><span class="lineno"> 5779</span>            </div>
<div class="line"><span class="lineno"> 5780</span>            <span class="comment">// Find max for numerical stability</span></div>
<div class="line"><span class="lineno"> 5781</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">max_val</a> = *<a class="code hl_class" href="classTensor.html">std::max_element</a>(<a class="code hl_class" href="classTensor.html">row_in</a>, <a class="code hl_class" href="classTensor.html">row_in</a> + <a class="code hl_class" href="classTensor.html">num_classes</a>);</div>
<div class="line"><span class="lineno"> 5782</span>            </div>
<div class="line"><span class="lineno"> 5783</span>            <span class="comment">// Compute exp(x - max) and sum</span></div>
<div class="line"><span class="lineno"> 5784</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 5785</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">j</a> = 0; <a class="code hl_class" href="classTensor.html">j</a> &lt; <a class="code hl_class" href="classTensor.html">num_classes</a>; ++<a class="code hl_class" href="classTensor.html">j</a>) {</div>
<div class="line"><span class="lineno"> 5786</span>                <a class="code hl_class" href="classTensor.html">row_out</a>[<a class="code hl_class" href="classTensor.html">j</a>] = <a class="code hl_class" href="classTensor.html">std::exp</a>(<a class="code hl_class" href="classTensor.html">row_in</a>[<a class="code hl_class" href="classTensor.html">j</a>] - <a class="code hl_class" href="classTensor.html">max_val</a>);</div>
<div class="line"><span class="lineno"> 5787</span>                <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> += <a class="code hl_class" href="classTensor.html">row_out</a>[<a class="code hl_class" href="classTensor.html">j</a>];</div>
<div class="line"><span class="lineno"> 5788</span>            }</div>
<div class="line"><span class="lineno"> 5789</span>            </div>
<div class="line"><span class="lineno"> 5790</span>            <span class="comment">// Normalize</span></div>
<div class="line"><span class="lineno"> 5791</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">inv_sum</a> = <a class="code hl_class" href="classTensor.html">T</a>(1) / <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>;</div>
<div class="line"><span class="lineno"> 5792</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">j</a> = 0; <a class="code hl_class" href="classTensor.html">j</a> &lt; <a class="code hl_class" href="classTensor.html">num_classes</a>; ++<a class="code hl_class" href="classTensor.html">j</a>) {</div>
<div class="line"><span class="lineno"> 5793</span>                <a class="code hl_class" href="classTensor.html">row_out</a>[<a class="code hl_class" href="classTensor.html">j</a>] *= <a class="code hl_class" href="classTensor.html">inv_sum</a>;</div>
<div class="line"><span class="lineno"> 5794</span>            }</div>
<div class="line"><span class="lineno"> 5795</span>        }</div>
<div class="line"><span class="lineno"> 5796</span>        </div>
<div class="line"><span class="lineno"> 5797</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 5798</span>    }</div>
<div class="ttc" id="aclassTensor_html_a80b3ffaf92ed36f02d6f4d4230b5d2a0"><div class="ttname"><a href="#a80b3ffaf92ed36f02d6f4d4230b5d2a0">Tensor::shape</a></div><div class="ttdeci">TensorIndices&lt; N &gt; shape() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00860">tensor.h:860</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a65eedb0d5f6932449b64d798c9dd9b5d_icgraph.png" border="0" usemap="#aclassTensor_a65eedb0d5f6932449b64d798c9dd9b5d_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a65eedb0d5f6932449b64d798c9dd9b5d_icgraph" id="aclassTensor_a65eedb0d5f6932449b64d798c9dd9b5d_icgraph">
<area shape="rect" title="Apply softmax activation along rows (axis=1) for 2D tensors." alt="" coords="204,13,354,40"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Softmax.html#a62cc4acc056fbd4f8a365637e1159a9e" title=" " alt="" coords="5,5,156,48"/>
<area shape="poly" title=" " alt="" coords="188,29,156,29,156,24,188,24"/>
</map>
</div>

</div>
</div>
<a id="a71992cdc0fae28d4c1947d7ebc3b85f3" name="a71992cdc0fae28d4c1947d7ebc3b85f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71992cdc0fae28d4c1947d7ebc3b85f3">&#9670;&#160;</a></span>spearman_correlation()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::spearman_correlation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute Spearman rank correlation coefficient with another tensor. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">other</td><td>The other tensor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The Spearman correlation coefficient or error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02977">2977</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2977</span>                                                                          {</div>
<div class="line"><span class="lineno"> 2978</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>() != <a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>()) {</div>
<div class="line"><span class="lineno"> 2979</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno"> 2980</span>        }</div>
<div class="line"><span class="lineno"> 2981</span>        </div>
<div class="line"><span class="lineno"> 2982</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2983</span>        </div>
<div class="line"><span class="lineno"> 2984</span>        <span class="comment">// Create rank vectors</span></div>
<div class="line"><span class="lineno"> 2985</span>        <a class="code hl_class" href="classTensor.html">std::vector&lt;std::pair&lt;T, size_t&gt;</a>&gt; <a class="code hl_class" href="classTensor.html">data1</a>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2986</span>        <a class="code hl_class" href="classTensor.html">std::vector&lt;std::pair&lt;T, size_t&gt;</a>&gt; <a class="code hl_class" href="classTensor.html">data2</a>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2987</span>        </div>
<div class="line"><span class="lineno"> 2988</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2989</span>            <a class="code hl_class" href="classTensor.html">data1</a>[<a class="code hl_class" href="classTensor.html">i</a>] = {<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>], <a class="code hl_class" href="classTensor.html">i</a>};</div>
<div class="line"><span class="lineno"> 2990</span>            <a class="code hl_class" href="classTensor.html">data2</a>[<a class="code hl_class" href="classTensor.html">i</a>] = {<a class="code hl_class" href="classTensor.html">other</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>], <a class="code hl_class" href="classTensor.html">i</a>};</div>
<div class="line"><span class="lineno"> 2991</span>        }</div>
<div class="line"><span class="lineno"> 2992</span>        </div>
<div class="line"><span class="lineno"> 2993</span>        <span class="comment">// Sort by value</span></div>
<div class="line"><span class="lineno"> 2994</span>        <a class="code hl_class" href="classTensor.html">std::sort</a>(<a class="code hl_class" href="classTensor.html">data1</a>.begin(), <a class="code hl_class" href="classTensor.html">data1</a>.end());</div>
<div class="line"><span class="lineno"> 2995</span>        <a class="code hl_class" href="classTensor.html">std::sort</a>(<a class="code hl_class" href="classTensor.html">data2</a>.begin(), <a class="code hl_class" href="classTensor.html">data2</a>.end());</div>
<div class="line"><span class="lineno"> 2996</span>        </div>
<div class="line"><span class="lineno"> 2997</span>        <span class="comment">// Assign ranks</span></div>
<div class="line"><span class="lineno"> 2998</span>        <a class="code hl_class" href="classTensor.html">std::vector&lt;T&gt;</a> <a class="code hl_class" href="classTensor.html">rank1</a>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2999</span>        <a class="code hl_class" href="classTensor.html">std::vector&lt;T&gt;</a> <a class="code hl_class" href="classTensor.html">rank2</a>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 3000</span>        </div>
<div class="line"><span class="lineno"> 3001</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3002</span>            <a class="code hl_class" href="classTensor.html">rank1</a>[<a class="code hl_class" href="classTensor.html">data1</a>[<a class="code hl_class" href="classTensor.html">i</a>].second] = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">i</a> + 1);</div>
<div class="line"><span class="lineno"> 3003</span>            <a class="code hl_class" href="classTensor.html">rank2</a>[<a class="code hl_class" href="classTensor.html">data2</a>[<a class="code hl_class" href="classTensor.html">i</a>].second] = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">i</a> + 1);</div>
<div class="line"><span class="lineno"> 3004</span>        }</div>
<div class="line"><span class="lineno"> 3005</span>        </div>
<div class="line"><span class="lineno"> 3006</span>        <span class="comment">// Compute Pearson correlation on ranks using tensor operations</span></div>
<div class="line"><span class="lineno"> 3007</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 1&gt;</a> <a class="code hl_class" href="classTensor.html">rank1_tensor</a>({<a class="code hl_class" href="classTensor.html">total</a>}, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3008</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 1&gt;</a> <a class="code hl_class" href="classTensor.html">rank2_tensor</a>({<a class="code hl_class" href="classTensor.html">total</a>}, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3009</span>        </div>
<div class="line"><span class="lineno"> 3010</span>        <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_class" href="classTensor.html">rank1</a>.begin(), <a class="code hl_class" href="classTensor.html">rank1</a>.end(), <a class="code hl_class" href="classTensor.html">rank1_tensor</a>.<a class="code hl_function" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>());</div>
<div class="line"><span class="lineno"> 3011</span>        <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_class" href="classTensor.html">rank2</a>.begin(), <a class="code hl_class" href="classTensor.html">rank2</a>.end(), <a class="code hl_class" href="classTensor.html">rank2_tensor</a>.<a class="code hl_function" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>());</div>
<div class="line"><span class="lineno"> 3012</span>        </div>
<div class="line"><span class="lineno"> 3013</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">diff_result</a> = <a class="code hl_class" href="classTensor.html">rank1_tensor</a> - <a class="code hl_class" href="classTensor.html">rank2_tensor</a>;</div>
<div class="line"><span class="lineno"> 3014</span>        <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">diff_tensor</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, 1&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">diff_result</a>);</div>
<div class="line"><span class="lineno"> 3015</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">squared_result</a> = <a class="code hl_class" href="classTensor.html">diff_tensor</a> * <a class="code hl_class" href="classTensor.html">diff_tensor</a>;</div>
<div class="line"><span class="lineno"> 3016</span>        <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">squared_tensor</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, 1&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">squared_result</a>);</div>
<div class="line"><span class="lineno"> 3017</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">sum_d_squared</a> = <a class="code hl_class" href="classTensor.html">squared_tensor</a>.<a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>();</div>
<div class="line"><span class="lineno"> 3018</span>        </div>
<div class="line"><span class="lineno"> 3019</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">n</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 3020</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">T</a>(1) - (<a class="code hl_class" href="classTensor.html">T</a>(6) * <a class="code hl_class" href="classTensor.html">sum_d_squared</a>) / (<a class="code hl_class" href="classTensor.html">n</a> * (<a class="code hl_class" href="classTensor.html">n</a> * <a class="code hl_class" href="classTensor.html">n</a> - <a class="code hl_class" href="classTensor.html">T</a>(1)));</div>
<div class="line"><span class="lineno"> 3021</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af5c4a58c5b957dcfe32a0e7842520404" name="af5c4a58c5b957dcfe32a0e7842520404"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5c4a58c5b957dcfe32a0e7842520404">&#9670;&#160;</a></span>sqrt()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sqrt </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply square root to all elements (creates new tensor). </p>
<p>Computes x for each element. Uses GPU acceleration when available.</p>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with sqrt(x) applied to all elements </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Elements must be non-negative (sqrt of negative values is undefined)</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_sqrt"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> matrix({2, 2});</div>
<div class="line">matrix.fill(4.0f);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> result = matrix.sqrt();  <span class="comment">// All elements = 2.0</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Useful for computing standard deviation</span></div>
<div class="line"><span class="keyword">auto</span> <a class="code hl_function" href="#ac24ac40382bfcce441f59645c4b73257">variance</a> = <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>.variance();</div>
<div class="line"><span class="keyword">auto</span> std_dev = <a class="code hl_function" href="#ac24ac40382bfcce441f59645c4b73257">variance</a>.sqrt();</div>
<div class="ttc" id="aclassTensor_html_ac24ac40382bfcce441f59645c4b73257"><div class="ttname"><a href="#ac24ac40382bfcce441f59645c4b73257">Tensor::variance</a></div><div class="ttdeci">T variance(size_t ddof=0) const</div><div class="ttdoc">Compute variance of all elements.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l02815">tensor.h:2815</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02067">2067</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2067</span>                              {</div>
<div class="line"><span class="lineno"> 2068</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2069</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2070</span>        </div>
<div class="line"><span class="lineno"> 2071</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 2072</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 2073</span>                <a class="code hl_class" href="classTensor.html">ensure_on_gpu</a>();</div>
<div class="line"><span class="lineno"> 2074</span>                <a class="code hl_class" href="classTensor.html">result</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 2075</span>                <a class="code hl_class" href="classTensor.html">TensorGPU::sqrt_gpu_direct</a>(<a class="code hl_class" href="classTensor.html">d_data_</a>, <a class="code hl_class" href="classTensor.html">result</a>.d_data_, <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2076</span>                <a class="code hl_class" href="classTensor.html">result</a>.mark_gpu_modified();</div>
<div class="line"><span class="lineno"> 2077</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2078</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2079</span>        {</div>
<div class="line"><span class="lineno"> 2080</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2081</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::sqrt</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 2082</span>            }</div>
<div class="line"><span class="lineno"> 2083</span>        }</div>
<div class="line"><span class="lineno"> 2084</span>        </div>
<div class="line"><span class="lineno"> 2085</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2086</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a958bad1db0d0a6867d12c75957d2de17" name="a958bad1db0d0a6867d12c75957d2de17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a958bad1db0d0a6867d12c75957d2de17">&#9670;&#160;</a></span>sqrt_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sqrt_derivative </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of square root. d/dx[sqrt(x)] = 1 / (2 * sqrt(x)) </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with sqrt derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02645">2645</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2645</span>                                         {</div>
<div class="line"><span class="lineno"> 2646</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">T</a>(1) / (<a class="code hl_class" href="classTensor.html">T</a>(2) * <a class="code hl_class" href="classTensor.html">std::sqrt</a>(<a class="code hl_class" href="classTensor.html">x</a>)); });</div>
<div class="line"><span class="lineno"> 2647</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aeede6504125b5aeff52c1a56dfbee125" name="aeede6504125b5aeff52c1a56dfbee125"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeede6504125b5aeff52c1a56dfbee125">&#9670;&#160;</a></span>square()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::square </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute element-wise square (x). Useful for computing squared errors. </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with squared values. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03064">3064</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3064</span>                                {</div>
<div class="line"><span class="lineno"> 3065</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">x</a> * <a class="code hl_class" href="classTensor.html">x</a>; });</div>
<div class="line"><span class="lineno"> 3066</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a46d44bb69fc3f0b7376ea35e21903b97" name="a46d44bb69fc3f0b7376ea35e21903b97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46d44bb69fc3f0b7376ea35e21903b97">&#9670;&#160;</a></span>squeeze()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::squeeze </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>axis</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Squeeze - remove dimensions of size 1. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>Specific axis to squeeze, or -1 to squeeze all axes of size 1 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> with squeezed dimensions, or zero tensor if invalid axis </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04739">4739</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4739</span>                                              {</div>
<div class="line"><span class="lineno"> 4740</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &gt;= 0) {</div>
<div class="line"><span class="lineno"> 4741</span>            <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">axis</a>) &gt;= <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 4742</span>                <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 4743</span>                <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4744</span>            }</div>
<div class="line"><span class="lineno"> 4745</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>] != 1) {</div>
<div class="line"><span class="lineno"> 4746</span>                <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 4747</span>                <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4748</span>            }</div>
<div class="line"><span class="lineno"> 4749</span>        }</div>
<div class="line"><span class="lineno"> 4750</span>        </div>
<div class="line"><span class="lineno"> 4751</span>        <span class="comment">// For simplicity, return a copy with same dimensions</span></div>
<div class="line"><span class="lineno"> 4752</span>        <span class="comment">// A proper implementation would change rank</span></div>
<div class="line"><span class="lineno"> 4753</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4754</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4755</span>        </div>
<div class="line"><span class="lineno"> 4756</span>        <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno"> 4757</span>        </div>
<div class="line"><span class="lineno"> 4758</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4759</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4760</span>            </div>
<div class="line"><span class="lineno"> 4761</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 4762</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4763</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4764</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, </div>
<div class="line"><span class="lineno"> 4765</span>                                                                          <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4766</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4767</span>                    }</div>
<div class="line"><span class="lineno"> 4768</span>                    </div>
<div class="line"><span class="lineno"> 4769</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4770</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4771</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4772</span>                    }</div>
<div class="line"><span class="lineno"> 4773</span>                    </div>
<div class="line"><span class="lineno"> 4774</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4775</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4776</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4777</span>                        }</div>
<div class="line"><span class="lineno"> 4778</span>                    }</div>
<div class="line"><span class="lineno"> 4779</span>                }</div>
<div class="line"><span class="lineno"> 4780</span>            });</div>
<div class="line"><span class="lineno"> 4781</span>        }</div>
<div class="line"><span class="lineno"> 4782</span>        </div>
<div class="line"><span class="lineno"> 4783</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4784</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9583b3dbaa99f4251d08085617f1b858" name="a9583b3dbaa99f4251d08085617f1b858"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9583b3dbaa99f4251d08085617f1b858">&#9670;&#160;</a></span>stack()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t... Dims&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N+1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::stack </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensors</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>dim</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Stack tensors along a new dimension (creates new dimension). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tensors</td><td><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b" title="Type alias for 1D vectors.">Vector</a> of tensors to stack. </td></tr>
    <tr><td class="paramname">dim</td><td>Dimension along which to stack (must be &lt;= N). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with dimension N+1. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03462">3462</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3462</span>                                                                                        {</div>
<div class="line"><span class="lineno"> 3463</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">tensors</a>.empty()) {</div>
<div class="line"><span class="lineno"> 3464</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N+1&gt;</a>({0}, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3465</span>        }</div>
<div class="line"><span class="lineno"> 3466</span>        </div>
<div class="line"><span class="lineno"> 3467</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">dim</a> &gt; <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 3468</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N+1&gt;</a>({0}, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3469</span>        }</div>
<div class="line"><span class="lineno"> 3470</span>        </div>
<div class="line"><span class="lineno"> 3471</span>        <span class="comment">// Check all tensors have the same shape</span></div>
<div class="line"><span class="lineno"> 3472</span>        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">first_dims</a> = <a class="code hl_class" href="classTensor.html">tensors</a>[0].<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 3473</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">t</a> : <a class="code hl_class" href="classTensor.html">tensors</a>) {</div>
<div class="line"><span class="lineno"> 3474</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">t</a>.<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a> != <a class="code hl_class" href="classTensor.html">first_dims</a>) {</div>
<div class="line"><span class="lineno"> 3475</span>                <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N+1&gt;</a>({0}, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3476</span>            }</div>
<div class="line"><span class="lineno"> 3477</span>        }</div>
<div class="line"><span class="lineno"> 3478</span>        </div>
<div class="line"><span class="lineno"> 3479</span>        <span class="comment">// Compute new dimensions</span></div>
<div class="line"><span class="lineno"> 3480</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N+1&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a>;</div>
<div class="line"><span class="lineno"> 3481</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">dim</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3482</span>            <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">first_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3483</span>        }</div>
<div class="line"><span class="lineno"> 3484</span>        <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">dim</a>] = <a class="code hl_class" href="classTensor.html">tensors</a>.size();</div>
<div class="line"><span class="lineno"> 3485</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">dim</a>; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3486</span>            <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>+1] = <a class="code hl_class" href="classTensor.html">first_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 3487</span>        }</div>
<div class="line"><span class="lineno"> 3488</span>        </div>
<div class="line"><span class="lineno"> 3489</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N+1&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <a class="code hl_class" href="classTensor.html">tensors</a>[0].<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3490</span>        </div>
<div class="line"><span class="lineno"> 3491</span>        <span class="comment">// Copy data</span></div>
<div class="line"><span class="lineno"> 3492</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">slice_size</a> = <a class="code hl_class" href="classTensor.html">tensors</a>[0].<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3493</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">t</a> = 0; <a class="code hl_class" href="classTensor.html">t</a> &lt; <a class="code hl_class" href="classTensor.html">tensors</a>.size(); ++<a class="code hl_class" href="classTensor.html">t</a>) {</div>
<div class="line"><span class="lineno"> 3494</span>            <span class="keywordtype">size_t</span> <a class="code hl_function" href="#acfd498e431d2689e191c1e9cb8d600fb">offset</a> = <a class="code hl_class" href="classTensor.html">t</a> * <a class="code hl_class" href="classTensor.html">slice_size</a>;</div>
<div class="line"><span class="lineno"> 3495</span>            <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_class" href="classTensor.html">tensors</a>[<a class="code hl_class" href="classTensor.html">t</a>].<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">tensors</a>[<a class="code hl_class" href="classTensor.html">t</a>].<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_class" href="classTensor.html">slice_size</a>,</div>
<div class="line"><span class="lineno"> 3496</span>                     <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_function" href="#acfd498e431d2689e191c1e9cb8d600fb">offset</a>);</div>
<div class="line"><span class="lineno"> 3497</span>        }</div>
<div class="line"><span class="lineno"> 3498</span>        </div>
<div class="line"><span class="lineno"> 3499</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3500</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a06eeff8ce7f54262b935b324bcb6833e" name="a06eeff8ce7f54262b935b324bcb6833e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06eeff8ce7f54262b935b324bcb6833e">&#9670;&#160;</a></span>standardize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::standardize </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Standardize tensor to [0, 1] range using min-max scaling. </p><dl class="section return"><dt>Returns</dt><dd>A new standardized tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03044">3044</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3044</span>                                     {</div>
<div class="line"><span class="lineno"> 3045</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">min_val</a> = <a class="code hl_function" href="#a20cb276f18c104077f75c6f712e4107b">min</a>();</div>
<div class="line"><span class="lineno"> 3046</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">max_val</a> = <a class="code hl_function" href="#a421ff1c638234245b00425702d3f23aa">max</a>();</div>
<div class="line"><span class="lineno"> 3047</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">range</a> = <a class="code hl_class" href="classTensor.html">max_val</a> - <a class="code hl_class" href="classTensor.html">min_val</a>;</div>
<div class="line"><span class="lineno"> 3048</span>        </div>
<div class="line"><span class="lineno"> 3049</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">range</a> &lt; <a class="code hl_class" href="classTensor.html">std::numeric_limits&lt;T&gt;::epsilon</a>()) {</div>
<div class="line"><span class="lineno"> 3050</span>            <span class="comment">// If all values are the same, return zeros</span></div>
<div class="line"><span class="lineno"> 3051</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 3052</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 3053</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3054</span>        }</div>
<div class="line"><span class="lineno"> 3055</span>        </div>
<div class="line"><span class="lineno"> 3056</span>        <span class="keywordflow">return</span> (*<span class="keyword">this</span> - <a class="code hl_class" href="classTensor.html">min_val</a>) / <a class="code hl_class" href="classTensor.html">range</a>;</div>
<div class="line"><span class="lineno"> 3057</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0cda55fce732dcb563b598ff636d8758" name="a0cda55fce732dcb563b598ff636d8758"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cda55fce732dcb563b598ff636d8758">&#9670;&#160;</a></span>std()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::std </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>ddof</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute standard deviation of all elements. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ddof</td><td>Delta degrees of freedom (default 0). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The standard deviation. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02829">2829</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2829</span>                                 {</div>
<div class="line"><span class="lineno"> 2830</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::sqrt</a>(<a class="code hl_function" href="#ac24ac40382bfcce441f59645c4b73257">variance</a>(<a class="code hl_class" href="classTensor.html">ddof</a>));</div>
<div class="line"><span class="lineno"> 2831</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a0cda55fce732dcb563b598ff636d8758_icgraph.png" border="0" usemap="#aclassTensor_a0cda55fce732dcb563b598ff636d8758_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a0cda55fce732dcb563b598ff636d8758_icgraph" id="aclassTensor_a0cda55fce732dcb563b598ff636d8758_icgraph">
<area shape="rect" title=" " alt="" coords="223,5,309,32"/>
<area shape="rect" href="classTensor.html#ab319628634a6c30afddd1a331d9c22e8" title=" " alt="" coords="5,5,175,32"/>
<area shape="poly" title=" " alt="" coords="207,21,175,21,175,16,207,16"/>
</map>
</div>

</div>
</div>
<a id="a938d78600782073a1ff2725066b46c85" name="a938d78600782073a1ff2725066b46c85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a938d78600782073a1ff2725066b46c85">&#9670;&#160;</a></span>strides()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::strides </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get strides for each dimension. </p><dl class="section return"><dt>Returns</dt><dd>Array of strides for each dimension. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00672">672</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  672</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#af6821d656bfc94c60fe4cd256c1d7402">strides_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d279878b61732de2f1986dfc7de8400" name="a3d279878b61732de2f1986dfc7de8400"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d279878b61732de2f1986dfc7de8400">&#9670;&#160;</a></span>sum()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sum </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute sum reduction along all dimensions. </p>
<p>Sums all elements in the tensor to produce a single scalar value. Useful for computing loss, gradient aggregation, or total statistics.</p>
<dl class="section return"><dt>Returns</dt><dd>The sum of all elements as a scalar</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_sum"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> matrix({3, 3});</div>
<div class="line">matrix.fill(2.0f);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">float</span> total = matrix.sum();  <span class="comment">// Returns 18.0 (9 elements  2.0)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Useful in loss computation:</span></div>
<div class="line"><a class="code hl_class" href="classTensor.html">Tensor&lt;float, 1&gt;</a> errors({100}, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="keyword">auto</span> loss_tensor = errors.<a class="code hl_function" href="#aed782eb734b3ef0dd50e5355e3d883c8">pow</a>(2.0f);  <span class="comment">// Square errors</span></div>
<div class="line"><span class="keywordtype">float</span> mse = loss_tensor.<a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>() / 100.0f;  <span class="comment">// Mean squared error</span></div>
<div class="ttc" id="aclassTensor_html_aed782eb734b3ef0dd50e5355e3d883c8"><div class="ttname"><a href="#aed782eb734b3ef0dd50e5355e3d883c8">Tensor::pow</a></div><div class="ttdeci">Tensor&lt; T, N &gt; pow(T exponent) const</div><div class="ttdoc">Apply power function to all elements (creates new tensor).</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l02114">tensor.h:2114</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02749">2749</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2749</span>                  {</div>
<div class="line"><span class="lineno"> 2750</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">result</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 2751</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2752</span>        </div>
<div class="line"><span class="lineno"> 2753</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2754</span>            <a class="code hl_class" href="classTensor.html">result</a> += <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 2755</span>        }</div>
<div class="line"><span class="lineno"> 2756</span>        </div>
<div class="line"><span class="lineno"> 2757</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2758</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a3d279878b61732de2f1986dfc7de8400_icgraph.png" border="0" usemap="#aclassTensor_a3d279878b61732de2f1986dfc7de8400_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a3d279878b61732de2f1986dfc7de8400_icgraph" id="aclassTensor_a3d279878b61732de2f1986dfc7de8400_icgraph">
<area shape="rect" title="Compute sum reduction along all dimensions." alt="" coords="423,115,516,141"/>
<area shape="rect" href="classTensor.html#a2b57a0f04d06e24633c240fe7b007b4a" title=" " alt="" coords="200,5,374,32"/>
<area shape="poly" title=" " alt="" coords="445,105,413,75,374,46,348,35,350,30,376,42,416,70,449,101"/>
<area shape="rect" href="classTensor.html#a36b35209e077e06698d7b0cb5e687b95" title=" " alt="" coords="199,56,375,83"/>
<area shape="poly" title=" " alt="" coords="416,111,374,97,337,86,339,81,376,92,418,106"/>
<area shape="rect" href="namespacetensor4d_1_1nn.html#a7682f7b06565fe530c833139aa5c52cd" title="Compute cross&#45;entropy loss between predictions and targets." alt="" coords="220,107,354,149"/>
<area shape="poly" title=" " alt="" coords="407,131,354,131,354,125,407,125"/>
<area shape="rect" href="classTensor.html#a84b27bf0213ab3f228c2efe5ca31eaec" title=" " alt="" coords="214,173,360,200"/>
<area shape="poly" title=" " alt="" coords="418,150,376,164,339,175,337,170,374,159,416,145"/>
<area shape="rect" href="classTensor.html#ac24ac40382bfcce441f59645c4b73257" title=" " alt="" coords="206,224,368,251"/>
<area shape="poly" title=" " alt="" coords="449,155,416,186,376,214,350,226,348,221,374,210,413,181,445,151"/>
<area shape="rect" href="classTensor.html#aeb090a8d70264aca77202fd451cae051" title=" " alt="" coords="5,173,151,200"/>
<area shape="poly" title=" " alt="" coords="199,189,151,189,151,184,199,184"/>
</map>
</div>

</div>
</div>
<a id="ac20a4679e14de6f68e148b447496adfc" name="ac20a4679e14de6f68e148b447496adfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac20a4679e14de6f68e148b447496adfc">&#9670;&#160;</a></span>sum_axis() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sum_axis </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>axis</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>keepdims</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sum reduction along a specific axis with autograd support. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The axis to sum along (-1 for last axis) </td></tr>
    <tr><td class="paramname">keepdims</td><td>Whether to keep the reduced dimension as size 1 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reduced tensor, or zero tensor if axis is out of range </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04089">4089</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4089</span>                                                                 {</div>
<div class="line"><span class="lineno"> 4090</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &lt; 0) {</div>
<div class="line"><span class="lineno"> 4091</span>            <a class="code hl_class" href="classTensor.html">axis</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) + <a class="code hl_class" href="classTensor.html">axis</a>;</div>
<div class="line"><span class="lineno"> 4092</span>        }</div>
<div class="line"><span class="lineno"> 4093</span>        </div>
<div class="line"><span class="lineno"> 4094</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis &lt; 0 || axis &gt;</a>= <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>)) {</div>
<div class="line"><span class="lineno"> 4095</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 4096</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4097</span>        }</div>
<div class="line"><span class="lineno"> 4098</span>        </div>
<div class="line"><span class="lineno"> 4099</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">ax</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">axis</a>);</div>
<div class="line"><span class="lineno"> 4100</span>        </div>
<div class="line"><span class="lineno"> 4101</span>        <span class="comment">// Compute output dimensions</span></div>
<div class="line"><span class="lineno"> 4102</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">result_dims</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 4103</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">keepdims</a>) {</div>
<div class="line"><span class="lineno"> 4104</span>            <a class="code hl_class" href="classTensor.html">result_dims</a>[<a class="code hl_class" href="classTensor.html">ax</a>] = 1;</div>
<div class="line"><span class="lineno"> 4105</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4106</span>            <span class="comment">// For now, keep the dimension but set to 1</span></div>
<div class="line"><span class="lineno"> 4107</span>            <span class="comment">// A proper implementation would reduce the tensor rank</span></div>
<div class="line"><span class="lineno"> 4108</span>            <a class="code hl_class" href="classTensor.html">result_dims</a>[<a class="code hl_class" href="classTensor.html">ax</a>] = 1;</div>
<div class="line"><span class="lineno"> 4109</span>        }</div>
<div class="line"><span class="lineno"> 4110</span>        </div>
<div class="line"><span class="lineno"> 4111</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">result_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4112</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4113</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4114</span>        </div>
<div class="line"><span class="lineno"> 4115</span>        <span class="comment">// Compute sum</span></div>
<div class="line"><span class="lineno"> 4116</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 4117</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">ax</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4118</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4119</span>        }</div>
<div class="line"><span class="lineno"> 4120</span>        </div>
<div class="line"><span class="lineno"> 4121</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">reduce_dim</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">ax</a>];</div>
<div class="line"><span class="lineno"> 4122</span>        </div>
<div class="line"><span class="lineno"> 4123</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 4124</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">ax</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4125</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4126</span>        }</div>
<div class="line"><span class="lineno"> 4127</span>        </div>
<div class="line"><span class="lineno"> 4128</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4129</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4130</span>                <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> = <a class="code hl_class" href="classTensor.html">T</a>(0);</div>
<div class="line"><span class="lineno"> 4131</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">r</a> = 0; <a class="code hl_class" href="classTensor.html">r</a> &lt; <a class="code hl_class" href="classTensor.html">reduce_dim</a>; ++<a class="code hl_class" href="classTensor.html">r</a>) {</div>
<div class="line"><span class="lineno"> 4132</span>                    <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 4133</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">linear_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">reduce_dim</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">r</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4134</span>                    </div>
<div class="line"><span class="lineno"> 4135</span>                    <span class="comment">// Convert linear index to multi-dimensional</span></div>
<div class="line"><span class="lineno"> 4136</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">linear_idx</a>;</div>
<div class="line"><span class="lineno"> 4137</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 4138</span>                        <a class="code hl_class" href="classTensor.html">idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4139</span>                        <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4140</span>                    }</div>
<div class="line"><span class="lineno"> 4141</span>                    </div>
<div class="line"><span class="lineno"> 4142</span>                    <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a> += (*this)[<a class="code hl_class" href="classTensor.html">idx</a>];</div>
<div class="line"><span class="lineno"> 4143</span>                }</div>
<div class="line"><span class="lineno"> 4144</span>                </div>
<div class="line"><span class="lineno"> 4145</span>                <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">result_idx</a>;</div>
<div class="line"><span class="lineno"> 4146</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">result_linear</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4147</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">result_linear</a>;</div>
<div class="line"><span class="lineno"> 4148</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 4149</span>                    <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">d</a> == <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">ax</a>)) {</div>
<div class="line"><span class="lineno"> 4150</span>                        <a class="code hl_class" href="classTensor.html">result_idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = 0;</div>
<div class="line"><span class="lineno"> 4151</span>                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">d</a> &lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">ax</a>)) {</div>
<div class="line"><span class="lineno"> 4152</span>                        <a class="code hl_class" href="classTensor.html">result_idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> / <a class="code hl_class" href="classTensor.html">inner</a>;</div>
<div class="line"><span class="lineno"> 4153</span>                        <a class="code hl_class" href="classTensor.html">temp</a> %= <a class="code hl_class" href="classTensor.html">inner</a>;</div>
<div class="line"><span class="lineno"> 4154</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4155</span>                        <a class="code hl_class" href="classTensor.html">result_idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_class" href="classTensor.html">result_dims</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4156</span>                        <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_class" href="classTensor.html">result_dims</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4157</span>                    }</div>
<div class="line"><span class="lineno"> 4158</span>                }</div>
<div class="line"><span class="lineno"> 4159</span>                </div>
<div class="line"><span class="lineno"> 4160</span>                <a class="code hl_class" href="classTensor.html">result</a>[<a class="code hl_class" href="classTensor.html">result_idx</a>] = <a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>;</div>
<div class="line"><span class="lineno"> 4161</span>            }</div>
<div class="line"><span class="lineno"> 4162</span>        }</div>
<div class="line"><span class="lineno"> 4163</span>        </div>
<div class="line"><span class="lineno"> 4164</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 4165</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4166</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4167</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">self_dims</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 4168</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">reduce_axis</a> = <a class="code hl_class" href="classTensor.html">ax</a>;</div>
<div class="line"><span class="lineno"> 4169</span>            </div>
<div class="line"><span class="lineno"> 4170</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">self_dims</a>, <a class="code hl_class" href="classTensor.html">reduce_axis</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 4171</span>                <span class="comment">// Gradient of sum: broadcast gradient back to original shape</span></div>
<div class="line"><span class="lineno"> 4172</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4173</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4174</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4175</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4176</span>                    }</div>
<div class="line"><span class="lineno"> 4177</span>                    </div>
<div class="line"><span class="lineno"> 4178</span>                    <span class="comment">// Each element in the original tensor contributed to one element in the sum</span></div>
<div class="line"><span class="lineno"> 4179</span>                    <span class="comment">// So gradient is just broadcast of the output gradient</span></div>
<div class="line"><span class="lineno"> 4180</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4181</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4182</span>                        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 4183</span>                        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4184</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">d</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">N</a>) - 1; <a class="code hl_class" href="classTensor.html">d</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">d</a>) {</div>
<div class="line"><span class="lineno"> 4185</span>                            <a class="code hl_class" href="classTensor.html">idx</a>[<a class="code hl_class" href="classTensor.html">d</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_class" href="classTensor.html">self_dims</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4186</span>                            <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_class" href="classTensor.html">self_dims</a>[<a class="code hl_class" href="classTensor.html">d</a>];</div>
<div class="line"><span class="lineno"> 4187</span>                        }</div>
<div class="line"><span class="lineno"> 4188</span>                        </div>
<div class="line"><span class="lineno"> 4189</span>                        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">grad_idx</a> = <a class="code hl_class" href="classTensor.html">idx</a>;</div>
<div class="line"><span class="lineno"> 4190</span>                        <a class="code hl_class" href="classTensor.html">grad_idx</a>[<a class="code hl_class" href="classTensor.html">reduce_axis</a>] = 0;  <span class="comment">// Sum reduced this dimension</span></div>
<div class="line"><span class="lineno"> 4191</span>                        </div>
<div class="line"><span class="lineno"> 4192</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>[<a class="code hl_class" href="classTensor.html">grad_idx</a>];</div>
<div class="line"><span class="lineno"> 4193</span>                    }</div>
<div class="line"><span class="lineno"> 4194</span>                    </div>
<div class="line"><span class="lineno"> 4195</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4196</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4197</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4198</span>                        }</div>
<div class="line"><span class="lineno"> 4199</span>                    }</div>
<div class="line"><span class="lineno"> 4200</span>                }</div>
<div class="line"><span class="lineno"> 4201</span>            });</div>
<div class="line"><span class="lineno"> 4202</span>        }</div>
<div class="line"><span class="lineno"> 4203</span>        </div>
<div class="line"><span class="lineno"> 4204</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4205</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_ac20a4679e14de6f68e148b447496adfc_icgraph.png" border="0" usemap="#aclassTensor_ac20a4679e14de6f68e148b447496adfc_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_ac20a4679e14de6f68e148b447496adfc_icgraph" id="aclassTensor_ac20a4679e14de6f68e148b447496adfc_icgraph">
<area shape="rect" title=" " alt="" coords="235,47,359,73"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1BatchNorm1d.html#a48ea5fa069810067b9756e3d24b48b73" title=" " alt="" coords="5,5,187,48"/>
<area shape="poly" title=" " alt="" coords="219,50,187,44,187,39,220,45"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Linear.html#a5364162aed6bb8c7758d88142ac74c1b" title=" " alt="" coords="28,72,164,115"/>
<area shape="poly" title=" " alt="" coords="220,75,165,85,164,79,219,70"/>
</map>
</div>

</div>
</div>
<a id="ac15f7a77f31ef7862dd9909c9ad97160" name="ac15f7a77f31ef7862dd9909c9ad97160"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac15f7a77f31ef7862dd9909c9ad97160">&#9670;&#160;</a></span>sum_axis() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::sum_axis </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>axis</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>keepdims</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sum reduction along a specific axis. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The dimension along which to sum. </td></tr>
    <tr><td class="paramname">keepdims</td><td>Whether to keep the reduced dimension (size 1) or remove it. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with the sum along the specified axis. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05080">5080</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5080</span>                                                                    {</div>
<div class="line"><span class="lineno"> 5081</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &gt;= <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 5082</span>            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 5083</span>        }</div>
<div class="line"><span class="lineno"> 5084</span>        </div>
<div class="line"><span class="lineno"> 5085</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 5086</span>        <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">axis</a>] = 1;</div>
<div class="line"><span class="lineno"> 5087</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 5088</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a234f74cd16bd13561f7963ba29efb163">fill</a>(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 5089</span>        </div>
<div class="line"><span class="lineno"> 5090</span>        <span class="comment">// Calculate strides for iteration</span></div>
<div class="line"><span class="lineno"> 5091</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 5092</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">axis</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5093</span>            <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5094</span>        }</div>
<div class="line"><span class="lineno"> 5095</span>        </div>
<div class="line"><span class="lineno"> 5096</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 5097</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">axis</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5098</span>            <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5099</span>        }</div>
<div class="line"><span class="lineno"> 5100</span>        </div>
<div class="line"><span class="lineno"> 5101</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">axis_size</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>];</div>
<div class="line"><span class="lineno"> 5102</span>        </div>
<div class="line"><span class="lineno"> 5103</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 5104</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; (<a class="code hl_class" href="classTensor.html">std::is_same_v&lt;T, float&gt;</a> || <a class="code hl_class" href="classTensor.html">std::is_same_v&lt;T, double&gt;</a>)) {</div>
<div class="line"><span class="lineno"> 5105</span>            <a class="code hl_class" href="classTensor.html">TensorGPU::reduce_sum_axis_gpu</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(),</div>
<div class="line"><span class="lineno"> 5106</span>                                           <a class="code hl_class" href="classTensor.html">outer</a>, <a class="code hl_class" href="classTensor.html">axis_size</a>, <a class="code hl_class" href="classTensor.html">inner</a>);</div>
<div class="line"><span class="lineno"> 5107</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5108</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 5109</span>        {</div>
<div class="line"><span class="lineno"> 5110</span>            <span class="comment">// CPU/BLAS fallback - triple nested loop</span></div>
<div class="line"><span class="lineno"> 5111</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 5112</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5113</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 0; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 5114</span>                        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 5115</span>                        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">dst_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 5116</span>                        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">dst_idx</a>] += <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 5117</span>                    }</div>
<div class="line"><span class="lineno"> 5118</span>                }</div>
<div class="line"><span class="lineno"> 5119</span>            }</div>
<div class="line"><span class="lineno"> 5120</span>        }</div>
<div class="line"><span class="lineno"> 5121</span>        </div>
<div class="line"><span class="lineno"> 5122</span>        <span class="comment">// If requested, squeeze the result (remove dimension of size 1)</span></div>
<div class="line"><span class="lineno"> 5123</span>        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">keepdims</a> &amp;&amp; <a class="code hl_class" href="classTensor.html">N</a> &gt; 1) {</div>
<div class="line"><span class="lineno"> 5124</span>            <span class="comment">// Return as-is with size 1 dimension</span></div>
<div class="line"><span class="lineno"> 5125</span>            <span class="comment">// Full squeeze would require changing dimension template parameter</span></div>
<div class="line"><span class="lineno"> 5126</span>        }</div>
<div class="line"><span class="lineno"> 5127</span>        </div>
<div class="line"><span class="lineno"> 5128</span>        <span class="comment">// Handle gradient tracking</span></div>
<div class="line"><span class="lineno"> 5129</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 5130</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 5131</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 5132</span>            </div>
<div class="line"><span class="lineno"> 5133</span>            <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">self_ptr</a> = <a class="code hl_class" href="classTensor.html">std::make_shared&lt;Tensor&lt;T, N&gt;</a>&gt;(*this);</div>
<div class="line"><span class="lineno"> 5134</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.push_back([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">axis</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 5135</span>                <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 5136</span>                    <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>,</div>
<div class="line"><span class="lineno"> 5137</span>                                                                      <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 5138</span>                    <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 5139</span>                }</div>
<div class="line"><span class="lineno"> 5140</span>                </div>
<div class="line"><span class="lineno"> 5141</span>                <span class="comment">// Broadcast gradient back to original shape</span></div>
<div class="line"><span class="lineno"> 5142</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 5143</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">axis</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5144</span>                    <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5145</span>                }</div>
<div class="line"><span class="lineno"> 5146</span>                </div>
<div class="line"><span class="lineno"> 5147</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">inner</a> = 1;</div>
<div class="line"><span class="lineno"> 5148</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">axis</a> + 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5149</span>                    <a class="code hl_class" href="classTensor.html">inner</a> *= <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 5150</span>                }</div>
<div class="line"><span class="lineno"> 5151</span>                </div>
<div class="line"><span class="lineno"> 5152</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">axis_size</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">axis</a>];</div>
<div class="line"><span class="lineno"> 5153</span>                </div>
<div class="line"><span class="lineno"> 5154</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 5155</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a> &amp;&amp; (<a class="code hl_class" href="classTensor.html">std::is_same_v&lt;T, float&gt;</a> || <a class="code hl_class" href="classTensor.html">std::is_same_v&lt;T, double&gt;</a>)) {</div>
<div class="line"><span class="lineno"> 5156</span>                    <a class="code hl_class" href="classTensor.html">TensorGPU::broadcast_add_axis_gpu</a>(<a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_ptr(), <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_ptr(),</div>
<div class="line"><span class="lineno"> 5157</span>                                                      <a class="code hl_class" href="classTensor.html">outer</a>, <a class="code hl_class" href="classTensor.html">axis_size</a>, <a class="code hl_class" href="classTensor.html">inner</a>);</div>
<div class="line"><span class="lineno"> 5158</span>                } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5159</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 5160</span>                {</div>
<div class="line"><span class="lineno"> 5161</span>                    <span class="comment">// CPU fallback - triple nested loop</span></div>
<div class="line"><span class="lineno"> 5162</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 5163</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">inner</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 5164</span>                            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">grad_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 5165</span>                            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">a</a> = 0; <a class="code hl_class" href="classTensor.html">a</a> &lt; <a class="code hl_class" href="classTensor.html">axis_size</a>; ++<a class="code hl_class" href="classTensor.html">a</a>) {</div>
<div class="line"><span class="lineno"> 5166</span>                                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">self_idx</a> = <a class="code hl_class" href="classTensor.html">o</a> * <a class="code hl_class" href="classTensor.html">axis_size</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">a</a> * <a class="code hl_class" href="classTensor.html">inner</a> + <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 5167</span>                                <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">self_idx</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">grad_idx</a>];</div>
<div class="line"><span class="lineno"> 5168</span>                            }</div>
<div class="line"><span class="lineno"> 5169</span>                        }</div>
<div class="line"><span class="lineno"> 5170</span>                    }</div>
<div class="line"><span class="lineno"> 5171</span>                }</div>
<div class="line"><span class="lineno"> 5172</span>                </div>
<div class="line"><span class="lineno"> 5173</span>                <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 5174</span>                    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 5175</span>                        <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 5176</span>                    }</div>
<div class="line"><span class="lineno"> 5177</span>                }</div>
<div class="line"><span class="lineno"> 5178</span>            });</div>
<div class="line"><span class="lineno"> 5179</span>        }</div>
<div class="line"><span class="lineno"> 5180</span>        </div>
<div class="line"><span class="lineno"> 5181</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 5182</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a44953b617ae85b4e9cc7906454bee59d" name="a44953b617ae85b4e9cc7906454bee59d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44953b617ae85b4e9cc7906454bee59d">&#9670;&#160;</a></span>tail()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 1&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::tail </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract last n elements (only for 1D tensors). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of elements to extract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1D tensor containing last n elements </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05704">5704</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5704</span>                                      {</div>
<div class="line"><span class="lineno"> 5705</span>        <a class="code hl_class" href="classTensor.html">return ::tail</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 1&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)), <a class="code hl_class" href="classTensor.html">n</a>);</div>
<div class="line"><span class="lineno"> 5706</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab71358eec191f202a2e95ce375133c28" name="ab71358eec191f202a2e95ce375133c28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab71358eec191f202a2e95ce375133c28">&#9670;&#160;</a></span>take()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 1 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::take </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; size_t &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>indices</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Extract elements at specific flat indices (fancy indexing). Treats the tensor as a flattened 1D array and extracts elements at the given indices. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">indices</td><td><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b" title="Type alias for 1D vectors.">Vector</a> of flat indices to extract. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new 1D tensor containing the extracted elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04975">4975</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4975</span>                                                              {</div>
<div class="line"><span class="lineno"> 4976</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 1&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>({<a class="code hl_class" href="classTensor.html">indices</a>.size()}, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 4977</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4978</span>        </div>
<div class="line"><span class="lineno"> 4979</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">indices</a>.size(); ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4980</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">indices</a>[<a class="code hl_class" href="classTensor.html">i</a>] &lt; <a class="code hl_class" href="classTensor.html">total</a>) {</div>
<div class="line"><span class="lineno"> 4981</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">indices</a>[<a class="code hl_class" href="classTensor.html">i</a>]];</div>
<div class="line"><span class="lineno"> 4982</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4983</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">T</a>(0);  <span class="comment">// Out of bounds returns zero</span></div>
<div class="line"><span class="lineno"> 4984</span>            }</div>
<div class="line"><span class="lineno"> 4985</span>        }</div>
<div class="line"><span class="lineno"> 4986</span>        </div>
<div class="line"><span class="lineno"> 4987</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4988</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ccbe9aa15ebe52d33cb890388bdf1ca" name="a0ccbe9aa15ebe52d33cb890388bdf1ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ccbe9aa15ebe52d33cb890388bdf1ca">&#9670;&#160;</a></span>tan()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::tan </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply tangent function to all elements (creates new tensor). </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with tan(x) applied to all elements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02197">2197</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2197</span>                             {</div>
<div class="line"><span class="lineno"> 2198</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">std::tan</a>(<a class="code hl_class" href="classTensor.html">x</a>); });</div>
<div class="line"><span class="lineno"> 2199</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7cc09049ddf2fb131becaefe19b7725a" name="a7cc09049ddf2fb131becaefe19b7725a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cc09049ddf2fb131becaefe19b7725a">&#9670;&#160;</a></span>tan_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::tan_derivative </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of tangent function. d/dx[tan(x)] = sec(x) = 1 / cos(x) </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with tan derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02684">2684</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2684</span>                                        {</div>
<div class="line"><span class="lineno"> 2685</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) { </div>
<div class="line"><span class="lineno"> 2686</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">c</a> = <a class="code hl_class" href="classTensor.html">std::cos</a>(<a class="code hl_class" href="classTensor.html">x</a>);</div>
<div class="line"><span class="lineno"> 2687</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">T</a>(1) / (<a class="code hl_class" href="classTensor.html">c</a> * <a class="code hl_class" href="classTensor.html">c</a>);</div>
<div class="line"><span class="lineno"> 2688</span>        });</div>
<div class="line"><span class="lineno"> 2689</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="adcc5341aa2156f24c0f4069543c958e1" name="adcc5341aa2156f24c0f4069543c958e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcc5341aa2156f24c0f4069543c958e1">&#9670;&#160;</a></span>tanh()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::tanh </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply hyperbolic tangent (tanh) to all elements (creates new tensor). </p>
<p>Computes tanh(x) = (exp(x) - exp(-x)) / (exp(x) + exp(-x)) for each element. Alternative activation function that outputs values in (-1, 1), making it zero-centered (unlike sigmoid). Often preferred in RNNs and hidden layers.</p>
<p>Range: (-1, 1) - zero-centered output helps with convergence.</p>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with tanh(x) applied to all elements</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_tanh"></a>
Example</h1>
<div class="fragment"><div class="line"><span class="comment">// Hidden layer with tanh activation</span></div>
<div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> hidden({32, 64}, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="keyword">auto</span> activated = hidden.tanh();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Common in RNNs for cell state updates:</span></div>
<div class="line"><span class="keyword">auto</span> cell_candidate = (W_c.matmul(concat) + b_c).tanh();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Comparison with sigmoid:</span></div>
<div class="line"><span class="keyword">auto</span> sigmoid_out = x.sigmoid();  <span class="comment">// Range: (0, 1)</span></div>
<div class="line"><span class="keyword">auto</span> tanh_out = x.tanh();        <span class="comment">// Range: (-1, 1), zero-centered</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02226">2226</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2226</span>                              {</div>
<div class="line"><span class="lineno"> 2227</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2228</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2229</span>        </div>
<div class="line"><span class="lineno"> 2230</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno"> 2231</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>) {</div>
<div class="line"><span class="lineno"> 2232</span>                <a class="code hl_class" href="classTensor.html">ensure_on_gpu</a>();</div>
<div class="line"><span class="lineno"> 2233</span>                <a class="code hl_class" href="classTensor.html">result</a>.ensure_on_gpu();</div>
<div class="line"><span class="lineno"> 2234</span>                <a class="code hl_class" href="classTensor.html">TensorGPU::tanh_gpu_direct</a>(<a class="code hl_class" href="classTensor.html">d_data_</a>, <a class="code hl_class" href="classTensor.html">result</a>.d_data_, <a class="code hl_class" href="classTensor.html">total</a>);</div>
<div class="line"><span class="lineno"> 2235</span>                <a class="code hl_class" href="classTensor.html">result</a>.mark_gpu_modified();</div>
<div class="line"><span class="lineno"> 2236</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2237</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2238</span>        {</div>
<div class="line"><span class="lineno"> 2239</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2240</span>                <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">std::tanh</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>]);</div>
<div class="line"><span class="lineno"> 2241</span>            }</div>
<div class="line"><span class="lineno"> 2242</span>        }</div>
<div class="line"><span class="lineno"> 2243</span>        </div>
<div class="line"><span class="lineno"> 2244</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2245</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_adcc5341aa2156f24c0f4069543c958e1_icgraph.png" border="0" usemap="#aclassTensor_adcc5341aa2156f24c0f4069543c958e1_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_adcc5341aa2156f24c0f4069543c958e1_icgraph" id="aclassTensor_adcc5341aa2156f24c0f4069543c958e1_icgraph">
<area shape="rect" title="Apply hyperbolic tangent (tanh) to all elements (creates new tensor)." alt="" coords="183,13,276,40"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Tanh.html#a5bf1911c8b5865f171c90efbefbbe437" title=" " alt="" coords="5,5,135,48"/>
<area shape="poly" title=" " alt="" coords="167,29,135,29,135,24,167,24"/>
</map>
</div>

</div>
</div>
<a id="ab400f3516df53eb4e6547a850335571e" name="ab400f3516df53eb4e6547a850335571e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab400f3516df53eb4e6547a850335571e">&#9670;&#160;</a></span>tanh_derivative()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::tanh_derivative </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of tanh function. Given output y = tanh(x), computes dy/dx = 1 - y </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with tanh derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02587">2587</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2587</span>                                         {</div>
<div class="line"><span class="lineno"> 2588</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">y</a>) { <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">y</a> * <a class="code hl_class" href="classTensor.html">y</a>; });</div>
<div class="line"><span class="lineno"> 2589</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afa485f1ec713acb3499de0a08659fc4a" name="afa485f1ec713acb3499de0a08659fc4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa485f1ec713acb3499de0a08659fc4a">&#9670;&#160;</a></span>tanh_derivative_from_input()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::tanh_derivative_from_input </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute derivative of tanh from input values. Given input x, computes d/dx[tanh(x)] = 1 - tanh(x) </p><dl class="section return"><dt>Returns</dt><dd>A new tensor with tanh derivative. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02596">2596</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2596</span>                                                    {</div>
<div class="line"><span class="lineno"> 2597</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a314dfaedc4f6b2dc8e3b44bbc5381eb3">map</a>([](<a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">x</a>) {</div>
<div class="line"><span class="lineno"> 2598</span>            <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">th</a> = <a class="code hl_class" href="classTensor.html">std::tanh</a>(<a class="code hl_class" href="classTensor.html">x</a>);</div>
<div class="line"><span class="lineno"> 2599</span>            <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">T</a>(1) - <a class="code hl_class" href="classTensor.html">th</a> * <a class="code hl_class" href="classTensor.html">th</a>;</div>
<div class="line"><span class="lineno"> 2600</span>        });</div>
<div class="line"><span class="lineno"> 2601</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a84007917e116ae1e79622ca804360146" name="a84007917e116ae1e79622ca804360146"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84007917e116ae1e79622ca804360146">&#9670;&#160;</a></span>tile()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::tile </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt; N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>reps</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Tile (repeat) tensor multiple times along each dimension. Similar to <a class="el" href="#a9905069af5b17d1a5d1c16ec6f0a80fa">repeat()</a> but with slightly different semantics matching NumPy's tile. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">reps</td><td>Number of repetitions along each dimension </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with tiled data</dd></dl>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 2&gt;</a> A({2, 3});</div>
<div class="line"><span class="keyword">auto</span> B = A.tile({2, 2});  <span class="comment">// Tile 2x in each dimension -&gt; {4, 6}</span></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05637">5637</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5637</span>                                                          {</div>
<div class="line"><span class="lineno"> 5638</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#a9905069af5b17d1a5d1c16ec6f0a80fa">repeat</a>(<a class="code hl_class" href="classTensor.html">reps</a>);</div>
<div class="line"><span class="lineno"> 5639</span>    }</div>
<div class="ttc" id="aclassTensor_html_a9905069af5b17d1a5d1c16ec6f0a80fa"><div class="ttname"><a href="#a9905069af5b17d1a5d1c16ec6f0a80fa">Tensor::repeat</a></div><div class="ttdeci">Tensor&lt; T, N &gt; repeat(const TensorIndices&lt; N &gt; &amp;repeats) const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l05583">tensor.h:5583</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af09f3224c551629f43c48c18a1fe87ee" name="af09f3224c551629f43c48c18a1fe87ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af09f3224c551629f43c48c18a1fe87ee">&#9670;&#160;</a></span>topRows()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N, typename = std::enable_if_t&lt;M == 2&gt;&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, 2 &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::topRows </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract top n rows (only for 2D tensors). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of rows to extract </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>2D tensor containing top n rows </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l05714">5714</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5714</span>                                         {</div>
<div class="line"><span class="lineno"> 5715</span>        <a class="code hl_class" href="classTensor.html">return ::topRows</a>(*<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, 2&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)), <a class="code hl_class" href="classTensor.html">n</a>);</div>
<div class="line"><span class="lineno"> 5716</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aad6aeb4859940befd0c46f0b99388bd7" name="aad6aeb4859940befd0c46f0b99388bd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad6aeb4859940befd0c46f0b99388bd7">&#9670;&#160;</a></span>total_size()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::total_size </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the total size of the tensor. </p><dl class="section return"><dt>Returns</dt><dd>The total number of elements in the tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00653">653</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  653</span>                              {</div>
<div class="line"><span class="lineno">  654</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">size</a> = 1;</div>
<div class="line"><span class="lineno">  655</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno">  656</span>            <a class="code hl_class" href="classTensor.html">size</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno">  657</span>        }</div>
<div class="line"><span class="lineno">  658</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">size</a>;</div>
<div class="line"><span class="lineno">  659</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aed9419fabd015e2c1c35ff6723c1600a" name="aed9419fabd015e2c1c35ff6723c1600a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed9419fabd015e2c1c35ff6723c1600a">&#9670;&#160;</a></span>transpose()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::transpose </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Transpose 2D tensor (swap dimensions 0 and 1). For N&gt;2, this swaps the last two dimensions. </p><dl class="section return"><dt>Returns</dt><dd>Transposed tensor </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04576">4576</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4576</span>                                   {</div>
<div class="line"><span class="lineno"> 4577</span>        <span class="keyword">static_assert</span>(<a class="code hl_class" href="classTensor.html">N</a> &gt;= 2, <span class="stringliteral">&quot;Transpose requires at least 2 dimensions&quot;</span>);</div>
<div class="line"><span class="lineno"> 4578</span>        </div>
<div class="line"><span class="lineno"> 4579</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 4580</span>        <a class="code hl_class" href="classTensor.html">std::swap</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">N</a>-2], <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">N</a>-1]);</div>
<div class="line"><span class="lineno"> 4581</span>        </div>
<div class="line"><span class="lineno"> 4582</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4583</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4584</span>        </div>
<div class="line"><span class="lineno"> 4585</span>        <span class="comment">// Transpose the last two dimensions</span></div>
<div class="line"><span class="lineno"> 4586</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<a class="code hl_class" href="classTensor.html">N</a> == 2) {</div>
<div class="line"><span class="lineno"> 4587</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[0]; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4588</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">j</a> = 0; <a class="code hl_class" href="classTensor.html">j</a> &lt; <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[1]; ++<a class="code hl_class" href="classTensor.html">j</a>) {</div>
<div class="line"><span class="lineno"> 4589</span>                    <a class="code hl_class" href="classTensor.html">result</a>[{<a class="code hl_class" href="classTensor.html">j</a>, <a class="code hl_class" href="classTensor.html">i</a>}] = (*this)[{<a class="code hl_class" href="classTensor.html">i</a>, <a class="code hl_class" href="classTensor.html">j</a>}];</div>
<div class="line"><span class="lineno"> 4590</span>                }</div>
<div class="line"><span class="lineno"> 4591</span>            }</div>
<div class="line"><span class="lineno"> 4592</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4593</span>            <span class="comment">// For N&gt;2, transpose last two dims while iterating over others</span></div>
<div class="line"><span class="lineno"> 4594</span>            <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">outer</a> = 1;</div>
<div class="line"><span class="lineno"> 4595</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>-2; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4596</span>                <a class="code hl_class" href="classTensor.html">outer</a> *= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4597</span>            }</div>
<div class="line"><span class="lineno"> 4598</span>            </div>
<div class="line"><span class="lineno"> 4599</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">o</a> = 0; <a class="code hl_class" href="classTensor.html">o</a> &lt; <a class="code hl_class" href="classTensor.html">outer</a>; ++<a class="code hl_class" href="classTensor.html">o</a>) {</div>
<div class="line"><span class="lineno"> 4600</span>                <span class="comment">// Compute indices for outer dimensions</span></div>
<div class="line"><span class="lineno"> 4601</span>                <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">base_idx</a>;</div>
<div class="line"><span class="lineno"> 4602</span>                <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">temp</a> = <a class="code hl_class" href="classTensor.html">o</a>;</div>
<div class="line"><span class="lineno"> 4603</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">N</a>-3; <a class="code hl_class" href="classTensor.html">i</a> &gt;= 0; --<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4604</span>                    <a class="code hl_class" href="classTensor.html">base_idx</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">temp</a> % <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4605</span>                    <a class="code hl_class" href="classTensor.html">temp</a> /= <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4606</span>                }</div>
<div class="line"><span class="lineno"> 4607</span>                </div>
<div class="line"><span class="lineno"> 4608</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">N</a>-2]; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4609</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">j</a> = 0; <a class="code hl_class" href="classTensor.html">j</a> &lt; <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">N</a>-1]; ++<a class="code hl_class" href="classTensor.html">j</a>) {</div>
<div class="line"><span class="lineno"> 4610</span>                        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">src_idx</a> = <a class="code hl_class" href="classTensor.html">base_idx</a>;</div>
<div class="line"><span class="lineno"> 4611</span>                        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">dst_idx</a> = <a class="code hl_class" href="classTensor.html">base_idx</a>;</div>
<div class="line"><span class="lineno"> 4612</span>                        <a class="code hl_class" href="classTensor.html">src_idx</a>[<a class="code hl_class" href="classTensor.html">N</a>-2] = <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4613</span>                        <a class="code hl_class" href="classTensor.html">src_idx</a>[<a class="code hl_class" href="classTensor.html">N</a>-1] = <a class="code hl_class" href="classTensor.html">j</a>;</div>
<div class="line"><span class="lineno"> 4614</span>                        <a class="code hl_class" href="classTensor.html">dst_idx</a>[<a class="code hl_class" href="classTensor.html">N</a>-2] = <a class="code hl_class" href="classTensor.html">j</a>;</div>
<div class="line"><span class="lineno"> 4615</span>                        <a class="code hl_class" href="classTensor.html">dst_idx</a>[<a class="code hl_class" href="classTensor.html">N</a>-1] = <a class="code hl_class" href="classTensor.html">i</a>;</div>
<div class="line"><span class="lineno"> 4616</span>                        <a class="code hl_class" href="classTensor.html">result</a>[<a class="code hl_class" href="classTensor.html">dst_idx</a>] = (*this)[<a class="code hl_class" href="classTensor.html">src_idx</a>];</div>
<div class="line"><span class="lineno"> 4617</span>                    }</div>
<div class="line"><span class="lineno"> 4618</span>                }</div>
<div class="line"><span class="lineno"> 4619</span>            }</div>
<div class="line"><span class="lineno"> 4620</span>        }</div>
<div class="line"><span class="lineno"> 4621</span>        </div>
<div class="line"><span class="lineno"> 4622</span>        <span class="comment">// Setup backward pass</span></div>
<div class="line"><span class="lineno"> 4623</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4624</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4625</span>            </div>
<div class="line"><span class="lineno"> 4626</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 4627</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4628</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4629</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>, </div>
<div class="line"><span class="lineno"> 4630</span>                                                                          <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4631</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4632</span>                    }</div>
<div class="line"><span class="lineno"> 4633</span>                    </div>
<div class="line"><span class="lineno"> 4634</span>                    <span class="comment">// Gradient of transpose is transpose of gradient</span></div>
<div class="line"><span class="lineno"> 4635</span>                    <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">grad_transposed</a> = <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.transpose();</div>
<div class="line"><span class="lineno"> 4636</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4637</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4638</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_class" href="classTensor.html">grad_transposed</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4639</span>                    }</div>
<div class="line"><span class="lineno"> 4640</span>                    </div>
<div class="line"><span class="lineno"> 4641</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4642</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4643</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4644</span>                        }</div>
<div class="line"><span class="lineno"> 4645</span>                    }</div>
<div class="line"><span class="lineno"> 4646</span>                }</div>
<div class="line"><span class="lineno"> 4647</span>            });</div>
<div class="line"><span class="lineno"> 4648</span>        }</div>
<div class="line"><span class="lineno"> 4649</span>        </div>
<div class="line"><span class="lineno"> 4650</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4651</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_aed9419fabd015e2c1c35ff6723c1600a_icgraph.png" border="0" usemap="#aclassTensor_aed9419fabd015e2c1c35ff6723c1600a_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_aed9419fabd015e2c1c35ff6723c1600a_icgraph" id="aclassTensor_aed9419fabd015e2c1c35ff6723c1600a_icgraph">
<area shape="rect" title=" " alt="" coords="190,13,315,40"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Linear.html#a5364162aed6bb8c7758d88142ac74c1b" title=" " alt="" coords="5,5,142,48"/>
<area shape="poly" title=" " alt="" coords="174,29,142,29,142,24,174,24"/>
</map>
</div>

</div>
</div>
<a id="a415f8016d31d376bb769402ce2ab5393" name="a415f8016d31d376bb769402ce2ab5393"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a415f8016d31d376bb769402ce2ab5393">&#9670;&#160;</a></span>uniform()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::uniform </td>
          <td>(</td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>low</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(0)</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>high</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(1)</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sample from uniform distribution [low, high). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">low</td><td>Lower bound (inclusive). </td></tr>
    <tr><td class="paramname">high</td><td>Upper bound (exclusive). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03429">3429</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3429</span>                                              {</div>
<div class="line"><span class="lineno"> 3430</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 3431</span>        <a class="code hl_class" href="classTensor.html">std::random_device</a> <a class="code hl_class" href="classTensor.html">rd</a>;</div>
<div class="line"><span class="lineno"> 3432</span>        <a class="code hl_class" href="classTensor.html">std::mt19937</a> <a class="code hl_class" href="classTensor.html">gen</a>(<a class="code hl_class" href="classTensor.html">rd</a>());</div>
<div class="line"><span class="lineno"> 3433</span>        <a class="code hl_class" href="classTensor.html">std::uniform_real_distribution&lt;&gt;</a> <a class="code hl_class" href="classTensor.html">dis</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">low</a>), <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">high</a>));</div>
<div class="line"><span class="lineno"> 3434</span>        </div>
<div class="line"><span class="lineno"> 3435</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3436</span>            <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_class" href="classTensor.html">dis</a>(<a class="code hl_class" href="classTensor.html">gen</a>));</div>
<div class="line"><span class="lineno"> 3437</span>        }</div>
<div class="line"><span class="lineno"> 3438</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac953ca944380b138ad1e524a1124070f" name="ac953ca944380b138ad1e524a1124070f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac953ca944380b138ad1e524a1124070f">&#9670;&#160;</a></span>unsqueeze()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;size_t M = N + 1&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, M &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::unsqueeze </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>axis</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Unsqueeze - add a dimension of size 1 at specified axis. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>Position to add the new dimension </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> with added dimension, or zero tensor if axis is invalid </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l04792">4792</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4792</span>                                              {</div>
<div class="line"><span class="lineno"> 4793</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">axis</a> &gt; <a class="code hl_class" href="classTensor.html">N</a>) {</div>
<div class="line"><span class="lineno"> 4794</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;M&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 4795</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, M&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4796</span>        }</div>
<div class="line"><span class="lineno"> 4797</span>        </div>
<div class="line"><span class="lineno"> 4798</span>        <a class="code hl_class" href="classTensor.html">TensorIndices&lt;M&gt;</a> <a class="code hl_class" href="classTensor.html">new_dims</a>;</div>
<div class="line"><span class="lineno"> 4799</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">axis</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4800</span>            <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4801</span>        }</div>
<div class="line"><span class="lineno"> 4802</span>        <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">axis</a>] = 1;</div>
<div class="line"><span class="lineno"> 4803</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = <a class="code hl_class" href="classTensor.html">axis</a>; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">N</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4804</span>            <a class="code hl_class" href="classTensor.html">new_dims</a>[<a class="code hl_class" href="classTensor.html">i</a>+1] = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4805</span>        }</div>
<div class="line"><span class="lineno"> 4806</span>        </div>
<div class="line"><span class="lineno"> 4807</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, M&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">new_dims</a>, <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>);</div>
<div class="line"><span class="lineno"> 4808</span>        <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4809</span>        </div>
<div class="line"><span class="lineno"> 4810</span>        <a class="code hl_class" href="classTensor.html">std::copy</a>(<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get(), <a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get() + <a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>(), <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>.get());</div>
<div class="line"><span class="lineno"> 4811</span>        </div>
<div class="line"><span class="lineno"> 4812</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4813</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">orig_dims</a> = <a class="code hl_variable" href="#a43fadce1ce3dd9ddb47c8b82168edb52">dims_</a>;</div>
<div class="line"><span class="lineno"> 4814</span>            <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>* <a class="code hl_class" href="classTensor.html">self_ptr</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4815</span>            </div>
<div class="line"><span class="lineno"> 4816</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#af274147e833dd1ab399ce08155ad169b">register_backward</a>([<a class="code hl_class" href="classTensor.html">self_ptr</a>, <a class="code hl_class" href="classTensor.html">orig_dims</a>](<span class="keyword">const</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, M&gt;</a>&amp; <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>) {</div>
<div class="line"><span class="lineno"> 4817</span>                <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#ac6b266b9e3b51d9da88b35eea30a92ec">requires_grad_</a>) {</div>
<div class="line"><span class="lineno"> 4818</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno"> 4819</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a> = <a class="code hl_class" href="classTensor.html">std::make_unique&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">orig_dims</a>, </div>
<div class="line"><span class="lineno"> 4820</span>                                                                          <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 4821</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno"> 4822</span>                    }</div>
<div class="line"><span class="lineno"> 4823</span>                    </div>
<div class="line"><span class="lineno"> 4824</span>                    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 4825</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 4826</span>                        <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;data_[<a class="code hl_class" href="classTensor.html">i</a>] += <a class="code hl_function" href="#a8c0ac5752345f4abb81ebe4fa78411fd">grad</a>.data_[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 4827</span>                    }</div>
<div class="line"><span class="lineno"> 4828</span>                    </div>
<div class="line"><span class="lineno"> 4829</span>                    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#abf7257d130e6bc46f6d2cd7de4ea2909">is_leaf_</a> &amp;&amp; !<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.empty()) {</div>
<div class="line"><span class="lineno"> 4830</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">func</a> : <a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>) {</div>
<div class="line"><span class="lineno"> 4831</span>                            <a class="code hl_class" href="classTensor.html">func</a>(*<a class="code hl_class" href="classTensor.html">self_ptr</a>-&gt;<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>);</div>
<div class="line"><span class="lineno"> 4832</span>                        }</div>
<div class="line"><span class="lineno"> 4833</span>                    }</div>
<div class="line"><span class="lineno"> 4834</span>                }</div>
<div class="line"><span class="lineno"> 4835</span>            });</div>
<div class="line"><span class="lineno"> 4836</span>        }</div>
<div class="line"><span class="lineno"> 4837</span>        </div>
<div class="line"><span class="lineno"> 4838</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 4839</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a83ae42925e21d2871d755407d7505c10" name="a83ae42925e21d2871d755407d7505c10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83ae42925e21d2871d755407d7505c10">&#9670;&#160;</a></span>uses_gpu()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::uses_gpu </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if tensor uses GPU. </p><dl class="section return"><dt>Returns</dt><dd>True if GPU is enabled for this tensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00866">866</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  866</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>; }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_a83ae42925e21d2871d755407d7505c10_icgraph.png" border="0" usemap="#aclassTensor_a83ae42925e21d2871d755407d7505c10_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_a83ae42925e21d2871d755407d7505c10_icgraph" id="aclassTensor_a83ae42925e21d2871d755407d7505c10_icgraph">
<area shape="rect" title=" " alt="" coords="720,1236,844,1263"/>
<area shape="rect" href="tensor_8h.html#a912e291f7a42f325c111def58ac98acf" title="Cast tensor to a different data type (NumPy&#45;compatible astype)." alt="" coords="558,5,619,32"/>
<area shape="poly" title=" " alt="" coords="777,1221,769,977,750,602,736,412,718,244,695,115,683,72,670,46,659,36,646,29,618,22,620,17,648,24,662,32,674,42,688,70,701,114,723,243,741,412,755,602,774,976,782,1220"/>
<area shape="rect" href="namespaceloss.html#a365059b00ea1e6ec1db86710cfcf3b31" title="Binary cross entropy loss for binary classification." alt="" coords="525,56,652,99"/>
<area shape="poly" title=" " alt="" coords="777,1220,767,988,746,637,732,458,714,299,693,178,682,137,670,112,651,96,654,92,674,109,687,135,698,177,719,299,737,457,752,636,772,988,782,1220"/>
<area shape="rect" href="tensor_8h.html#adc912199dacbff108e0d2cadfae000df" title="Extract a rectangular block from a 2D tensor." alt="" coords="562,123,615,149"/>
<area shape="poly" title=" " alt="" coords="777,1220,767,997,747,661,732,490,714,340,693,225,682,186,670,163,658,153,644,146,614,139,616,134,646,141,661,149,674,160,687,184,698,224,719,339,737,490,752,661,772,997,782,1220"/>
<area shape="rect" href="tensor_8h.html#aa94ca571f8bc2b76cd1bdb6fd851c556" title="Extract bottom n rows from a 2D tensor." alt="" coords="541,173,636,200"/>
<area shape="poly" title=" " alt="" coords="777,1221,765,1009,744,691,729,530,711,388,691,279,681,243,670,220,654,207,635,198,638,193,657,202,674,217,686,241,697,278,716,387,734,530,749,691,771,1008,782,1220"/>
<area shape="rect" href="namespacelinalg.html#a12137fd985ff57d9e9396c8f6919383e" title="Cholesky decomposition: A = L * L^T for symmetric positive definite matrices." alt="" coords="293,477,457,504"/>
<area shape="poly" title=" " alt="" coords="777,1221,772,1084,755,889,741,789,723,698,699,623,685,594,670,572,656,561,636,551,582,532,457,505,458,500,584,527,638,546,659,557,674,569,690,592,704,621,728,697,747,788,760,889,777,1084,783,1221"/>
<area shape="rect" href="tensor_8h.html#a64dfa8c2475ed50ae00ef1d4e1c12fd2" title="Divide tensor into equal&#45;sized chunks (last chunk may be smaller)." alt="" coords="560,1008,617,1035"/>
<area shape="poly" title=" " alt="" coords="770,1222,757,1183,736,1136,707,1089,670,1049,644,1034,616,1027,618,1022,646,1029,673,1045,712,1086,741,1134,762,1181,775,1220"/>
<area shape="rect" href="tensor_8h.html#a139335a446015c5f7ad70fa3d2ccfbec" title="Split tensor into chunks along specified axis." alt="" coords="352,996,398,1023"/>
<area shape="poly" title=" " alt="" coords="777,1221,770,1165,753,1096,739,1061,721,1028,698,998,670,974,636,958,600,950,561,950,523,955,452,976,400,1000,397,995,450,971,522,950,561,944,600,945,638,953,673,970,702,995,725,1025,744,1059,758,1095,775,1164,782,1220"/>
<area shape="rect" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74" title="Extract a single column from a 2D tensor." alt="" coords="569,275,608,301"/>
<area shape="poly" title=" " alt="" coords="776,1220,765,1025,742,738,727,592,710,465,690,367,680,335,670,315,656,304,640,297,608,291,609,286,642,292,659,299,674,312,685,333,696,366,715,464,732,592,747,737,770,1025,782,1220"/>
<area shape="rect" href="namespacelinalg.html#a6b7af062b5a9642d788fcc084335b39c" title=" " alt="" coords="305,325,445,352"/>
<area shape="poly" title=" " alt="" coords="778,1220,777,1056,773,940,765,814,752,689,732,574,705,480,689,444,670,417,641,403,583,386,445,355,446,350,585,381,643,398,673,413,693,441,710,478,737,573,757,688,770,814,778,939,782,1056,784,1220"/>
<area shape="rect" href="namespacelinalg.html#a61b846dd17050c602c624ff0a898d617" title=" " alt="" coords="5,275,96,301"/>
<area shape="poly" title=" " alt="" coords="777,1221,768,1015,749,708,734,554,716,419,695,317,683,284,670,265,651,252,627,243,564,232,486,230,400,235,228,257,97,281,96,276,227,252,400,230,486,225,564,227,629,238,654,248,674,261,687,281,700,316,721,418,739,554,754,708,773,1015,782,1221"/>
<area shape="rect" href="tensor_8h.html#a3331b6cf4ac182d022336e4d068a0e58" title="Create a copy of a tensor (NumPy&#45;compatible)." alt="" coords="564,1059,613,1085"/>
<area shape="poly" title=" " alt="" coords="766,1224,728,1161,702,1128,670,1100,642,1085,613,1078,614,1073,644,1080,673,1095,706,1124,733,1158,770,1221"/>
<area shape="rect" href="namespaceloss.html#a75edef9d102d2ab811b15c50f13c4eee" title="Cross entropy loss for multi&#45;class classification." alt="" coords="505,1109,672,1136"/>
<area shape="poly" title=" " alt="" coords="757,1226,719,1187,670,1150,646,1139,648,1134,673,1146,723,1183,761,1222"/>
<area shape="rect" href="tensor_8h.html#a43014e3309494c3851da86be3a162194" title="Extract the diagonal of a 2D tensor." alt="" coords="566,1160,611,1187"/>
<area shape="poly" title=" " alt="" coords="738,1231,671,1201,611,1182,612,1177,673,1196,741,1226"/>
<area shape="rect" href="namespacelinalg.html#ad030750ea599dfc970dc357fd319ebea" title=" " alt="" coords="547,1211,630,1237"/>
<area shape="poly" title=" " alt="" coords="704,1242,630,1232,631,1227,705,1237"/>
<area shape="rect" href="namespacelinalg.html#a1df90002eef905350589edef7a4ace1b" title=" " alt="" coords="547,1261,630,1288"/>
<area shape="poly" title=" " alt="" coords="705,1262,631,1272,630,1267,704,1257"/>
<area shape="rect" href="tensor_8h.html#ae66ddfcd20907014f524982e01698d82" title="Create a diagonal matrix from a 1D tensor." alt="" coords="544,1312,633,1339"/>
<area shape="poly" title=" " alt="" coords="741,1272,673,1302,634,1316,632,1311,671,1298,738,1268"/>
<area shape="rect" href="namespacelinalg.html#a4f401211bb16058dcce20c796bda8dd2" title="Compute dot product of two vectors." alt="" coords="550,1363,627,1389"/>
<area shape="poly" title=" " alt="" coords="761,1277,723,1316,673,1353,629,1371,627,1366,670,1348,719,1312,757,1273"/>
<area shape="rect" href="namespacelinalg.html#a7141076f8e6b39635853e8368a13c4ea" title="Compute eigenvalues and eigenvectors for symmetric matrices." alt="" coords="310,731,440,757"/>
<area shape="poly" title=" " alt="" coords="776,1221,766,1118,746,980,732,911,715,848,694,798,670,766,644,748,615,735,583,727,551,723,488,724,432,733,431,727,487,719,551,718,584,722,616,730,646,743,674,762,699,796,720,847,737,909,751,979,771,1118,781,1220"/>
<area shape="rect" href="classtensor4d_1_1nn_1_1Dropout.html#aff0f87aa27d1aceca0bbcc6b0655ce24" title=" " alt="" coords="515,1413,662,1456"/>
<area shape="poly" title=" " alt="" coords="769,1278,731,1340,705,1374,673,1403,655,1415,652,1411,670,1399,701,1370,727,1337,765,1275"/>
<area shape="rect" href="tensor_8h.html#a04c7965d0b8f08cfdb84580050e9e0b5" title="Extract first n elements from a 1D tensor." alt="" coords="564,1480,613,1507"/>
<area shape="poly" title=" " alt="" coords="777,1278,764,1320,744,1372,714,1425,695,1449,673,1470,644,1486,614,1494,613,1488,642,1481,670,1466,691,1445,709,1422,739,1370,759,1319,772,1277"/>
<area shape="rect" href="namespacelinalg.html#abc25aee98d873c690a7d8a88277e7219" title="Compute inverse of a square matrix." alt="" coords="144,680,245,707"/>
<area shape="poly" title=" " alt="" coords="774,1221,760,1140,738,1036,708,939,690,903,670,879,646,864,622,854,599,849,576,848,532,856,487,871,442,887,394,897,370,898,345,894,319,886,292,873,270,856,251,836,223,789,205,743,196,708,201,707,210,741,228,787,255,833,273,852,294,868,321,881,346,889,370,892,394,891,440,882,485,866,530,851,576,843,600,844,624,849,648,859,673,875,694,900,712,937,743,1035,766,1139,779,1220"/>
<area shape="rect" href="namespacelinalg.html#a7b56c15653bd4614605326c1ced1a36d" title="Compute Kronecker product of two matrices." alt="" coords="546,1531,631,1557"/>
<area shape="poly" title=" " alt="" coords="780,1278,770,1330,751,1395,720,1462,699,1493,673,1521,654,1534,632,1541,630,1536,651,1529,670,1517,694,1490,715,1460,746,1393,765,1329,774,1277"/>
<area shape="rect" href="namespaceloss.html#ab7fbd0200f34e3d12f66d20b681a948f" title="L1 loss (Mean Absolute Error)." alt="" coords="541,1581,636,1608"/>
<area shape="poly" title=" " alt="" coords="782,1279,775,1339,758,1417,744,1459,725,1500,702,1538,673,1571,656,1583,637,1591,635,1586,654,1579,670,1567,698,1535,721,1497,739,1457,752,1416,770,1338,776,1278"/>
<area shape="rect" href="tensor_8h.html#a0d1116cdf6624cb52514979cd1869e55" title="Extract leftmost n columns from a 2D tensor." alt="" coords="555,1632,622,1659"/>
<area shape="poly" title=" " alt="" coords="783,1278,779,1347,764,1439,750,1488,731,1537,706,1582,673,1622,649,1638,623,1645,621,1640,647,1633,670,1618,702,1579,726,1534,745,1487,759,1438,774,1347,778,1278"/>
<area shape="rect" href="namespacelinalg.html#a8405b084d692b1fc7f685f40425a0970" title="Solve least squares problem: minimize ||Ax &#45; b||" alt="" coords="7,579,94,605"/>
<area shape="poly" title=" " alt="" coords="777,1221,772,1161,755,1084,742,1044,723,1006,700,971,670,942,646,925,622,914,577,903,533,905,489,913,444,923,396,928,346,923,319,915,292,902,245,871,202,833,165,791,132,747,83,664,55,607,60,605,88,662,137,744,169,788,206,830,248,867,294,898,321,910,347,918,396,923,443,918,488,908,533,900,578,898,624,909,649,921,673,938,704,968,728,1003,747,1042,761,1082,777,1160,783,1220"/>
<area shape="rect" href="namespacelinalg.html#a299049265c4cb34923444e82e56f381f" title="Compute LU decomposition with partial pivoting: P*A = L*U." alt="" coords="314,528,436,555"/>
<area shape="poly" title=" " alt="" coords="777,1221,770,1092,753,911,739,819,720,735,697,666,684,639,670,619,654,607,631,596,570,577,501,562,436,552,437,546,502,557,572,572,633,591,657,603,674,615,689,636,702,664,726,733,744,818,758,911,775,1092,782,1221"/>
<area shape="rect" href="namespacelinalg.html#a49a644f54af36b484886d433da564a1f" title="Solve linear system Ax = b." alt="" coords="149,528,240,555"/>
<area shape="poly" title=" " alt="" coords="778,1220,773,1075,758,866,744,758,726,660,701,579,686,548,670,524,646,502,623,487,600,478,576,474,523,472,457,468,373,454,338,455,294,468,279,476,269,486,247,511,220,530,217,525,243,507,266,483,276,472,292,463,337,450,374,449,458,463,523,467,577,469,601,473,625,482,649,498,674,521,691,545,706,577,731,659,750,757,763,865,779,1075,783,1220"/>
<area shape="rect" href="namespacelinalg.html#a6ee776536e47c3e57b3b24ed6225bff2" title=" " alt="" coords="537,427,640,453"/>
<area shape="poly" title=" " alt="" coords="778,1221,773,1068,758,844,744,729,726,622,701,534,686,500,670,474,656,461,639,453,641,448,659,457,674,470,691,497,706,532,731,621,750,728,763,844,779,1067,783,1221"/>
<area shape="rect" href="namespacelinalg.html#a57a91e9770c813128f00c0a1ea674012" title=" " alt="" coords="537,1683,640,1709"/>
<area shape="poly" title=" " alt="" coords="779,1278,766,1368,743,1485,712,1598,694,1642,674,1672,658,1684,641,1691,639,1687,656,1679,670,1669,689,1639,707,1596,738,1484,761,1367,774,1278"/>
<area shape="rect" href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7" title="Mean Squared Error (MSE) Loss." alt="" coords="534,1733,643,1760"/>
<area shape="poly" title=" " alt="" coords="780,1278,768,1377,747,1510,732,1577,715,1638,696,1688,674,1723,660,1734,645,1741,643,1736,657,1729,670,1720,691,1686,710,1636,727,1576,741,1509,763,1376,775,1277"/>
<area shape="rect" href="namespacelinalg.html#a16562e1c4018bf2a58455158a8022fb9" title="Compute the L2 norm (Euclidean norm) of a vector." alt="" coords="544,1835,633,1861"/>
<area shape="poly" title=" " alt="" coords="781,1278,771,1394,751,1554,737,1636,719,1712,698,1774,674,1818,655,1833,634,1842,632,1837,653,1828,670,1814,694,1772,714,1710,732,1635,746,1554,766,1393,776,1277"/>
<area shape="rect" href="namespacelinalg.html#afbe723a0bf8fb7dc2d98815c1ea724b2" title="Normalize a vector to unit length." alt="" coords="318,1809,433,1836"/>
<area shape="poly" title=" " alt="" coords="781,1278,772,1387,752,1536,738,1612,720,1680,699,1736,674,1774,656,1785,632,1795,569,1809,498,1818,434,1823,433,1818,498,1813,568,1804,630,1790,654,1781,670,1770,694,1734,715,1678,733,1611,747,1535,767,1387,776,1278"/>
<area shape="rect" href="tensor_8h.html#aa8d30c4d06f085bf8078c8644030c633" title="Normalize tensor using L1 norm (sum of absolute values)." alt="" coords="541,1885,636,1912"/>
<area shape="poly" title=" " alt="" coords="782,1279,774,1406,756,1584,742,1675,724,1759,701,1827,688,1854,674,1875,657,1888,637,1896,635,1891,654,1884,670,1871,684,1852,696,1825,719,1757,737,1674,751,1583,769,1405,777,1278"/>
<area shape="rect" href="tensor_8h.html#a7718d2096a1190de7777bc65f9a86deb" title="Normalize tensor using L2 norm (Euclidean norm)." alt="" coords="541,1936,636,1963"/>
<area shape="poly" title=" " alt="" coords="782,1278,776,1415,759,1608,745,1707,727,1798,703,1874,689,1903,674,1926,657,1939,637,1947,635,1942,654,1934,670,1922,685,1900,698,1872,722,1797,740,1706,754,1607,771,1414,777,1278"/>
<area shape="rect" href="tensor_8h.html#a1782e0dff417e1292f8a6f1e3e1975f1" title="Min&#45;Max normalization: scales values to [min_val, max_val] range." alt="" coords="523,1987,654,2013"/>
<area shape="poly" title=" " alt="" coords="783,1278,778,1423,762,1632,749,1740,730,1838,705,1920,690,1952,674,1976,656,1990,652,1986,670,1973,686,1949,700,1918,725,1837,743,1739,757,1631,773,1423,777,1278"/>
<area shape="rect" href="tensor_8h.html#a57c931d0d77f610850f315fdd9acef39" title="Z&#45;score normalization (standardization): (x &#45; mean) / std." alt="" coords="527,2037,650,2064"/>
<area shape="poly" title=" " alt="" coords="783,1278,780,1432,765,1656,752,1772,733,1878,707,1966,691,2001,674,2027,652,2043,649,2038,670,2023,687,1998,702,1964,728,1877,747,1771,760,1655,774,1432,778,1278"/>
<area shape="rect" href="namespacelinalg.html#a8a8d04b2734fdcad37cc861687fbb6fc" title=" " alt="" coords="544,2088,633,2115"/>
<area shape="poly" title=" " alt="" coords="783,1278,781,1441,768,1680,755,1804,736,1918,709,2012,692,2049,674,2078,655,2092,634,2100,632,2095,653,2087,670,2074,688,2047,704,2011,730,1917,750,1803,763,1680,776,1441,778,1278"/>
<area shape="rect" href="namespacelinalg.html#a3395139856f5efebaa58f3bc9c4ed3bd" title="QR decomposition: A = QR." alt="" coords="314,781,437,808"/>
<area shape="poly" title=" " alt="" coords="775,1221,764,1125,744,998,730,934,713,878,693,832,670,803,642,786,610,774,577,768,543,766,476,771,421,783,420,778,475,766,542,760,577,762,612,769,644,781,673,799,697,830,718,876,735,933,749,997,770,1124,781,1220"/>
<area shape="rect" href="tensor_8h.html#ad71687cadd6e7bdae0f2d66fc9f437e1" title="Construct tensor by repeating along specified axis." alt="" coords="525,2139,652,2165"/>
<area shape="poly" title=" " alt="" coords="784,1278,783,1450,779,1572,771,1704,758,1836,738,1958,711,2059,694,2098,674,2128,654,2143,651,2139,670,2125,689,2096,706,2057,733,1957,753,1836,766,1704,774,1572,778,1450,778,1278"/>
<area shape="rect" href="tensor_8h.html#a3798be100af6c60da8c8489ba3ac808a" title="Extract rightmost n columns from a 2D tensor." alt="" coords="552,2189,625,2216"/>
<area shape="poly" title=" " alt="" coords="782,1278,770,1472,747,1757,732,1901,715,2028,695,2125,685,2158,674,2179,652,2195,627,2203,625,2198,649,2190,670,2176,680,2156,690,2124,710,2027,727,1901,742,1757,764,1471,776,1278"/>
<area shape="rect" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee" title="Extract a single row from a 2D tensor." alt="" coords="567,325,610,352"/>
<area shape="poly" title=" " alt="" coords="778,1220,776,1050,764,796,750,664,731,543,704,442,688,402,670,372,657,361,641,352,609,343,611,338,643,347,660,356,674,369,693,400,709,440,736,541,756,663,769,796,782,1049,783,1220"/>
<area shape="rect" href="namespaceloss.html#a2d2c1dacdb37d834f7dc10e85cd1a742" title="Smooth L1 loss (Huber loss)." alt="" coords="516,2240,661,2267"/>
<area shape="poly" title=" " alt="" coords="782,1278,771,1481,749,1783,734,1935,716,2070,696,2173,686,2208,674,2230,660,2241,656,2237,670,2226,681,2206,691,2171,711,2069,728,1935,743,1783,765,1481,776,1278"/>
<area shape="rect" href="namespacetensor4d_1_1nn.html#af4ed0870610368776140c66a749f99ab" title="Compute the Jacobian matrix of softmax for a single row." alt="" coords="514,2291,663,2333"/>
<area shape="poly" title=" " alt="" coords="782,1278,771,1490,749,1807,734,1968,716,2110,696,2219,685,2257,674,2280,662,2292,658,2288,670,2277,681,2255,691,2218,711,2110,728,1967,743,1807,765,1490,777,1278"/>
<area shape="rect" href="namespacelinalg.html#a2e81c90534586128fa4bcae3bb042175" title="Singular Value Decomposition: A = U * Sigma * V^T." alt="" coords="308,832,442,859"/>
<area shape="poly" title=" " alt="" coords="775,1221,763,1129,742,1010,728,951,711,898,692,856,670,829,654,821,632,817,573,816,506,823,443,834,442,829,505,818,572,811,632,811,656,816,673,825,696,853,716,896,733,949,747,1009,769,1129,780,1220"/>
<area shape="rect" href="tensor_8h.html#a90d629271a42d730c36b7be1f66deae8" title="Extract last n elements from a 1D tensor." alt="" coords="569,2357,608,2384"/>
<area shape="poly" title=" " alt="" coords="782,1278,773,1502,752,1842,737,2014,720,2166,699,2282,687,2322,674,2347,659,2359,642,2367,609,2373,608,2368,641,2362,657,2355,670,2344,682,2320,693,2281,714,2165,732,2013,747,1841,767,1502,777,1278"/>
<area shape="rect" href="tensor_8h.html#ac2791cd88647d71068c02d8824a38ff2" title="Repeat tensor multiple times along each dimension." alt="" coords="569,2408,608,2435"/>
<area shape="poly" title=" " alt="" coords="782,1278,773,1511,754,1867,739,2048,721,2208,700,2330,687,2372,674,2398,659,2410,642,2418,609,2424,608,2419,641,2413,657,2405,670,2394,682,2370,694,2329,716,2207,734,2047,748,1866,768,1511,777,1278"/>
<area shape="rect" href="tensor_8h.html#a1cb2cae503ca515b1780c72fd05b21db" title="Extract top n rows from a 2D tensor." alt="" coords="552,2459,625,2485"/>
<area shape="poly" title=" " alt="" coords="782,1279,774,1522,755,1893,741,2082,723,2250,701,2377,688,2421,674,2448,652,2465,626,2472,625,2467,649,2460,670,2445,683,2419,695,2376,717,2249,735,2082,750,1893,769,1521,777,1278"/>
<area shape="rect" href="namespacelinalg.html#af0c07b2c6a745bcb68c10766032cc5e0" title=" " alt="" coords="530,629,647,656"/>
<area shape="poly" title=" " alt="" coords="776,1221,766,1104,746,941,732,858,715,782,694,719,670,676,646,659,649,654,674,673,699,717,720,780,737,857,752,940,772,1103,781,1220"/>
<area shape="rect" href="classMemoryPool.html#a980db306a49ce0f4b149198a99b6d24e" title="Clear all pooled memory." alt="" coords="310,123,440,149"/>
<area shape="poly" title=" " alt="" coords="546,139,441,139,441,133,546,133"/>
<area shape="poly" title=" " alt="" coords="623,998,613,990,588,987,568,989,557,994,555,1000,562,1007,558,1011,550,1001,553,990,566,984,589,981,615,985,626,994"/>
<area shape="poly" title=" " alt="" coords="545,1022,398,1013,399,1008,545,1016"/>
<area shape="poly" title=" " alt="" coords="555,299,435,327,434,322,554,293"/>
<area shape="poly" title=" " alt="" coords="553,291,96,291,96,285,553,285"/>
<area shape="poly" title=" " alt="" coords="348,567,213,682,210,678,345,563"/>
<area shape="poly" title=" " alt="" coords="299,544,240,544,240,539,299,539"/>
<area shape="poly" title=" " alt="" coords="175,515,57,303,62,300,180,513"/>
<area shape="poly" title=" " alt="" coords="141,563,92,581,90,576,139,558"/>
<area shape="poly" title=" " alt="" coords="530,423,504,410,480,391,456,373,417,355,419,350,459,368,483,387,507,406,532,418"/>
<area shape="poly" title=" " alt="" coords="522,426,471,417,414,412,353,413,294,424,256,438,220,456,155,500,101,545,66,580,62,576,98,541,151,496,218,451,254,433,292,419,352,408,414,407,472,412,523,421"/>
<area shape="poly" title=" " alt="" coords="529,1844,433,1832,434,1827,529,1838"/>
<area shape="poly" title=" " alt="" coords="552,341,446,341,446,336,552,336"/>
<area shape="poly" title=" " alt="" coords="561,620,456,518,432,507,434,502,459,514,564,616"/>
<area shape="poly" title=" " alt="" coords="567,618,384,354,388,351,571,615"/>
<area shape="poly" title=" " alt="" coords="532,664,507,677,483,695,459,714,419,732,417,728,456,710,480,691,504,672,530,660"/>
<area shape="poly" title=" " alt="" coords="515,656,458,664,246,690,245,685,457,659,515,651"/>
<area shape="poly" title=" " alt="" coords="514,638,94,599,95,593,515,633"/>
<area shape="poly" title=" " alt="" coords="530,626,504,613,480,594,456,576,417,558,419,553,459,571,483,590,507,608,532,621"/>
<area shape="poly" title=" " alt="" coords="518,628,292,569,239,555,240,550,294,564,519,622"/>
<area shape="poly" title=" " alt="" coords="564,669,459,772,434,783,432,778,456,767,561,665"/>
<area shape="poly" title=" " alt="" coords="576,672,558,706,531,746,498,787,459,822,438,834,435,829,456,818,494,783,527,743,553,703,572,669"/>
</map>
</div>

</div>
</div>
<a id="ac24ac40382bfcce441f59645c4b73257" name="ac24ac40382bfcce441f59645c4b73257"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac24ac40382bfcce441f59645c4b73257">&#9670;&#160;</a></span>variance()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::variance </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>ddof</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute variance of all elements. </p>
<p>Calculates the variance, measuring the spread of data around the mean. Use ddof=1 for sample variance, ddof=0 for population variance.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ddof</td><td>Delta degrees of freedom (default 0 for population variance) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The variance as a scalar</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_variance"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;float, 1&gt;</a> <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>({5});</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{0}] = 1.0f;</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{1}] = 2.0f;</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{2}] = 3.0f;</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{3}] = 4.0f;</div>
<div class="line"><a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>[{4}] = 5.0f;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">float</span> pop_var = <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>.variance(0);  <span class="comment">// Population variance</span></div>
<div class="line"><span class="keywordtype">float</span> sample_var = <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>.variance(1);  <span class="comment">// Sample variance (unbiased)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// For normalized data distributions:</span></div>
<div class="line"><span class="keywordtype">float</span> var = <a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>.variance();</div>
<div class="line"><span class="keywordflow">if</span> (var &lt; 0.01f) {</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Data has low variance\n&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02815">2815</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2815</span>                                      {</div>
<div class="line"><span class="lineno"> 2816</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">m</a> = <a class="code hl_function" href="#a84b27bf0213ab3f228c2efe5ca31eaec">mean</a>();</div>
<div class="line"><span class="lineno"> 2817</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">diff</a> = *<span class="keyword">this</span> - <a class="code hl_class" href="classTensor.html">m</a>;</div>
<div class="line"><span class="lineno"> 2818</span>        <span class="keyword">auto</span> <a class="code hl_class" href="classTensor.html">squared_result</a> = <a class="code hl_class" href="classTensor.html">diff</a> * <a class="code hl_class" href="classTensor.html">diff</a>;</div>
<div class="line"><span class="lineno"> 2819</span>        <span class="keyword">auto</span>&amp; <a class="code hl_class" href="classTensor.html">squared</a> = <a class="code hl_class" href="classTensor.html">std::get&lt;Tensor&lt;T, N&gt;</a>&gt;(<a class="code hl_class" href="classTensor.html">squared_result</a>);</div>
<div class="line"><span class="lineno"> 2820</span>        <a class="code hl_class" href="classTensor.html">T</a> <a class="code hl_class" href="classTensor.html">var</a> = <a class="code hl_class" href="classTensor.html">squared</a>.<a class="code hl_function" href="#a3d279878b61732de2f1986dfc7de8400">sum</a>();</div>
<div class="line"><span class="lineno"> 2821</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">var</a> / <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classTensor.html">T</a><span class="keyword">&gt;</span>(<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>() - <a class="code hl_class" href="classTensor.html">ddof</a>);</div>
<div class="line"><span class="lineno"> 2822</span>    }</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classTensor_ac24ac40382bfcce441f59645c4b73257_icgraph.png" border="0" usemap="#aclassTensor_ac24ac40382bfcce441f59645c4b73257_icgraph" loading="lazy" alt=""/></div>
<map name="aclassTensor_ac24ac40382bfcce441f59645c4b73257_icgraph" id="aclassTensor_ac24ac40382bfcce441f59645c4b73257_icgraph">
<area shape="rect" title="Compute variance of all elements." alt="" coords="185,5,302,32"/>
<area shape="rect" href="classTensor.html#a0cda55fce732dcb563b598ff636d8758" title=" " alt="" coords="5,5,137,32"/>
<area shape="poly" title=" " alt="" coords="169,21,137,21,137,16,169,16"/>
</map>
</div>

</div>
</div>
<a id="a0fc4cc0c22be7a233b9c64c6677d54d5" name="a0fc4cc0c22be7a233b9c64c6677d54d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fc4cc0c22be7a233b9c64c6677d54d5">&#9670;&#160;</a></span>vstack()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::vstack </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensors</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Vertical stack (stack along first dimension) - convenience method for 2D tensors. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tensors</td><td><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b" title="Type alias for 1D vectors.">Vector</a> of tensors to stack vertically. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor stacked vertically. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l03507">3507</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3507</span>                                                                       {</div>
<div class="line"><span class="lineno"> 3508</span>        <span class="keyword">static_assert</span>(<a class="code hl_class" href="classTensor.html">N</a> &gt;= 2, <span class="stringliteral">&quot;vstack requires at least 2D tensors&quot;</span>);</div>
<div class="line"><span class="lineno"> 3509</span>        </div>
<div class="line"><span class="lineno"> 3510</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">tensors</a>.empty()) {</div>
<div class="line"><span class="lineno"> 3511</span>            <a class="code hl_class" href="classTensor.html">TensorIndices&lt;N&gt;</a> <a class="code hl_class" href="classTensor.html">zero_dims</a>{};</div>
<div class="line"><span class="lineno"> 3512</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">zero_dims</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3513</span>        }</div>
<div class="line"><span class="lineno"> 3514</span>        </div>
<div class="line"><span class="lineno"> 3515</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">tensors</a>.size() == 1) {</div>
<div class="line"><span class="lineno"> 3516</span>            <span class="keywordflow">return</span> <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a>(<a class="code hl_class" href="classTensor.html">tensors</a>[0]);</div>
<div class="line"><span class="lineno"> 3517</span>        }</div>
<div class="line"><span class="lineno"> 3518</span>        </div>
<div class="line"><span class="lineno"> 3519</span>        <span class="comment">// Start with first tensor and concatenate the rest</span></div>
<div class="line"><span class="lineno"> 3520</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">tensors</a>[0]);</div>
<div class="line"><span class="lineno"> 3521</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 1; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">tensors</a>.size(); ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 3522</span>            <a class="code hl_class" href="classTensor.html">result</a> = <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_function" href="#a7a0af0b59b00d2f2623609ff3562f087">concatenate</a>(<a class="code hl_class" href="classTensor.html">tensors</a>[<a class="code hl_class" href="classTensor.html">i</a>], 0);</div>
<div class="line"><span class="lineno"> 3523</span>        }</div>
<div class="line"><span class="lineno"> 3524</span>        </div>
<div class="line"><span class="lineno"> 3525</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 3526</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab35759b8f0cec852e27c31cf339737b8" name="ab35759b8f0cec852e27c31cf339737b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab35759b8f0cec852e27c31cf339737b8">&#9670;&#160;</a></span>where()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename C&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::where </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; C, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>condition</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>y</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Conditional selection (ternary operator for tensors). Returns a tensor where each element is taken from x if condition is true, otherwise from y. This is a static method that acts as a ternary operator: condition ? x : y </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">C</td><td>The condition tensor type (should be bool or numeric) </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">condition</td><td><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> of boolean/numeric values (non-zero is true). </td></tr>
    <tr><td class="paramname">x</td><td><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> to select from when condition is true. </td></tr>
    <tr><td class="paramname">y</td><td><a class="el" href="classTensor.html" title="Forward declaration for autograd.">Tensor</a> to select from when condition is false. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new tensor with conditional values. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l02541">2541</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2541</span>                                                                                                           {</div>
<div class="line"><span class="lineno"> 2542</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classTensor.html">condition</a>.<a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>() != <a class="code hl_class" href="classTensor.html">x</a>.<a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>() || <a class="code hl_class" href="classTensor.html">x</a>.<a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>() != <a class="code hl_class" href="classTensor.html">y</a>.<a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>()) {</div>
<div class="line"><span class="lineno"> 2543</span>            <span class="keywordflow">throw</span> <a class="code hl_class" href="classTensor.html">std::invalid_argument</a>(<span class="stringliteral">&quot;where(): all tensors must have the same shape&quot;</span>);</div>
<div class="line"><span class="lineno"> 2544</span>        }</div>
<div class="line"><span class="lineno"> 2545</span>        </div>
<div class="line"><span class="lineno"> 2546</span>        <a class="code hl_friend" href="#af4a07134de1525172d3c60c57e8f1496">Tensor&lt;T, N&gt;</a> <a class="code hl_class" href="classTensor.html">result</a>(<a class="code hl_class" href="classTensor.html">x</a>.<a class="code hl_function" href="#a03d314303958ffc5644796d8025cd012">dims</a>(), <a class="code hl_class" href="classTensor.html">x</a>.<a class="code hl_variable" href="#aa3214ec02474d17494e1eb95d5006262">use_gpu_</a>);</div>
<div class="line"><span class="lineno"> 2547</span>        <span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">total</a> = <a class="code hl_class" href="classTensor.html">x</a>.<a class="code hl_function" href="#aad6aeb4859940befd0c46f0b99388bd7">total_size</a>();</div>
<div class="line"><span class="lineno"> 2548</span>        </div>
<div class="line"><span class="lineno"> 2549</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classTensor.html">i</a> = 0; <a class="code hl_class" href="classTensor.html">i</a> &lt; <a class="code hl_class" href="classTensor.html">total</a>; ++<a class="code hl_class" href="classTensor.html">i</a>) {</div>
<div class="line"><span class="lineno"> 2550</span>            <a class="code hl_class" href="classTensor.html">result</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] = <a class="code hl_class" href="classTensor.html">condition</a>.<a class="code hl_function" href="#a07bf856a863505d2960b0bfad9c3b3f4">data</a>()[<a class="code hl_class" href="classTensor.html">i</a>] ? <a class="code hl_class" href="classTensor.html">x</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>] : <a class="code hl_class" href="classTensor.html">y</a>.<a class="code hl_variable" href="#acf7ced620891506216fc0112a743e04b">data_</a>[<a class="code hl_class" href="classTensor.html">i</a>];</div>
<div class="line"><span class="lineno"> 2551</span>        }</div>
<div class="line"><span class="lineno"> 2552</span>        </div>
<div class="line"><span class="lineno"> 2553</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classTensor.html">result</a>;</div>
<div class="line"><span class="lineno"> 2554</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a35de015456ce4657b150b3d6add16e3d" name="a35de015456ce4657b150b3d6add16e3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35de015456ce4657b150b3d6add16e3d">&#9670;&#160;</a></span>zero_grad()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::zero_grad </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Zero out the gradients. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00956">956</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  956</span>                     {</div>
<div class="line"><span class="lineno">  957</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>) {</div>
<div class="line"><span class="lineno">  958</span>            <a class="code hl_variable" href="#a4d61cfe1428b0302cd1683dc1e6fd733">grad_</a>-&gt;fill(<a class="code hl_class" href="classTensor.html">T</a>(0));</div>
<div class="line"><span class="lineno">  959</span>        }</div>
<div class="line"><span class="lineno">  960</span>        <a class="code hl_variable" href="#a89d50a2ba15e719d4bf025178150d308">backward_funcs_</a>.clear();</div>
<div class="line"><span class="lineno">  961</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a name="doc-related-members" id="doc-related-members"></a><h2 id="header-doc-related-members" class="groupheader">Friends And Related Symbol Documentation</h2>
<a id="af7fd1e562b92d7f3302fc10d83effcb1" name="af7fd1e562b92d7f3302fc10d83effcb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7fd1e562b92d7f3302fc10d83effcb1">&#9670;&#160;</a></span>Adam</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classAdam.html">Adam</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00897">897</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="a90bb53720dd3d4ba6e6bdacd786a7eaa" name="a90bb53720dd3d4ba6e6bdacd786a7eaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90bb53720dd3d4ba6e6bdacd786a7eaa">&#9670;&#160;</a></span>loss::binary_cross_entropy</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, 1 &gt; <a class="el" href="namespaceloss.html#a365059b00ea1e6ec1db86710cfcf3b31">loss::binary_cross_entropy</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a683473b73d31abc59759419a3214cc0a" name="a683473b73d31abc59759419a3214cc0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a683473b73d31abc59759419a3214cc0a">&#9670;&#160;</a></span>loss::cross_entropy_loss</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, 1 &gt; <a class="el" href="namespaceloss.html#a75edef9d102d2ab811b15c50f13c4eee">loss::cross_entropy_loss</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0cda1cdc9cb6e34768415968395336e6" name="a0cda1cdc9cb6e34768415968395336e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cda1cdc9cb6e34768415968395336e6">&#9670;&#160;</a></span>loss::l1_loss</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, 1 &gt; <a class="el" href="namespaceloss.html#ab7fbd0200f34e3d12f66d20b681a948f">loss::l1_loss</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a73e9357327da350df1da748ebeeefdaf" name="a73e9357327da350df1da748ebeeefdaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73e9357327da350df1da748ebeeefdaf">&#9670;&#160;</a></span>loss::mse_loss</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; <a class="el" href="namespaceloss.html#aff5180b0c38ddd16d08f058205c01ef7">loss::mse_loss</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9893818a67f313b613d96073a7e499ba" name="a9893818a67f313b613d96073a7e499ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9893818a67f313b613d96073a7e499ba">&#9670;&#160;</a></span>loss::smooth_l1_loss</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, 1 &gt; <a class="el" href="namespaceloss.html#a2d2c1dacdb37d834f7dc10e85cd1a742">loss::smooth_l1_loss</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8f3108b5c57f4335e97b21b78b42330d" name="a8f3108b5c57f4335e97b21b78b42330d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f3108b5c57f4335e97b21b78b42330d">&#9670;&#160;</a></span>operator*</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; operator* </td>
          <td>(</td>
          <td class="paramtype">const U &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2cb4bd9887892f4061bcc4dca0b73bea" name="a2cb4bd9887892f4061bcc4dca0b73bea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cb4bd9887892f4061bcc4dca0b73bea">&#9670;&#160;</a></span>operator+</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; operator+ </td>
          <td>(</td>
          <td class="paramtype">const U &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aac6ea4a3d1a17a2636be1ebfe4980aca" name="aac6ea4a3d1a17a2636be1ebfe4980aca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac6ea4a3d1a17a2636be1ebfe4980aca">&#9670;&#160;</a></span>operator-</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; operator- </td>
          <td>(</td>
          <td class="paramtype">const U &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0720e918044cb7c8c9246a04605bc3dc" name="a0720e918044cb7c8c9246a04605bc3dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0720e918044cb7c8c9246a04605bc3dc">&#9670;&#160;</a></span>operator/</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; operator/ </td>
          <td>(</td>
          <td class="paramtype">const U &amp;</td>          <td class="paramname"><span class="paramname"><em>scalar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7dfa2de684ae22342afca259156bc646" name="a7dfa2de684ae22342afca259156bc646"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dfa2de684ae22342afca259156bc646">&#9670;&#160;</a></span>Optimizer</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classOptimizer.html">Optimizer</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00891">891</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="a41c9488576fa08bf4f2140fa944babcb" name="a41c9488576fa08bf4f2140fa944babcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41c9488576fa08bf4f2140fa944babcb">&#9670;&#160;</a></span>print</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void print </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abaf62b111934cc2f3ca92641c4f0d6e4" name="abaf62b111934cc2f3ca92641c4f0d6e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaf62b111934cc2f3ca92641c4f0d6e4">&#9670;&#160;</a></span>RMSprop</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classRMSprop.html">RMSprop</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00900">900</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="a5d13a99740a5300be84dda1088ba7090" name="a5d13a99740a5300be84dda1088ba7090"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d13a99740a5300be84dda1088ba7090">&#9670;&#160;</a></span>save_binary</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool save_binary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a38b040592e2971efef12ec68d71ab18b" name="a38b040592e2971efef12ec68d71ab18b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38b040592e2971efef12ec68d71ab18b">&#9670;&#160;</a></span>save_npy</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool save_npy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9a5b8df7f4954ba2fb1f867a57d760dc" name="a9a5b8df7f4954ba2fb1f867a57d760dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a5b8df7f4954ba2fb1f867a57d760dc">&#9670;&#160;</a></span>save_text</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool save_text </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTensor.html">Tensor</a>&lt; U, M &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abd938abc7dd75aa658a2f68507d27e0c" name="abd938abc7dd75aa658a2f68507d27e0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd938abc7dd75aa658a2f68507d27e0c">&#9670;&#160;</a></span>SGD</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classSGD.html">SGD</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00894">894</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="af4a07134de1525172d3c60c57e8f1496" name="af4a07134de1525172d3c60c57e8f1496"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4a07134de1525172d3c60c57e8f1496">&#9670;&#160;</a></span>Tensor</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classTensor.html">Tensor</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00602">602</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="acff32a26ad67634e185bf3be335d8f45" name="acff32a26ad67634e185bf3be335d8f45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acff32a26ad67634e185bf3be335d8f45">&#9670;&#160;</a></span>TensorSlice</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classTensorSlice.html">TensorSlice</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00608">608</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="a22260556618c0a39e3ff6824e778fdb3" name="a22260556618c0a39e3ff6824e778fdb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22260556618c0a39e3ff6824e778fdb3">&#9670;&#160;</a></span>TensorView</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<div class="memtemplate">
template&lt;typename U, size_t M&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classTensorView.html">TensorView</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel friend">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00606">606</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a name="doc-variable-members" id="doc-variable-members"></a><h2 id="header-doc-variable-members" class="groupheader">Member Data Documentation</h2>
<a id="a89d50a2ba15e719d4bf025178150d308" name="a89d50a2ba15e719d4bf025178150d308"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89d50a2ba15e719d4bf025178150d308">&#9670;&#160;</a></span>backward_funcs_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="tensor_8h.html#a1e846f46f87b55f57de12d6aa70eda1e">BackwardFunc</a>&lt;T, N&gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::backward_funcs_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Functions to compute gradients. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00538">538</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="acf7ced620891506216fc0112a743e04b" name="acf7ced620891506216fc0112a743e04b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf7ced620891506216fc0112a743e04b">&#9670;&#160;</a></span>data_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;T[]&gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::data_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flat data storage in row-major order. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00520">520</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="a43fadce1ce3dd9ddb47c8b82168edb52" name="a43fadce1ce3dd9ddb47c8b82168edb52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43fadce1ce3dd9ddb47c8b82168edb52">&#9670;&#160;</a></span>dims_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt;N&gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::dims_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dimensions of the tensor. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00521">521</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="a4d61cfe1428b0302cd1683dc1e6fd733" name="a4d61cfe1428b0302cd1683dc1e6fd733"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d61cfe1428b0302cd1683dc1e6fd733">&#9670;&#160;</a></span>grad_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classTensor.html">Tensor</a>&lt;T, N&gt; &gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::grad_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gradient tensor. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00537">537</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="abf7257d130e6bc46f6d2cd7de4ea2909" name="abf7257d130e6bc46f6d2cd7de4ea2909"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf7257d130e6bc46f6d2cd7de4ea2909">&#9670;&#160;</a></span>is_leaf_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::is_leaf_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether this is a leaf node in the graph. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00539">539</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="ac6b266b9e3b51d9da88b35eea30a92ec" name="ac6b266b9e3b51d9da88b35eea30a92ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6b266b9e3b51d9da88b35eea30a92ec">&#9670;&#160;</a></span>requires_grad_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::requires_grad_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether to track gradients. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00536">536</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="af6821d656bfc94c60fe4cd256c1d7402" name="af6821d656bfc94c60fe4cd256c1d7402"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6821d656bfc94c60fe4cd256c1d7402">&#9670;&#160;</a></span>strides_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#ab58b5b2b06188fb918bfa78bdfce068b">TensorIndices</a>&lt;N&gt; <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::strides_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Strides for each dimension. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00522">522</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<a id="aa3214ec02474d17494e1eb95d5006262" name="aa3214ec02474d17494e1eb95d5006262"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3214ec02474d17494e1eb95d5006262">&#9670;&#160;</a></span>use_gpu_</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T, size_t N&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classTensor.html">Tensor</a>&lt; T, N &gt;::use_gpu_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag to indicate if GPU should be used. </p>

<p class="definition">Definition at line <a class="el" href="tensor_8h_source.html#l00523">523</a> of file <a class="el" href="tensor_8h_source.html">tensor.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/<a class="el" href="tensor_8h_source.html">tensor.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="classTensor.html">Tensor</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
