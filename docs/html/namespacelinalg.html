<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tensor Library: linalg Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tensor Library
   </div>
   <div id="projectbrief">High-performance C++ tensor library with GPU, BLAS, autograd, and linear algebra support</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('namespacelinalg.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">linalg Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Linear algebra operations namespace.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-namespaces" class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:detail" id="r_detail"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelinalg_1_1detail.html">detail</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-enum-members" class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a6b074b3bbdaaecb5d69bfe7b42a4e696" id="r_a6b074b3bbdaaecb5d69bfe7b42a4e696"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696">SolverMethod</a> { <br />
&#160;&#160;<a class="el" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a06b9281e396db002010bde1de57262eb">Auto</a>
, <a class="el" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>
, <a class="el" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696ac84ce85b6bfbfa4ad1983fe305494ab0">Cholesky</a>
, <a class="el" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a66c35cd8077f7e1db5faefbc048a646a">QR</a>
, <br />
&#160;&#160;<a class="el" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a595e2d2f1a68ede96e96f849a85370bc">SVD</a>
<br />
 }</td></tr>
<tr class="memdesc:a6b074b3bbdaaecb5d69bfe7b42a4e696"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method for solving linear systems.  <a href="#a6b074b3bbdaaecb5d69bfe7b42a4e696">More...</a><br /></td></tr>
<tr class="memitem:acfd8438cccf61414430eaf034addccfa" id="r_acfd8438cccf61414430eaf034addccfa"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acfd8438cccf61414430eaf034addccfa">LstsqMethod</a> { <a class="el" href="#acfd8438cccf61414430eaf034addccfaa66c35cd8077f7e1db5faefbc048a646a">QR</a>
, <a class="el" href="#acfd8438cccf61414430eaf034addccfaa595e2d2f1a68ede96e96f849a85370bc">SVD</a>
 }</td></tr>
<tr class="memdesc:acfd8438cccf61414430eaf034addccfa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method for least squares problems.  <a href="#acfd8438cccf61414430eaf034addccfa">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a16562e1c4018bf2a58455158a8022fb9" id="r_a16562e1c4018bf2a58455158a8022fb9"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a16562e1c4018bf2a58455158a8022fb9 template"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a16562e1c4018bf2a58455158a8022fb9">norm</a> (const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;v)</td></tr>
<tr class="memdesc:a16562e1c4018bf2a58455158a8022fb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the L2 norm (Euclidean norm) of a vector.  <br /></td></tr>
<tr class="memitem:afbe723a0bf8fb7dc2d98815c1ea724b2" id="r_afbe723a0bf8fb7dc2d98815c1ea724b2"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:afbe723a0bf8fb7dc2d98815c1ea724b2 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afbe723a0bf8fb7dc2d98815c1ea724b2">normalize</a> (const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;v)</td></tr>
<tr class="memdesc:afbe723a0bf8fb7dc2d98815c1ea724b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Normalize a vector to unit length.  <br /></td></tr>
<tr class="memitem:a4f401211bb16058dcce20c796bda8dd2" id="r_a4f401211bb16058dcce20c796bda8dd2"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a4f401211bb16058dcce20c796bda8dd2 template"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4f401211bb16058dcce20c796bda8dd2">dot</a> (const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;a, const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;b)</td></tr>
<tr class="memdesc:a4f401211bb16058dcce20c796bda8dd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute dot product of two vectors.  <br /></td></tr>
<tr class="memitem:a8a8d04b2734fdcad37cc861687fbb6fc" id="r_a8a8d04b2734fdcad37cc861687fbb6fc"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a8a8d04b2734fdcad37cc861687fbb6fc template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8a8d04b2734fdcad37cc861687fbb6fc">outer</a> (const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;a, const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;b)</td></tr>
<tr class="memitem:a57a91e9770c813128f00c0a1ea674012" id="r_a57a91e9770c813128f00c0a1ea674012"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a57a91e9770c813128f00c0a1ea674012 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a57a91e9770c813128f00c0a1ea674012">matvec</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;mat, const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;vec)</td></tr>
<tr class="memitem:a6ee776536e47c3e57b3b24ed6225bff2" id="r_a6ee776536e47c3e57b3b24ed6225bff2"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a6ee776536e47c3e57b3b24ed6225bff2 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ee776536e47c3e57b3b24ed6225bff2">matmul</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;a, const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;b)</td></tr>
<tr class="memitem:af0c07b2c6a745bcb68c10766032cc5e0" id="r_af0c07b2c6a745bcb68c10766032cc5e0"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:af0c07b2c6a745bcb68c10766032cc5e0 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;mat)</td></tr>
<tr class="memitem:a42b83ecf931f8079418e5aeff5445040" id="r_a42b83ecf931f8079418e5aeff5445040"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a42b83ecf931f8079418e5aeff5445040 template"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a42b83ecf931f8079418e5aeff5445040">trace</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;mat)</td></tr>
<tr class="memitem:ad030750ea599dfc970dc357fd319ebea" id="r_ad030750ea599dfc970dc357fd319ebea"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:ad030750ea599dfc970dc357fd319ebea template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad030750ea599dfc970dc357fd319ebea">diag</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;mat)</td></tr>
<tr class="memitem:a1df90002eef905350589edef7a4ace1b" id="r_a1df90002eef905350589edef7a4ace1b"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a1df90002eef905350589edef7a4ace1b template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1df90002eef905350589edef7a4ace1b">diag</a> (const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;vec)</td></tr>
<tr class="memitem:a1a4b218ec7989b24b54c914f6cdf199e" id="r_a1a4b218ec7989b24b54c914f6cdf199e"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a1a4b218ec7989b24b54c914f6cdf199e template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1a4b218ec7989b24b54c914f6cdf199e">eye</a> (size_t n, bool use_gpu=true)</td></tr>
<tr class="memitem:ad8e7656cd25d2342040ecb53cc331657" id="r_ad8e7656cd25d2342040ecb53cc331657"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:ad8e7656cd25d2342040ecb53cc331657 template"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad8e7656cd25d2342040ecb53cc331657">frobenius_norm</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;mat)</td></tr>
<tr class="memitem:a3df66cae44de6442e02c8d3a1e2a3ea6" id="r_a3df66cae44de6442e02c8d3a1e2a3ea6"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a3df66cae44de6442e02c8d3a1e2a3ea6 template"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3df66cae44de6442e02c8d3a1e2a3ea6">norm_l1</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;mat)</td></tr>
<tr class="memitem:a4d71f03f0561f2e14840e3a593c24da5" id="r_a4d71f03f0561f2e14840e3a593c24da5"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a4d71f03f0561f2e14840e3a593c24da5 template"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4d71f03f0561f2e14840e3a593c24da5">norm_inf</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;mat)</td></tr>
<tr class="memitem:ad07d8335c6ed4ffb675492effc453771" id="r_ad07d8335c6ed4ffb675492effc453771"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:ad07d8335c6ed4ffb675492effc453771 template"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad07d8335c6ed4ffb675492effc453771">rank</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;mat, T tol=T(-1))</td></tr>
<tr class="memitem:a5238785f1e2a88a5c99da1f586039ec0" id="r_a5238785f1e2a88a5c99da1f586039ec0"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a5238785f1e2a88a5c99da1f586039ec0 template"><td class="memItemLeft" align="right" valign="top">T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5238785f1e2a88a5c99da1f586039ec0">condition_number</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;mat)</td></tr>
<tr class="memitem:a6b7af062b5a9642d788fcc084335b39c" id="r_a6b7af062b5a9642d788fcc084335b39c"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a6b7af062b5a9642d788fcc084335b39c template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b7af062b5a9642d788fcc084335b39c">least_squares</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;A, const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;b)</td></tr>
<tr class="memitem:a299049265c4cb34923444e82e56f381f" id="r_a299049265c4cb34923444e82e56f381f"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a299049265c4cb34923444e82e56f381f template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; std::pair&lt; <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt;, std::vector&lt; int &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a299049265c4cb34923444e82e56f381f">lu_decomp</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;A)</td></tr>
<tr class="memdesc:a299049265c4cb34923444e82e56f381f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute LU decomposition with partial pivoting: P*A = L*U.  <br /></td></tr>
<tr class="memitem:a49a644f54af36b484886d433da564a1f" id="r_a49a644f54af36b484886d433da564a1f"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a49a644f54af36b484886d433da564a1f template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a49a644f54af36b484886d433da564a1f">solve</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;A, const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;b, <a class="el" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696">SolverMethod</a> method=<a class="el" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a06b9281e396db002010bde1de57262eb">SolverMethod::Auto</a>)</td></tr>
<tr class="memdesc:a49a644f54af36b484886d433da564a1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve linear system Ax = b.  <br /></td></tr>
<tr class="memitem:a61b846dd17050c602c624ff0a898d617" id="r_a61b846dd17050c602c624ff0a898d617"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a61b846dd17050c602c624ff0a898d617 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a61b846dd17050c602c624ff0a898d617">solve</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;A, const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;B, <a class="el" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696">SolverMethod</a> method=<a class="el" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a06b9281e396db002010bde1de57262eb">SolverMethod::Auto</a>)</td></tr>
<tr class="memitem:a8405b084d692b1fc7f685f40425a0970" id="r_a8405b084d692b1fc7f685f40425a0970"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a8405b084d692b1fc7f685f40425a0970 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8405b084d692b1fc7f685f40425a0970">lstsq</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;A, const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;b, <a class="el" href="#acfd8438cccf61414430eaf034addccfa">LstsqMethod</a> method=<a class="el" href="#acfd8438cccf61414430eaf034addccfaa66c35cd8077f7e1db5faefbc048a646a">LstsqMethod::QR</a>, T rcond=T(-1))</td></tr>
<tr class="memdesc:a8405b084d692b1fc7f685f40425a0970"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve least squares problem: minimize ||Ax - b||Â²  <br /></td></tr>
<tr class="memitem:a0e459857cd625f66948d7ae48731b17a" id="r_a0e459857cd625f66948d7ae48731b17a"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a0e459857cd625f66948d7ae48731b17a template"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0e459857cd625f66948d7ae48731b17a">matrix_rank</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;A, T tol=T(-1))</td></tr>
<tr class="memdesc:a0e459857cd625f66948d7ae48731b17a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute numerical rank of a matrix using SVD.  <br /></td></tr>
<tr class="memitem:a6ff4392ae10b75895ce02443bf3c77d6" id="r_a6ff4392ae10b75895ce02443bf3c77d6"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a6ff4392ae10b75895ce02443bf3c77d6 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ff4392ae10b75895ce02443bf3c77d6">pinv</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;A, T rcond=T(-1))</td></tr>
<tr class="memdesc:a6ff4392ae10b75895ce02443bf3c77d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute Moore-Penrose pseudo-inverse using SVD.  <br /></td></tr>
<tr class="memitem:a7b56c15653bd4614605326c1ced1a36d" id="r_a7b56c15653bd4614605326c1ced1a36d"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a7b56c15653bd4614605326c1ced1a36d template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7b56c15653bd4614605326c1ced1a36d">kron</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;A, const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;B)</td></tr>
<tr class="memdesc:a7b56c15653bd4614605326c1ced1a36d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute Kronecker product of two matrices.  <br /></td></tr>
<tr class="memitem:a397bea6a8d02533eae3c3eb837d0fd7a" id="r_a397bea6a8d02533eae3c3eb837d0fd7a"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a397bea6a8d02533eae3c3eb837d0fd7a template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a397bea6a8d02533eae3c3eb837d0fd7a">determinant</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;A)</td></tr>
<tr class="memdesc:a397bea6a8d02533eae3c3eb837d0fd7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute determinant of a square matrix.  <br /></td></tr>
<tr class="memitem:abc25aee98d873c690a7d8a88277e7219" id="r_abc25aee98d873c690a7d8a88277e7219"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:abc25aee98d873c690a7d8a88277e7219 template"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abc25aee98d873c690a7d8a88277e7219">inverse</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;A)</td></tr>
<tr class="memdesc:abc25aee98d873c690a7d8a88277e7219"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute inverse of a square matrix.  <br /></td></tr>
<tr class="memitem:a3395139856f5efebaa58f3bc9c4ed3bd" id="r_a3395139856f5efebaa58f3bc9c4ed3bd"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a3395139856f5efebaa58f3bc9c4ed3bd template"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3395139856f5efebaa58f3bc9c4ed3bd">qr_decomp</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;A) -&gt; std::variant&lt; std::pair&lt; <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt;, <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &gt;, <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaa">TensorError</a> &gt;</td></tr>
<tr class="memdesc:a3395139856f5efebaa58f3bc9c4ed3bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">QR decomposition: A = QR.  <br /></td></tr>
<tr class="memitem:a12137fd985ff57d9e9396c8f6919383e" id="r_a12137fd985ff57d9e9396c8f6919383e"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a12137fd985ff57d9e9396c8f6919383e template"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a12137fd985ff57d9e9396c8f6919383e">cholesky_decomp</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;A) -&gt; std::variant&lt; <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt;, <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaa">TensorError</a> &gt;</td></tr>
<tr class="memdesc:a12137fd985ff57d9e9396c8f6919383e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cholesky decomposition: A = L * L^T for symmetric positive definite matrices.  <br /></td></tr>
<tr class="memitem:a2e81c90534586128fa4bcae3bb042175" id="r_a2e81c90534586128fa4bcae3bb042175"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a2e81c90534586128fa4bcae3bb042175 template"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2e81c90534586128fa4bcae3bb042175">svd_decomp</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;A) -&gt; std::variant&lt; std::tuple&lt; <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt;, <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt;, <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &gt;, <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaa">TensorError</a> &gt;</td></tr>
<tr class="memdesc:a2e81c90534586128fa4bcae3bb042175"><td class="mdescLeft">&#160;</td><td class="mdescRight">Singular Value Decomposition: A = U * Sigma * V^T.  <br /></td></tr>
<tr class="memitem:a7141076f8e6b39635853e8368a13c4ea" id="r_a7141076f8e6b39635853e8368a13c4ea"><td class="memTemplParams" colspan="2">template&lt;typename T&gt; </td></tr>
<tr class="memitem:a7141076f8e6b39635853e8368a13c4ea template"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7141076f8e6b39635853e8368a13c4ea">eig_decomp</a> (const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;A) -&gt; std::variant&lt; std::pair&lt; <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt;, <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &gt;, <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaa">TensorError</a> &gt;</td></tr>
<tr class="memdesc:a7141076f8e6b39635853e8368a13c4ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute eigenvalues and eigenvectors for symmetric matrices.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Linear algebra operations namespace. </p>
<p>Provides comprehensive linear algebra functionality including:</p><ul>
<li>Basic operations: norm, dot, cross products</li>
<li><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc" title="Type alias for 2D matrices.">Matrix</a> operations: multiplication, transpose, inverse</li>
<li>Decompositions: LU, Cholesky, QR, SVD</li>
<li>System solving: linear systems, eigenvalues</li>
</ul>
<p>All functions are optimized to use GPU (CUDA) or BLAS when available. </p>
</div><a name="doc-enum-members" id="doc-enum-members"></a><h2 id="header-doc-enum-members" class="groupheader">Enumeration Type Documentation</h2>
<a id="acfd8438cccf61414430eaf034addccfa" name="acfd8438cccf61414430eaf034addccfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfd8438cccf61414430eaf034addccfa">&#9670;&#160;</a></span>LstsqMethod</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="#acfd8438cccf61414430eaf034addccfa">linalg::LstsqMethod</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel strong">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method for least squares problems. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="acfd8438cccf61414430eaf034addccfaa66c35cd8077f7e1db5faefbc048a646a" name="acfd8438cccf61414430eaf034addccfaa66c35cd8077f7e1db5faefbc048a646a"></a>QR&#160;</td><td class="fielddoc"><p>QR-based (fast, numerically stable). </p>
</td></tr>
<tr><td class="fieldname"><a id="acfd8438cccf61414430eaf034addccfaa595e2d2f1a68ede96e96f849a85370bc" name="acfd8438cccf61414430eaf034addccfaa595e2d2f1a68ede96e96f849a85370bc"></a>SVD&#160;</td><td class="fielddoc"><p>SVD-based (handles rank deficiency). </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="linalg__advanced_8h_source.html#l00128">128</a> of file <a class="el" href="linalg__advanced_8h_source.html">linalg_advanced.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  128</span>                       {</div>
<div class="line"><span class="lineno">  129</span>    <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a66c35cd8077f7e1db5faefbc048a646a">QR</a>,         </div>
<div class="line"><span class="lineno">  130</span>    <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a595e2d2f1a68ede96e96f849a85370bc">SVD</a>         </div>
<div class="line"><span class="lineno">  131</span>};</div>
<div class="ttc" id="anamespacelinalg_html_a6b074b3bbdaaecb5d69bfe7b42a4e696a595e2d2f1a68ede96e96f849a85370bc"><div class="ttname"><a href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a595e2d2f1a68ede96e96f849a85370bc">linalg::SolverMethod::SVD</a></div><div class="ttdeci">@ SVD</div><div class="ttdoc">SVD (rank-deficient systems).</div><div class="ttdef"><b>Definition</b> <a href="linalg__advanced_8h_source.html#l00122">linalg_advanced.h:122</a></div></div>
<div class="ttc" id="anamespacelinalg_html_a6b074b3bbdaaecb5d69bfe7b42a4e696a66c35cd8077f7e1db5faefbc048a646a"><div class="ttname"><a href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a66c35cd8077f7e1db5faefbc048a646a">linalg::SolverMethod::QR</a></div><div class="ttdeci">@ QR</div><div class="ttdoc">QR decomposition (overdetermined systems).</div><div class="ttdef"><b>Definition</b> <a href="linalg__advanced_8h_source.html#l00121">linalg_advanced.h:121</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b074b3bbdaaecb5d69bfe7b42a4e696" name="a6b074b3bbdaaecb5d69bfe7b42a4e696"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b074b3bbdaaecb5d69bfe7b42a4e696">&#9670;&#160;</a></span>SolverMethod</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696">linalg::SolverMethod</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel strong">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method for solving linear systems. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a6b074b3bbdaaecb5d69bfe7b42a4e696a06b9281e396db002010bde1de57262eb" name="a6b074b3bbdaaecb5d69bfe7b42a4e696a06b9281e396db002010bde1de57262eb"></a>Auto&#160;</td><td class="fielddoc"><p>Automatically select best method. </p>
</td></tr>
<tr><td class="fieldname"><a id="a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9" name="a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9"></a>LU&#160;</td><td class="fielddoc"><p>LU decomposition (general matrices). </p>
</td></tr>
<tr><td class="fieldname"><a id="a6b074b3bbdaaecb5d69bfe7b42a4e696ac84ce85b6bfbfa4ad1983fe305494ab0" name="a6b074b3bbdaaecb5d69bfe7b42a4e696ac84ce85b6bfbfa4ad1983fe305494ab0"></a>Cholesky&#160;</td><td class="fielddoc"><p>Cholesky decomposition (SPD matrices). </p>
</td></tr>
<tr><td class="fieldname"><a id="a6b074b3bbdaaecb5d69bfe7b42a4e696a66c35cd8077f7e1db5faefbc048a646a" name="a6b074b3bbdaaecb5d69bfe7b42a4e696a66c35cd8077f7e1db5faefbc048a646a"></a>QR&#160;</td><td class="fielddoc"><p>QR decomposition (overdetermined systems). </p>
</td></tr>
<tr><td class="fieldname"><a id="a6b074b3bbdaaecb5d69bfe7b42a4e696a595e2d2f1a68ede96e96f849a85370bc" name="a6b074b3bbdaaecb5d69bfe7b42a4e696a595e2d2f1a68ede96e96f849a85370bc"></a>SVD&#160;</td><td class="fielddoc"><p>SVD (rank-deficient systems). </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="linalg__advanced_8h_source.html#l00117">117</a> of file <a class="el" href="linalg__advanced_8h_source.html">linalg_advanced.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  117</span>                        {</div>
<div class="line"><span class="lineno">  118</span>    <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a06b9281e396db002010bde1de57262eb">Auto</a>,       </div>
<div class="line"><span class="lineno">  119</span>    <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>,         </div>
<div class="line"><span class="lineno">  120</span>    <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696ac84ce85b6bfbfa4ad1983fe305494ab0">Cholesky</a>,   </div>
<div class="line"><span class="lineno">  121</span>    <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a66c35cd8077f7e1db5faefbc048a646a">QR</a>,         </div>
<div class="line"><span class="lineno">  122</span>    <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a595e2d2f1a68ede96e96f849a85370bc">SVD</a>         </div>
<div class="line"><span class="lineno">  123</span>};</div>
<div class="ttc" id="anamespacelinalg_html_a6b074b3bbdaaecb5d69bfe7b42a4e696a06b9281e396db002010bde1de57262eb"><div class="ttname"><a href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a06b9281e396db002010bde1de57262eb">linalg::SolverMethod::Auto</a></div><div class="ttdeci">@ Auto</div><div class="ttdoc">Automatically select best method.</div><div class="ttdef"><b>Definition</b> <a href="linalg__advanced_8h_source.html#l00118">linalg_advanced.h:118</a></div></div>
<div class="ttc" id="anamespacelinalg_html_a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9"><div class="ttname"><a href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">linalg::SolverMethod::LU</a></div><div class="ttdeci">@ LU</div><div class="ttdoc">LU decomposition (general matrices).</div><div class="ttdef"><b>Definition</b> <a href="linalg__advanced_8h_source.html#l00119">linalg_advanced.h:119</a></div></div>
<div class="ttc" id="anamespacelinalg_html_a6b074b3bbdaaecb5d69bfe7b42a4e696ac84ce85b6bfbfa4ad1983fe305494ab0"><div class="ttname"><a href="#a6b074b3bbdaaecb5d69bfe7b42a4e696ac84ce85b6bfbfa4ad1983fe305494ab0">linalg::SolverMethod::Cholesky</a></div><div class="ttdeci">@ Cholesky</div><div class="ttdoc">Cholesky decomposition (SPD matrices).</div><div class="ttdef"><b>Definition</b> <a href="linalg__advanced_8h_source.html#l00120">linalg_advanced.h:120</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a12137fd985ff57d9e9396c8f6919383e" name="a12137fd985ff57d9e9396c8f6919383e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12137fd985ff57d9e9396c8f6919383e">&#9670;&#160;</a></span>cholesky_decomp()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">auto linalg::cholesky_decomp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span></td><td>)</td>
          <td>-&gt;std::variant&lt; <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt;, <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaa">TensorError</a> &gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cholesky decomposition: A = L * L^T for symmetric positive definite matrices. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>Input symmetric positive definite matrix (n x n) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Lower triangular matrix L, or error </dd></dl>

<p class="definition">Definition at line <a class="el" href="linalg__advanced_8h_source.html#l01104">1104</a> of file <a class="el" href="linalg__advanced_8h_source.html">linalg_advanced.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1104</span>                                                                               {</div>
<div class="line"><span class="lineno"> 1105</span>    <span class="keyword">auto</span> dims = A.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno"> 1106</span>    <span class="keywordflow">if</span> (dims[0] != dims[1]) {</div>
<div class="line"><span class="lineno"> 1107</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa69d8864d8802ee76419e96eaa669295a">TensorError::NotSquare</a>;</div>
<div class="line"><span class="lineno"> 1108</span>    }</div>
<div class="line"><span class="lineno"> 1109</span>    </div>
<div class="line"><span class="lineno"> 1110</span>    <span class="keywordtype">size_t</span> n = dims[0];</div>
<div class="line"><span class="lineno"> 1111</span>    </div>
<div class="line"><span class="lineno"> 1112</span><span class="preprocessor">#ifdef USE_LAPACK</span></div>
<div class="line"><span class="lineno"> 1113</span>    <span class="keywordflow">if</span> (!A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>()) {</div>
<div class="line"><span class="lineno"> 1114</span>        <span class="comment">// Make a column-major copy</span></div>
<div class="line"><span class="lineno"> 1115</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> A_col = <a class="code hl_function" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a>(A);</div>
<div class="line"><span class="lineno"> 1116</span>        <span class="keywordtype">int</span> N = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(n);</div>
<div class="line"><span class="lineno"> 1117</span>        <span class="keywordtype">int</span> LDA = N;</div>
<div class="line"><span class="lineno"> 1118</span>        <span class="keywordtype">int</span> INFO = 0;</div>
<div class="line"><span class="lineno"> 1119</span>        <span class="keywordtype">char</span> UPLO = <span class="charliteral">&#39;L&#39;</span>;</div>
<div class="line"><span class="lineno"> 1120</span>        </div>
<div class="line"><span class="lineno"> 1121</span>        <span class="comment">// Compute Cholesky factorization</span></div>
<div class="line"><span class="lineno"> 1122</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, float&gt;) {</div>
<div class="line"><span class="lineno"> 1123</span>            spotrf_(&amp;UPLO, &amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, &amp;INFO);</div>
<div class="line"><span class="lineno"> 1124</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, double&gt;) {</div>
<div class="line"><span class="lineno"> 1125</span>            dpotrf_(&amp;UPLO, &amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, &amp;INFO);</div>
<div class="line"><span class="lineno"> 1126</span>        }</div>
<div class="line"><span class="lineno"> 1127</span>        </div>
<div class="line"><span class="lineno"> 1128</span>        <span class="keywordflow">if</span> (INFO != 0) {</div>
<div class="line"><span class="lineno"> 1129</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaaa1df5a085496d7c89611f837bf1d52ef">TensorError::LapackError</a>;</div>
<div class="line"><span class="lineno"> 1130</span>        }</div>
<div class="line"><span class="lineno"> 1131</span>        </div>
<div class="line"><span class="lineno"> 1132</span>        <span class="comment">// Extract lower triangular part and transpose back</span></div>
<div class="line"><span class="lineno"> 1133</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> L({n, n}, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1134</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i) {</div>
<div class="line"><span class="lineno"> 1135</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno"> 1136</span>                <span class="keywordflow">if</span> (i &gt;= j) {</div>
<div class="line"><span class="lineno"> 1137</span>                    L[{i, j}] = A_col[{j, i}];</div>
<div class="line"><span class="lineno"> 1138</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1139</span>                    L[{i, j}] = T(0);</div>
<div class="line"><span class="lineno"> 1140</span>                }</div>
<div class="line"><span class="lineno"> 1141</span>            }</div>
<div class="line"><span class="lineno"> 1142</span>        }</div>
<div class="line"><span class="lineno"> 1143</span>        </div>
<div class="line"><span class="lineno"> 1144</span>        <span class="keywordflow">return</span> L;</div>
<div class="line"><span class="lineno"> 1145</span>    }</div>
<div class="line"><span class="lineno"> 1146</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1147</span>    </div>
<div class="line"><span class="lineno"> 1148</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa997ca4ce119685f40f03a9a8a6c5346e">TensorError::NotImplemented</a>;</div>
<div class="line"><span class="lineno"> 1149</span>}</div>
<div class="ttc" id="aclassTensor_html_a03d314303958ffc5644796d8025cd012"><div class="ttname"><a href="classTensor.html#a03d314303958ffc5644796d8025cd012">Tensor::dims</a></div><div class="ttdeci">TensorIndices&lt; N &gt; dims() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00669">tensor.h:669</a></div></div>
<div class="ttc" id="aclassTensor_html_a3f3c97d177cb960a4423afc3dafc612a"><div class="ttname"><a href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">Tensor::data_ptr</a></div><div class="ttdeci">const T * data_ptr() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00529">tensor.h:529</a></div></div>
<div class="ttc" id="aclassTensor_html_a83ae42925e21d2871d755407d7505c10"><div class="ttname"><a href="classTensor.html#a83ae42925e21d2871d755407d7505c10">Tensor::uses_gpu</a></div><div class="ttdeci">bool uses_gpu() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00681">tensor.h:681</a></div></div>
<div class="ttc" id="alinalg_8h_html_aab91b0e1295509532b53ec846e227dcc"><div class="ttname"><a href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a></div><div class="ttdeci">Tensor&lt; T, 2 &gt; Matrix</div><div class="ttdoc">Type alias for 2D matrices.</div><div class="ttdef"><b>Definition</b> <a href="linalg_8h_source.html#l00060">linalg.h:60</a></div></div>
<div class="ttc" id="anamespacelinalg_html_af0c07b2c6a745bcb68c10766032cc5e0"><div class="ttname"><a href="#af0c07b2c6a745bcb68c10766032cc5e0">linalg::transpose</a></div><div class="ttdeci">Matrix&lt; T &gt; transpose(const Matrix&lt; T &gt; &amp;mat)</div><div class="ttdef"><b>Definition</b> <a href="linalg_8h_source.html#l00364">linalg.h:364</a></div></div>
<div class="ttc" id="atensor_8h_html_a2db6a67f5b95f95cb23a9d7b28deceaaa69d8864d8802ee76419e96eaa669295a"><div class="ttname"><a href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa69d8864d8802ee76419e96eaa669295a">TensorError::NotSquare</a></div><div class="ttdeci">@ NotSquare</div><div class="ttdoc">Operation requires square matrix.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00266">tensor.h:266</a></div></div>
<div class="ttc" id="atensor_8h_html_a2db6a67f5b95f95cb23a9d7b28deceaaa997ca4ce119685f40f03a9a8a6c5346e"><div class="ttname"><a href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa997ca4ce119685f40f03a9a8a6c5346e">TensorError::NotImplemented</a></div><div class="ttdeci">@ NotImplemented</div><div class="ttdoc">Feature not yet implemented.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00269">tensor.h:269</a></div></div>
<div class="ttc" id="atensor_8h_html_a2db6a67f5b95f95cb23a9d7b28deceaaaa1df5a085496d7c89611f837bf1d52ef"><div class="ttname"><a href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaaa1df5a085496d7c89611f837bf1d52ef">TensorError::LapackError</a></div><div class="ttdeci">@ LapackError</div><div class="ttdoc">LAPACK routine error.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00268">tensor.h:268</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a12137fd985ff57d9e9396c8f6919383e_cgraph.png" border="0" usemap="#anamespacelinalg_a12137fd985ff57d9e9396c8f6919383e_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a12137fd985ff57d9e9396c8f6919383e_cgraph" id="anamespacelinalg_a12137fd985ff57d9e9396c8f6919383e_cgraph">
<area shape="rect" title="Cholesky decomposition: A = L * L^T for symmetric positive definite matrices." alt="" coords="5,81,170,108"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="218,5,334,32"/>
<area shape="poly" title=" " alt="" coords="122,78,225,36,228,41,124,83"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="396,81,492,108"/>
<area shape="poly" title=" " alt="" coords="170,92,380,92,380,97,170,97"/>
<area shape="rect" href="namespacelinalg.html#af0c07b2c6a745bcb68c10766032cc5e0" title=" " alt="" coords="218,107,334,133"/>
<area shape="poly" title=" " alt="" coords="171,103,202,107,202,113,170,108"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="382,144,506,171"/>
<area shape="poly" title=" " alt="" coords="118,106,164,126,218,143,294,154,367,157,366,162,294,159,217,148,162,131,116,111"/>
<area shape="poly" title=" " alt="" coords="334,109,380,102,381,107,335,114"/>
<area shape="poly" title=" " alt="" coords="335,130,367,138,366,143,334,136"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a12137fd985ff57d9e9396c8f6919383e_icgraph.png" border="0" usemap="#anamespacelinalg_a12137fd985ff57d9e9396c8f6919383e_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a12137fd985ff57d9e9396c8f6919383e_icgraph" id="anamespacelinalg_a12137fd985ff57d9e9396c8f6919383e_icgraph">
<area shape="rect" title="Cholesky decomposition: A = L * L^T for symmetric positive definite matrices." alt="" coords="215,31,379,57"/>
<area shape="rect" href="tensor__c_8cpp.html#ae83aa792d547c4137efbfed451c7357c" title=" " alt="" coords="5,5,167,32"/>
<area shape="poly" title=" " alt="" coords="199,35,167,31,167,26,200,30"/>
<area shape="rect" href="tensor__c_8cpp.html#a255ee6f1fd55dc24865fd759cda653c9" title=" " alt="" coords="12,56,160,83"/>
<area shape="poly" title=" " alt="" coords="200,58,161,63,160,58,199,53"/>
</map>
</div>

</div>
</div>
<a id="a5238785f1e2a88a5c99da1f586039ec0" name="a5238785f1e2a88a5c99da1f586039ec0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5238785f1e2a88a5c99da1f586039ec0">&#9670;&#160;</a></span>condition_number()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">T linalg::condition_number </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mat</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Estimate the condition number of a matrix. condition(A) = ||A|| * ||A^(-1)||</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mat</td><td>Input square matrix </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Condition number (using infinity norm), or -1 if matrix is singular</dd></dl>
<p>Note: This requires matrix inversion, which is computationally expensive. For large matrices, consider using iterative methods or SVD-based computation. </p>

<p class="definition">Definition at line <a class="el" href="linalg_8h_source.html#l00592">592</a> of file <a class="el" href="linalg_8h_source.html">linalg.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  592</span>                                         {</div>
<div class="line"><span class="lineno">  593</span>    <span class="keyword">auto</span> dims = mat.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  594</span>    <span class="keywordflow">if</span> (dims[0] != dims[1]) {</div>
<div class="line"><span class="lineno">  595</span>        <span class="keywordflow">return</span> T(-1); <span class="comment">// Not defined for non-square matrices</span></div>
<div class="line"><span class="lineno">  596</span>    }</div>
<div class="line"><span class="lineno">  597</span>    </div>
<div class="line"><span class="lineno">  598</span>    T norm_A = <a class="code hl_function" href="#a4d71f03f0561f2e14840e3a593c24da5">norm_inf</a>(mat);</div>
<div class="line"><span class="lineno">  599</span>    </div>
<div class="line"><span class="lineno">  600</span>    <span class="comment">// Compute inverse (simplified - would need proper implementation)</span></div>
<div class="line"><span class="lineno">  601</span>    <span class="comment">// For now, return an estimate based on norm</span></div>
<div class="line"><span class="lineno">  602</span>    <span class="comment">// A proper implementation would require computing ||A^(-1)||</span></div>
<div class="line"><span class="lineno">  603</span>    <span class="comment">// which requires actual inversion or iterative methods</span></div>
<div class="line"><span class="lineno">  604</span>    </div>
<div class="line"><span class="lineno">  605</span>    <span class="comment">// For now, we return a placeholder based on norm</span></div>
<div class="line"><span class="lineno">  606</span>    <span class="comment">// This is a simplified estimate</span></div>
<div class="line"><span class="lineno">  607</span>    T estimate = norm_A * norm_A;  <span class="comment">// Rough approximation</span></div>
<div class="line"><span class="lineno">  608</span>    <span class="keywordflow">return</span> estimate;</div>
<div class="line"><span class="lineno">  609</span>}</div>
<div class="ttc" id="anamespacelinalg_html_a4d71f03f0561f2e14840e3a593c24da5"><div class="ttname"><a href="#a4d71f03f0561f2e14840e3a593c24da5">linalg::norm_inf</a></div><div class="ttdeci">T norm_inf(const Matrix&lt; T &gt; &amp;mat)</div><div class="ttdef"><b>Definition</b> <a href="linalg_8h_source.html#l00503">linalg.h:503</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a5238785f1e2a88a5c99da1f586039ec0_cgraph.png" border="0" usemap="#anamespacelinalg_a5238785f1e2a88a5c99da1f586039ec0_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a5238785f1e2a88a5c99da1f586039ec0_cgraph" id="anamespacelinalg_a5238785f1e2a88a5c99da1f586039ec0_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,167,32"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="372,5,468,32"/>
<area shape="poly" title=" " alt="" coords="167,16,356,16,356,21,167,21"/>
<area shape="rect" href="namespacelinalg.html#a4d71f03f0561f2e14840e3a593c24da5" title=" " alt="" coords="215,31,324,57"/>
<area shape="poly" title=" " alt="" coords="167,27,199,32,199,37,167,32"/>
<area shape="poly" title=" " alt="" coords="324,32,356,27,357,32,325,37"/>
</map>
</div>

</div>
</div>
<a id="a397bea6a8d02533eae3c3eb837d0fd7a" name="a397bea6a8d02533eae3c3eb837d0fd7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a397bea6a8d02533eae3c3eb837d0fd7a">&#9670;&#160;</a></span>determinant()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; T &gt; linalg::determinant </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute determinant of a square matrix. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Data type </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>Input square matrix </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Determinant value or error</dd></dl>
<p>Uses LU decomposition: det(A) = det(P) * det(L) * det(U) = (-1)^(number of swaps) * product of diagonal elements of U</p>
<h1 class="doxsection"><a class="anchor" id="example_det"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;float&gt;</a> A({{4, -2}, {-1, 3}});</div>
<div class="line"><span class="keyword">auto</span> det_result = <a class="code hl_function" href="#a397bea6a8d02533eae3c3eb837d0fd7a">linalg::determinant</a>(A);</div>
<div class="line"><span class="keywordflow">if</span> (<span class="keyword">auto</span>* det = std::get_if&lt;float&gt;(&amp;det_result)) {</div>
<div class="line">    <span class="comment">// det = 10</span></div>
<div class="line">}</div>
<div class="ttc" id="anamespacelinalg_html_a397bea6a8d02533eae3c3eb837d0fd7a"><div class="ttname"><a href="#a397bea6a8d02533eae3c3eb837d0fd7a">linalg::determinant</a></div><div class="ttdeci">TensorResult&lt; T &gt; determinant(const Matrix&lt; T &gt; &amp;A)</div><div class="ttdoc">Compute determinant of a square matrix.</div><div class="ttdef"><b>Definition</b> <a href="linalg__advanced_8h_source.html#l00786">linalg_advanced.h:786</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="linalg__advanced_8h_source.html#l00786">786</a> of file <a class="el" href="linalg__advanced_8h_source.html">linalg_advanced.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  786</span>                                                {</div>
<div class="line"><span class="lineno">  787</span>    <span class="keyword">auto</span> dims = A.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  788</span>    <span class="keywordflow">if</span> (dims[0] != dims[1]) {</div>
<div class="line"><span class="lineno">  789</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa69d8864d8802ee76419e96eaa669295a">TensorError::NotSquare</a>;</div>
<div class="line"><span class="lineno">  790</span>    }</div>
<div class="line"><span class="lineno">  791</span>    </div>
<div class="line"><span class="lineno">  792</span>    <span class="keywordtype">size_t</span> n = dims[0];</div>
<div class="line"><span class="lineno">  793</span>    </div>
<div class="line"><span class="lineno">  794</span>    <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line"><span class="lineno">  795</span>        <span class="keywordflow">return</span> T(1);</div>
<div class="line"><span class="lineno">  796</span>    }</div>
<div class="line"><span class="lineno">  797</span>    </div>
<div class="line"><span class="lineno">  798</span>    <span class="keywordflow">if</span> (n == 1) {</div>
<div class="line"><span class="lineno">  799</span>        <span class="keywordflow">return</span> A[{0, 0}];</div>
<div class="line"><span class="lineno">  800</span>    }</div>
<div class="line"><span class="lineno">  801</span>    </div>
<div class="line"><span class="lineno">  802</span>    <span class="keywordflow">if</span> (n == 2) {</div>
<div class="line"><span class="lineno">  803</span>        <span class="keywordflow">return</span> A[{0, 0}] * A[{1, 1}] - A[{0, 1}] * A[{1, 0}];</div>
<div class="line"><span class="lineno">  804</span>    }</div>
<div class="line"><span class="lineno">  805</span>    </div>
<div class="line"><span class="lineno">  806</span>    <span class="comment">// Use LU decomposition</span></div>
<div class="line"><span class="lineno">  807</span>    <span class="keyword">auto</span> lu_result = <a class="code hl_function" href="#a299049265c4cb34923444e82e56f381f">lu_decomp</a>(A);</div>
<div class="line"><span class="lineno">  808</span>    <span class="keywordflow">if</span> (<span class="keyword">auto</span>* lu_data = std::get_if&lt;std::pair&lt;<a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a>, std::vector&lt;int&gt;&gt;&gt;(&amp;lu_result)) {</div>
<div class="line"><span class="lineno">  809</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a>&amp; <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a> = lu_data-&gt;first;</div>
<div class="line"><span class="lineno">  810</span>        <span class="keyword">const</span> std::vector&lt;int&gt;&amp; pivots = lu_data-&gt;second;</div>
<div class="line"><span class="lineno">  811</span>        </div>
<div class="line"><span class="lineno">  812</span>        <span class="comment">// Compute product of diagonal elements</span></div>
<div class="line"><span class="lineno">  813</span>        T det = T(1);</div>
<div class="line"><span class="lineno">  814</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i) {</div>
<div class="line"><span class="lineno">  815</span>            det *= <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>[{i, i}];</div>
<div class="line"><span class="lineno">  816</span>        }</div>
<div class="line"><span class="lineno">  817</span>        </div>
<div class="line"><span class="lineno">  818</span>        <span class="comment">// Account for row swaps (each swap changes sign)</span></div>
<div class="line"><span class="lineno">  819</span>        <span class="keywordtype">int</span> num_swaps = 0;</div>
<div class="line"><span class="lineno">  820</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; pivots.size(); ++i) {</div>
<div class="line"><span class="lineno">  821</span>            <span class="keywordflow">if</span> (pivots[i] != <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(i)) {</div>
<div class="line"><span class="lineno">  822</span>                num_swaps++;</div>
<div class="line"><span class="lineno">  823</span>            }</div>
<div class="line"><span class="lineno">  824</span>        }</div>
<div class="line"><span class="lineno">  825</span>        </div>
<div class="line"><span class="lineno">  826</span>        <span class="keywordflow">if</span> (num_swaps % 2 == 1) {</div>
<div class="line"><span class="lineno">  827</span>            det = -det;</div>
<div class="line"><span class="lineno">  828</span>        }</div>
<div class="line"><span class="lineno">  829</span>        </div>
<div class="line"><span class="lineno">  830</span>        <span class="keywordflow">return</span> det;</div>
<div class="line"><span class="lineno">  831</span>    }</div>
<div class="line"><span class="lineno">  832</span>    </div>
<div class="line"><span class="lineno">  833</span>    <span class="keywordflow">return</span> std::get&lt;TensorError&gt;(lu_result);</div>
<div class="line"><span class="lineno">  834</span>}</div>
<div class="ttc" id="anamespacelinalg_html_a299049265c4cb34923444e82e56f381f"><div class="ttname"><a href="#a299049265c4cb34923444e82e56f381f">linalg::lu_decomp</a></div><div class="ttdeci">TensorResult&lt; std::pair&lt; Matrix&lt; T &gt;, std::vector&lt; int &gt; &gt; &gt; lu_decomp(const Matrix&lt; T &gt; &amp;A)</div><div class="ttdoc">Compute LU decomposition with partial pivoting: P*A = L*U.</div><div class="ttdef"><b>Definition</b> <a href="linalg__advanced_8h_source.html#l00202">linalg_advanced.h:202</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a397bea6a8d02533eae3c3eb837d0fd7a_cgraph.png" border="0" usemap="#anamespacelinalg_a397bea6a8d02533eae3c3eb837d0fd7a_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a397bea6a8d02533eae3c3eb837d0fd7a_cgraph" id="anamespacelinalg_a397bea6a8d02533eae3c3eb837d0fd7a_cgraph">
<area shape="rect" title="Compute determinant of a square matrix." alt="" coords="5,5,133,32"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="529,5,626,32"/>
<area shape="poly" title=" " alt="" coords="133,15,467,15,514,15,514,20,467,20,133,21"/>
<area shape="rect" href="namespacelinalg.html#a299049265c4cb34923444e82e56f381f" title="Compute LU decomposition with partial pivoting: P*A = L*U." alt="" coords="181,56,303,83"/>
<area shape="poly" title=" " alt="" coords="118,30,180,49,179,54,117,35"/>
<area shape="poly" title=" " alt="" coords="296,53,351,41,513,21,514,26,351,47,297,58"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="352,56,467,83"/>
<area shape="poly" title=" " alt="" coords="304,67,336,67,336,72,304,72"/>
<area shape="rect" href="namespacelinalg.html#af0c07b2c6a745bcb68c10766032cc5e0" title=" " alt="" coords="351,107,467,133"/>
<area shape="poly" title=" " alt="" coords="289,81,349,99,347,104,288,86"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="515,132,640,159"/>
<area shape="poly" title=" " alt="" coords="258,81,298,114,324,131,352,143,389,151,427,155,500,154,500,159,427,161,388,157,350,148,321,135,295,118,255,85"/>
<area shape="poly" title=" " alt="" coords="443,104,466,92,545,39,548,44,469,97,446,108"/>
<area shape="poly" title=" " alt="" coords="468,126,500,131,499,136,468,131"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a397bea6a8d02533eae3c3eb837d0fd7a_icgraph.png" border="0" usemap="#anamespacelinalg_a397bea6a8d02533eae3c3eb837d0fd7a_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a397bea6a8d02533eae3c3eb837d0fd7a_icgraph" id="anamespacelinalg_a397bea6a8d02533eae3c3eb837d0fd7a_icgraph">
<area shape="rect" title="Compute determinant of a square matrix." alt="" coords="231,31,358,57"/>
<area shape="rect" href="tensor__c_8cpp.html#a8c7d0e2386ccf7736acfd38fde6b346b" title=" " alt="" coords="5,5,183,32"/>
<area shape="poly" title=" " alt="" coords="215,37,183,33,183,27,216,31"/>
<area shape="rect" href="tensor__c_8cpp.html#a42edf6fc1ead7dfe415d6182180f2852" title=" " alt="" coords="12,56,176,83"/>
<area shape="poly" title=" " alt="" coords="216,57,177,62,176,56,215,51"/>
</map>
</div>

</div>
</div>
<a id="ad030750ea599dfc970dc357fd319ebea" name="ad030750ea599dfc970dc357fd319ebea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad030750ea599dfc970dc357fd319ebea">&#9670;&#160;</a></span>diag() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; linalg::diag </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mat</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Extract diagonal elements from a matrix. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mat</td><td>Input matrix (m x n) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b" title="Type alias for 1D vectors.">Vector</a> of diagonal elements (length min(m,n)) </dd></dl>

<p class="definition">Definition at line <a class="el" href="linalg_8h_source.html#l00406">406</a> of file <a class="el" href="linalg_8h_source.html">linalg.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  406</span>                                     {</div>
<div class="line"><span class="lineno">  407</span>    <span class="keyword">auto</span> dims = mat.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  408</span>    <span class="keywordtype">size_t</span> m = dims[0];</div>
<div class="line"><span class="lineno">  409</span>    <span class="keywordtype">size_t</span> n = dims[1];</div>
<div class="line"><span class="lineno">  410</span>    <span class="keywordtype">size_t</span> k = std::min(m, n);</div>
<div class="line"><span class="lineno">  411</span>    </div>
<div class="line"><span class="lineno">  412</span>    <a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a> result({k}, mat.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  413</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; k; ++i) {</div>
<div class="line"><span class="lineno">  414</span>        result[{i}] = mat[{i, i}];</div>
<div class="line"><span class="lineno">  415</span>    }</div>
<div class="line"><span class="lineno">  416</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  417</span>}</div>
<div class="ttc" id="alinalg_8h_html_a99ba6a0becc538dc0109d3818ca80f3b"><div class="ttname"><a href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a></div><div class="ttdeci">Tensor&lt; T, 1 &gt; Vector</div><div class="ttdoc">Type alias for 1D vectors.</div><div class="ttdef"><b>Definition</b> <a href="linalg_8h_source.html#l00051">linalg.h:51</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_ad030750ea599dfc970dc357fd319ebea_cgraph.png" border="0" usemap="#anamespacelinalg_ad030750ea599dfc970dc357fd319ebea_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_ad030750ea599dfc970dc357fd319ebea_cgraph" id="anamespacelinalg_ad030750ea599dfc970dc357fd319ebea_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,89,57"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="151,5,247,32"/>
<area shape="poly" title=" " alt="" coords="89,34,135,27,136,32,90,40"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="137,56,261,83"/>
<area shape="poly" title=" " alt="" coords="90,48,122,54,121,59,89,54"/>
</map>
</div>

</div>
</div>
<a id="a1df90002eef905350589edef7a4ace1b" name="a1df90002eef905350589edef7a4ace1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1df90002eef905350589edef7a4ace1b">&#9670;&#160;</a></span>diag() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; linalg::diag </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>vec</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create diagonal matrix from vector. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vec</td><td>Input vector of length n </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Diagonal matrix of shape (n, n) </dd></dl>

<p class="definition">Definition at line <a class="el" href="linalg_8h_source.html#l00425">425</a> of file <a class="el" href="linalg_8h_source.html">linalg.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  425</span>                                     {</div>
<div class="line"><span class="lineno">  426</span>    <span class="keyword">auto</span> dims = vec.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  427</span>    <span class="keywordtype">size_t</span> n = dims[0];</div>
<div class="line"><span class="lineno">  428</span>    </div>
<div class="line"><span class="lineno">  429</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> result({n, n}, vec.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  430</span>    result.fill(T(0));</div>
<div class="line"><span class="lineno">  431</span>    </div>
<div class="line"><span class="lineno">  432</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i) {</div>
<div class="line"><span class="lineno">  433</span>        result[{i, i}] = vec[{i}];</div>
<div class="line"><span class="lineno">  434</span>    }</div>
<div class="line"><span class="lineno">  435</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  436</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a1df90002eef905350589edef7a4ace1b_cgraph.png" border="0" usemap="#anamespacelinalg_a1df90002eef905350589edef7a4ace1b_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a1df90002eef905350589edef7a4ace1b_cgraph" id="anamespacelinalg_a1df90002eef905350589edef7a4ace1b_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,89,83"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="151,5,247,32"/>
<area shape="poly" title=" " alt="" coords="88,53,142,35,143,40,90,58"/>
<area shape="rect" href="classTensor.html#a234f74cd16bd13561f7963ba29efb163" title="Fill the tensor with a specified value." alt="" coords="158,56,240,83"/>
<area shape="poly" title=" " alt="" coords="89,67,143,67,143,72,89,72"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="137,107,261,133"/>
<area shape="poly" title=" " alt="" coords="90,81,143,99,142,104,88,86"/>
</map>
</div>

</div>
</div>
<a id="a4f401211bb16058dcce20c796bda8dd2" name="a4f401211bb16058dcce20c796bda8dd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f401211bb16058dcce20c796bda8dd2">&#9670;&#160;</a></span>dot()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">T linalg::dot </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute dot product of two vectors. </p>
<p>Computes the inner product: a Â· b = aâbâ + aâbâ + ... + aâbâ Uses GPU or BLAS acceleration when available.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Data type </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>First vector </td></tr>
    <tr><td class="paramname">b</td><td>Second vector </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Dot product as scalar, or 0 if dimensions don't match</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_dot"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;float&gt;</a> a({3});</div>
<div class="line"><a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;float&gt;</a> b({3});</div>
<div class="line">a[{0}] = 1.0f; a[{1}] = 2.0f; a[{2}] = 3.0f;</div>
<div class="line">b[{0}] = 4.0f; b[{1}] = 5.0f; b[{2}] = 6.0f;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">float</span> result = <a class="code hl_function" href="#a4f401211bb16058dcce20c796bda8dd2">linalg::dot</a>(a, b);</div>
<div class="line"><span class="comment">// result = 1*4 + 2*5 + 3*6 = 32.0</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Check orthogonality:</span></div>
<div class="line"><span class="keywordflow">if</span> (std::abs(<a class="code hl_function" href="#a4f401211bb16058dcce20c796bda8dd2">linalg::dot</a>(v1, v2)) &lt; 1e-6) {</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Vectors are orthogonal\n&quot;</span>;</div>
<div class="line">}</div>
<div class="ttc" id="anamespacelinalg_html_a4f401211bb16058dcce20c796bda8dd2"><div class="ttname"><a href="#a4f401211bb16058dcce20c796bda8dd2">linalg::dot</a></div><div class="ttdeci">T dot(const Vector&lt; T &gt; &amp;a, const Vector&lt; T &gt; &amp;b)</div><div class="ttdoc">Compute dot product of two vectors.</div><div class="ttdef"><b>Definition</b> <a href="linalg_8h_source.html#l00190">linalg.h:190</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="linalg_8h_source.html#l00190">190</a> of file <a class="el" href="linalg_8h_source.html">linalg.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  190</span>                                              {</div>
<div class="line"><span class="lineno">  191</span>    <span class="keyword">auto</span> dims_a = a.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  192</span>    <span class="keyword">auto</span> dims_b = b.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  193</span>    </div>
<div class="line"><span class="lineno">  194</span>    <span class="keywordflow">if</span> (dims_a[0] != dims_b[0]) {</div>
<div class="line"><span class="lineno">  195</span>        <span class="keywordflow">return</span> T(0);</div>
<div class="line"><span class="lineno">  196</span>    }</div>
<div class="line"><span class="lineno">  197</span>    </div>
<div class="line"><span class="lineno">  198</span>    <span class="keywordtype">size_t</span> n = dims_a[0];</div>
<div class="line"><span class="lineno">  199</span>    </div>
<div class="line"><span class="lineno">  200</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  201</span>    <span class="keywordflow">if</span> (a.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>() &amp;&amp; b.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>()) {</div>
<div class="line"><span class="lineno">  202</span>        T result;</div>
<div class="line"><span class="lineno">  203</span>        TensorGPU::dot_1d_gpu(a.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), b.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;result, n);</div>
<div class="line"><span class="lineno">  204</span>        <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  205</span>    }</div>
<div class="line"><span class="lineno">  206</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  207</span>    </div>
<div class="line"><span class="lineno">  208</span><span class="preprocessor">#ifdef USE_BLAS</span></div>
<div class="line"><span class="lineno">  209</span>    <span class="keywordflow">return</span> blas_dot&lt;T&gt;(n, a.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), 1, b.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), 1);</div>
<div class="line"><span class="lineno">  210</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  211</span>    T sum = T(0);</div>
<div class="line"><span class="lineno">  212</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i) {</div>
<div class="line"><span class="lineno">  213</span>        sum += a[{i}] * b[{i}];</div>
<div class="line"><span class="lineno">  214</span>    }</div>
<div class="line"><span class="lineno">  215</span>    <span class="keywordflow">return</span> sum;</div>
<div class="line"><span class="lineno">  216</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  217</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a4f401211bb16058dcce20c796bda8dd2_cgraph.png" border="0" usemap="#anamespacelinalg_a4f401211bb16058dcce20c796bda8dd2_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a4f401211bb16058dcce20c796bda8dd2_cgraph" id="anamespacelinalg_a4f401211bb16058dcce20c796bda8dd2_cgraph">
<area shape="rect" title="Compute dot product of two vectors." alt="" coords="5,56,83,83"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="135,5,250,32"/>
<area shape="poly" title=" " alt="" coords="82,54,136,35,138,40,84,59"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="145,56,241,83"/>
<area shape="poly" title=" " alt="" coords="83,67,129,67,129,72,83,72"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="131,107,255,133"/>
<area shape="poly" title=" " alt="" coords="84,80,138,99,136,104,82,85"/>
</map>
</div>

</div>
</div>
<a id="a7141076f8e6b39635853e8368a13c4ea" name="a7141076f8e6b39635853e8368a13c4ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7141076f8e6b39635853e8368a13c4ea">&#9670;&#160;</a></span>eig_decomp()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">auto linalg::eig_decomp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span></td><td>)</td>
          <td>-&gt;std::variant&lt; std::pair&lt; <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt;, <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &gt;, <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaa">TensorError</a> &gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute eigenvalues and eigenvectors for symmetric matrices. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>Input symmetric matrix (n x n) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pair of eigenvalues and eigenvector matrix (columns are eigenvectors), or error </dd></dl>

<p class="definition">Definition at line <a class="el" href="linalg__advanced_8h_source.html#l01238">1238</a> of file <a class="el" href="linalg__advanced_8h_source.html">linalg_advanced.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1239</span>                                                              {</div>
<div class="line"><span class="lineno"> 1240</span>    <span class="keyword">auto</span> dims = A.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno"> 1241</span>    <span class="keywordflow">if</span> (dims[0] != dims[1]) {</div>
<div class="line"><span class="lineno"> 1242</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa69d8864d8802ee76419e96eaa669295a">TensorError::NotSquare</a>;</div>
<div class="line"><span class="lineno"> 1243</span>    }</div>
<div class="line"><span class="lineno"> 1244</span>    </div>
<div class="line"><span class="lineno"> 1245</span>    <span class="keywordtype">size_t</span> n = dims[0];</div>
<div class="line"><span class="lineno"> 1246</span>    </div>
<div class="line"><span class="lineno"> 1247</span><span class="preprocessor">#ifdef USE_LAPACK</span></div>
<div class="line"><span class="lineno"> 1248</span>    <span class="keywordflow">if</span> (!A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>()) {</div>
<div class="line"><span class="lineno"> 1249</span>        <span class="comment">// Make a column-major copy</span></div>
<div class="line"><span class="lineno"> 1250</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> A_col = <a class="code hl_function" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a>(A);</div>
<div class="line"><span class="lineno"> 1251</span>        <span class="keywordtype">int</span> N = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(n);</div>
<div class="line"><span class="lineno"> 1252</span>        <span class="keywordtype">int</span> LDA = N;</div>
<div class="line"><span class="lineno"> 1253</span>        <span class="keywordtype">int</span> INFO = 0;</div>
<div class="line"><span class="lineno"> 1254</span>        <span class="keywordtype">char</span> JOBZ = <span class="charliteral">&#39;V&#39;</span>;  <span class="comment">// Compute eigenvalues and eigenvectors</span></div>
<div class="line"><span class="lineno"> 1255</span>        <span class="keywordtype">char</span> UPLO = <span class="charliteral">&#39;U&#39;</span>;  <span class="comment">// Upper triangle of A is stored</span></div>
<div class="line"><span class="lineno"> 1256</span>        </div>
<div class="line"><span class="lineno"> 1257</span>        <a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a> W({n}, <span class="keyword">false</span>);  <span class="comment">// Eigenvalues</span></div>
<div class="line"><span class="lineno"> 1258</span>        </div>
<div class="line"><span class="lineno"> 1259</span>        T work_size;</div>
<div class="line"><span class="lineno"> 1260</span>        <span class="keywordtype">int</span> LWORK = -1;</div>
<div class="line"><span class="lineno"> 1261</span>        </div>
<div class="line"><span class="lineno"> 1262</span>        <span class="comment">// Query workspace size</span></div>
<div class="line"><span class="lineno"> 1263</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, float&gt;) {</div>
<div class="line"><span class="lineno"> 1264</span>            ssyev_(&amp;JOBZ, &amp;UPLO, &amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, W.data_ptr(),</div>
<div class="line"><span class="lineno"> 1265</span>                   &amp;work_size, &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno"> 1266</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, double&gt;) {</div>
<div class="line"><span class="lineno"> 1267</span>            dsyev_(&amp;JOBZ, &amp;UPLO, &amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, W.data_ptr(),</div>
<div class="line"><span class="lineno"> 1268</span>                   &amp;work_size, &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno"> 1269</span>        }</div>
<div class="line"><span class="lineno"> 1270</span>        </div>
<div class="line"><span class="lineno"> 1271</span>        LWORK = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(work_size);</div>
<div class="line"><span class="lineno"> 1272</span>        std::vector&lt;T&gt; work(LWORK);</div>
<div class="line"><span class="lineno"> 1273</span>        </div>
<div class="line"><span class="lineno"> 1274</span>        <span class="comment">// Compute eigendecomposition</span></div>
<div class="line"><span class="lineno"> 1275</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, float&gt;) {</div>
<div class="line"><span class="lineno"> 1276</span>            ssyev_(&amp;JOBZ, &amp;UPLO, &amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, W.data_ptr(),</div>
<div class="line"><span class="lineno"> 1277</span>                   work.data(), &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno"> 1278</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, double&gt;) {</div>
<div class="line"><span class="lineno"> 1279</span>            dsyev_(&amp;JOBZ, &amp;UPLO, &amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, W.data_ptr(),</div>
<div class="line"><span class="lineno"> 1280</span>                   work.data(), &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno"> 1281</span>        }</div>
<div class="line"><span class="lineno"> 1282</span>        </div>
<div class="line"><span class="lineno"> 1283</span>        <span class="keywordflow">if</span> (INFO != 0) {</div>
<div class="line"><span class="lineno"> 1284</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaaa1df5a085496d7c89611f837bf1d52ef">TensorError::LapackError</a>;</div>
<div class="line"><span class="lineno"> 1285</span>        }</div>
<div class="line"><span class="lineno"> 1286</span>        </div>
<div class="line"><span class="lineno"> 1287</span>        <span class="comment">// Transpose eigenvectors back to row-major</span></div>
<div class="line"><span class="lineno"> 1288</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> V = <a class="code hl_function" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a>(A_col);</div>
<div class="line"><span class="lineno"> 1289</span>        </div>
<div class="line"><span class="lineno"> 1290</span>        <span class="keywordflow">return</span> std::make_pair(W, V);</div>
<div class="line"><span class="lineno"> 1291</span>    }</div>
<div class="line"><span class="lineno"> 1292</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1293</span>    </div>
<div class="line"><span class="lineno"> 1294</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa997ca4ce119685f40f03a9a8a6c5346e">TensorError::NotImplemented</a>;</div>
<div class="line"><span class="lineno"> 1295</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a7141076f8e6b39635853e8368a13c4ea_cgraph.png" border="0" usemap="#anamespacelinalg_a7141076f8e6b39635853e8368a13c4ea_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a7141076f8e6b39635853e8368a13c4ea_cgraph" id="anamespacelinalg_a7141076f8e6b39635853e8368a13c4ea_cgraph">
<area shape="rect" title="Compute eigenvalues and eigenvectors for symmetric matrices." alt="" coords="5,81,135,108"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="183,5,298,32"/>
<area shape="poly" title=" " alt="" coords="101,78,194,36,196,41,103,83"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="361,81,457,108"/>
<area shape="poly" title=" " alt="" coords="135,92,345,92,345,97,135,97"/>
<area shape="rect" href="namespacelinalg.html#af0c07b2c6a745bcb68c10766032cc5e0" title=" " alt="" coords="183,107,299,133"/>
<area shape="poly" title=" " alt="" coords="135,102,168,107,167,112,135,107"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="347,144,471,171"/>
<area shape="poly" title=" " alt="" coords="96,106,136,126,183,143,259,155,332,158,332,163,259,160,182,148,134,131,94,111"/>
<area shape="poly" title=" " alt="" coords="299,109,345,102,346,107,300,114"/>
<area shape="poly" title=" " alt="" coords="300,130,332,138,331,143,299,136"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a7141076f8e6b39635853e8368a13c4ea_icgraph.png" border="0" usemap="#anamespacelinalg_a7141076f8e6b39635853e8368a13c4ea_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a7141076f8e6b39635853e8368a13c4ea_icgraph" id="anamespacelinalg_a7141076f8e6b39635853e8368a13c4ea_icgraph">
<area shape="rect" title="Compute eigenvalues and eigenvectors for symmetric matrices." alt="" coords="180,31,309,57"/>
<area shape="rect" href="tensor__c_8cpp.html#a6dd699eaa84717bb6be0a58278bcda75" title=" " alt="" coords="5,5,132,32"/>
<area shape="poly" title=" " alt="" coords="164,35,131,30,132,25,164,30"/>
<area shape="rect" href="tensor__c_8cpp.html#acfaf5261dd34ed1780ef4ccc06fc1cb8" title=" " alt="" coords="12,56,125,83"/>
<area shape="poly" title=" " alt="" coords="164,58,126,64,125,59,164,53"/>
</map>
</div>

</div>
</div>
<a id="a1a4b218ec7989b24b54c914f6cdf199e" name="a1a4b218ec7989b24b54c914f6cdf199e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a4b218ec7989b24b54c914f6cdf199e">&#9670;&#160;</a></span>eye()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; linalg::eye </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>use_gpu</em></span><span class="paramdefsep"> = </span><span class="paramdefval">true</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create identity matrix. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Size of the matrix </td></tr>
    <tr><td class="paramname">use_gpu</td><td>Whether to use GPU </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Identity matrix of shape (n, n) </dd></dl>

<p class="definition">Definition at line <a class="el" href="linalg_8h_source.html#l00445">445</a> of file <a class="el" href="linalg_8h_source.html">linalg.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  445</span>                                             {</div>
<div class="line"><span class="lineno">  446</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> result({n, n}, use_gpu);</div>
<div class="line"><span class="lineno">  447</span>    result.fill(T(0));</div>
<div class="line"><span class="lineno">  448</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i) {</div>
<div class="line"><span class="lineno">  449</span>        result[{i, i}] = T(1);</div>
<div class="line"><span class="lineno">  450</span>    }</div>
<div class="line"><span class="lineno">  451</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  452</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a1a4b218ec7989b24b54c914f6cdf199e_icgraph.png" border="0" usemap="#anamespacelinalg_a1a4b218ec7989b24b54c914f6cdf199e_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a1a4b218ec7989b24b54c914f6cdf199e_icgraph" id="anamespacelinalg_a1a4b218ec7989b24b54c914f6cdf199e_icgraph">
<area shape="rect" title=" " alt="" coords="184,31,264,57"/>
<area shape="rect" href="tensor__c_8cpp.html#a113ffbc50951369856f2ffd01debda12" title=" " alt="" coords="5,5,136,32"/>
<area shape="poly" title=" " alt="" coords="168,38,135,32,136,27,169,32"/>
<area shape="rect" href="tensor__c_8cpp.html#a14b3185d66dfec988feac1c4f9dacc68" title=" " alt="" coords="12,56,129,83"/>
<area shape="poly" title=" " alt="" coords="169,56,130,62,129,57,168,50"/>
</map>
</div>

</div>
</div>
<a id="ad8e7656cd25d2342040ecb53cc331657" name="ad8e7656cd25d2342040ecb53cc331657"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8e7656cd25d2342040ecb53cc331657">&#9670;&#160;</a></span>frobenius_norm()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">T linalg::frobenius_norm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mat</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute Frobenius norm of a matrix. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mat</td><td>Input matrix </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Frobenius norm </dd></dl>

<p class="definition">Definition at line <a class="el" href="linalg_8h_source.html#l00460">460</a> of file <a class="el" href="linalg_8h_source.html">linalg.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  460</span>                                       {</div>
<div class="line"><span class="lineno">  461</span>    <span class="keyword">auto</span> dims = mat.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  462</span>    <span class="keywordtype">size_t</span> m = dims[0];</div>
<div class="line"><span class="lineno">  463</span>    <span class="keywordtype">size_t</span> n = dims[1];</div>
<div class="line"><span class="lineno">  464</span>    </div>
<div class="line"><span class="lineno">  465</span>    T sum = T(0);</div>
<div class="line"><span class="lineno">  466</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; ++i) {</div>
<div class="line"><span class="lineno">  467</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno">  468</span>            T val = mat[{i, j}];</div>
<div class="line"><span class="lineno">  469</span>            sum += val * val;</div>
<div class="line"><span class="lineno">  470</span>        }</div>
<div class="line"><span class="lineno">  471</span>    }</div>
<div class="line"><span class="lineno">  472</span>    <span class="keywordflow">return</span> std::sqrt(sum);</div>
<div class="line"><span class="lineno">  473</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_ad8e7656cd25d2342040ecb53cc331657_cgraph.png" border="0" usemap="#anamespacelinalg_ad8e7656cd25d2342040ecb53cc331657_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_ad8e7656cd25d2342040ecb53cc331657_cgraph" id="anamespacelinalg_ad8e7656cd25d2342040ecb53cc331657_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,154,32"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="202,5,298,32"/>
<area shape="poly" title=" " alt="" coords="154,16,186,16,186,21,154,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_ad8e7656cd25d2342040ecb53cc331657_icgraph.png" border="0" usemap="#anamespacelinalg_ad8e7656cd25d2342040ecb53cc331657_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_ad8e7656cd25d2342040ecb53cc331657_icgraph" id="anamespacelinalg_ad8e7656cd25d2342040ecb53cc331657_icgraph">
<area shape="rect" title=" " alt="" coords="192,31,340,57"/>
<area shape="rect" href="tensor__c_8cpp.html#a9116057b055e18e0e2519d3efcd4f666" title=" " alt="" coords="5,5,144,32"/>
<area shape="poly" title=" " alt="" coords="176,35,144,30,144,25,176,29"/>
<area shape="rect" href="tensor__c_8cpp.html#afd0e347ef4d2d541c4f455f9700702bf" title=" " alt="" coords="12,56,137,83"/>
<area shape="poly" title=" " alt="" coords="176,59,138,64,137,58,176,53"/>
</map>
</div>

</div>
</div>
<a id="abc25aee98d873c690a7d8a88277e7219" name="abc25aee98d873c690a7d8a88277e7219"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc25aee98d873c690a7d8a88277e7219">&#9670;&#160;</a></span>inverse()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &gt; linalg::inverse </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute inverse of a square matrix. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Data type </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>Input square matrix </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Inverse matrix or error</dd></dl>
<p>Uses LU decomposition followed by inversion. For symmetric positive definite matrices, consider using Cholesky-based inversion.</p>
<h1 class="doxsection"><a class="anchor" id="example_inv"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;float&gt;</a> A({{4, 7}, {2, 6}});</div>
<div class="line"><span class="keyword">auto</span> Ainv_result = <a class="code hl_function" href="#abc25aee98d873c690a7d8a88277e7219">linalg::inverse</a>(A);</div>
<div class="line"><span class="keywordflow">if</span> (<span class="keyword">auto</span>* Ainv = std::get_if&lt;<a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;float&gt;</a>&gt;(&amp;Ainv_result)) {</div>
<div class="line">    <span class="comment">// Verify: A * Ainv â I</span></div>
<div class="line">}</div>
<div class="ttc" id="anamespacelinalg_html_abc25aee98d873c690a7d8a88277e7219"><div class="ttname"><a href="#abc25aee98d873c690a7d8a88277e7219">linalg::inverse</a></div><div class="ttdeci">TensorResult&lt; Matrix&lt; T &gt; &gt; inverse(const Matrix&lt; T &gt; &amp;A)</div><div class="ttdoc">Compute inverse of a square matrix.</div><div class="ttdef"><b>Definition</b> <a href="linalg__advanced_8h_source.html#l00860">linalg_advanced.h:860</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="linalg__advanced_8h_source.html#l00860">860</a> of file <a class="el" href="linalg__advanced_8h_source.html">linalg_advanced.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  860</span>                                                    {</div>
<div class="line"><span class="lineno">  861</span>    <span class="keyword">auto</span> dims = A.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  862</span>    <span class="keywordflow">if</span> (dims[0] != dims[1]) {</div>
<div class="line"><span class="lineno">  863</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa69d8864d8802ee76419e96eaa669295a">TensorError::NotSquare</a>;</div>
<div class="line"><span class="lineno">  864</span>    }</div>
<div class="line"><span class="lineno">  865</span>    </div>
<div class="line"><span class="lineno">  866</span>    <span class="keywordtype">size_t</span> n = dims[0];</div>
<div class="line"><span class="lineno">  867</span>    </div>
<div class="line"><span class="lineno">  868</span>    <span class="keywordflow">if</span> (n == 0) {</div>
<div class="line"><span class="lineno">  869</span>        <span class="keywordflow">return</span> <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a>({0, 0}, A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  870</span>    }</div>
<div class="line"><span class="lineno">  871</span>    </div>
<div class="line"><span class="lineno">  872</span>    <span class="keywordflow">if</span> (n == 1) {</div>
<div class="line"><span class="lineno">  873</span>        T val = A[{0, 0}];</div>
<div class="line"><span class="lineno">  874</span>        <span class="keywordflow">if</span> (std::abs(val) &lt; std::numeric_limits&lt;T&gt;::epsilon()) {</div>
<div class="line"><span class="lineno">  875</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaade2e45aece7bcbb9fe7540cc9e11c40f">TensorError::SingularMatrix</a>;</div>
<div class="line"><span class="lineno">  876</span>        }</div>
<div class="line"><span class="lineno">  877</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> inv({1, 1}, A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  878</span>        inv[{0, 0}] = T(1) / val;</div>
<div class="line"><span class="lineno">  879</span>        <span class="keywordflow">return</span> inv;</div>
<div class="line"><span class="lineno">  880</span>    }</div>
<div class="line"><span class="lineno">  881</span>    </div>
<div class="line"><span class="lineno">  882</span><span class="preprocessor">#ifdef USE_LAPACK</span></div>
<div class="line"><span class="lineno">  883</span>    <span class="keywordflow">if</span> (!A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>()) {</div>
<div class="line"><span class="lineno">  884</span>        <span class="comment">// Use LAPACK getrf + getri for inversion</span></div>
<div class="line"><span class="lineno">  885</span>        <span class="keyword">auto</span> lu_result = <a class="code hl_function" href="#a299049265c4cb34923444e82e56f381f">lu_decomp</a>(A);</div>
<div class="line"><span class="lineno">  886</span>        <span class="keywordflow">if</span> (<span class="keyword">auto</span>* lu_data = std::get_if&lt;std::pair&lt;<a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a>, std::vector&lt;int&gt;&gt;&gt;(&amp;lu_result)) {</div>
<div class="line"><span class="lineno">  887</span>            <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> A_inv = lu_data-&gt;first;</div>
<div class="line"><span class="lineno">  888</span>            std::vector&lt;int&gt;&amp; pivots = lu_data-&gt;second;</div>
<div class="line"><span class="lineno">  889</span>            </div>
<div class="line"><span class="lineno">  890</span>            <span class="comment">// Convert pivots back to 1-based for LAPACK</span></div>
<div class="line"><span class="lineno">  891</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; p : pivots) {</div>
<div class="line"><span class="lineno">  892</span>                p += 1;</div>
<div class="line"><span class="lineno">  893</span>            }</div>
<div class="line"><span class="lineno">  894</span>            </div>
<div class="line"><span class="lineno">  895</span>            <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> A_col = <a class="code hl_function" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a>(A_inv);</div>
<div class="line"><span class="lineno">  896</span>            </div>
<div class="line"><span class="lineno">  897</span>            <span class="comment">// Query workspace size</span></div>
<div class="line"><span class="lineno">  898</span>            <span class="keywordtype">int</span> N = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(n);</div>
<div class="line"><span class="lineno">  899</span>            <span class="keywordtype">int</span> LDA = N;</div>
<div class="line"><span class="lineno">  900</span>            <span class="keywordtype">int</span> INFO = 0;</div>
<div class="line"><span class="lineno">  901</span>            T work_size;</div>
<div class="line"><span class="lineno">  902</span>            <span class="keywordtype">int</span> LWORK = -1;</div>
<div class="line"><span class="lineno">  903</span>            </div>
<div class="line"><span class="lineno">  904</span>            <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, float&gt;) {</div>
<div class="line"><span class="lineno">  905</span>                sgetri_(&amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, pivots.data(), &amp;work_size, &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno">  906</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, double&gt;) {</div>
<div class="line"><span class="lineno">  907</span>                dgetri_(&amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, pivots.data(), &amp;work_size, &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno">  908</span>            }</div>
<div class="line"><span class="lineno">  909</span>            </div>
<div class="line"><span class="lineno">  910</span>            LWORK = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(work_size);</div>
<div class="line"><span class="lineno">  911</span>            std::vector&lt;T&gt; work(LWORK);</div>
<div class="line"><span class="lineno">  912</span>            </div>
<div class="line"><span class="lineno">  913</span>            <span class="comment">// Compute inverse</span></div>
<div class="line"><span class="lineno">  914</span>            <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, float&gt;) {</div>
<div class="line"><span class="lineno">  915</span>                sgetri_(&amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, pivots.data(), work.data(), &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno">  916</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, double&gt;) {</div>
<div class="line"><span class="lineno">  917</span>                dgetri_(&amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, pivots.data(), work.data(), &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno">  918</span>            }</div>
<div class="line"><span class="lineno">  919</span>            </div>
<div class="line"><span class="lineno">  920</span>            <span class="keywordflow">if</span> (INFO != 0) {</div>
<div class="line"><span class="lineno">  921</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaaa1df5a085496d7c89611f837bf1d52ef">TensorError::LapackError</a>;</div>
<div class="line"><span class="lineno">  922</span>            }</div>
<div class="line"><span class="lineno">  923</span>            </div>
<div class="line"><span class="lineno">  924</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a>(A_col);</div>
<div class="line"><span class="lineno">  925</span>        }</div>
<div class="line"><span class="lineno">  926</span>        </div>
<div class="line"><span class="lineno">  927</span>        <span class="keywordflow">return</span> std::get&lt;TensorError&gt;(lu_result);</div>
<div class="line"><span class="lineno">  928</span>    }</div>
<div class="line"><span class="lineno">  929</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  930</span>    </div>
<div class="line"><span class="lineno">  931</span>    <span class="comment">// Fallback: Gauss-Jordan elimination</span></div>
<div class="line"><span class="lineno">  932</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> Aug({n, 2 * n}, A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  933</span>    </div>
<div class="line"><span class="lineno">  934</span>    <span class="comment">// Build augmented matrix [A | I]</span></div>
<div class="line"><span class="lineno">  935</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i) {</div>
<div class="line"><span class="lineno">  936</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno">  937</span>            Aug[{i, j}] = A[{i, j}];</div>
<div class="line"><span class="lineno">  938</span>            Aug[{i, n + j}] = (i == j) ? T(1) : T(0);</div>
<div class="line"><span class="lineno">  939</span>        }</div>
<div class="line"><span class="lineno">  940</span>    }</div>
<div class="line"><span class="lineno">  941</span>    </div>
<div class="line"><span class="lineno">  942</span>    <span class="comment">// Forward elimination</span></div>
<div class="line"><span class="lineno">  943</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; n; ++k) {</div>
<div class="line"><span class="lineno">  944</span>        <span class="comment">// Find pivot</span></div>
<div class="line"><span class="lineno">  945</span>        <span class="keywordtype">size_t</span> pivot_row = k;</div>
<div class="line"><span class="lineno">  946</span>        T max_val = std::abs(Aug[{k, k}]);</div>
<div class="line"><span class="lineno">  947</span>        </div>
<div class="line"><span class="lineno">  948</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = k + 1; i &lt; n; ++i) {</div>
<div class="line"><span class="lineno">  949</span>            T val = std::abs(Aug[{i, k}]);</div>
<div class="line"><span class="lineno">  950</span>            <span class="keywordflow">if</span> (val &gt; max_val) {</div>
<div class="line"><span class="lineno">  951</span>                max_val = val;</div>
<div class="line"><span class="lineno">  952</span>                pivot_row = i;</div>
<div class="line"><span class="lineno">  953</span>            }</div>
<div class="line"><span class="lineno">  954</span>        }</div>
<div class="line"><span class="lineno">  955</span>        </div>
<div class="line"><span class="lineno">  956</span>        <span class="keywordflow">if</span> (max_val &lt; std::numeric_limits&lt;T&gt;::epsilon()) {</div>
<div class="line"><span class="lineno">  957</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaade2e45aece7bcbb9fe7540cc9e11c40f">TensorError::SingularMatrix</a>;</div>
<div class="line"><span class="lineno">  958</span>        }</div>
<div class="line"><span class="lineno">  959</span>        </div>
<div class="line"><span class="lineno">  960</span>        <span class="comment">// Swap rows</span></div>
<div class="line"><span class="lineno">  961</span>        <span class="keywordflow">if</span> (pivot_row != k) {</div>
<div class="line"><span class="lineno">  962</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; 2 * n; ++j) {</div>
<div class="line"><span class="lineno">  963</span>                T temp = Aug[{k, j}];</div>
<div class="line"><span class="lineno">  964</span>                Aug[{k, j}] = Aug[{pivot_row, j}];</div>
<div class="line"><span class="lineno">  965</span>                Aug[{pivot_row, j}] = temp;</div>
<div class="line"><span class="lineno">  966</span>            }</div>
<div class="line"><span class="lineno">  967</span>        }</div>
<div class="line"><span class="lineno">  968</span>        </div>
<div class="line"><span class="lineno">  969</span>        <span class="comment">// Scale pivot row</span></div>
<div class="line"><span class="lineno">  970</span>        T pivot = Aug[{k, k}];</div>
<div class="line"><span class="lineno">  971</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; 2 * n; ++j) {</div>
<div class="line"><span class="lineno">  972</span>            Aug[{k, j}] /= pivot;</div>
<div class="line"><span class="lineno">  973</span>        }</div>
<div class="line"><span class="lineno">  974</span>        </div>
<div class="line"><span class="lineno">  975</span>        <span class="comment">// Eliminate column</span></div>
<div class="line"><span class="lineno">  976</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i) {</div>
<div class="line"><span class="lineno">  977</span>            <span class="keywordflow">if</span> (i != k) {</div>
<div class="line"><span class="lineno">  978</span>                T factor = Aug[{i, k}];</div>
<div class="line"><span class="lineno">  979</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; 2 * n; ++j) {</div>
<div class="line"><span class="lineno">  980</span>                    Aug[{i, j}] -= factor * Aug[{k, j}];</div>
<div class="line"><span class="lineno">  981</span>                }</div>
<div class="line"><span class="lineno">  982</span>            }</div>
<div class="line"><span class="lineno">  983</span>        }</div>
<div class="line"><span class="lineno">  984</span>    }</div>
<div class="line"><span class="lineno">  985</span>    </div>
<div class="line"><span class="lineno">  986</span>    <span class="comment">// Extract inverse from right half</span></div>
<div class="line"><span class="lineno">  987</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> A_inv({n, n}, A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  988</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i) {</div>
<div class="line"><span class="lineno">  989</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno">  990</span>            A_inv[{i, j}] = Aug[{i, n + j}];</div>
<div class="line"><span class="lineno">  991</span>        }</div>
<div class="line"><span class="lineno">  992</span>    }</div>
<div class="line"><span class="lineno">  993</span>    </div>
<div class="line"><span class="lineno">  994</span>    <span class="keywordflow">return</span> A_inv;</div>
<div class="line"><span class="lineno">  995</span>}</div>
<div class="ttc" id="atensor_8h_html_a2db6a67f5b95f95cb23a9d7b28deceaaade2e45aece7bcbb9fe7540cc9e11c40f"><div class="ttname"><a href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaade2e45aece7bcbb9fe7540cc9e11c40f">TensorError::SingularMatrix</a></div><div class="ttdeci">@ SingularMatrix</div><div class="ttdoc">Matrix is singular (non-invertible).</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00264">tensor.h:264</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_abc25aee98d873c690a7d8a88277e7219_cgraph.png" border="0" usemap="#anamespacelinalg_abc25aee98d873c690a7d8a88277e7219_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_abc25aee98d873c690a7d8a88277e7219_cgraph" id="anamespacelinalg_abc25aee98d873c690a7d8a88277e7219_cgraph">
<area shape="rect" title="Compute inverse of a square matrix." alt="" coords="5,102,107,129"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="326,26,441,53"/>
<area shape="poly" title=" " alt="" coords="107,100,154,88,310,52,311,57,155,93,108,105"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="503,77,600,103"/>
<area shape="poly" title=" " alt="" coords="76,99,111,77,154,56,237,26,325,12,384,3,410,4,442,12,490,35,528,65,524,69,487,40,440,17,409,9,384,9,325,17,239,31,156,61,114,82,78,104"/>
<area shape="rect" href="namespacelinalg.html#a299049265c4cb34923444e82e56f381f" title="Compute LU decomposition with partial pivoting: P*A = L*U." alt="" coords="155,102,277,129"/>
<area shape="poly" title=" " alt="" coords="107,113,139,113,139,118,107,118"/>
<area shape="rect" href="namespacelinalg.html#af0c07b2c6a745bcb68c10766032cc5e0" title=" " alt="" coords="325,178,441,205"/>
<area shape="poly" title=" " alt="" coords="108,126,155,138,311,174,310,179,154,143,107,131"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="489,178,614,205"/>
<area shape="poly" title=" " alt="" coords="78,127,114,149,156,170,239,200,325,214,383,219,441,214,486,206,487,212,442,219,383,224,325,219,237,205,154,175,111,154,76,132"/>
<area shape="poly" title=" " alt="" coords="246,99,337,57,339,62,248,104"/>
<area shape="poly" title=" " alt="" coords="277,108,487,92,488,98,278,114"/>
<area shape="poly" title=" " alt="" coords="248,127,339,169,337,174,246,132"/>
<area shape="poly" title=" " alt="" coords="278,126,442,164,477,172,476,177,441,169,277,132"/>
<area shape="poly" title=" " alt="" coords="406,175,513,110,516,114,409,180"/>
<area shape="poly" title=" " alt="" coords="442,189,474,189,474,194,442,194"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_abc25aee98d873c690a7d8a88277e7219_icgraph.png" border="0" usemap="#anamespacelinalg_abc25aee98d873c690a7d8a88277e7219_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_abc25aee98d873c690a7d8a88277e7219_icgraph" id="anamespacelinalg_abc25aee98d873c690a7d8a88277e7219_icgraph">
<area shape="rect" title="Compute inverse of a square matrix." alt="" coords="205,31,306,57"/>
<area shape="rect" href="tensor__c_8cpp.html#a754f7e7480b2f39aaa21596868896d92" title=" " alt="" coords="5,5,157,32"/>
<area shape="poly" title=" " alt="" coords="189,37,156,32,157,27,190,32"/>
<area shape="rect" href="tensor__c_8cpp.html#a95c93d5c49416ca78236c13928cd0037" title=" " alt="" coords="12,56,150,83"/>
<area shape="poly" title=" " alt="" coords="190,56,151,62,150,57,189,51"/>
</map>
</div>

</div>
</div>
<a id="a7b56c15653bd4614605326c1ced1a36d" name="a7b56c15653bd4614605326c1ced1a36d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b56c15653bd4614605326c1ced1a36d">&#9670;&#160;</a></span>kron()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &gt; linalg::kron </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>B</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute Kronecker product of two matrices. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Data type </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>First matrix (m x n) </td></tr>
    <tr><td class="paramname">B</td><td>Second matrix (p x q) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Kronecker product (mp x nq)</dd></dl>
<p>The Kronecker product A â B is defined as: [aââB aââB ...] [aââB aââB ...] [...]</p>
<p>Used in statistics, quantum computing, tensor decompositions, etc.</p>
<h1 class="doxsection"><a class="anchor" id="example_kron"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;float&gt;</a> A({{1, 2}, {3, 4}});</div>
<div class="line"><a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;float&gt;</a> B({{0, 5}, {6, 7}});</div>
<div class="line"><span class="keyword">auto</span> C = <a class="code hl_function" href="#a7b56c15653bd4614605326c1ced1a36d">linalg::kron</a>(A, B);  <span class="comment">// 4x4 matrix</span></div>
<div class="ttc" id="anamespacelinalg_html_a7b56c15653bd4614605326c1ced1a36d"><div class="ttname"><a href="#a7b56c15653bd4614605326c1ced1a36d">linalg::kron</a></div><div class="ttdeci">TensorResult&lt; Matrix&lt; T &gt; &gt; kron(const Matrix&lt; T &gt; &amp;A, const Matrix&lt; T &gt; &amp;B)</div><div class="ttdoc">Compute Kronecker product of two matrices.</div><div class="ttdef"><b>Definition</b> <a href="linalg__advanced_8h_source.html#l00737">linalg_advanced.h:737</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="linalg__advanced_8h_source.html#l00737">737</a> of file <a class="el" href="linalg__advanced_8h_source.html">linalg_advanced.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  737</span>                                                                     {</div>
<div class="line"><span class="lineno">  738</span>    <span class="keyword">auto</span> dims_A = A.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  739</span>    <span class="keyword">auto</span> dims_B = B.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  740</span>    <span class="keywordtype">size_t</span> m = dims_A[0];</div>
<div class="line"><span class="lineno">  741</span>    <span class="keywordtype">size_t</span> n = dims_A[1];</div>
<div class="line"><span class="lineno">  742</span>    <span class="keywordtype">size_t</span> p = dims_B[0];</div>
<div class="line"><span class="lineno">  743</span>    <span class="keywordtype">size_t</span> q = dims_B[1];</div>
<div class="line"><span class="lineno">  744</span>    </div>
<div class="line"><span class="lineno">  745</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> C({m * p, n * q}, A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  746</span>    </div>
<div class="line"><span class="lineno">  747</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; ++i) {</div>
<div class="line"><span class="lineno">  748</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno">  749</span>            T a_ij = A[{i, j}];</div>
<div class="line"><span class="lineno">  750</span>            </div>
<div class="line"><span class="lineno">  751</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; p; ++k) {</div>
<div class="line"><span class="lineno">  752</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> l = 0; l &lt; q; ++l) {</div>
<div class="line"><span class="lineno">  753</span>                    C[{(i * p) + k, (j * q) + l}] = (a_ij) * (B[{k, l}]);</div>
<div class="line"><span class="lineno">  754</span>                }</div>
<div class="line"><span class="lineno">  755</span>            }</div>
<div class="line"><span class="lineno">  756</span>        }</div>
<div class="line"><span class="lineno">  757</span>    }</div>
<div class="line"><span class="lineno">  758</span>    </div>
<div class="line"><span class="lineno">  759</span>    <span class="keywordflow">return</span> C;</div>
<div class="line"><span class="lineno">  760</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a7b56c15653bd4614605326c1ced1a36d_cgraph.png" border="0" usemap="#anamespacelinalg_a7b56c15653bd4614605326c1ced1a36d_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a7b56c15653bd4614605326c1ced1a36d_cgraph" id="anamespacelinalg_a7b56c15653bd4614605326c1ced1a36d_cgraph">
<area shape="rect" title="Compute Kronecker product of two matrices." alt="" coords="5,31,90,57"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="152,5,248,32"/>
<area shape="poly" title=" " alt="" coords="90,34,136,26,137,32,91,40"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="138,56,262,83"/>
<area shape="poly" title=" " alt="" coords="91,48,123,54,122,59,90,54"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a7b56c15653bd4614605326c1ced1a36d_icgraph.png" border="0" usemap="#anamespacelinalg_a7b56c15653bd4614605326c1ced1a36d_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a7b56c15653bd4614605326c1ced1a36d_icgraph" id="anamespacelinalg_a7b56c15653bd4614605326c1ced1a36d_icgraph">
<area shape="rect" title="Compute Kronecker product of two matrices." alt="" coords="188,31,272,57"/>
<area shape="rect" href="tensor__c_8cpp.html#a9cb3a0a004ab335a7b28b44b9c21d4ae" title=" " alt="" coords="5,5,140,32"/>
<area shape="poly" title=" " alt="" coords="172,37,139,32,140,27,173,32"/>
<area shape="rect" href="tensor__c_8cpp.html#ab00dfd4594e0bb9317ab3891fc9363d1" title=" " alt="" coords="12,56,133,83"/>
<area shape="poly" title=" " alt="" coords="173,56,134,62,133,57,172,51"/>
</map>
</div>

</div>
</div>
<a id="a6b7af062b5a9642d788fcc084335b39c" name="a6b7af062b5a9642d788fcc084335b39c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b7af062b5a9642d788fcc084335b39c">&#9670;&#160;</a></span>least_squares()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; linalg::least_squares </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve linear least squares problem: minimize ||Ax - b||^2 Uses normal equations: A^T A x = A^T b</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc" title="Type alias for 2D matrices.">Matrix</a> of shape (m, n) where m &gt;= n </td></tr>
    <tr><td class="paramname">b</td><td><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b" title="Type alias for 1D vectors.">Vector</a> of length m </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Solution vector of length n, or empty vector if solution fails</dd></dl>
<p>Note: This uses the normal equations method, which can be numerically unstable for ill-conditioned matrices. For better numerical stability, consider QR or SVD methods. </p>

<p class="definition">Definition at line <a class="el" href="linalg_8h_source.html#l00623">623</a> of file <a class="el" href="linalg_8h_source.html">linalg.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  623</span>                                                                {</div>
<div class="line"><span class="lineno">  624</span>    <span class="keyword">auto</span> dims_A = A.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  625</span>    <span class="keyword">auto</span> dims_b = b.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  626</span>    <span class="keywordtype">size_t</span> m = dims_A[0];</div>
<div class="line"><span class="lineno">  627</span>    <span class="keywordtype">size_t</span> n = dims_A[1];</div>
<div class="line"><span class="lineno">  628</span>    </div>
<div class="line"><span class="lineno">  629</span>    <span class="keywordflow">if</span> (dims_b[0] != m) {</div>
<div class="line"><span class="lineno">  630</span>        <span class="keywordflow">return</span> <a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a>({0}, <span class="keyword">false</span>); <span class="comment">// Dimension mismatch</span></div>
<div class="line"><span class="lineno">  631</span>    }</div>
<div class="line"><span class="lineno">  632</span>    </div>
<div class="line"><span class="lineno">  633</span>    <span class="keywordflow">if</span> (m &lt; n) {</div>
<div class="line"><span class="lineno">  634</span>        <span class="keywordflow">return</span> <a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a>({0}, <span class="keyword">false</span>); <span class="comment">// Underdetermined system</span></div>
<div class="line"><span class="lineno">  635</span>    }</div>
<div class="line"><span class="lineno">  636</span>    </div>
<div class="line"><span class="lineno">  637</span>    <span class="comment">// Compute A^T</span></div>
<div class="line"><span class="lineno">  638</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> AT = <a class="code hl_function" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a>(A);</div>
<div class="line"><span class="lineno">  639</span>    </div>
<div class="line"><span class="lineno">  640</span>    <span class="comment">// Compute A^T * A</span></div>
<div class="line"><span class="lineno">  641</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> ATA = <a class="code hl_function" href="#a6ee776536e47c3e57b3b24ed6225bff2">matmul</a>(AT, A);</div>
<div class="line"><span class="lineno">  642</span>    </div>
<div class="line"><span class="lineno">  643</span>    <span class="comment">// Compute A^T * b</span></div>
<div class="line"><span class="lineno">  644</span>    <span class="comment">// We need to convert b to a matrix for matmul</span></div>
<div class="line"><span class="lineno">  645</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> b_mat({m, 1}, b.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  646</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; ++i) {</div>
<div class="line"><span class="lineno">  647</span>        b_mat[{i, 0}] = b[{i}];</div>
<div class="line"><span class="lineno">  648</span>    }</div>
<div class="line"><span class="lineno">  649</span>    </div>
<div class="line"><span class="lineno">  650</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> ATb_mat = <a class="code hl_function" href="#a6ee776536e47c3e57b3b24ed6225bff2">matmul</a>(AT, b_mat);</div>
<div class="line"><span class="lineno">  651</span>    </div>
<div class="line"><span class="lineno">  652</span>    <span class="comment">// Convert to vector</span></div>
<div class="line"><span class="lineno">  653</span>    <a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a> ATb({n}, b.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  654</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i) {</div>
<div class="line"><span class="lineno">  655</span>        ATb[{i}] = ATb_mat[{i, 0}];</div>
<div class="line"><span class="lineno">  656</span>    }</div>
<div class="line"><span class="lineno">  657</span>    </div>
<div class="line"><span class="lineno">  658</span>    <span class="comment">// Solve ATA * x = ATb using Gaussian elimination</span></div>
<div class="line"><span class="lineno">  659</span>    <span class="comment">// This is a simplified implementation</span></div>
<div class="line"><span class="lineno">  660</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> augmented({n, n + 1}, A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  661</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i) {</div>
<div class="line"><span class="lineno">  662</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno">  663</span>            augmented[{i, j}] = ATA[{i, j}];</div>
<div class="line"><span class="lineno">  664</span>        }</div>
<div class="line"><span class="lineno">  665</span>        augmented[{i, n}] = ATb[{i}];</div>
<div class="line"><span class="lineno">  666</span>    }</div>
<div class="line"><span class="lineno">  667</span>    </div>
<div class="line"><span class="lineno">  668</span>    <span class="comment">// Gaussian elimination with partial pivoting</span></div>
<div class="line"><span class="lineno">  669</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a> = 0; <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a> &lt; n; ++<a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>) {</div>
<div class="line"><span class="lineno">  670</span>        <span class="comment">// Find pivot</span></div>
<div class="line"><span class="lineno">  671</span>        <span class="keywordtype">size_t</span> pivot_row = <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>;</div>
<div class="line"><span class="lineno">  672</span>        T max_val = std::abs(augmented[{<a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>, <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>}]);</div>
<div class="line"><span class="lineno">  673</span>        </div>
<div class="line"><span class="lineno">  674</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a> = <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a> + 1; <a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a> &lt; n; ++<a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a>) {</div>
<div class="line"><span class="lineno">  675</span>            T val = std::abs(augmented[{<a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a>, <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>}]);</div>
<div class="line"><span class="lineno">  676</span>            <span class="keywordflow">if</span> (val &gt; max_val) {</div>
<div class="line"><span class="lineno">  677</span>                max_val = val;</div>
<div class="line"><span class="lineno">  678</span>                pivot_row = <a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a>;</div>
<div class="line"><span class="lineno">  679</span>            }</div>
<div class="line"><span class="lineno">  680</span>        }</div>
<div class="line"><span class="lineno">  681</span>        </div>
<div class="line"><span class="lineno">  682</span>        <span class="keywordflow">if</span> (max_val &lt; std::numeric_limits&lt;T&gt;::epsilon()) {</div>
<div class="line"><span class="lineno">  683</span>            <span class="keywordflow">return</span> <a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a>({0}, <span class="keyword">false</span>); <span class="comment">// Singular matrix</span></div>
<div class="line"><span class="lineno">  684</span>        }</div>
<div class="line"><span class="lineno">  685</span>        </div>
<div class="line"><span class="lineno">  686</span>        <span class="comment">// Swap rows</span></div>
<div class="line"><span class="lineno">  687</span>        <span class="keywordflow">if</span> (pivot_row != <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>) {</div>
<div class="line"><span class="lineno">  688</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>; j &lt;= n; ++j) {</div>
<div class="line"><span class="lineno">  689</span>                T temp = augmented[{<a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>, j}];</div>
<div class="line"><span class="lineno">  690</span>                augmented[{<a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>, j}] = augmented[{pivot_row, j}];</div>
<div class="line"><span class="lineno">  691</span>                augmented[{pivot_row, j}] = temp;</div>
<div class="line"><span class="lineno">  692</span>            }</div>
<div class="line"><span class="lineno">  693</span>        }</div>
<div class="line"><span class="lineno">  694</span>        </div>
<div class="line"><span class="lineno">  695</span>        <span class="comment">// Eliminate</span></div>
<div class="line"><span class="lineno">  696</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a> = <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a> + 1; <a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a> &lt; n; ++<a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a>) {</div>
<div class="line"><span class="lineno">  697</span>            T factor = augmented[{<a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a>, <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>}] / augmented[{<a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>, <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>}];</div>
<div class="line"><span class="lineno">  698</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>; j &lt;= n; ++j) {</div>
<div class="line"><span class="lineno">  699</span>                augmented[{<a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a>, j}] -= factor * augmented[{<a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>, j}];</div>
<div class="line"><span class="lineno">  700</span>            }</div>
<div class="line"><span class="lineno">  701</span>        }</div>
<div class="line"><span class="lineno">  702</span>    }</div>
<div class="line"><span class="lineno">  703</span>    </div>
<div class="line"><span class="lineno">  704</span>    <span class="comment">// Back substitution</span></div>
<div class="line"><span class="lineno">  705</span>    <a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a> x({n}, b.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  706</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = n; i-- &gt; 0;) {</div>
<div class="line"><span class="lineno">  707</span>        T sum = augmented[{i, n}];</div>
<div class="line"><span class="lineno">  708</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = i + 1; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno">  709</span>            sum -= augmented[{i, j}] * x[{j}];</div>
<div class="line"><span class="lineno">  710</span>        }</div>
<div class="line"><span class="lineno">  711</span>        x[{i}] = sum / augmented[{i, i}];</div>
<div class="line"><span class="lineno">  712</span>    }</div>
<div class="line"><span class="lineno">  713</span>    </div>
<div class="line"><span class="lineno">  714</span>    <span class="keywordflow">return</span> x;</div>
<div class="line"><span class="lineno">  715</span>}</div>
<div class="ttc" id="anamespacelinalg_html_a6ee776536e47c3e57b3b24ed6225bff2"><div class="ttname"><a href="#a6ee776536e47c3e57b3b24ed6225bff2">linalg::matmul</a></div><div class="ttdeci">Matrix&lt; T &gt; matmul(const Matrix&lt; T &gt; &amp;a, const Matrix&lt; T &gt; &amp;b)</div><div class="ttdef"><b>Definition</b> <a href="linalg_8h_source.html#l00313">linalg.h:313</a></div></div>
<div class="ttc" id="atensor_8h_html_a5f2a03f722ba5a985a3733e2ff823a74"><div class="ttname"><a href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a></div><div class="ttdeci">Tensor&lt; T, 1 &gt; col(const Tensor&lt; T, 2 &gt; &amp;matrix, size_t col_idx)</div><div class="ttdoc">Extract a single column from a 2D tensor.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l07223">tensor.h:7223</a></div></div>
<div class="ttc" id="atensor_8h_html_adf94b1b28dd9932dd278abaa3cb7a9ee"><div class="ttname"><a href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a></div><div class="ttdeci">Tensor&lt; T, 1 &gt; row(const Tensor&lt; T, 2 &gt; &amp;matrix, size_t row_idx)</div><div class="ttdoc">Extract a single row from a 2D tensor.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l07191">tensor.h:7191</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a6b7af062b5a9642d788fcc084335b39c_cgraph.png" border="0" usemap="#anamespacelinalg_a6b7af062b5a9642d788fcc084335b39c_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a6b7af062b5a9642d788fcc084335b39c_cgraph" id="anamespacelinalg_a6b7af062b5a9642d788fcc084335b39c_cgraph">
<area shape="rect" title=" " alt="" coords="5,106,146,133"/>
<area shape="rect" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74" title="Extract a single column from a 2D tensor." alt="" coords="233,182,271,209"/>
<area shape="poly" title=" " alt="" coords="110,131,219,179,217,184,108,136"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="372,81,468,107"/>
<area shape="poly" title=" " alt="" coords="85,104,128,58,158,34,193,16,225,6,252,3,278,6,311,16,358,39,396,69,393,73,356,44,309,21,277,12,251,8,226,11,195,21,161,38,131,62,89,107"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="358,131,482,158"/>
<area shape="poly" title=" " alt="" coords="146,122,343,136,342,142,146,127"/>
<area shape="rect" href="namespacelinalg.html#a6ee776536e47c3e57b3b24ed6225bff2" title=" " alt="" coords="201,233,303,259"/>
<area shape="poly" title=" " alt="" coords="92,131,136,173,195,219,203,223,200,228,192,223,132,177,88,135"/>
<area shape="rect" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee" title="Extract a single row from a 2D tensor." alt="" coords="231,81,273,107"/>
<area shape="poly" title=" " alt="" coords="146,107,215,97,216,102,146,112"/>
<area shape="rect" href="namespacelinalg.html#af0c07b2c6a745bcb68c10766032cc5e0" title=" " alt="" coords="194,30,310,57"/>
<area shape="poly" title=" " alt="" coords="108,103,204,61,206,66,110,108"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="362,182,478,209"/>
<area shape="poly" title=" " alt="" coords="272,193,347,193,347,198,272,198"/>
<area shape="poly" title=" " alt="" coords="268,179,307,149,357,117,366,112,369,117,359,122,311,153,271,184"/>
<area shape="poly" title=" " alt="" coords="271,187,358,161,359,166,272,192"/>
<area shape="poly" title=" " alt="" coords="298,230,358,211,359,216,300,235"/>
<area shape="poly" title=" " alt="" coords="292,230,308,219,325,194,331,169,338,144,356,118,360,114,364,118,360,121,343,146,336,171,330,196,312,223,295,234"/>
<area shape="poly" title=" " alt="" coords="288,230,308,219,323,206,332,194,341,181,356,168,364,163,367,168,360,172,345,185,336,197,327,210,312,223,291,235"/>
<area shape="rect" href="classTensor.html#a234f74cd16bd13561f7963ba29efb163" title="Fill the tensor with a specified value." alt="" coords="380,233,461,259"/>
<area shape="poly" title=" " alt="" coords="303,243,364,243,364,249,303,249"/>
<area shape="poly" title=" " alt="" coords="271,106,311,136,359,168,369,173,366,178,357,172,307,140,268,110"/>
<area shape="poly" title=" " alt="" coords="273,91,357,91,357,97,273,97"/>
<area shape="poly" title=" " alt="" coords="274,98,360,124,358,129,273,103"/>
<area shape="poly" title=" " alt="" coords="300,55,359,73,358,78,298,60"/>
<area shape="poly" title=" " alt="" coords="291,55,312,67,327,80,336,93,345,105,360,117,367,122,364,126,356,122,341,108,332,96,323,84,308,71,288,60"/>
</map>
</div>

</div>
</div>
<a id="a8405b084d692b1fc7f685f40425a0970" name="a8405b084d692b1fc7f685f40425a0970"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8405b084d692b1fc7f685f40425a0970">&#9670;&#160;</a></span>lstsq()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &gt; linalg::lstsq </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#acfd8438cccf61414430eaf034addccfa">LstsqMethod</a></td>          <td class="paramname"><span class="paramname"><em>method</em></span><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="#acfd8438cccf61414430eaf034addccfaa66c35cd8077f7e1db5faefbc048a646a">LstsqMethod::QR</a></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>rcond</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(-1)</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solve least squares problem: minimize ||Ax - b||Â² </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Data type (float or double) </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>Coefficient matrix (m x n), typically m &gt; n (overdetermined) </td></tr>
    <tr><td class="paramname">b</td><td>Right-hand side vector </td></tr>
    <tr><td class="paramname">method</td><td>QR (fast, stable) or SVD (rank-deficient) </td></tr>
    <tr><td class="paramname">rcond</td><td>Tolerance for rank determination (only for SVD), -1 = default </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Solution vector or error</dd></dl>
<p>Uses LAPACK sgels/dgels (QR) or sgelsd/dgelsd (SVD) when available.</p>
<h1 class="doxsection"><a class="anchor" id="example_lstsq"></a>
Example</h1>
<div class="fragment"><div class="line"><span class="comment">// Fit line y = mx + b to data points</span></div>
<div class="line"><a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;float&gt;</a> A({{1, 1}, {2, 1}, {3, 1}, {4, 1}});  <span class="comment">// [x, 1]</span></div>
<div class="line"><a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;float&gt;</a> y({2.1, 3.9, 6.2, 7.9});</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> params = <a class="code hl_function" href="#a8405b084d692b1fc7f685f40425a0970">linalg::lstsq</a>(A, y);  <span class="comment">// Returns [m, b]</span></div>
<div class="ttc" id="anamespacelinalg_html_a8405b084d692b1fc7f685f40425a0970"><div class="ttname"><a href="#a8405b084d692b1fc7f685f40425a0970">linalg::lstsq</a></div><div class="ttdeci">TensorResult&lt; Vector&lt; T &gt; &gt; lstsq(const Matrix&lt; T &gt; &amp;A, const Vector&lt; T &gt; &amp;b, LstsqMethod method=LstsqMethod::QR, T rcond=T(-1))</div><div class="ttdoc">Solve least squares problem: minimize ||Ax - b||Â²</div><div class="ttdef"><b>Definition</b> <a href="linalg__advanced_8h_source.html#l00515">linalg_advanced.h:515</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="linalg__advanced_8h_source.html#l00515">515</a> of file <a class="el" href="linalg__advanced_8h_source.html">linalg_advanced.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  517</span>                                                {</div>
<div class="line"><span class="lineno">  518</span>    <span class="keyword">auto</span> dims_A = A.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  519</span>    <span class="keyword">auto</span> dims_b = b.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  520</span>    <span class="keywordtype">size_t</span> m = dims_A[0];</div>
<div class="line"><span class="lineno">  521</span>    <span class="keywordtype">size_t</span> n = dims_A[1];</div>
<div class="line"><span class="lineno">  522</span>    </div>
<div class="line"><span class="lineno">  523</span>    <span class="keywordflow">if</span> (dims_b[0] != m) {</div>
<div class="line"><span class="lineno">  524</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa2664c241558d7674e8ed4d5f63d2e463">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno">  525</span>    }</div>
<div class="line"><span class="lineno">  526</span>    </div>
<div class="line"><span class="lineno">  527</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  528</span>    <span class="comment">// TODO: cuSOLVER implementation</span></div>
<div class="line"><span class="lineno">  529</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  530</span>    </div>
<div class="line"><span class="lineno">  531</span><span class="preprocessor">#ifdef USE_LAPACK</span></div>
<div class="line"><span class="lineno">  532</span>    <span class="keywordflow">if</span> (!A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>()) {</div>
<div class="line"><span class="lineno">  533</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> A_copy = A;</div>
<div class="line"><span class="lineno">  534</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> A_col = <a class="code hl_function" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a>(A_copy);</div>
<div class="line"><span class="lineno">  535</span>        <a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a> b_ext({std::max(m, n)}, <span class="keyword">false</span>);  <span class="comment">// Extended for LAPACK</span></div>
<div class="line"><span class="lineno">  536</span>        </div>
<div class="line"><span class="lineno">  537</span>        <span class="comment">// Copy b into extended vector</span></div>
<div class="line"><span class="lineno">  538</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; ++i) {</div>
<div class="line"><span class="lineno">  539</span>            b_ext[{i}] = b[{i}];</div>
<div class="line"><span class="lineno">  540</span>        }</div>
<div class="line"><span class="lineno">  541</span>        </div>
<div class="line"><span class="lineno">  542</span>        <span class="keywordtype">int</span> M = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(m);</div>
<div class="line"><span class="lineno">  543</span>        <span class="keywordtype">int</span> N = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(n);</div>
<div class="line"><span class="lineno">  544</span>        <span class="keywordtype">int</span> NRHS = 1;</div>
<div class="line"><span class="lineno">  545</span>        <span class="keywordtype">int</span> LDA = M;</div>
<div class="line"><span class="lineno">  546</span>        <span class="keywordtype">int</span> LDB = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::max(m, n));</div>
<div class="line"><span class="lineno">  547</span>        <span class="keywordtype">int</span> INFO = 0;</div>
<div class="line"><span class="lineno">  548</span>        <span class="keywordtype">char</span> TRANS = <span class="charliteral">&#39;N&#39;</span>;</div>
<div class="line"><span class="lineno">  549</span>        </div>
<div class="line"><span class="lineno">  550</span>        <span class="keywordflow">if</span> (method == <a class="code hl_enumvalue" href="#acfd8438cccf61414430eaf034addccfaa66c35cd8077f7e1db5faefbc048a646a">LstsqMethod::QR</a>) {</div>
<div class="line"><span class="lineno">  551</span>            <span class="comment">// Query optimal workspace</span></div>
<div class="line"><span class="lineno">  552</span>            T work_size;</div>
<div class="line"><span class="lineno">  553</span>            <span class="keywordtype">int</span> LWORK = -1;</div>
<div class="line"><span class="lineno">  554</span>            </div>
<div class="line"><span class="lineno">  555</span>            <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, float&gt;) {</div>
<div class="line"><span class="lineno">  556</span>                sgels_(&amp;TRANS, &amp;M, &amp;N, &amp;NRHS, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA,</div>
<div class="line"><span class="lineno">  557</span>                       b_ext.data_ptr(), &amp;LDB, &amp;work_size, &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno">  558</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, double&gt;) {</div>
<div class="line"><span class="lineno">  559</span>                dgels_(&amp;TRANS, &amp;M, &amp;N, &amp;NRHS, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA,</div>
<div class="line"><span class="lineno">  560</span>                       b_ext.data_ptr(), &amp;LDB, &amp;work_size, &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno">  561</span>            }</div>
<div class="line"><span class="lineno">  562</span>            </div>
<div class="line"><span class="lineno">  563</span>            LWORK = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(work_size);</div>
<div class="line"><span class="lineno">  564</span>            std::vector&lt;T&gt; work(LWORK);</div>
<div class="line"><span class="lineno">  565</span>            </div>
<div class="line"><span class="lineno">  566</span>            <span class="comment">// Actual computation</span></div>
<div class="line"><span class="lineno">  567</span>            <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, float&gt;) {</div>
<div class="line"><span class="lineno">  568</span>                sgels_(&amp;TRANS, &amp;M, &amp;N, &amp;NRHS, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA,</div>
<div class="line"><span class="lineno">  569</span>                       b_ext.data_ptr(), &amp;LDB, work.data(), &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno">  570</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, double&gt;) {</div>
<div class="line"><span class="lineno">  571</span>                dgels_(&amp;TRANS, &amp;M, &amp;N, &amp;NRHS, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA,</div>
<div class="line"><span class="lineno">  572</span>                       b_ext.data_ptr(), &amp;LDB, work.data(), &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno">  573</span>            }</div>
<div class="line"><span class="lineno">  574</span>            </div>
<div class="line"><span class="lineno">  575</span>            <span class="keywordflow">if</span> (INFO != 0) {</div>
<div class="line"><span class="lineno">  576</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaaa1df5a085496d7c89611f837bf1d52ef">TensorError::LapackError</a>;</div>
<div class="line"><span class="lineno">  577</span>            }</div>
<div class="line"><span class="lineno">  578</span>            </div>
<div class="line"><span class="lineno">  579</span>            <span class="comment">// Extract solution (first n elements)</span></div>
<div class="line"><span class="lineno">  580</span>            <a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a> x({n}, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  581</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i) {</div>
<div class="line"><span class="lineno">  582</span>                x[{i}] = b_ext[{i}];</div>
<div class="line"><span class="lineno">  583</span>            }</div>
<div class="line"><span class="lineno">  584</span>            </div>
<div class="line"><span class="lineno">  585</span>            <span class="keywordflow">return</span> x;</div>
<div class="line"><span class="lineno">  586</span>        }</div>
<div class="line"><span class="lineno">  587</span>    }</div>
<div class="line"><span class="lineno">  588</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  589</span>    </div>
<div class="line"><span class="lineno">  590</span>    <span class="comment">// Fallback: use normal equations A^T A x = A^T b</span></div>
<div class="line"><span class="lineno">  591</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> AT = <a class="code hl_function" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a>(A);</div>
<div class="line"><span class="lineno">  592</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> ATA = <a class="code hl_function" href="#a6ee776536e47c3e57b3b24ed6225bff2">matmul</a>(AT, A);</div>
<div class="line"><span class="lineno">  593</span>    </div>
<div class="line"><span class="lineno">  594</span>    <span class="comment">// Convert b to matrix for matmul</span></div>
<div class="line"><span class="lineno">  595</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> b_mat({m, 1}, A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  596</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; ++i) {</div>
<div class="line"><span class="lineno">  597</span>        b_mat[{i, 0}] = b[{i}];</div>
<div class="line"><span class="lineno">  598</span>    }</div>
<div class="line"><span class="lineno">  599</span>    </div>
<div class="line"><span class="lineno">  600</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> ATb_mat = <a class="code hl_function" href="#a6ee776536e47c3e57b3b24ed6225bff2">matmul</a>(AT, b_mat);</div>
<div class="line"><span class="lineno">  601</span>    </div>
<div class="line"><span class="lineno">  602</span>    <span class="comment">// Extract as vector</span></div>
<div class="line"><span class="lineno">  603</span>    <a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a> ATb({n}, A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  604</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i) {</div>
<div class="line"><span class="lineno">  605</span>        ATb[{i}] = ATb_mat[{i, 0}];</div>
<div class="line"><span class="lineno">  606</span>    }</div>
<div class="line"><span class="lineno">  607</span>    </div>
<div class="line"><span class="lineno">  608</span>    <span class="comment">// Solve A^T A x = A^T b</span></div>
<div class="line"><span class="lineno">  609</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="#a49a644f54af36b484886d433da564a1f">solve</a>(ATA, ATb, <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696ac84ce85b6bfbfa4ad1983fe305494ab0">SolverMethod::Cholesky</a>);</div>
<div class="line"><span class="lineno">  610</span>}</div>
<div class="ttc" id="anamespacelinalg_html_a49a644f54af36b484886d433da564a1f"><div class="ttname"><a href="#a49a644f54af36b484886d433da564a1f">linalg::solve</a></div><div class="ttdeci">TensorResult&lt; Vector&lt; T &gt; &gt; solve(const Matrix&lt; T &gt; &amp;A, const Vector&lt; T &gt; &amp;b, SolverMethod method=SolverMethod::Auto)</div><div class="ttdoc">Solve linear system Ax = b.</div><div class="ttdef"><b>Definition</b> <a href="linalg__advanced_8h_source.html#l00328">linalg_advanced.h:328</a></div></div>
<div class="ttc" id="anamespacelinalg_html_acfd8438cccf61414430eaf034addccfaa66c35cd8077f7e1db5faefbc048a646a"><div class="ttname"><a href="#acfd8438cccf61414430eaf034addccfaa66c35cd8077f7e1db5faefbc048a646a">linalg::LstsqMethod::QR</a></div><div class="ttdeci">@ QR</div><div class="ttdoc">QR-based (fast, numerically stable).</div><div class="ttdef"><b>Definition</b> <a href="linalg__advanced_8h_source.html#l00129">linalg_advanced.h:129</a></div></div>
<div class="ttc" id="atensor_8h_html_a2db6a67f5b95f95cb23a9d7b28deceaaa2664c241558d7674e8ed4d5f63d2e463"><div class="ttname"><a href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa2664c241558d7674e8ed4d5f63d2e463">TensorError::DimensionMismatch</a></div><div class="ttdeci">@ DimensionMismatch</div><div class="ttdoc">Tensor dimensions do not match for the operation.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00261">tensor.h:261</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a8405b084d692b1fc7f685f40425a0970_cgraph.png" border="0" usemap="#anamespacelinalg_a8405b084d692b1fc7f685f40425a0970_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a8405b084d692b1fc7f685f40425a0970_cgraph" id="anamespacelinalg_a8405b084d692b1fc7f685f40425a0970_cgraph">
<area shape="rect" title="Solve least squares problem: minimize ||Ax &#45; b||Â²" alt="" coords="5,303,93,330"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="450,303,565,330"/>
<area shape="poly" title=" " alt="" coords="93,314,434,314,434,319,93,319"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="628,244,724,271"/>
<area shape="poly" title=" " alt="" coords="57,301,90,254,139,201,216,135,281,87,352,51,449,19,510,4,537,6,567,20,593,40,614,65,631,93,645,122,664,180,674,228,668,229,659,182,640,124,626,95,609,68,589,44,564,24,535,11,510,9,450,24,354,56,284,91,220,139,143,205,94,257,61,304"/>
<area shape="rect" href="namespacelinalg.html#a6ee776536e47c3e57b3b24ed6225bff2" title=" " alt="" coords="289,135,391,162"/>
<area shape="poly" title=" " alt="" coords="65,301,139,245,207,205,278,171,289,166,292,171,280,176,209,210,142,249,68,305"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="614,506,738,532"/>
<area shape="poly" title=" " alt="" coords="58,329,88,397,112,438,143,476,175,507,204,527,236,542,280,555,358,573,421,578,485,572,565,558,600,549,632,536,634,541,601,554,566,563,486,577,421,583,358,578,278,560,235,547,202,532,172,511,139,480,108,441,83,399,53,331"/>
<area shape="rect" href="namespacelinalg.html#a49a644f54af36b484886d433da564a1f" title="Solve linear system Ax = b." alt="" coords="141,354,231,380"/>
<area shape="poly" title=" " alt="" coords="88,328,134,345,132,350,86,333"/>
<area shape="rect" href="namespacelinalg.html#af0c07b2c6a745bcb68c10766032cc5e0" title=" " alt="" coords="449,506,566,532"/>
<area shape="poly" title=" " alt="" coords="64,328,97,364,147,411,210,458,244,479,280,495,318,507,358,515,434,520,434,525,358,520,317,512,278,500,242,483,207,463,144,415,93,368,60,332"/>
<area shape="poly" title=" " alt="" coords="387,160,403,172,415,187,423,203,428,232,433,261,440,275,451,289,454,292,450,296,447,293,435,277,428,262,423,233,417,204,411,190,399,176,384,165"/>
<area shape="poly" title=" " alt="" coords="392,153,475,170,567,197,606,214,641,234,639,238,604,219,565,202,474,175,391,158"/>
<area shape="rect" href="classTensor.html#a234f74cd16bd13561f7963ba29efb163" title="Fill the tensor with a specified value." alt="" coords="467,34,548,60"/>
<area shape="poly" title=" " alt="" coords="361,132,448,77,467,66,469,71,451,81,364,137"/>
<area shape="poly" title=" " alt="" coords="390,160,497,193,542,210,567,222,594,253,616,288,634,325,648,362,666,434,675,490,669,491,661,435,642,364,629,327,611,290,590,256,564,227,540,214,495,198,389,165"/>
<area shape="poly" title=" " alt="" coords="231,355,279,346,434,323,435,328,279,351,232,360"/>
<area shape="poly" title=" " alt="" coords="232,370,298,374,383,373,475,363,521,353,565,339,589,328,612,313,650,280,653,284,615,317,592,332,567,344,522,358,476,368,383,378,298,379,231,375"/>
<area shape="poly" title=" " alt="" coords="195,380,226,436,251,468,281,496,318,519,351,536,383,546,414,552,481,551,565,542,610,534,611,539,566,547,482,556,414,557,382,552,349,541,315,524,277,500,247,472,222,439,191,382"/>
<area shape="rect" href="namespacelinalg_1_1detail.html#aa01152ed1ca1dc6cdf2ceb75eb1c2334" title=" " alt="" coords="279,186,401,228"/>
<area shape="poly" title=" " alt="" coords="198,352,306,238,310,242,202,355"/>
<area shape="rect" href="namespacelinalg.html#a299049265c4cb34923444e82e56f381f" title="Compute LU decomposition with partial pivoting: P*A = L*U." alt="" coords="279,404,401,431"/>
<area shape="poly" title=" " alt="" coords="230,379,284,396,282,402,228,384"/>
<area shape="poly" title=" " alt="" coords="202,379,236,410,280,441,359,476,435,500,433,505,357,481,278,445,233,414,198,383"/>
<area shape="poly" title=" " alt="" coords="402,206,481,210,566,222,623,237,621,242,565,227,480,216,402,211"/>
<area shape="rect" href="namespacelinalg_1_1detail.html#ae27253e1f235523164ab348ddd5fbe5b" title=" " alt="" coords="453,236,562,279"/>
<area shape="poly" title=" " alt="" coords="403,223,439,234,438,239,401,228"/>
<area shape="poly" title=" " alt="" coords="562,255,612,255,612,260,562,260"/>
<area shape="poly" title=" " alt="" coords="363,402,470,336,472,340,365,406"/>
<area shape="poly" title=" " alt="" coords="402,418,482,411,525,400,564,383,594,362,620,336,658,283,662,286,624,339,598,366,567,388,526,405,483,416,402,423"/>
<area shape="poly" title=" " alt="" coords="388,429,615,498,614,503,387,434"/>
<area shape="poly" title=" " alt="" coords="371,429,403,448,451,485,468,495,465,500,448,489,400,452,368,434"/>
<area shape="poly" title=" " alt="" coords="517,504,563,435,657,283,661,286,568,438,521,507"/>
<area shape="poly" title=" " alt="" coords="566,516,598,516,598,522,566,522"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a8405b084d692b1fc7f685f40425a0970_icgraph.png" border="0" usemap="#anamespacelinalg_a8405b084d692b1fc7f685f40425a0970_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a8405b084d692b1fc7f685f40425a0970_icgraph" id="anamespacelinalg_a8405b084d692b1fc7f685f40425a0970_icgraph">
<area shape="rect" title="Solve least squares problem: minimize ||Ax &#45; b||Â²" alt="" coords="191,31,278,57"/>
<area shape="rect" href="tensor__c_8cpp.html#ac4676f00843bcb11305f402265e7b747" title=" " alt="" coords="5,5,143,32"/>
<area shape="poly" title=" " alt="" coords="175,37,143,32,143,27,176,32"/>
<area shape="rect" href="tensor__c_8cpp.html#ab0ed3244c40a7734ca7af5affd241c6d" title=" " alt="" coords="12,56,136,83"/>
<area shape="poly" title=" " alt="" coords="176,56,137,62,136,57,175,51"/>
</map>
</div>

</div>
</div>
<a id="a299049265c4cb34923444e82e56f381f" name="a299049265c4cb34923444e82e56f381f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a299049265c4cb34923444e82e56f381f">&#9670;&#160;</a></span>lu_decomp()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; std::pair&lt; <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt;, std::vector&lt; int &gt; &gt; &gt; linalg::lu_decomp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute LU decomposition with partial pivoting: P*A = L*U. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Data type (float or double) </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>Input matrix (will not be modified) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pair of (LU combined matrix, pivot vector) or error</dd></dl>
<p>The LU combined matrix stores both L and U:</p><ul>
<li>Lower triangle (below diagonal): L (with implicit unit diagonal)</li>
<li>Upper triangle (including diagonal): U</li>
</ul>
<p>Uses LAPACK sgetrf/dgetrf when available, otherwise fallback implementation.</p>
<h1 class="doxsection"><a class="anchor" id="example_lu"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;float&gt;</a> A({{4, 3}, {6, 3}});</div>
<div class="line"><span class="keyword">auto</span> result = <a class="code hl_function" href="#a299049265c4cb34923444e82e56f381f">linalg::lu_decomp</a>(A);</div>
<div class="line"><span class="keywordflow">if</span> (<span class="keyword">auto</span>* lu_data = std::get_if&lt;std::pair&lt;<a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;float&gt;</a>, std::vector&lt;int&gt;&gt;&gt;(&amp;result)) {</div>
<div class="line">    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;float&gt;</a>&amp; <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a> = lu_data-&gt;first;</div>
<div class="line">    std::vector&lt;int&gt;&amp; pivots = lu_data-&gt;second;</div>
<div class="line">    <span class="comment">// Use LU and pivots...</span></div>
<div class="line">}</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="linalg__advanced_8h_source.html#l00202">202</a> of file <a class="el" href="linalg__advanced_8h_source.html">linalg_advanced.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  202</span>                                                                               {</div>
<div class="line"><span class="lineno">  203</span>    <span class="keyword">auto</span> dims = A.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  204</span>    <span class="keywordtype">size_t</span> m = dims[0];</div>
<div class="line"><span class="lineno">  205</span>    <span class="keywordtype">size_t</span> n = dims[1];</div>
<div class="line"><span class="lineno">  206</span>    </div>
<div class="line"><span class="lineno">  207</span>    <span class="keywordflow">if</span> (m == 0 || n == 0) {</div>
<div class="line"><span class="lineno">  208</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa953002ae82f05e5c52b3e676992dacc6">TensorError::EmptyMatrix</a>;</div>
<div class="line"><span class="lineno">  209</span>    }</div>
<div class="line"><span class="lineno">  210</span>    </div>
<div class="line"><span class="lineno">  211</span>    <span class="comment">// Create copy for decomposition (LAPACK modifies in-place)</span></div>
<div class="line"><span class="lineno">  212</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a> = A;</div>
<div class="line"><span class="lineno">  213</span>    std::vector&lt;int&gt; pivots(std::min(m, n));</div>
<div class="line"><span class="lineno">  214</span>    </div>
<div class="line"><span class="lineno">  215</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  216</span>    <span class="comment">// TODO: cuSOLVER implementation</span></div>
<div class="line"><span class="lineno">  217</span>    <span class="comment">// For now, fall through to CPU</span></div>
<div class="line"><span class="lineno">  218</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  219</span>    </div>
<div class="line"><span class="lineno">  220</span><span class="preprocessor">#ifdef USE_LAPACK</span></div>
<div class="line"><span class="lineno">  221</span>    <span class="keywordflow">if</span> (!A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>()) {</div>
<div class="line"><span class="lineno">  222</span>        <span class="keywordtype">int</span> M = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(m);</div>
<div class="line"><span class="lineno">  223</span>        <span class="keywordtype">int</span> N = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(n);</div>
<div class="line"><span class="lineno">  224</span>        <span class="keywordtype">int</span> LDA = N;  <span class="comment">// Column-major: leading dimension</span></div>
<div class="line"><span class="lineno">  225</span>        <span class="keywordtype">int</span> INFO = 0;</div>
<div class="line"><span class="lineno">  226</span>        </div>
<div class="line"><span class="lineno">  227</span>        <span class="comment">// LAPACK expects column-major, but our tensors are row-major</span></div>
<div class="line"><span class="lineno">  228</span>        <span class="comment">// Need to transpose, call LAPACK, then transpose back</span></div>
<div class="line"><span class="lineno">  229</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> A_col = <a class="code hl_function" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a>(<a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>);</div>
<div class="line"><span class="lineno">  230</span>        </div>
<div class="line"><span class="lineno">  231</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, float&gt;) {</div>
<div class="line"><span class="lineno">  232</span>            sgetrf_(&amp;M, &amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, pivots.data(), &amp;INFO);</div>
<div class="line"><span class="lineno">  233</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, double&gt;) {</div>
<div class="line"><span class="lineno">  234</span>            dgetrf_(&amp;M, &amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, pivots.data(), &amp;INFO);</div>
<div class="line"><span class="lineno">  235</span>        }</div>
<div class="line"><span class="lineno">  236</span>        </div>
<div class="line"><span class="lineno">  237</span>        <span class="keywordflow">if</span> (INFO &lt; 0) {</div>
<div class="line"><span class="lineno">  238</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaaa1df5a085496d7c89611f837bf1d52ef">TensorError::LapackError</a>;</div>
<div class="line"><span class="lineno">  239</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (INFO &gt; 0) {</div>
<div class="line"><span class="lineno">  240</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaade2e45aece7bcbb9fe7540cc9e11c40f">TensorError::SingularMatrix</a>;</div>
<div class="line"><span class="lineno">  241</span>        }</div>
<div class="line"><span class="lineno">  242</span>        </div>
<div class="line"><span class="lineno">  243</span>        <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a> = <a class="code hl_function" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a>(A_col);</div>
<div class="line"><span class="lineno">  244</span>        </div>
<div class="line"><span class="lineno">  245</span>        <span class="comment">// Convert 1-based FORTRAN indices to 0-based</span></div>
<div class="line"><span class="lineno">  246</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; p : pivots) {</div>
<div class="line"><span class="lineno">  247</span>            p -= 1;</div>
<div class="line"><span class="lineno">  248</span>        }</div>
<div class="line"><span class="lineno">  249</span>        </div>
<div class="line"><span class="lineno">  250</span>        <span class="keywordflow">return</span> std::make_pair(<a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>, pivots);</div>
<div class="line"><span class="lineno">  251</span>    }</div>
<div class="line"><span class="lineno">  252</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  253</span>    </div>
<div class="line"><span class="lineno">  254</span>    <span class="comment">// Fallback: Doolittle LU decomposition with partial pivoting</span></div>
<div class="line"><span class="lineno">  255</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; std::min(m, n); ++k) {</div>
<div class="line"><span class="lineno">  256</span>        <span class="comment">// Find pivot</span></div>
<div class="line"><span class="lineno">  257</span>        <span class="keywordtype">size_t</span> pivot_row = k;</div>
<div class="line"><span class="lineno">  258</span>        T max_val = std::abs(<a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>[{k, k}]);</div>
<div class="line"><span class="lineno">  259</span>        </div>
<div class="line"><span class="lineno">  260</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = k + 1; i &lt; m; ++i) {</div>
<div class="line"><span class="lineno">  261</span>            T val = std::abs(<a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>[{i, k}]);</div>
<div class="line"><span class="lineno">  262</span>            <span class="keywordflow">if</span> (val &gt; max_val) {</div>
<div class="line"><span class="lineno">  263</span>                max_val = val;</div>
<div class="line"><span class="lineno">  264</span>                pivot_row = i;</div>
<div class="line"><span class="lineno">  265</span>            }</div>
<div class="line"><span class="lineno">  266</span>        }</div>
<div class="line"><span class="lineno">  267</span>        </div>
<div class="line"><span class="lineno">  268</span>        pivots[k] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(pivot_row);</div>
<div class="line"><span class="lineno">  269</span>        </div>
<div class="line"><span class="lineno">  270</span>        <span class="keywordflow">if</span> (max_val &lt; std::numeric_limits&lt;T&gt;::epsilon()) {</div>
<div class="line"><span class="lineno">  271</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaade2e45aece7bcbb9fe7540cc9e11c40f">TensorError::SingularMatrix</a>;</div>
<div class="line"><span class="lineno">  272</span>        }</div>
<div class="line"><span class="lineno">  273</span>        </div>
<div class="line"><span class="lineno">  274</span>        <span class="comment">// Swap rows</span></div>
<div class="line"><span class="lineno">  275</span>        <span class="keywordflow">if</span> (pivot_row != k) {</div>
<div class="line"><span class="lineno">  276</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno">  277</span>                T temp = <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>[{k, j}];</div>
<div class="line"><span class="lineno">  278</span>                <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>[{k, j}] = <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>[{pivot_row, j}];</div>
<div class="line"><span class="lineno">  279</span>                <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>[{pivot_row, j}] = temp;</div>
<div class="line"><span class="lineno">  280</span>            }</div>
<div class="line"><span class="lineno">  281</span>        }</div>
<div class="line"><span class="lineno">  282</span>        </div>
<div class="line"><span class="lineno">  283</span>        <span class="comment">// Compute multipliers and eliminate</span></div>
<div class="line"><span class="lineno">  284</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = k + 1; i &lt; m; ++i) {</div>
<div class="line"><span class="lineno">  285</span>            <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>[{i, k}] /= <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>[{k, k}];</div>
<div class="line"><span class="lineno">  286</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = k + 1; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno">  287</span>                <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>[{i, j}] -= <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>[{i, k}] * <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>[{k, j}];</div>
<div class="line"><span class="lineno">  288</span>            }</div>
<div class="line"><span class="lineno">  289</span>        }</div>
<div class="line"><span class="lineno">  290</span>    }</div>
<div class="line"><span class="lineno">  291</span>    </div>
<div class="line"><span class="lineno">  292</span>    <span class="keywordflow">return</span> std::make_pair(<a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>, pivots);</div>
<div class="line"><span class="lineno">  293</span>}</div>
<div class="ttc" id="atensor_8h_html_a2db6a67f5b95f95cb23a9d7b28deceaaa953002ae82f05e5c52b3e676992dacc6"><div class="ttname"><a href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa953002ae82f05e5c52b3e676992dacc6">TensorError::EmptyMatrix</a></div><div class="ttdeci">@ EmptyMatrix</div><div class="ttdoc">Matrix is empty.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00267">tensor.h:267</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a299049265c4cb34923444e82e56f381f_cgraph.png" border="0" usemap="#anamespacelinalg_a299049265c4cb34923444e82e56f381f_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a299049265c4cb34923444e82e56f381f_cgraph" id="anamespacelinalg_a299049265c4cb34923444e82e56f381f_cgraph">
<area shape="rect" title="Compute LU decomposition with partial pivoting: P*A = L*U." alt="" coords="5,81,128,108"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="176,5,292,32"/>
<area shape="poly" title=" " alt="" coords="97,78,188,36,190,41,99,83"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="354,81,450,108"/>
<area shape="poly" title=" " alt="" coords="128,92,338,92,338,97,128,97"/>
<area shape="rect" href="namespacelinalg.html#af0c07b2c6a745bcb68c10766032cc5e0" title=" " alt="" coords="176,107,292,133"/>
<area shape="poly" title=" " alt="" coords="129,101,161,106,160,112,128,107"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="340,144,464,171"/>
<area shape="poly" title=" " alt="" coords="92,106,130,126,176,143,252,155,325,158,325,163,252,160,175,148,128,131,89,111"/>
<area shape="poly" title=" " alt="" coords="292,109,338,102,339,107,293,114"/>
<area shape="poly" title=" " alt="" coords="293,130,325,138,324,143,292,136"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a299049265c4cb34923444e82e56f381f_icgraph.png" border="0" usemap="#anamespacelinalg_a299049265c4cb34923444e82e56f381f_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a299049265c4cb34923444e82e56f381f_icgraph" id="anamespacelinalg_a299049265c4cb34923444e82e56f381f_icgraph">
<area shape="rect" title="Compute LU decomposition with partial pivoting: P*A = L*U." alt="" coords="591,169,714,196"/>
<area shape="rect" href="namespacelinalg.html#a397bea6a8d02533eae3c3eb837d0fd7a" title="Compute determinant of a square matrix." alt="" coords="416,56,543,83"/>
<area shape="poly" title=" " alt="" coords="619,162,542,109,504,85,506,81,545,104,622,158"/>
<area shape="rect" href="namespacelinalg.html#abc25aee98d873c690a7d8a88277e7219" title="Compute inverse of a square matrix." alt="" coords="429,119,530,145"/>
<area shape="poly" title=" " alt="" coords="589,167,527,148,529,143,591,162"/>
<area shape="rect" href="tensor__c_8cpp.html#a986a2d450dd68de32ba10aca25c9e7ac" title=" " alt="" coords="420,169,539,196"/>
<area shape="poly" title=" " alt="" coords="576,185,540,185,540,180,576,180"/>
<area shape="rect" href="tensor__c_8cpp.html#a1522eabc50b84f6a17d4bcaabffba8ab" title=" " alt="" coords="426,220,533,247"/>
<area shape="poly" title=" " alt="" coords="591,204,529,222,527,217,589,198"/>
<area shape="rect" href="namespacelinalg.html#a49a644f54af36b484886d433da564a1f" title="Solve linear system Ax = b." alt="" coords="434,296,525,323"/>
<area shape="poly" title=" " alt="" coords="623,207,501,298,498,293,619,203"/>
<area shape="rect" href="tensor__c_8cpp.html#a8c7d0e2386ccf7736acfd38fde6b346b" title=" " alt="" coords="191,5,368,32"/>
<area shape="poly" title=" " alt="" coords="408,54,334,35,336,30,410,49"/>
<area shape="rect" href="tensor__c_8cpp.html#a42edf6fc1ead7dfe415d6182180f2852" title=" " alt="" coords="197,56,362,83"/>
<area shape="poly" title=" " alt="" coords="401,72,362,72,362,67,401,67"/>
<area shape="rect" href="tensor__c_8cpp.html#a754f7e7480b2f39aaa21596868896d92" title=" " alt="" coords="204,107,355,133"/>
<area shape="poly" title=" " alt="" coords="413,131,355,127,356,122,414,125"/>
<area shape="rect" href="tensor__c_8cpp.html#a95c93d5c49416ca78236c13928cd0037" title=" " alt="" coords="210,157,348,184"/>
<area shape="poly" title=" " alt="" coords="414,147,349,160,348,155,413,142"/>
<area shape="rect" href="namespacelinalg.html#a8405b084d692b1fc7f685f40425a0970" title="Solve least squares problem: minimize ||Ax &#45; b||Â²" alt="" coords="236,208,323,235"/>
<area shape="poly" title=" " alt="" coords="443,290,367,249,323,234,324,229,369,244,446,285"/>
<area shape="rect" href="tensor__c_8cpp.html#a187bbbf40169a9167f8db3976d81f51a" title=" " alt="" coords="209,259,350,285"/>
<area shape="poly" title=" " alt="" coords="419,301,350,288,351,282,420,296"/>
<area shape="rect" href="tensor__c_8cpp.html#ae8b1c96b8422926b97b2f6305c562ce9" title=" " alt="" coords="216,309,343,336"/>
<area shape="poly" title=" " alt="" coords="419,316,344,321,343,316,419,311"/>
<area shape="rect" href="namespacelinalg.html#a6ff4392ae10b75895ce02443bf3c77d6" title="Compute Moore&#45;Penrose pseudo&#45;inverse using SVD." alt="" coords="238,360,321,387"/>
<area shape="poly" title=" " alt="" coords="427,331,369,351,322,365,320,360,367,345,425,326"/>
<area shape="rect" href="namespacelinalg.html#a61b846dd17050c602c624ff0a898d617" title=" " alt="" coords="234,411,324,437"/>
<area shape="poly" title=" " alt="" coords="457,335,418,369,369,401,326,417,324,412,367,396,414,365,453,331"/>
<area shape="rect" href="tensor__c_8cpp.html#ac4676f00843bcb11305f402265e7b747" title=" " alt="" coords="5,183,143,209"/>
<area shape="poly" title=" " alt="" coords="220,217,143,207,143,202,220,211"/>
<area shape="rect" href="tensor__c_8cpp.html#ab0ed3244c40a7734ca7af5affd241c6d" title=" " alt="" coords="12,233,136,260"/>
<area shape="poly" title=" " alt="" coords="220,231,137,242,136,236,220,226"/>
<area shape="rect" href="tensor__c_8cpp.html#ad0eab2342bda5d725085476abc7c50b6" title=" " alt="" coords="7,335,141,361"/>
<area shape="poly" title=" " alt="" coords="222,369,141,359,142,354,223,364"/>
<area shape="rect" href="tensor__c_8cpp.html#acf74b6d7b42a82859c1fbec640125775" title=" " alt="" coords="14,385,134,412"/>
<area shape="poly" title=" " alt="" coords="223,383,135,394,134,389,222,378"/>
</map>
</div>

</div>
</div>
<a id="a6ee776536e47c3e57b3b24ed6225bff2" name="a6ee776536e47c3e57b3b24ed6225bff2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ee776536e47c3e57b3b24ed6225bff2">&#9670;&#160;</a></span>matmul()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; linalg::matmul </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Matrix-matrix multiplication using BLAS/GPU. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc" title="Type alias for 2D matrices.">Matrix</a> of shape (m, k) </td></tr>
    <tr><td class="paramname">b</td><td><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc" title="Type alias for 2D matrices.">Matrix</a> of shape (k, n) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Result matrix of shape (m, n) </dd></dl>

<p class="definition">Definition at line <a class="el" href="linalg_8h_source.html#l00313">313</a> of file <a class="el" href="linalg_8h_source.html">linalg.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  313</span>                                                         {</div>
<div class="line"><span class="lineno">  314</span>    <span class="keyword">auto</span> dims_a = a.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  315</span>    <span class="keyword">auto</span> dims_b = b.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  316</span>    </div>
<div class="line"><span class="lineno">  317</span>    <span class="keywordtype">size_t</span> m = dims_a[0];</div>
<div class="line"><span class="lineno">  318</span>    <span class="keywordtype">size_t</span> k = dims_a[1];</div>
<div class="line"><span class="lineno">  319</span>    <span class="keywordtype">size_t</span> n = dims_b[1];</div>
<div class="line"><span class="lineno">  320</span>    </div>
<div class="line"><span class="lineno">  321</span>    <span class="keywordflow">if</span> (k != dims_b[0]) {</div>
<div class="line"><span class="lineno">  322</span>        <span class="keywordflow">return</span> <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a>({m, n}, a.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  323</span>    }</div>
<div class="line"><span class="lineno">  324</span>    </div>
<div class="line"><span class="lineno">  325</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> result({m, n}, a.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  326</span>    result.fill(T(0));</div>
<div class="line"><span class="lineno">  327</span>    </div>
<div class="line"><span class="lineno">  328</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  329</span>    <span class="keywordflow">if</span> (a.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>() &amp;&amp; b.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>()) {</div>
<div class="line"><span class="lineno">  330</span>        TensorGPU::dot_2d_gpu(a.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), b.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), result.data_ptr(), m, k, n);</div>
<div class="line"><span class="lineno">  331</span>        <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  332</span>    }</div>
<div class="line"><span class="lineno">  333</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  334</span>    </div>
<div class="line"><span class="lineno">  335</span><span class="preprocessor">#ifdef USE_BLAS</span></div>
<div class="line"><span class="lineno">  336</span>    <span class="comment">// Use BLAS GEMM: C = alpha * A * B + beta * C</span></div>
<div class="line"><span class="lineno">  337</span>    blas_gemm&lt;T&gt;(CblasRowMajor, CblasNoTrans, CblasNoTrans,</div>
<div class="line"><span class="lineno">  338</span>                 m, n, k,</div>
<div class="line"><span class="lineno">  339</span>                 T(1), a.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), k,</div>
<div class="line"><span class="lineno">  340</span>                 b.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), n,</div>
<div class="line"><span class="lineno">  341</span>                 T(0), result.data_ptr(), n);</div>
<div class="line"><span class="lineno">  342</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  343</span>    <span class="comment">// Fallback CPU implementation</span></div>
<div class="line"><span class="lineno">  344</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; ++i) {</div>
<div class="line"><span class="lineno">  345</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno">  346</span>            T sum = T(0);</div>
<div class="line"><span class="lineno">  347</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> p = 0; p &lt; k; ++p) {</div>
<div class="line"><span class="lineno">  348</span>                sum += a[{i, p}] * b[{p, j}];</div>
<div class="line"><span class="lineno">  349</span>            }</div>
<div class="line"><span class="lineno">  350</span>            result[{i, j}] = sum;</div>
<div class="line"><span class="lineno">  351</span>        }</div>
<div class="line"><span class="lineno">  352</span>    }</div>
<div class="line"><span class="lineno">  353</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  354</span>    </div>
<div class="line"><span class="lineno">  355</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  356</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a6ee776536e47c3e57b3b24ed6225bff2_cgraph.png" border="0" usemap="#anamespacelinalg_a6ee776536e47c3e57b3b24ed6225bff2_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a6ee776536e47c3e57b3b24ed6225bff2_cgraph" id="anamespacelinalg_a6ee776536e47c3e57b3b24ed6225bff2_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,108,108"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="160,5,276,32"/>
<area shape="poly" title=" " alt="" coords="82,78,155,42,167,36,169,41,157,46,84,83"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="170,56,266,83"/>
<area shape="poly" title=" " alt="" coords="108,84,154,77,155,82,108,89"/>
<area shape="rect" href="classTensor.html#a234f74cd16bd13561f7963ba29efb163" title="Fill the tensor with a specified value." alt="" coords="177,107,258,133"/>
<area shape="poly" title=" " alt="" coords="108,100,162,109,161,114,108,105"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="156,157,280,184"/>
<area shape="poly" title=" " alt="" coords="84,106,157,143,169,148,167,153,155,148,82,111"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a6ee776536e47c3e57b3b24ed6225bff2_icgraph.png" border="0" usemap="#anamespacelinalg_a6ee776536e47c3e57b3b24ed6225bff2_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a6ee776536e47c3e57b3b24ed6225bff2_icgraph" id="anamespacelinalg_a6ee776536e47c3e57b3b24ed6225bff2_icgraph">
<area shape="rect" title=" " alt="" coords="379,56,481,83"/>
<area shape="rect" href="namespacelinalg.html#a6b7af062b5a9642d788fcc084335b39c" title=" " alt="" coords="191,5,331,32"/>
<area shape="poly" title=" " alt="" coords="368,54,307,35,309,30,369,49"/>
<area shape="rect" href="namespacelinalg.html#a8405b084d692b1fc7f685f40425a0970" title="Solve least squares problem: minimize ||Ax &#45; b||Â²" alt="" coords="217,56,304,83"/>
<area shape="poly" title=" " alt="" coords="363,72,305,72,305,67,363,67"/>
<area shape="rect" href="namespacelinalg.html#a6ff4392ae10b75895ce02443bf3c77d6" title="Compute Moore&#45;Penrose pseudo&#45;inverse using SVD." alt="" coords="219,107,302,133"/>
<area shape="poly" title=" " alt="" coords="369,90,304,110,302,105,367,85"/>
<area shape="rect" href="tensor__c_8cpp.html#ac4676f00843bcb11305f402265e7b747" title=" " alt="" coords="5,5,143,32"/>
<area shape="poly" title=" " alt="" coords="201,56,125,35,127,30,203,51"/>
<area shape="rect" href="tensor__c_8cpp.html#ab0ed3244c40a7734ca7af5affd241c6d" title=" " alt="" coords="12,56,136,83"/>
<area shape="poly" title=" " alt="" coords="202,72,137,72,137,67,202,67"/>
<area shape="rect" href="tensor__c_8cpp.html#ad0eab2342bda5d725085476abc7c50b6" title=" " alt="" coords="7,107,141,133"/>
<area shape="poly" title=" " alt="" coords="203,123,141,123,141,117,203,117"/>
<area shape="rect" href="tensor__c_8cpp.html#acf74b6d7b42a82859c1fbec640125775" title=" " alt="" coords="14,157,134,184"/>
<area shape="poly" title=" " alt="" coords="205,138,127,159,125,154,203,133"/>
</map>
</div>

</div>
</div>
<a id="a0e459857cd625f66948d7ae48731b17a" name="a0e459857cd625f66948d7ae48731b17a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e459857cd625f66948d7ae48731b17a">&#9670;&#160;</a></span>matrix_rank()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">size_t linalg::matrix_rank </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>tol</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(-1)</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute numerical rank of a matrix using SVD. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Data type </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>Input matrix </td></tr>
    <tr><td class="paramname">tol</td><td>Tolerance for zero singular values (default: epsilon * max(m,n) * max_sigma) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Rank of matrix</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_rank"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;float&gt;</a> A({{1, 2}, {2, 4}});  <span class="comment">// Rank-1 matrix</span></div>
<div class="line"><span class="keywordtype">size_t</span> r = <a class="code hl_function" href="#a0e459857cd625f66948d7ae48731b17a">linalg::matrix_rank</a>(A);  <span class="comment">// Returns 1</span></div>
<div class="ttc" id="anamespacelinalg_html_a0e459857cd625f66948d7ae48731b17a"><div class="ttname"><a href="#a0e459857cd625f66948d7ae48731b17a">linalg::matrix_rank</a></div><div class="ttdeci">size_t matrix_rank(const Matrix&lt; T &gt; &amp;A, T tol=T(-1))</div><div class="ttdoc">Compute numerical rank of a matrix using SVD.</div><div class="ttdef"><b>Definition</b> <a href="linalg__advanced_8h_source.html#l00631">linalg_advanced.h:631</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="linalg__advanced_8h_source.html#l00631">631</a> of file <a class="el" href="linalg__advanced_8h_source.html">linalg_advanced.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  631</span>                                                      {</div>
<div class="line"><span class="lineno">  632</span>    <span class="comment">// For now, use the existing rank() function from linalg.h</span></div>
<div class="line"><span class="lineno">  633</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="#ad07d8335c6ed4ffb675492effc453771">rank</a>(A, tol);</div>
<div class="line"><span class="lineno">  634</span>}</div>
<div class="ttc" id="anamespacelinalg_html_ad07d8335c6ed4ffb675492effc453771"><div class="ttname"><a href="#ad07d8335c6ed4ffb675492effc453771">linalg::rank</a></div><div class="ttdeci">size_t rank(const Matrix&lt; T &gt; &amp;mat, T tol=T(-1))</div><div class="ttdef"><b>Definition</b> <a href="linalg_8h_source.html#l00528">linalg.h:528</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a0e459857cd625f66948d7ae48731b17a_cgraph.png" border="0" usemap="#anamespacelinalg_a0e459857cd625f66948d7ae48731b17a_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a0e459857cd625f66948d7ae48731b17a_cgraph" id="anamespacelinalg_a0e459857cd625f66948d7ae48731b17a_cgraph">
<area shape="rect" title="Compute numerical rank of a matrix using SVD." alt="" coords="5,81,133,108"/>
<area shape="rect" href="namespacelinalg.html#ad07d8335c6ed4ffb675492effc453771" title=" " alt="" coords="181,81,265,108"/>
<area shape="poly" title=" " alt="" coords="133,92,165,92,165,97,133,97"/>
<area shape="rect" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74" title="Extract a single column from a 2D tensor." alt="" coords="348,5,387,32"/>
<area shape="poly" title=" " alt="" coords="246,79,312,42,333,31,335,36,314,46,249,83"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="484,107,581,133"/>
<area shape="poly" title=" " alt="" coords="266,95,469,112,469,118,265,101"/>
<area shape="rect" href="namespacelinalg.html#a4d71f03f0561f2e14840e3a593c24da5" title=" " alt="" coords="313,157,422,184"/>
<area shape="poly" title=" " alt="" coords="251,106,328,147,326,152,249,111"/>
<area shape="rect" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee" title="Extract a single row from a 2D tensor." alt="" coords="346,56,389,83"/>
<area shape="poly" title=" " alt="" coords="265,85,331,73,332,78,266,90"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="475,56,590,83"/>
<area shape="poly" title=" " alt="" coords="388,22,473,48,471,53,386,27"/>
<area shape="poly" title=" " alt="" coords="388,23,424,42,439,55,448,68,458,80,472,93,479,97,476,102,469,97,454,84,444,71,435,59,421,46,386,28"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="470,5,595,32"/>
<area shape="poly" title=" " alt="" coords="387,16,455,16,455,21,387,21"/>
<area shape="poly" title=" " alt="" coords="413,154,471,136,473,141,415,159"/>
<area shape="poly" title=" " alt="" coords="389,67,459,67,459,72,389,72"/>
<area shape="poly" title=" " alt="" coords="390,73,473,99,471,104,388,78"/>
<area shape="poly" title=" " alt="" coords="388,61,471,35,473,40,390,66"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a0e459857cd625f66948d7ae48731b17a_icgraph.png" border="0" usemap="#anamespacelinalg_a0e459857cd625f66948d7ae48731b17a_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a0e459857cd625f66948d7ae48731b17a_icgraph" id="anamespacelinalg_a0e459857cd625f66948d7ae48731b17a_icgraph">
<area shape="rect" title="Compute numerical rank of a matrix using SVD." alt="" coords="188,31,315,57"/>
<area shape="rect" href="tensor__c_8cpp.html#af30504e8e051a714b7a0fdcae0f7c636" title=" " alt="" coords="5,5,140,32"/>
<area shape="poly" title=" " alt="" coords="172,35,139,31,140,26,173,30"/>
<area shape="rect" href="tensor__c_8cpp.html#ab1f7ff7476a784a17149afa2fd100d07" title=" " alt="" coords="12,56,133,83"/>
<area shape="poly" title=" " alt="" coords="173,58,134,63,133,58,172,53"/>
</map>
</div>

</div>
</div>
<a id="a57a91e9770c813128f00c0a1ea674012" name="a57a91e9770c813128f00c0a1ea674012"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57a91e9770c813128f00c0a1ea674012">&#9670;&#160;</a></span>matvec()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; linalg::matvec </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>vec</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Matrix-vector multiplication. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mat</td><td><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc" title="Type alias for 2D matrices.">Matrix</a> of shape (m, n) </td></tr>
    <tr><td class="paramname">vec</td><td><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b" title="Type alias for 1D vectors.">Vector</a> of length n </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Result vector of length m </dd></dl>

<p class="definition">Definition at line <a class="el" href="linalg_8h_source.html#l00255">255</a> of file <a class="el" href="linalg_8h_source.html">linalg.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  255</span>                                                             {</div>
<div class="line"><span class="lineno">  256</span>    <span class="keyword">auto</span> mat_dims = mat.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  257</span>    <span class="keyword">auto</span> vec_dims = vec.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  258</span>    </div>
<div class="line"><span class="lineno">  259</span>    <span class="keywordtype">size_t</span> m = mat_dims[0];</div>
<div class="line"><span class="lineno">  260</span>    <span class="keywordtype">size_t</span> n = mat_dims[1];</div>
<div class="line"><span class="lineno">  261</span>    </div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordflow">if</span> (n != vec_dims[0]) {</div>
<div class="line"><span class="lineno">  263</span>        <span class="keywordflow">return</span> <a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a>({m}, mat.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  264</span>    }</div>
<div class="line"><span class="lineno">  265</span>    </div>
<div class="line"><span class="lineno">  266</span>    <a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a> result({m}, mat.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  267</span>    </div>
<div class="line"><span class="lineno">  268</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  269</span>    <span class="keywordflow">if</span> (mat.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>() &amp;&amp; vec.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>()) {</div>
<div class="line"><span class="lineno">  270</span>        <span class="comment">// Use GPU matrix-vector multiplication</span></div>
<div class="line"><span class="lineno">  271</span>        <span class="comment">// Can reuse 2D dot product with single column</span></div>
<div class="line"><span class="lineno">  272</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> vec_as_mat({n, 1}, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  273</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i) {</div>
<div class="line"><span class="lineno">  274</span>            vec_as_mat[{i, 0}] = vec[{i}];</div>
<div class="line"><span class="lineno">  275</span>        }</div>
<div class="line"><span class="lineno">  276</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> result_mat({m, 1}, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  277</span>        TensorGPU::dot_2d_gpu(mat.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), vec_as_mat.data_ptr(), result_mat.data_ptr(), m, n, 1);</div>
<div class="line"><span class="lineno">  278</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; ++i) {</div>
<div class="line"><span class="lineno">  279</span>            result[{i}] = result_mat[{i, 0}];</div>
<div class="line"><span class="lineno">  280</span>        }</div>
<div class="line"><span class="lineno">  281</span>        <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  282</span>    }</div>
<div class="line"><span class="lineno">  283</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  284</span>    </div>
<div class="line"><span class="lineno">  285</span><span class="preprocessor">#ifdef USE_BLAS</span></div>
<div class="line"><span class="lineno">  286</span>    <span class="comment">// Use BLAS GEMV for optimized matrix-vector multiplication</span></div>
<div class="line"><span class="lineno">  287</span>    <span class="comment">// C = alpha * A * x + beta * C</span></div>
<div class="line"><span class="lineno">  288</span>    <span class="comment">// For row-major: y = A * x means we compute y_i = sum_j A[i,j] * x[j]</span></div>
<div class="line"><span class="lineno">  289</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; ++i) {</div>
<div class="line"><span class="lineno">  290</span>        result[{i}] = blas_dot&lt;T&gt;(n, mat.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>() + i * n, 1, vec.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), 1);</div>
<div class="line"><span class="lineno">  291</span>    }</div>
<div class="line"><span class="lineno">  292</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  293</span>    <span class="comment">// Fallback CPU implementation</span></div>
<div class="line"><span class="lineno">  294</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; ++i) {</div>
<div class="line"><span class="lineno">  295</span>        T sum = T(0);</div>
<div class="line"><span class="lineno">  296</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno">  297</span>            sum += mat[{i, j}] * vec[{j}];</div>
<div class="line"><span class="lineno">  298</span>        }</div>
<div class="line"><span class="lineno">  299</span>        result[{i}] = sum;</div>
<div class="line"><span class="lineno">  300</span>    }</div>
<div class="line"><span class="lineno">  301</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  302</span>    </div>
<div class="line"><span class="lineno">  303</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  304</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a57a91e9770c813128f00c0a1ea674012_cgraph.png" border="0" usemap="#anamespacelinalg_a57a91e9770c813128f00c0a1ea674012_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a57a91e9770c813128f00c0a1ea674012_cgraph" id="anamespacelinalg_a57a91e9770c813128f00c0a1ea674012_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,108,83"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="160,5,276,32"/>
<area shape="poly" title=" " alt="" coords="101,53,157,35,159,40,102,58"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="170,56,266,83"/>
<area shape="poly" title=" " alt="" coords="108,67,154,67,154,72,108,72"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="156,107,280,133"/>
<area shape="poly" title=" " alt="" coords="102,81,159,99,157,104,101,86"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a57a91e9770c813128f00c0a1ea674012_icgraph.png" border="0" usemap="#anamespacelinalg_a57a91e9770c813128f00c0a1ea674012_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a57a91e9770c813128f00c0a1ea674012_icgraph" id="anamespacelinalg_a57a91e9770c813128f00c0a1ea674012_icgraph">
<area shape="rect" title=" " alt="" coords="206,31,308,57"/>
<area shape="rect" href="tensor__c_8cpp.html#abccf318edf4efc223ffff60d48ac300c" title=" " alt="" coords="5,5,158,32"/>
<area shape="poly" title=" " alt="" coords="190,37,158,32,158,27,191,32"/>
<area shape="rect" href="tensor__c_8cpp.html#a079e41a6775b98530018b97ccd0e923d" title=" " alt="" coords="12,56,151,83"/>
<area shape="poly" title=" " alt="" coords="191,56,152,62,151,57,190,51"/>
</map>
</div>

</div>
</div>
<a id="a16562e1c4018bf2a58455158a8022fb9" name="a16562e1c4018bf2a58455158a8022fb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16562e1c4018bf2a58455158a8022fb9">&#9670;&#160;</a></span>norm()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">T linalg::norm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>v</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the L2 norm (Euclidean norm) of a vector. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Data type </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">v</td><td>Input vector </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>L2 norm as scalar (sqrt of sum of squares)</dd></dl>
<p>Computes ||v|| = sqrt(vâÂ² + vâÂ² + ... + vâÂ²). Uses GPU or BLAS acceleration when available.</p>
<h1 class="doxsection"><a class="anchor" id="example_norm"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;float&gt;</a> v({3});</div>
<div class="line">v[{0}] = 3.0f;</div>
<div class="line">v[{1}] = 4.0f;</div>
<div class="line">v[{2}] = 0.0f;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">float</span> length = <a class="code hl_function" href="#a16562e1c4018bf2a58455158a8022fb9">linalg::norm</a>(v);  <span class="comment">// Returns 5.0 = sqrt(9 + 16)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Useful for normalization:</span></div>
<div class="line"><span class="keyword">auto</span> unit_v = v / <a class="code hl_function" href="#a16562e1c4018bf2a58455158a8022fb9">linalg::norm</a>(v);  <span class="comment">// Unit vector</span></div>
<div class="ttc" id="anamespacelinalg_html_a16562e1c4018bf2a58455158a8022fb9"><div class="ttname"><a href="#a16562e1c4018bf2a58455158a8022fb9">linalg::norm</a></div><div class="ttdeci">T norm(const Vector&lt; T &gt; &amp;v)</div><div class="ttdoc">Compute the L2 norm (Euclidean norm) of a vector.</div><div class="ttdef"><b>Definition</b> <a href="linalg_8h_source.html#l00103">linalg.h:103</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="linalg_8h_source.html#l00103">103</a> of file <a class="el" href="linalg_8h_source.html">linalg.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  103</span>                           {</div>
<div class="line"><span class="lineno">  104</span>    T sum = T(0);</div>
<div class="line"><span class="lineno">  105</span>    <span class="keyword">auto</span> dims = v.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordtype">size_t</span> n = dims[0];</div>
<div class="line"><span class="lineno">  107</span>    </div>
<div class="line"><span class="lineno">  108</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  109</span>    <span class="keywordflow">if</span> (v.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>()) {</div>
<div class="line"><span class="lineno">  110</span>        <span class="comment">// Use GPU for norm computation</span></div>
<div class="line"><span class="lineno">  111</span>        T result;</div>
<div class="line"><span class="lineno">  112</span>        TensorGPU::dot_1d_gpu(v.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), v.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;result, n);</div>
<div class="line"><span class="lineno">  113</span>        <span class="keywordflow">return</span> std::sqrt(result);</div>
<div class="line"><span class="lineno">  114</span>    }</div>
<div class="line"><span class="lineno">  115</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  116</span>    </div>
<div class="line"><span class="lineno">  117</span><span class="preprocessor">#ifdef USE_BLAS</span></div>
<div class="line"><span class="lineno">  118</span>    <span class="comment">// Use BLAS dot product for norm</span></div>
<div class="line"><span class="lineno">  119</span>    T dot_result = blas_dot&lt;T&gt;(n, v.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), 1, v.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), 1);</div>
<div class="line"><span class="lineno">  120</span>    <span class="keywordflow">return</span> std::sqrt(dot_result);</div>
<div class="line"><span class="lineno">  121</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  122</span>    <span class="comment">// Fallback CPU implementation</span></div>
<div class="line"><span class="lineno">  123</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i) {</div>
<div class="line"><span class="lineno">  124</span>        T val = v[{i}];</div>
<div class="line"><span class="lineno">  125</span>        sum += val * val;</div>
<div class="line"><span class="lineno">  126</span>    }</div>
<div class="line"><span class="lineno">  127</span>    <span class="keywordflow">return</span> std::sqrt(sum);</div>
<div class="line"><span class="lineno">  128</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  129</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a16562e1c4018bf2a58455158a8022fb9_cgraph.png" border="0" usemap="#anamespacelinalg_a16562e1c4018bf2a58455158a8022fb9_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a16562e1c4018bf2a58455158a8022fb9_cgraph" id="anamespacelinalg_a16562e1c4018bf2a58455158a8022fb9_cgraph">
<area shape="rect" title="Compute the L2 norm (Euclidean norm) of a vector." alt="" coords="5,56,94,83"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="146,5,262,32"/>
<area shape="poly" title=" " alt="" coords="92,53,145,35,147,40,94,58"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="156,56,252,83"/>
<area shape="poly" title=" " alt="" coords="94,67,140,67,140,72,94,72"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="142,107,266,133"/>
<area shape="poly" title=" " alt="" coords="94,81,147,99,145,104,92,86"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a16562e1c4018bf2a58455158a8022fb9_icgraph.png" border="0" usemap="#anamespacelinalg_a16562e1c4018bf2a58455158a8022fb9_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a16562e1c4018bf2a58455158a8022fb9_icgraph" id="anamespacelinalg_a16562e1c4018bf2a58455158a8022fb9_icgraph">
<area shape="rect" title="Compute the L2 norm (Euclidean norm) of a vector." alt="" coords="192,56,280,83"/>
<area shape="rect" href="namespacelinalg.html#afbe723a0bf8fb7dc2d98815c1ea724b2" title="Normalize a vector to unit length." alt="" coords="17,5,132,32"/>
<area shape="poly" title=" " alt="" coords="176,54,118,35,120,30,178,48"/>
<area shape="rect" href="tensor__c_8cpp.html#a7d5b0b6e1f3294f76ea0a47ee9a458e6" title=" " alt="" coords="5,56,144,83"/>
<area shape="poly" title=" " alt="" coords="176,72,144,72,144,67,176,67"/>
<area shape="rect" href="tensor__c_8cpp.html#a8cb885e97277046203442ad19c70c013" title=" " alt="" coords="12,107,137,133"/>
<area shape="poly" title=" " alt="" coords="178,90,120,109,118,104,176,85"/>
</map>
</div>

</div>
</div>
<a id="a4d71f03f0561f2e14840e3a593c24da5" name="a4d71f03f0561f2e14840e3a593c24da5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d71f03f0561f2e14840e3a593c24da5">&#9670;&#160;</a></span>norm_inf()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">T linalg::norm_inf </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mat</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute infinity norm of a matrix (max row sum). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mat</td><td>Input matrix </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Infinity norm </dd></dl>

<p class="definition">Definition at line <a class="el" href="linalg_8h_source.html#l00503">503</a> of file <a class="el" href="linalg_8h_source.html">linalg.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  503</span>                                 {</div>
<div class="line"><span class="lineno">  504</span>    <span class="keyword">auto</span> dims = mat.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  505</span>    <span class="keywordtype">size_t</span> m = dims[0];</div>
<div class="line"><span class="lineno">  506</span>    <span class="keywordtype">size_t</span> n = dims[1];</div>
<div class="line"><span class="lineno">  507</span>    </div>
<div class="line"><span class="lineno">  508</span>    T max_sum = T(0);</div>
<div class="line"><span class="lineno">  509</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; ++i) {</div>
<div class="line"><span class="lineno">  510</span>        T row_sum = T(0);</div>
<div class="line"><span class="lineno">  511</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno">  512</span>            row_sum += std::abs(mat[{i, j}]);</div>
<div class="line"><span class="lineno">  513</span>        }</div>
<div class="line"><span class="lineno">  514</span>        max_sum = std::max(max_sum, row_sum);</div>
<div class="line"><span class="lineno">  515</span>    }</div>
<div class="line"><span class="lineno">  516</span>    <span class="keywordflow">return</span> max_sum;</div>
<div class="line"><span class="lineno">  517</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a4d71f03f0561f2e14840e3a593c24da5_cgraph.png" border="0" usemap="#anamespacelinalg_a4d71f03f0561f2e14840e3a593c24da5_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a4d71f03f0561f2e14840e3a593c24da5_cgraph" id="anamespacelinalg_a4d71f03f0561f2e14840e3a593c24da5_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,115,32"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="163,5,259,32"/>
<area shape="poly" title=" " alt="" coords="115,16,147,16,147,21,115,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a4d71f03f0561f2e14840e3a593c24da5_icgraph.png" border="0" usemap="#anamespacelinalg_a4d71f03f0561f2e14840e3a593c24da5_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a4d71f03f0561f2e14840e3a593c24da5_icgraph" id="anamespacelinalg_a4d71f03f0561f2e14840e3a593c24da5_icgraph">
<area shape="rect" title=" " alt="" coords="572,31,682,57"/>
<area shape="rect" href="namespacelinalg.html#a5238785f1e2a88a5c99da1f586039ec0" title=" " alt="" coords="363,5,524,32"/>
<area shape="poly" title=" " alt="" coords="557,37,525,33,525,27,557,32"/>
<area shape="rect" href="namespacelinalg.html#ad07d8335c6ed4ffb675492effc453771" title=" " alt="" coords="402,56,486,83"/>
<area shape="poly" title=" " alt="" coords="557,56,487,66,486,61,557,51"/>
<area shape="rect" href="namespacelinalg.html#a0e459857cd625f66948d7ae48731b17a" title="Compute numerical rank of a matrix using SVD." alt="" coords="188,56,315,83"/>
<area shape="poly" title=" " alt="" coords="386,72,315,72,315,67,386,67"/>
<area shape="rect" href="tensor__c_8cpp.html#af30504e8e051a714b7a0fdcae0f7c636" title=" " alt="" coords="5,31,140,57"/>
<area shape="poly" title=" " alt="" coords="172,61,139,56,140,51,173,56"/>
<area shape="rect" href="tensor__c_8cpp.html#ab1f7ff7476a784a17149afa2fd100d07" title=" " alt="" coords="12,81,133,108"/>
<area shape="poly" title=" " alt="" coords="173,83,134,89,133,83,172,78"/>
</map>
</div>

</div>
</div>
<a id="a3df66cae44de6442e02c8d3a1e2a3ea6" name="a3df66cae44de6442e02c8d3a1e2a3ea6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3df66cae44de6442e02c8d3a1e2a3ea6">&#9670;&#160;</a></span>norm_l1()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">T linalg::norm_l1 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mat</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute L1 norm of a matrix (max column sum). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mat</td><td>Input matrix </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>L1 norm </dd></dl>

<p class="definition">Definition at line <a class="el" href="linalg_8h_source.html#l00481">481</a> of file <a class="el" href="linalg_8h_source.html">linalg.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  481</span>                                {</div>
<div class="line"><span class="lineno">  482</span>    <span class="keyword">auto</span> dims = mat.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordtype">size_t</span> m = dims[0];</div>
<div class="line"><span class="lineno">  484</span>    <span class="keywordtype">size_t</span> n = dims[1];</div>
<div class="line"><span class="lineno">  485</span>    </div>
<div class="line"><span class="lineno">  486</span>    T max_sum = T(0);</div>
<div class="line"><span class="lineno">  487</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno">  488</span>        T col_sum = T(0);</div>
<div class="line"><span class="lineno">  489</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; ++i) {</div>
<div class="line"><span class="lineno">  490</span>            col_sum += std::abs(mat[{i, j}]);</div>
<div class="line"><span class="lineno">  491</span>        }</div>
<div class="line"><span class="lineno">  492</span>        max_sum = std::max(max_sum, col_sum);</div>
<div class="line"><span class="lineno">  493</span>    }</div>
<div class="line"><span class="lineno">  494</span>    <span class="keywordflow">return</span> max_sum;</div>
<div class="line"><span class="lineno">  495</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a3df66cae44de6442e02c8d3a1e2a3ea6_cgraph.png" border="0" usemap="#anamespacelinalg_a3df66cae44de6442e02c8d3a1e2a3ea6_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a3df66cae44de6442e02c8d3a1e2a3ea6_cgraph" id="anamespacelinalg_a3df66cae44de6442e02c8d3a1e2a3ea6_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,111,32"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="159,5,255,32"/>
<area shape="poly" title=" " alt="" coords="111,16,143,16,143,21,111,21"/>
</map>
</div>

</div>
</div>
<a id="afbe723a0bf8fb7dc2d98815c1ea724b2" name="afbe723a0bf8fb7dc2d98815c1ea724b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbe723a0bf8fb7dc2d98815c1ea724b2">&#9670;&#160;</a></span>normalize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; linalg::normalize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>v</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Normalize a vector to unit length. </p>
<p>Scales the vector so its L2 norm equals 1. Returns a zero vector if the input norm is too small (near zero).</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Data type </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">v</td><td>Input vector </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Normalized vector with ||v|| = 1, or zero vector if norm â 0</dd></dl>
<h1 class="doxsection"><a class="anchor" id="example_normalize"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;float&gt;</a> v({3});</div>
<div class="line">v[{0}] = 3.0f;</div>
<div class="line">v[{1}] = 4.0f;</div>
<div class="line">v[{2}] = 0.0f;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> unit_v = <a class="code hl_function" href="#afbe723a0bf8fb7dc2d98815c1ea724b2">linalg::normalize</a>(v);</div>
<div class="line"><span class="comment">// unit_v â [0.6, 0.8, 0.0]</span></div>
<div class="line"><span class="comment">// linalg::norm(unit_v) â 1.0</span></div>
<div class="ttc" id="anamespacelinalg_html_afbe723a0bf8fb7dc2d98815c1ea724b2"><div class="ttname"><a href="#afbe723a0bf8fb7dc2d98815c1ea724b2">linalg::normalize</a></div><div class="ttdeci">Vector&lt; T &gt; normalize(const Vector&lt; T &gt; &amp;v)</div><div class="ttdoc">Normalize a vector to unit length.</div><div class="ttdef"><b>Definition</b> <a href="linalg_8h_source.html#l00154">linalg.h:154</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="linalg_8h_source.html#l00154">154</a> of file <a class="el" href="linalg_8h_source.html">linalg.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  154</span>                                        {</div>
<div class="line"><span class="lineno">  155</span>    T n = <a class="code hl_function" href="#a16562e1c4018bf2a58455158a8022fb9">norm</a>(v);</div>
<div class="line"><span class="lineno">  156</span>    <span class="keywordflow">if</span> (n &lt; std::numeric_limits&lt;T&gt;::epsilon()) {</div>
<div class="line"><span class="lineno">  157</span>        <span class="keywordflow">return</span> <a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a>(v.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>(), v.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>(), v.<a class="code hl_function" href="classTensor.html#a947326cf96b1bf3423b40861e1213ab8">requires_grad</a>());</div>
<div class="line"><span class="lineno">  158</span>    }</div>
<div class="line"><span class="lineno">  159</span>    <span class="keywordflow">return</span> v / n;</div>
<div class="line"><span class="lineno">  160</span>}</div>
<div class="ttc" id="aclassTensor_html_a947326cf96b1bf3423b40861e1213ab8"><div class="ttname"><a href="classTensor.html#a947326cf96b1bf3423b40861e1213ab8">Tensor::requires_grad</a></div><div class="ttdeci">bool requires_grad() const</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00753">tensor.h:753</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_afbe723a0bf8fb7dc2d98815c1ea724b2_cgraph.png" border="0" usemap="#anamespacelinalg_afbe723a0bf8fb7dc2d98815c1ea724b2_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_afbe723a0bf8fb7dc2d98815c1ea724b2_cgraph" id="anamespacelinalg_afbe723a0bf8fb7dc2d98815c1ea724b2_cgraph">
<area shape="rect" title="Normalize a vector to unit length." alt="" coords="5,81,121,108"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="377,5,473,32"/>
<area shape="poly" title=" " alt="" coords="86,78,123,59,168,41,218,30,269,23,361,16,361,21,270,28,219,35,169,47,126,63,88,83"/>
<area shape="rect" href="namespacelinalg.html#a16562e1c4018bf2a58455158a8022fb9" title="Compute the L2 norm (Euclidean norm) of a vector." alt="" coords="198,56,286,83"/>
<area shape="poly" title=" " alt="" coords="121,84,182,75,183,80,121,89"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="363,107,487,133"/>
<area shape="poly" title=" " alt="" coords="121,96,348,112,347,117,121,101"/>
<area shape="rect" href="classTensor.html#a947326cf96b1bf3423b40861e1213ab8" title=" " alt="" coords="169,157,315,184"/>
<area shape="poly" title=" " alt="" coords="98,106,196,148,193,153,96,111"/>
<area shape="poly" title=" " alt="" coords="286,55,361,33,363,39,287,60"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="368,56,483,83"/>
<area shape="poly" title=" " alt="" coords="286,67,352,67,352,72,286,72"/>
<area shape="poly" title=" " alt="" coords="287,79,361,99,359,105,286,84"/>
</map>
</div>

</div>
</div>
<a id="a8a8d04b2734fdcad37cc861687fbb6fc" name="a8a8d04b2734fdcad37cc861687fbb6fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a8d04b2734fdcad37cc861687fbb6fc">&#9670;&#160;</a></span>outer()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; linalg::outer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute outer product of two vectors. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>First vector (m elements) </td></tr>
    <tr><td class="paramname">b</td><td>Second vector (n elements) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc" title="Type alias for 2D matrices.">Matrix</a> of shape (m, n) </dd></dl>

<p class="definition">Definition at line <a class="el" href="linalg_8h_source.html#l00226">226</a> of file <a class="el" href="linalg_8h_source.html">linalg.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  226</span>                                                        {</div>
<div class="line"><span class="lineno">  227</span>    <span class="keyword">auto</span> dims_a = a.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  228</span>    <span class="keyword">auto</span> dims_b = b.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  229</span>    </div>
<div class="line"><span class="lineno">  230</span>    <span class="keywordtype">size_t</span> m = dims_a[0];</div>
<div class="line"><span class="lineno">  231</span>    <span class="keywordtype">size_t</span> n = dims_b[0];</div>
<div class="line"><span class="lineno">  232</span>    </div>
<div class="line"><span class="lineno">  233</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> result({m, n}, a.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  234</span>    </div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; ++i) {</div>
<div class="line"><span class="lineno">  236</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno">  237</span>            result[{i, j}] = a[{i}] * b[{j}];</div>
<div class="line"><span class="lineno">  238</span>        }</div>
<div class="line"><span class="lineno">  239</span>    }</div>
<div class="line"><span class="lineno">  240</span>    </div>
<div class="line"><span class="lineno">  241</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  242</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a8a8d04b2734fdcad37cc861687fbb6fc_cgraph.png" border="0" usemap="#anamespacelinalg_a8a8d04b2734fdcad37cc861687fbb6fc_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a8a8d04b2734fdcad37cc861687fbb6fc_cgraph" id="anamespacelinalg_a8a8d04b2734fdcad37cc861687fbb6fc_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,94,57"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="156,5,252,32"/>
<area shape="poly" title=" " alt="" coords="94,34,140,26,141,32,95,39"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="142,56,266,83"/>
<area shape="poly" title=" " alt="" coords="95,49,127,54,126,59,94,54"/>
</map>
</div>

</div>
</div>
<a id="a6ff4392ae10b75895ce02443bf3c77d6" name="a6ff4392ae10b75895ce02443bf3c77d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ff4392ae10b75895ce02443bf3c77d6">&#9670;&#160;</a></span>pinv()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &gt; linalg::pinv </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>rcond</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(-1)</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute Moore-Penrose pseudo-inverse using SVD. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Data type </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>Input matrix (m x n) </td></tr>
    <tr><td class="paramname">rcond</td><td>Cutoff for small singular values (default: epsilon * max(m,n)) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pseudo-inverse (n x m) or error</dd></dl>
<p>The pseudo-inverse Aâº satisfies: A Aâº A = A and Aâº A Aâº = Aâº</p>
<p>Uses SVD: A = U Î£ V^T, then Aâº = V Î£âº U^T where Î£âº has reciprocals of non-zero singular values.</p>
<h1 class="doxsection"><a class="anchor" id="example_pinv"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;float&gt;</a> A({{1, 2}, {3, 4}, {5, 6}});</div>
<div class="line"><span class="keyword">auto</span> Ainv_result = <a class="code hl_function" href="#a6ff4392ae10b75895ce02443bf3c77d6">linalg::pinv</a>(A);</div>
<div class="line"><span class="keywordflow">if</span> (<span class="keyword">auto</span>* Ainv = std::get_if&lt;<a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;float&gt;</a>&gt;(&amp;Ainv_result)) {</div>
<div class="line">    <span class="comment">// Ainv is 2x3 pseudo-inverse</span></div>
<div class="line">}</div>
<div class="ttc" id="anamespacelinalg_html_a6ff4392ae10b75895ce02443bf3c77d6"><div class="ttname"><a href="#a6ff4392ae10b75895ce02443bf3c77d6">linalg::pinv</a></div><div class="ttdeci">TensorResult&lt; Matrix&lt; T &gt; &gt; pinv(const Matrix&lt; T &gt; &amp;A, T rcond=T(-1))</div><div class="ttdoc">Compute Moore-Penrose pseudo-inverse using SVD.</div><div class="ttdef"><b>Definition</b> <a href="linalg__advanced_8h_source.html#l00663">linalg_advanced.h:663</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="linalg__advanced_8h_source.html#l00663">663</a> of file <a class="el" href="linalg__advanced_8h_source.html">linalg_advanced.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  663</span>                                                                  {</div>
<div class="line"><span class="lineno">  664</span>    <span class="keyword">auto</span> dims = A.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  665</span>    <span class="keywordtype">size_t</span> m = dims[0];</div>
<div class="line"><span class="lineno">  666</span>    <span class="keywordtype">size_t</span> n = dims[1];</div>
<div class="line"><span class="lineno">  667</span>    </div>
<div class="line"><span class="lineno">  668</span>    <span class="keywordflow">if</span> (rcond &lt; T(0)) {</div>
<div class="line"><span class="lineno">  669</span>        rcond = std::numeric_limits&lt;T&gt;::epsilon() * std::max(m, n);</div>
<div class="line"><span class="lineno">  670</span>    }</div>
<div class="line"><span class="lineno">  671</span>    </div>
<div class="line"><span class="lineno">  672</span>    <span class="comment">// For now, use simplified approach via solve for square matrices</span></div>
<div class="line"><span class="lineno">  673</span>    <span class="comment">// Full SVD-based implementation would be added with LAPACK integration</span></div>
<div class="line"><span class="lineno">  674</span>    </div>
<div class="line"><span class="lineno">  675</span>    <span class="keywordflow">if</span> (m == n) {</div>
<div class="line"><span class="lineno">  676</span>        <span class="comment">// Square matrix - try to use inverse</span></div>
<div class="line"><span class="lineno">  677</span>        <span class="comment">// This is a placeholder - would use LAPACK sgetri/dgetri</span></div>
<div class="line"><span class="lineno">  678</span>        </div>
<div class="line"><span class="lineno">  679</span><span class="preprocessor">#ifdef USE_LAPACK</span></div>
<div class="line"><span class="lineno">  680</span>        <span class="comment">// TODO: Implement using LAPACK sgetri/dgetri after LU decomposition</span></div>
<div class="line"><span class="lineno">  681</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  682</span>        </div>
<div class="line"><span class="lineno">  683</span>        <span class="comment">// Fallback: return error for now</span></div>
<div class="line"><span class="lineno">  684</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa997ca4ce119685f40f03a9a8a6c5346e">TensorError::NotImplemented</a>;</div>
<div class="line"><span class="lineno">  685</span>    }</div>
<div class="line"><span class="lineno">  686</span>    </div>
<div class="line"><span class="lineno">  687</span>    <span class="comment">// For rectangular matrices, Aâº = (A^T A)^(-1) A^T (right inverse)</span></div>
<div class="line"><span class="lineno">  688</span>    <span class="comment">// or Aâº = A^T (A A^T)^(-1) (left inverse)</span></div>
<div class="line"><span class="lineno">  689</span>    </div>
<div class="line"><span class="lineno">  690</span>    <span class="keywordflow">if</span> (m &gt; n) {</div>
<div class="line"><span class="lineno">  691</span>        <span class="comment">// Overdetermined: Aâº = (A^T A)^(-1) A^T</span></div>
<div class="line"><span class="lineno">  692</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> AT = <a class="code hl_function" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a>(A);</div>
<div class="line"><span class="lineno">  693</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> ATA = <a class="code hl_function" href="#a6ee776536e47c3e57b3b24ed6225bff2">matmul</a>(AT, A);</div>
<div class="line"><span class="lineno">  694</span>        </div>
<div class="line"><span class="lineno">  695</span>        <span class="comment">// Solve ATA * X = AT</span></div>
<div class="line"><span class="lineno">  696</span>        <span class="keyword">auto</span> X_result = <a class="code hl_function" href="#a49a644f54af36b484886d433da564a1f">solve</a>(ATA, AT);</div>
<div class="line"><span class="lineno">  697</span>        <span class="keywordflow">return</span> X_result;</div>
<div class="line"><span class="lineno">  698</span>        </div>
<div class="line"><span class="lineno">  699</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  700</span>        <span class="comment">// Underdetermined: Aâº = A^T (A A^T)^(-1)</span></div>
<div class="line"><span class="lineno">  701</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> AT = <a class="code hl_function" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a>(A);</div>
<div class="line"><span class="lineno">  702</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> AAT = <a class="code hl_function" href="#a6ee776536e47c3e57b3b24ed6225bff2">matmul</a>(A, AT);</div>
<div class="line"><span class="lineno">  703</span>        </div>
<div class="line"><span class="lineno">  704</span>        <span class="comment">// Solve AAT * X^T = A, then transpose</span></div>
<div class="line"><span class="lineno">  705</span>        <span class="comment">// For now, return error</span></div>
<div class="line"><span class="lineno">  706</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa997ca4ce119685f40f03a9a8a6c5346e">TensorError::NotImplemented</a>;</div>
<div class="line"><span class="lineno">  707</span>    }</div>
<div class="line"><span class="lineno">  708</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a6ff4392ae10b75895ce02443bf3c77d6_cgraph.png" border="0" usemap="#anamespacelinalg_a6ff4392ae10b75895ce02443bf3c77d6_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a6ff4392ae10b75895ce02443bf3c77d6_cgraph" id="anamespacelinalg_a6ff4392ae10b75895ce02443bf3c77d6_cgraph">
<area shape="rect" title="Compute Moore&#45;Penrose pseudo&#45;inverse using SVD." alt="" coords="5,312,89,339"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="624,396,720,423"/>
<area shape="poly" title=" " alt="" coords="63,337,96,370,146,412,208,453,241,471,276,484,328,487,423,486,561,480,606,458,643,431,646,435,609,463,562,485,423,492,328,492,274,489,239,475,205,458,143,416,93,374,59,341"/>
<area shape="rect" href="namespacelinalg.html#a6ee776536e47c3e57b3b24ed6225bff2" title=" " alt="" coords="285,84,387,111"/>
<area shape="poly" title=" " alt="" coords="60,310,146,228,208,176,273,127,291,116,294,120,277,131,211,180,150,232,64,314"/>
<area shape="rect" href="namespacelinalg.html#a49a644f54af36b484886d433da564a1f" title="Solve linear system Ax = b." alt="" coords="137,287,227,313"/>
<area shape="poly" title=" " alt="" coords="89,315,121,309,122,314,90,320"/>
<area shape="rect" href="namespacelinalg.html#af0c07b2c6a745bcb68c10766032cc5e0" title=" " alt="" coords="445,337,562,364"/>
<area shape="poly" title=" " alt="" coords="89,325,430,344,430,349,89,330"/>
<area shape="poly" title=" " alt="" coords="388,100,430,108,476,122,522,142,563,171,586,195,605,221,635,279,656,335,668,380,662,381,651,336,631,281,601,224,582,198,560,175,520,147,474,127,428,113,387,105"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="446,185,561,212"/>
<area shape="poly" title=" " alt="" coords="361,109,468,175,466,179,359,113"/>
<area shape="rect" href="classTensor.html#a234f74cd16bd13561f7963ba29efb163" title="Fill the tensor with a specified value." alt="" coords="463,33,544,60"/>
<area shape="poly" title=" " alt="" coords="382,81,448,61,449,66,384,86"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="610,185,734,212"/>
<area shape="poly" title=" " alt="" coords="349,82,389,48,416,31,444,19,477,9,505,3,532,6,563,19,584,33,602,51,631,91,652,133,665,170,660,172,647,135,627,94,598,54,580,37,560,24,531,11,505,9,479,14,446,24,418,36,392,52,352,86"/>
<area shape="poly" title=" " alt="" coords="190,313,200,341,218,377,243,412,276,440,315,460,349,472,381,478,412,479,479,468,561,451,597,441,630,427,632,432,599,446,562,456,480,474,413,484,381,483,348,477,313,465,274,445,239,416,214,379,196,343,185,315"/>
<area shape="poly" title=" " alt="" coords="193,285,227,252,249,235,274,221,313,208,353,200,430,194,430,199,354,205,314,214,276,226,252,239,230,256,196,288"/>
<area shape="poly" title=" " alt="" coords="192,285,237,229,273,190,316,172,361,161,407,155,453,155,540,163,612,178,611,183,539,168,453,160,407,161,362,166,318,177,277,194,241,233,196,288"/>
<area shape="rect" href="namespacelinalg_1_1detail.html#aa01152ed1ca1dc6cdf2ceb75eb1c2334" title=" " alt="" coords="275,388,397,431"/>
<area shape="poly" title=" " alt="" coords="204,312,294,377,291,381,201,316"/>
<area shape="rect" href="namespacelinalg.html#a299049265c4cb34923444e82e56f381f" title="Compute LU decomposition with partial pivoting: P*A = L*U." alt="" coords="275,236,397,263"/>
<area shape="poly" title=" " alt="" coords="224,283,278,265,280,271,226,288"/>
<area shape="poly" title=" " alt="" coords="228,304,398,329,431,335,430,340,397,335,227,309"/>
<area shape="poly" title=" " alt="" coords="398,429,446,440,503,446,561,440,620,425,621,430,562,445,503,451,445,445,397,434"/>
<area shape="rect" href="namespacelinalg_1_1detail.html#ae27253e1f235523164ab348ddd5fbe5b" title=" " alt="" coords="449,388,558,431"/>
<area shape="poly" title=" " alt="" coords="398,407,434,407,434,412,398,412"/>
<area shape="poly" title=" " alt="" coords="558,407,608,407,608,412,558,412"/>
<area shape="poly" title=" " alt="" coords="396,261,477,286,563,323,608,352,646,383,643,387,605,357,560,328,475,291,395,266"/>
<area shape="poly" title=" " alt="" coords="382,233,442,214,443,220,384,238"/>
<area shape="poly" title=" " alt="" coords="397,242,561,221,601,213,602,218,562,227,398,247"/>
<area shape="poly" title=" " alt="" coords="367,261,399,279,447,316,464,327,461,331,444,321,396,283,364,265"/>
<area shape="poly" title=" " alt="" coords="545,362,618,388,616,393,543,367"/>
<area shape="poly" title=" " alt="" coords="518,335,643,221,646,225,521,339"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a6ff4392ae10b75895ce02443bf3c77d6_icgraph.png" border="0" usemap="#anamespacelinalg_a6ff4392ae10b75895ce02443bf3c77d6_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a6ff4392ae10b75895ce02443bf3c77d6_icgraph" id="anamespacelinalg_a6ff4392ae10b75895ce02443bf3c77d6_icgraph">
<area shape="rect" title="Compute Moore&#45;Penrose pseudo&#45;inverse using SVD." alt="" coords="187,31,270,57"/>
<area shape="rect" href="tensor__c_8cpp.html#ad0eab2342bda5d725085476abc7c50b6" title=" " alt="" coords="5,5,139,32"/>
<area shape="poly" title=" " alt="" coords="171,37,139,32,140,27,172,32"/>
<area shape="rect" href="tensor__c_8cpp.html#acf74b6d7b42a82859c1fbec640125775" title=" " alt="" coords="12,56,132,83"/>
<area shape="poly" title=" " alt="" coords="172,56,133,62,132,57,171,51"/>
</map>
</div>

</div>
</div>
<a id="a3395139856f5efebaa58f3bc9c4ed3bd" name="a3395139856f5efebaa58f3bc9c4ed3bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3395139856f5efebaa58f3bc9c4ed3bd">&#9670;&#160;</a></span>qr_decomp()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">auto linalg::qr_decomp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span></td><td>)</td>
          <td>-&gt;std::variant&lt; std::pair&lt; <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt;, <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &gt;, <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaa">TensorError</a> &gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>QR decomposition: A = QR. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>Input matrix (m x n) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pair of Q (m x m orthogonal) and R (m x n upper triangular), or error </dd></dl>

<p class="definition">Definition at line <a class="el" href="linalg__advanced_8h_source.html#l01007">1007</a> of file <a class="el" href="linalg__advanced_8h_source.html">linalg_advanced.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1007</span>                                                                                             {</div>
<div class="line"><span class="lineno"> 1008</span>    <span class="keyword">auto</span> dims = A.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno"> 1009</span>    <span class="keywordtype">size_t</span> m = dims[0];</div>
<div class="line"><span class="lineno"> 1010</span>    <span class="keywordtype">size_t</span> n = dims[1];</div>
<div class="line"><span class="lineno"> 1011</span>    </div>
<div class="line"><span class="lineno"> 1012</span><span class="preprocessor">#ifdef USE_LAPACK</span></div>
<div class="line"><span class="lineno"> 1013</span>    <span class="keywordflow">if</span> (!A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>()) {</div>
<div class="line"><span class="lineno"> 1014</span>        <span class="comment">// Make a column-major copy</span></div>
<div class="line"><span class="lineno"> 1015</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> A_col = <a class="code hl_function" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a>(A);</div>
<div class="line"><span class="lineno"> 1016</span>        <span class="keywordtype">int</span> M = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(m);</div>
<div class="line"><span class="lineno"> 1017</span>        <span class="keywordtype">int</span> N = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(n);</div>
<div class="line"><span class="lineno"> 1018</span>        <span class="keywordtype">int</span> K = std::min(M, N);</div>
<div class="line"><span class="lineno"> 1019</span>        <span class="keywordtype">int</span> LDA = M;</div>
<div class="line"><span class="lineno"> 1020</span>        <span class="keywordtype">int</span> INFO = 0;</div>
<div class="line"><span class="lineno"> 1021</span>        </div>
<div class="line"><span class="lineno"> 1022</span>        std::vector&lt;T&gt; tau(K);</div>
<div class="line"><span class="lineno"> 1023</span>        T work_size;</div>
<div class="line"><span class="lineno"> 1024</span>        <span class="keywordtype">int</span> LWORK = -1;</div>
<div class="line"><span class="lineno"> 1025</span>        </div>
<div class="line"><span class="lineno"> 1026</span>        <span class="comment">// Query workspace size</span></div>
<div class="line"><span class="lineno"> 1027</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, float&gt;) {</div>
<div class="line"><span class="lineno"> 1028</span>            sgeqrf_(&amp;M, &amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, tau.data(), &amp;work_size, &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno"> 1029</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, double&gt;) {</div>
<div class="line"><span class="lineno"> 1030</span>            dgeqrf_(&amp;M, &amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, tau.data(), &amp;work_size, &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno"> 1031</span>        }</div>
<div class="line"><span class="lineno"> 1032</span>        </div>
<div class="line"><span class="lineno"> 1033</span>        LWORK = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(work_size);</div>
<div class="line"><span class="lineno"> 1034</span>        std::vector&lt;T&gt; work(LWORK);</div>
<div class="line"><span class="lineno"> 1035</span>        </div>
<div class="line"><span class="lineno"> 1036</span>        <span class="comment">// Compute QR factorization</span></div>
<div class="line"><span class="lineno"> 1037</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, float&gt;) {</div>
<div class="line"><span class="lineno"> 1038</span>            sgeqrf_(&amp;M, &amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, tau.data(), work.data(), &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno"> 1039</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, double&gt;) {</div>
<div class="line"><span class="lineno"> 1040</span>            dgeqrf_(&amp;M, &amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, tau.data(), work.data(), &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno"> 1041</span>        }</div>
<div class="line"><span class="lineno"> 1042</span>        </div>
<div class="line"><span class="lineno"> 1043</span>        <span class="keywordflow">if</span> (INFO != 0) {</div>
<div class="line"><span class="lineno"> 1044</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaaa1df5a085496d7c89611f837bf1d52ef">TensorError::LapackError</a>;</div>
<div class="line"><span class="lineno"> 1045</span>        }</div>
<div class="line"><span class="lineno"> 1046</span>        </div>
<div class="line"><span class="lineno"> 1047</span>        <span class="comment">// Extract R (upper triangular part)</span></div>
<div class="line"><span class="lineno"> 1048</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> R({m, n}, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1049</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; ++i) {</div>
<div class="line"><span class="lineno"> 1050</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno"> 1051</span>                <span class="keywordflow">if</span> (i &lt;= j) {</div>
<div class="line"><span class="lineno"> 1052</span>                    R[{i, j}] = A_col[{j, i}];</div>
<div class="line"><span class="lineno"> 1053</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1054</span>                    R[{i, j}] = T(0);</div>
<div class="line"><span class="lineno"> 1055</span>                }</div>
<div class="line"><span class="lineno"> 1056</span>            }</div>
<div class="line"><span class="lineno"> 1057</span>        }</div>
<div class="line"><span class="lineno"> 1058</span>        </div>
<div class="line"><span class="lineno"> 1059</span>        <span class="comment">// Generate Q</span></div>
<div class="line"><span class="lineno"> 1060</span>        LWORK = -1;</div>
<div class="line"><span class="lineno"> 1061</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, float&gt;) {</div>
<div class="line"><span class="lineno"> 1062</span>            sorgqr_(&amp;M, &amp;M, &amp;K, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, tau.data(), &amp;work_size, &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno"> 1063</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, double&gt;) {</div>
<div class="line"><span class="lineno"> 1064</span>            dorgqr_(&amp;M, &amp;M, &amp;K, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, tau.data(), &amp;work_size, &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno"> 1065</span>        }</div>
<div class="line"><span class="lineno"> 1066</span>        </div>
<div class="line"><span class="lineno"> 1067</span>        LWORK = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(work_size);</div>
<div class="line"><span class="lineno"> 1068</span>        work.resize(LWORK);</div>
<div class="line"><span class="lineno"> 1069</span>        </div>
<div class="line"><span class="lineno"> 1070</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, float&gt;) {</div>
<div class="line"><span class="lineno"> 1071</span>            sorgqr_(&amp;M, &amp;M, &amp;K, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, tau.data(), work.data(), &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno"> 1072</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, double&gt;) {</div>
<div class="line"><span class="lineno"> 1073</span>            dorgqr_(&amp;M, &amp;M, &amp;K, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, tau.data(), work.data(), &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno"> 1074</span>        }</div>
<div class="line"><span class="lineno"> 1075</span>        </div>
<div class="line"><span class="lineno"> 1076</span>        <span class="keywordflow">if</span> (INFO != 0) {</div>
<div class="line"><span class="lineno"> 1077</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaaa1df5a085496d7c89611f837bf1d52ef">TensorError::LapackError</a>;</div>
<div class="line"><span class="lineno"> 1078</span>        }</div>
<div class="line"><span class="lineno"> 1079</span>        </div>
<div class="line"><span class="lineno"> 1080</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> Q({m, m}, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1081</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; ++i) {</div>
<div class="line"><span class="lineno"> 1082</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; m; ++j) {</div>
<div class="line"><span class="lineno"> 1083</span>                Q[{i, j}] = A_col[{j, i}];</div>
<div class="line"><span class="lineno"> 1084</span>            }</div>
<div class="line"><span class="lineno"> 1085</span>        }</div>
<div class="line"><span class="lineno"> 1086</span>        </div>
<div class="line"><span class="lineno"> 1087</span>        <span class="keywordflow">return</span> std::make_pair(Q, R);</div>
<div class="line"><span class="lineno"> 1088</span>    }</div>
<div class="line"><span class="lineno"> 1089</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1090</span>    </div>
<div class="line"><span class="lineno"> 1091</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa997ca4ce119685f40f03a9a8a6c5346e">TensorError::NotImplemented</a>;</div>
<div class="line"><span class="lineno"> 1092</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a3395139856f5efebaa58f3bc9c4ed3bd_cgraph.png" border="0" usemap="#anamespacelinalg_a3395139856f5efebaa58f3bc9c4ed3bd_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a3395139856f5efebaa58f3bc9c4ed3bd_cgraph" id="anamespacelinalg_a3395139856f5efebaa58f3bc9c4ed3bd_cgraph">
<area shape="rect" title="QR decomposition: A = QR." alt="" coords="5,81,129,108"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="177,5,292,32"/>
<area shape="poly" title=" " alt="" coords="98,78,189,36,191,41,100,83"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="355,81,451,108"/>
<area shape="poly" title=" " alt="" coords="129,92,339,92,339,97,129,97"/>
<area shape="rect" href="namespacelinalg.html#af0c07b2c6a745bcb68c10766032cc5e0" title=" " alt="" coords="177,107,293,133"/>
<area shape="poly" title=" " alt="" coords="129,101,162,106,161,112,128,107"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="341,144,465,171"/>
<area shape="poly" title=" " alt="" coords="92,106,131,126,177,143,253,155,326,158,326,163,253,160,176,148,129,131,90,111"/>
<area shape="poly" title=" " alt="" coords="293,109,339,102,340,107,294,114"/>
<area shape="poly" title=" " alt="" coords="294,130,326,138,325,143,293,136"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a3395139856f5efebaa58f3bc9c4ed3bd_icgraph.png" border="0" usemap="#anamespacelinalg_a3395139856f5efebaa58f3bc9c4ed3bd_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a3395139856f5efebaa58f3bc9c4ed3bd_icgraph" id="anamespacelinalg_a3395139856f5efebaa58f3bc9c4ed3bd_icgraph">
<area shape="rect" title="QR decomposition: A = QR." alt="" coords="174,31,297,57"/>
<area shape="rect" href="tensor__c_8cpp.html#aa3a8e0732f21d46808a15b1a2da569ed" title=" " alt="" coords="5,5,126,32"/>
<area shape="poly" title=" " alt="" coords="158,35,126,30,127,25,159,30"/>
<area shape="rect" href="tensor__c_8cpp.html#a3d60bab577de01d53ca9d0ac33219fb7" title=" " alt="" coords="12,56,119,83"/>
<area shape="poly" title=" " alt="" coords="158,58,120,64,119,59,158,53"/>
</map>
</div>

</div>
</div>
<a id="ad07d8335c6ed4ffb675492effc453771" name="ad07d8335c6ed4ffb675492effc453771"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad07d8335c6ed4ffb675492effc453771">&#9670;&#160;</a></span>rank()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">size_t linalg::rank </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T</td>          <td class="paramname"><span class="paramname"><em>tol</em></span><span class="paramdefsep"> = </span><span class="paramdefval">T(-1)</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Estimate the rank of a matrix using SVD. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mat</td><td>Input matrix </td></tr>
    <tr><td class="paramname">tol</td><td>Tolerance for zero singular values (default: machine epsilon * max(m,n) * max_singular_value) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Estimated rank</dd></dl>
<p>Note: This is a simplified implementation. For more accurate results, use full SVD. </p>

<p class="definition">Definition at line <a class="el" href="linalg_8h_source.html#l00528">528</a> of file <a class="el" href="linalg_8h_source.html">linalg.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  528</span>                                                 {</div>
<div class="line"><span class="lineno">  529</span>    <span class="keyword">auto</span> dims = mat.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  530</span>    <span class="keywordtype">size_t</span> m = dims[0];</div>
<div class="line"><span class="lineno">  531</span>    <span class="keywordtype">size_t</span> n = dims[1];</div>
<div class="line"><span class="lineno">  532</span>    </div>
<div class="line"><span class="lineno">  533</span>    <span class="comment">// Simple rank estimation by counting non-zero singular values</span></div>
<div class="line"><span class="lineno">  534</span>    <span class="comment">// For a full implementation, we would need SVD</span></div>
<div class="line"><span class="lineno">  535</span>    <span class="comment">// Here we use a simplified approach based on row reduction</span></div>
<div class="line"><span class="lineno">  536</span>    </div>
<div class="line"><span class="lineno">  537</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> A = mat; <span class="comment">// Copy for row reduction</span></div>
<div class="line"><span class="lineno">  538</span>    <span class="keywordtype">size_t</span> rank_count = 0;</div>
<div class="line"><span class="lineno">  539</span>    </div>
<div class="line"><span class="lineno">  540</span>    T eps = tol &lt; T(0) ? std::numeric_limits&lt;T&gt;::epsilon() * std::max(m, n) * <a class="code hl_function" href="#a4d71f03f0561f2e14840e3a593c24da5">norm_inf</a>(A) : tol;</div>
<div class="line"><span class="lineno">  541</span>    </div>
<div class="line"><span class="lineno">  542</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a> = 0; <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a> &lt; std::min(m, n); ++<a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>) {</div>
<div class="line"><span class="lineno">  543</span>        <span class="comment">// Find pivot</span></div>
<div class="line"><span class="lineno">  544</span>        <span class="keywordtype">size_t</span> pivot_row = <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>;</div>
<div class="line"><span class="lineno">  545</span>        T max_val = std::abs(A[{<a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>, <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>}]);</div>
<div class="line"><span class="lineno">  546</span>        </div>
<div class="line"><span class="lineno">  547</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a> = <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a> + 1; <a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a> &lt; m; ++<a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a>) {</div>
<div class="line"><span class="lineno">  548</span>            T val = std::abs(A[{<a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a>, <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>}]);</div>
<div class="line"><span class="lineno">  549</span>            <span class="keywordflow">if</span> (val &gt; max_val) {</div>
<div class="line"><span class="lineno">  550</span>                max_val = val;</div>
<div class="line"><span class="lineno">  551</span>                pivot_row = <a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a>;</div>
<div class="line"><span class="lineno">  552</span>            }</div>
<div class="line"><span class="lineno">  553</span>        }</div>
<div class="line"><span class="lineno">  554</span>        </div>
<div class="line"><span class="lineno">  555</span>        <span class="keywordflow">if</span> (max_val &lt; eps) <span class="keywordflow">continue</span>; <span class="comment">// Column is zero</span></div>
<div class="line"><span class="lineno">  556</span>        </div>
<div class="line"><span class="lineno">  557</span>        rank_count++;</div>
<div class="line"><span class="lineno">  558</span>        </div>
<div class="line"><span class="lineno">  559</span>        <span class="comment">// Swap rows if needed</span></div>
<div class="line"><span class="lineno">  560</span>        <span class="keywordflow">if</span> (pivot_row != <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>) {</div>
<div class="line"><span class="lineno">  561</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno">  562</span>                T temp = A[{<a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>, j}];</div>
<div class="line"><span class="lineno">  563</span>                A[{<a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>, j}] = A[{pivot_row, j}];</div>
<div class="line"><span class="lineno">  564</span>                A[{pivot_row, j}] = temp;</div>
<div class="line"><span class="lineno">  565</span>            }</div>
<div class="line"><span class="lineno">  566</span>        }</div>
<div class="line"><span class="lineno">  567</span>        </div>
<div class="line"><span class="lineno">  568</span>        <span class="comment">// Eliminate column</span></div>
<div class="line"><span class="lineno">  569</span>        T pivot = A[{<a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>, <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>}];</div>
<div class="line"><span class="lineno">  570</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a> = <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a> + 1; <a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a> &lt; m; ++<a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a>) {</div>
<div class="line"><span class="lineno">  571</span>            T factor = A[{<a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a>, <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>}] / pivot;</div>
<div class="line"><span class="lineno">  572</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno">  573</span>                A[{<a class="code hl_function" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee">row</a>, j}] -= factor * A[{<a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>, j}];</div>
<div class="line"><span class="lineno">  574</span>            }</div>
<div class="line"><span class="lineno">  575</span>        }</div>
<div class="line"><span class="lineno">  576</span>    }</div>
<div class="line"><span class="lineno">  577</span>    </div>
<div class="line"><span class="lineno">  578</span>    <span class="keywordflow">return</span> rank_count;</div>
<div class="line"><span class="lineno">  579</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_ad07d8335c6ed4ffb675492effc453771_cgraph.png" border="0" usemap="#anamespacelinalg_ad07d8335c6ed4ffb675492effc453771_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_ad07d8335c6ed4ffb675492effc453771_cgraph" id="anamespacelinalg_ad07d8335c6ed4ffb675492effc453771_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,90,108"/>
<area shape="rect" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74" title="Extract a single column from a 2D tensor." alt="" coords="173,5,212,32"/>
<area shape="poly" title=" " alt="" coords="71,79,136,42,158,31,160,36,139,46,73,83"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="309,107,405,133"/>
<area shape="poly" title=" " alt="" coords="90,95,294,112,293,118,90,101"/>
<area shape="rect" href="namespacelinalg.html#a4d71f03f0561f2e14840e3a593c24da5" title=" " alt="" coords="138,157,247,184"/>
<area shape="poly" title=" " alt="" coords="76,106,153,147,151,152,74,111"/>
<area shape="rect" href="tensor_8h.html#adf94b1b28dd9932dd278abaa3cb7a9ee" title="Extract a single row from a 2D tensor." alt="" coords="171,56,214,83"/>
<area shape="poly" title=" " alt="" coords="89,85,156,73,157,78,90,90"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="300,56,415,83"/>
<area shape="poly" title=" " alt="" coords="212,22,298,48,296,53,211,27"/>
<area shape="poly" title=" " alt="" coords="213,23,249,42,263,55,273,68,282,80,297,93,304,97,301,102,293,97,278,84,269,71,260,59,245,46,211,28"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="295,5,419,32"/>
<area shape="poly" title=" " alt="" coords="212,16,279,16,279,21,212,21"/>
<area shape="poly" title=" " alt="" coords="238,154,296,136,298,141,239,159"/>
<area shape="poly" title=" " alt="" coords="214,67,284,67,284,72,214,72"/>
<area shape="poly" title=" " alt="" coords="214,73,298,99,296,104,213,78"/>
<area shape="poly" title=" " alt="" coords="213,61,296,35,298,40,214,66"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_ad07d8335c6ed4ffb675492effc453771_icgraph.png" border="0" usemap="#anamespacelinalg_ad07d8335c6ed4ffb675492effc453771_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_ad07d8335c6ed4ffb675492effc453771_icgraph" id="anamespacelinalg_ad07d8335c6ed4ffb675492effc453771_icgraph">
<area shape="rect" title=" " alt="" coords="363,31,447,57"/>
<area shape="rect" href="namespacelinalg.html#a0e459857cd625f66948d7ae48731b17a" title="Compute numerical rank of a matrix using SVD." alt="" coords="188,31,315,57"/>
<area shape="poly" title=" " alt="" coords="347,47,315,47,315,41,347,41"/>
<area shape="rect" href="tensor__c_8cpp.html#af30504e8e051a714b7a0fdcae0f7c636" title=" " alt="" coords="5,5,140,32"/>
<area shape="poly" title=" " alt="" coords="172,35,139,31,140,26,173,30"/>
<area shape="rect" href="tensor__c_8cpp.html#ab1f7ff7476a784a17149afa2fd100d07" title=" " alt="" coords="12,56,133,83"/>
<area shape="poly" title=" " alt="" coords="173,58,134,63,133,58,172,53"/>
</map>
</div>

</div>
</div>
<a id="a61b846dd17050c602c624ff0a898d617" name="a61b846dd17050c602c624ff0a898d617"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61b846dd17050c602c624ff0a898d617">&#9670;&#160;</a></span>solve() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &gt; linalg::solve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>B</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696">SolverMethod</a></td>          <td class="paramname"><span class="paramname"><em>method</em></span><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a06b9281e396db002010bde1de57262eb">SolverMethod::Auto</a></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="linalg__advanced_8h_source.html#l00459">459</a> of file <a class="el" href="linalg__advanced_8h_source.html">linalg_advanced.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  460</span>                                                                       {</div>
<div class="line"><span class="lineno">  461</span>    <span class="keyword">auto</span> dims_B = B.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  462</span>    <span class="keywordtype">size_t</span> nrhs = dims_B[1];</div>
<div class="line"><span class="lineno">  463</span>    </div>
<div class="line"><span class="lineno">  464</span>    <span class="comment">// Solve column by column</span></div>
<div class="line"><span class="lineno">  465</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> X({dims_B[0], nrhs}, A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  466</span>    </div>
<div class="line"><span class="lineno">  467</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a> = 0; <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a> &lt; nrhs; ++<a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>) {</div>
<div class="line"><span class="lineno">  468</span>        <span class="comment">// Extract column</span></div>
<div class="line"><span class="lineno">  469</span>        <a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a> b({dims_B[0]}, A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  470</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; dims_B[0]; ++i) {</div>
<div class="line"><span class="lineno">  471</span>            b[{i}] = B[{i, <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>}];</div>
<div class="line"><span class="lineno">  472</span>        }</div>
<div class="line"><span class="lineno">  473</span>        </div>
<div class="line"><span class="lineno">  474</span>        <span class="comment">// Solve</span></div>
<div class="line"><span class="lineno">  475</span>        <span class="keyword">auto</span> x_result = <a class="code hl_function" href="#a49a644f54af36b484886d433da564a1f">solve</a>(A, b, method);</div>
<div class="line"><span class="lineno">  476</span>        <span class="keywordflow">if</span> (<span class="keyword">auto</span>* x = std::get_if&lt;<a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a>&gt;(&amp;x_result)) {</div>
<div class="line"><span class="lineno">  477</span>            <span class="comment">// Store solution</span></div>
<div class="line"><span class="lineno">  478</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; x-&gt;dims()[0]; ++i) {</div>
<div class="line"><span class="lineno">  479</span>                X[{i, <a class="code hl_function" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74">col</a>}] = (*x)[{i}];</div>
<div class="line"><span class="lineno">  480</span>            }</div>
<div class="line"><span class="lineno">  481</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  482</span>            <span class="keywordflow">return</span> std::get&lt;TensorError&gt;(x_result);</div>
<div class="line"><span class="lineno">  483</span>        }</div>
<div class="line"><span class="lineno">  484</span>    }</div>
<div class="line"><span class="lineno">  485</span>    </div>
<div class="line"><span class="lineno">  486</span>    <span class="keywordflow">return</span> X;</div>
<div class="line"><span class="lineno">  487</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a61b846dd17050c602c624ff0a898d617_cgraph.png" border="0" usemap="#anamespacelinalg_a61b846dd17050c602c624ff0a898d617_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a61b846dd17050c602c624ff0a898d617_cgraph" id="anamespacelinalg_a61b846dd17050c602c624ff0a898d617_cgraph">
<area shape="rect" title=" " alt="" coords="5,313,96,339"/>
<area shape="rect" href="tensor_8h.html#a5f2a03f722ba5a985a3733e2ff823a74" title="Extract a single column from a 2D tensor." alt="" coords="324,389,362,415"/>
<area shape="poly" title=" " alt="" coords="97,335,310,391,308,396,95,340"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="631,135,727,162"/>
<area shape="poly" title=" " alt="" coords="58,311,88,264,138,198,203,128,240,96,281,69,356,28,390,15,422,6,455,3,490,5,528,15,570,30,600,48,626,72,664,120,660,124,622,75,597,53,568,35,526,20,489,11,455,8,423,11,391,20,358,33,283,74,244,101,207,132,142,202,92,267,62,314"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="617,439,741,466"/>
<area shape="poly" title=" " alt="" coords="69,338,104,367,155,404,217,441,283,469,361,488,423,493,487,487,568,477,616,468,617,473,569,482,488,493,423,498,360,494,281,474,214,446,152,409,101,371,65,342"/>
<area shape="rect" href="namespacelinalg.html#a49a644f54af36b484886d433da564a1f" title="Solve linear system Ax = b." alt="" coords="144,287,234,314"/>
<area shape="poly" title=" " alt="" coords="96,315,128,309,129,314,97,320"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="453,338,568,365"/>
<area shape="poly" title=" " alt="" coords="362,394,448,367,450,372,364,399"/>
<area shape="poly" title=" " alt="" coords="363,403,404,408,457,408,515,399,542,389,567,375,590,355,610,331,640,276,660,222,670,176,676,178,665,223,645,279,614,334,594,358,570,379,544,394,516,404,457,413,403,413,363,408"/>
<area shape="poly" title=" " alt="" coords="363,403,453,418,602,440,601,445,452,423,362,408"/>
<area shape="poly" title=" " alt="" coords="235,312,283,323,362,336,437,344,437,349,362,341,281,329,234,317"/>
<area shape="poly" title=" " alt="" coords="191,286,200,252,218,205,244,156,261,134,280,113,322,83,359,69,452,54,511,44,538,45,570,54,596,67,621,85,659,122,655,126,617,89,594,72,568,59,537,51,512,50,453,59,361,74,324,88,284,117,265,137,248,159,222,208,205,253,196,288"/>
<area shape="poly" title=" " alt="" coords="198,313,228,370,252,401,283,425,322,443,363,456,405,465,447,470,530,470,601,464,601,469,530,476,447,475,404,470,361,461,320,448,281,430,249,404,223,373,193,316"/>
<area shape="rect" href="namespacelinalg_1_1detail.html#aa01152ed1ca1dc6cdf2ceb75eb1c2334" title=" " alt="" coords="282,127,404,170"/>
<area shape="poly" title=" " alt="" coords="202,285,308,179,311,183,206,289"/>
<area shape="rect" href="namespacelinalg.html#a299049265c4cb34923444e82e56f381f" title="Compute LU decomposition with partial pivoting: P*A = L*U." alt="" coords="282,287,404,314"/>
<area shape="poly" title=" " alt="" coords="234,298,266,298,266,303,234,303"/>
<area shape="rect" href="namespacelinalg.html#af0c07b2c6a745bcb68c10766032cc5e0" title=" " alt="" coords="452,237,569,263"/>
<area shape="poly" title=" " alt="" coords="234,285,281,273,361,260,436,253,437,258,362,266,283,278,235,290"/>
<area shape="poly" title=" " alt="" coords="405,146,615,146,615,151,405,151"/>
<area shape="rect" href="namespacelinalg_1_1detail.html#ae27253e1f235523164ab348ddd5fbe5b" title=" " alt="" coords="456,69,565,111"/>
<area shape="poly" title=" " alt="" coords="404,125,441,112,443,117,406,130"/>
<area shape="poly" title=" " alt="" coords="566,106,625,127,624,133,564,112"/>
<area shape="poly" title=" " alt="" coords="391,312,450,330,449,336,389,317"/>
<area shape="poly" title=" " alt="" coords="359,285,400,254,451,222,536,187,615,162,617,167,537,192,454,227,403,259,362,289"/>
<area shape="poly" title=" " alt="" coords="405,293,443,294,486,298,529,307,570,324,601,345,627,372,665,424,661,428,623,375,597,349,567,328,528,312,485,303,443,299,405,299"/>
<area shape="poly" title=" " alt="" coords="389,284,449,266,450,271,391,289"/>
<area shape="poly" title=" " alt="" coords="536,234,567,216,643,168,646,173,570,220,538,239"/>
<area shape="poly" title=" " alt="" coords="544,262,570,280,602,315,629,354,667,424,663,426,625,357,598,319,567,284,541,266"/>
</map>
</div>

</div>
</div>
<a id="a49a644f54af36b484886d433da564a1f" name="a49a644f54af36b484886d433da564a1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49a644f54af36b484886d433da564a1f">&#9670;&#160;</a></span>solve() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tensor_8h.html#a4eaf7c692573fd9dc1a450be56b68fcc">TensorResult</a>&lt; <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &gt; linalg::solve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696">SolverMethod</a></td>          <td class="paramname"><span class="paramname"><em>method</em></span><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a06b9281e396db002010bde1de57262eb">SolverMethod::Auto</a></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solve linear system Ax = b. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Data type (float or double) </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>Coefficient matrix (m x n) </td></tr>
    <tr><td class="paramname">b</td><td>Right-hand side vector or matrix </td></tr>
    <tr><td class="paramname">method</td><td>Solver method (Auto, LU, Cholesky, QR, SVD) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Solution vector/matrix or error</dd></dl>
<p>Automatically selects the best method when method = Auto:</p><ul>
<li>Square + SPD â Cholesky (fastest, most stable for SPD)</li>
<li>Square â LU (general square systems)</li>
<li>Rectangular (m &gt; n) â Least squares (overdetermined)</li>
<li>Rectangular (m &lt; n) â Minimum norm solution (underdetermined)</li>
</ul>
<p>Uses LAPACK sgesv/dgesv, sposv/dposv, or sgels/dgels when available.</p>
<h1 class="doxsection"><a class="anchor" id="example_solve"></a>
Example</h1>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;float&gt;</a> A({{4, -1}, {-1, 4}});</div>
<div class="line"><a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;float&gt;</a> b({10, 5});</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> x_result = <a class="code hl_function" href="#a49a644f54af36b484886d433da564a1f">linalg::solve</a>(A, b);</div>
<div class="line"><span class="keywordflow">if</span> (<span class="keyword">auto</span>* x = std::get_if&lt;<a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;float&gt;</a>&gt;(&amp;x_result)) {</div>
<div class="line">    <span class="comment">// Solution found</span></div>
<div class="line">}</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="linalg__advanced_8h_source.html#l00328">328</a> of file <a class="el" href="linalg__advanced_8h_source.html">linalg_advanced.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  329</span>                                                                       {</div>
<div class="line"><span class="lineno">  330</span>    <span class="keyword">auto</span> dims_A = A.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  331</span>    <span class="keyword">auto</span> dims_b = b.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  332</span>    <span class="keywordtype">size_t</span> m = dims_A[0];</div>
<div class="line"><span class="lineno">  333</span>    <span class="keywordtype">size_t</span> n = dims_A[1];</div>
<div class="line"><span class="lineno">  334</span>    </div>
<div class="line"><span class="lineno">  335</span>    <span class="keywordflow">if</span> (dims_b[0] != m) {</div>
<div class="line"><span class="lineno">  336</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa2664c241558d7674e8ed4d5f63d2e463">TensorError::DimensionMismatch</a>;</div>
<div class="line"><span class="lineno">  337</span>    }</div>
<div class="line"><span class="lineno">  338</span>    </div>
<div class="line"><span class="lineno">  339</span>    <span class="comment">// Select method</span></div>
<div class="line"><span class="lineno">  340</span>    <span class="keywordflow">if</span> (method == <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a06b9281e396db002010bde1de57262eb">SolverMethod::Auto</a>) {</div>
<div class="line"><span class="lineno">  341</span>        <span class="keywordflow">if</span> (m == n) {</div>
<div class="line"><span class="lineno">  342</span>            <span class="comment">// Square system</span></div>
<div class="line"><span class="lineno">  343</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="namespacelinalg_1_1detail.html#aa01152ed1ca1dc6cdf2ceb75eb1c2334">detail::is_positive_definite</a>(A)) {</div>
<div class="line"><span class="lineno">  344</span>                method = <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696ac84ce85b6bfbfa4ad1983fe305494ab0">SolverMethod::Cholesky</a>;</div>
<div class="line"><span class="lineno">  345</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  346</span>                method = <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">SolverMethod::LU</a>;</div>
<div class="line"><span class="lineno">  347</span>            }</div>
<div class="line"><span class="lineno">  348</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  349</span>            <span class="comment">// Rectangular system â least squares</span></div>
<div class="line"><span class="lineno">  350</span>            method = <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a66c35cd8077f7e1db5faefbc048a646a">SolverMethod::QR</a>;</div>
<div class="line"><span class="lineno">  351</span>        }</div>
<div class="line"><span class="lineno">  352</span>    }</div>
<div class="line"><span class="lineno">  353</span>    </div>
<div class="line"><span class="lineno">  354</span><span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><span class="lineno">  355</span>    <span class="comment">// TODO: cuSOLVER implementation</span></div>
<div class="line"><span class="lineno">  356</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  357</span>    </div>
<div class="line"><span class="lineno">  358</span><span class="preprocessor">#ifdef USE_LAPACK</span></div>
<div class="line"><span class="lineno">  359</span>    <span class="keywordflow">if</span> (!A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>()) {</div>
<div class="line"><span class="lineno">  360</span>        <a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a> x = b;  <span class="comment">// Copy RHS (will be overwritten with solution)</span></div>
<div class="line"><span class="lineno">  361</span>        </div>
<div class="line"><span class="lineno">  362</span>        <span class="keywordflow">if</span> (method == <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">SolverMethod::LU</a> || (method == <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a06b9281e396db002010bde1de57262eb">SolverMethod::Auto</a> &amp;&amp; m == n)) {</div>
<div class="line"><span class="lineno">  363</span>            <span class="comment">// General solver using LU</span></div>
<div class="line"><span class="lineno">  364</span>            <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> A_copy = A;</div>
<div class="line"><span class="lineno">  365</span>            <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> A_col = <a class="code hl_function" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a>(A_copy);</div>
<div class="line"><span class="lineno">  366</span>            std::vector&lt;int&gt; pivots(n);</div>
<div class="line"><span class="lineno">  367</span>            </div>
<div class="line"><span class="lineno">  368</span>            <span class="keywordtype">int</span> N = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(n);</div>
<div class="line"><span class="lineno">  369</span>            <span class="keywordtype">int</span> NRHS = 1;</div>
<div class="line"><span class="lineno">  370</span>            <span class="keywordtype">int</span> LDA = N;</div>
<div class="line"><span class="lineno">  371</span>            <span class="keywordtype">int</span> LDB = N;</div>
<div class="line"><span class="lineno">  372</span>            <span class="keywordtype">int</span> INFO = 0;</div>
<div class="line"><span class="lineno">  373</span>            </div>
<div class="line"><span class="lineno">  374</span>            <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, float&gt;) {</div>
<div class="line"><span class="lineno">  375</span>                sgesv_(&amp;N, &amp;NRHS, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, pivots.data(),</div>
<div class="line"><span class="lineno">  376</span>                       x.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDB, &amp;INFO);</div>
<div class="line"><span class="lineno">  377</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, double&gt;) {</div>
<div class="line"><span class="lineno">  378</span>                dgesv_(&amp;N, &amp;NRHS, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA, pivots.data(),</div>
<div class="line"><span class="lineno">  379</span>                       x.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDB, &amp;INFO);</div>
<div class="line"><span class="lineno">  380</span>            }</div>
<div class="line"><span class="lineno">  381</span>            </div>
<div class="line"><span class="lineno">  382</span>            <span class="keywordflow">if</span> (INFO &lt; 0) {</div>
<div class="line"><span class="lineno">  383</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaaa1df5a085496d7c89611f837bf1d52ef">TensorError::LapackError</a>;</div>
<div class="line"><span class="lineno">  384</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (INFO &gt; 0) {</div>
<div class="line"><span class="lineno">  385</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaade2e45aece7bcbb9fe7540cc9e11c40f">TensorError::SingularMatrix</a>;</div>
<div class="line"><span class="lineno">  386</span>            }</div>
<div class="line"><span class="lineno">  387</span>            </div>
<div class="line"><span class="lineno">  388</span>            <span class="keywordflow">return</span> x;</div>
<div class="line"><span class="lineno">  389</span>            </div>
<div class="line"><span class="lineno">  390</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (method == <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696ac84ce85b6bfbfa4ad1983fe305494ab0">SolverMethod::Cholesky</a>) {</div>
<div class="line"><span class="lineno">  391</span>            <span class="comment">// SPD solver using Cholesky</span></div>
<div class="line"><span class="lineno">  392</span>            <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> A_copy = A;</div>
<div class="line"><span class="lineno">  393</span>            <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> A_col = <a class="code hl_function" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a>(A_copy);</div>
<div class="line"><span class="lineno">  394</span>            </div>
<div class="line"><span class="lineno">  395</span>            <span class="keywordtype">int</span> N = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(n);</div>
<div class="line"><span class="lineno">  396</span>            <span class="keywordtype">int</span> NRHS = 1;</div>
<div class="line"><span class="lineno">  397</span>            <span class="keywordtype">int</span> LDA = N;</div>
<div class="line"><span class="lineno">  398</span>            <span class="keywordtype">int</span> LDB = N;</div>
<div class="line"><span class="lineno">  399</span>            <span class="keywordtype">int</span> INFO = 0;</div>
<div class="line"><span class="lineno">  400</span>            <span class="keywordtype">char</span> UPLO = <span class="charliteral">&#39;U&#39;</span>;  <span class="comment">// Upper triangular</span></div>
<div class="line"><span class="lineno">  401</span>            </div>
<div class="line"><span class="lineno">  402</span>            <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, float&gt;) {</div>
<div class="line"><span class="lineno">  403</span>                sposv_(&amp;UPLO, &amp;N, &amp;NRHS, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA,</div>
<div class="line"><span class="lineno">  404</span>                       x.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDB, &amp;INFO);</div>
<div class="line"><span class="lineno">  405</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, double&gt;) {</div>
<div class="line"><span class="lineno">  406</span>                dposv_(&amp;UPLO, &amp;N, &amp;NRHS, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA,</div>
<div class="line"><span class="lineno">  407</span>                       x.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDB, &amp;INFO);</div>
<div class="line"><span class="lineno">  408</span>            }</div>
<div class="line"><span class="lineno">  409</span>            </div>
<div class="line"><span class="lineno">  410</span>            <span class="keywordflow">if</span> (INFO &lt; 0) {</div>
<div class="line"><span class="lineno">  411</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaaa1df5a085496d7c89611f837bf1d52ef">TensorError::LapackError</a>;</div>
<div class="line"><span class="lineno">  412</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (INFO &gt; 0) {</div>
<div class="line"><span class="lineno">  413</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa5a386c59a2af4745f1107846201959ed">TensorError::NotPositiveDefinite</a>;</div>
<div class="line"><span class="lineno">  414</span>            }</div>
<div class="line"><span class="lineno">  415</span>            </div>
<div class="line"><span class="lineno">  416</span>            <span class="keywordflow">return</span> x;</div>
<div class="line"><span class="lineno">  417</span>        }</div>
<div class="line"><span class="lineno">  418</span>    }</div>
<div class="line"><span class="lineno">  419</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  420</span>    </div>
<div class="line"><span class="lineno">  421</span>    <span class="comment">// Fallback: use LU decomposition</span></div>
<div class="line"><span class="lineno">  422</span>    <span class="keyword">auto</span> lu_result = <a class="code hl_function" href="#a299049265c4cb34923444e82e56f381f">lu_decomp</a>(A);</div>
<div class="line"><span class="lineno">  423</span>    <span class="keywordflow">if</span> (<span class="keyword">auto</span>* lu_data = std::get_if&lt;std::pair&lt;<a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a>, std::vector&lt;int&gt;&gt;&gt;(&amp;lu_result)) {</div>
<div class="line"><span class="lineno">  424</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a>&amp; <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a> = lu_data-&gt;first;</div>
<div class="line"><span class="lineno">  425</span>        <span class="keyword">const</span> std::vector&lt;int&gt;&amp; pivots = lu_data-&gt;second;</div>
<div class="line"><span class="lineno">  426</span>        </div>
<div class="line"><span class="lineno">  427</span>        <span class="comment">// Forward substitution with pivoting: Ly = Pb</span></div>
<div class="line"><span class="lineno">  428</span>        <a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a> y = b;</div>
<div class="line"><span class="lineno">  429</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; pivots.size(); ++i) {</div>
<div class="line"><span class="lineno">  430</span>            <span class="keywordflow">if</span> (pivots[i] != <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(i)) {</div>
<div class="line"><span class="lineno">  431</span>                T temp = y[{i}];</div>
<div class="line"><span class="lineno">  432</span>                y[{i}] = y[{<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(pivots[i])}];</div>
<div class="line"><span class="lineno">  433</span>                y[{<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(pivots[i])}] = temp;</div>
<div class="line"><span class="lineno">  434</span>            }</div>
<div class="line"><span class="lineno">  435</span>            </div>
<div class="line"><span class="lineno">  436</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; i; ++j) {</div>
<div class="line"><span class="lineno">  437</span>                y[{i}] -= <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>[{i, j}] * y[{j}];</div>
<div class="line"><span class="lineno">  438</span>            }</div>
<div class="line"><span class="lineno">  439</span>        }</div>
<div class="line"><span class="lineno">  440</span>        </div>
<div class="line"><span class="lineno">  441</span>        <span class="comment">// Backward substitution: Ux = y</span></div>
<div class="line"><span class="lineno">  442</span>        <a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a> x({n}, A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  443</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(n) - 1; i &gt;= 0; --i) {</div>
<div class="line"><span class="lineno">  444</span>            T sum = y[{<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(i)}];</div>
<div class="line"><span class="lineno">  445</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = i + 1; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno">  446</span>                sum -= <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>[{<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(i), j}] * x[{j}];</div>
<div class="line"><span class="lineno">  447</span>            }</div>
<div class="line"><span class="lineno">  448</span>            x[{<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(i)}] = sum / <a class="code hl_enumvalue" href="#a6b074b3bbdaaecb5d69bfe7b42a4e696a920d0c66f3d2ad926a6d590a5d244bd9">LU</a>[{<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(i), <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(i)}];</div>
<div class="line"><span class="lineno">  449</span>        }</div>
<div class="line"><span class="lineno">  450</span>        </div>
<div class="line"><span class="lineno">  451</span>        <span class="keywordflow">return</span> x;</div>
<div class="line"><span class="lineno">  452</span>    }</div>
<div class="line"><span class="lineno">  453</span>    </div>
<div class="line"><span class="lineno">  454</span>    <span class="keywordflow">return</span> std::get&lt;TensorError&gt;(lu_result);</div>
<div class="line"><span class="lineno">  455</span>}</div>
<div class="ttc" id="anamespacelinalg_1_1detail_html_aa01152ed1ca1dc6cdf2ceb75eb1c2334"><div class="ttname"><a href="namespacelinalg_1_1detail.html#aa01152ed1ca1dc6cdf2ceb75eb1c2334">linalg::detail::is_positive_definite</a></div><div class="ttdeci">bool is_positive_definite(const Matrix&lt; T &gt; &amp;A)</div><div class="ttdef"><b>Definition</b> <a href="linalg__advanced_8h_source.html#l00158">linalg_advanced.h:158</a></div></div>
<div class="ttc" id="atensor_8h_html_a2db6a67f5b95f95cb23a9d7b28deceaaa5a386c59a2af4745f1107846201959ed"><div class="ttname"><a href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa5a386c59a2af4745f1107846201959ed">TensorError::NotPositiveDefinite</a></div><div class="ttdeci">@ NotPositiveDefinite</div><div class="ttdoc">Matrix is not positive definite.</div><div class="ttdef"><b>Definition</b> <a href="tensor_8h_source.html#l00265">tensor.h:265</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a49a644f54af36b484886d433da564a1f_cgraph.png" border="0" usemap="#anamespacelinalg_a49a644f54af36b484886d433da564a1f_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a49a644f54af36b484886d433da564a1f_cgraph" id="anamespacelinalg_a49a644f54af36b484886d433da564a1f_cgraph">
<area shape="rect" title="Solve linear system Ax = b." alt="" coords="5,155,96,182"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="314,130,430,157"/>
<area shape="poly" title=" " alt="" coords="96,162,298,146,299,152,96,168"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="492,71,589,98"/>
<area shape="poly" title=" " alt="" coords="56,153,87,101,112,72,142,49,182,29,217,15,250,6,282,3,349,9,431,27,472,42,508,61,505,65,470,47,430,32,348,15,282,9,251,12,219,20,184,33,145,53,116,76,91,104,60,156"/>
<area shape="rect" href="namespacelinalg_1_1detail.html#aa01152ed1ca1dc6cdf2ceb75eb1c2334" title=" " alt="" coords="144,63,266,106"/>
<area shape="poly" title=" " alt="" coords="76,152,150,111,152,116,78,157"/>
<area shape="rect" href="namespacelinalg.html#a299049265c4cb34923444e82e56f381f" title="Compute LU decomposition with partial pivoting: P*A = L*U." alt="" coords="144,181,266,207"/>
<area shape="poly" title=" " alt="" coords="97,173,129,179,128,184,96,179"/>
<area shape="rect" href="namespacelinalg.html#af0c07b2c6a745bcb68c10766032cc5e0" title=" " alt="" coords="314,282,430,309"/>
<area shape="poly" title=" " alt="" coords="76,180,145,217,229,249,307,275,306,280,227,254,143,222,73,185"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="478,282,603,309"/>
<area shape="poly" title=" " alt="" coords="63,181,96,224,119,247,145,268,189,292,225,304,314,318,372,323,430,318,475,310,476,315,431,323,372,328,314,323,224,309,186,296,142,272,115,251,92,227,58,184"/>
<area shape="poly" title=" " alt="" coords="265,60,314,49,372,43,431,49,490,63,489,69,430,54,372,48,314,54,266,65"/>
<area shape="rect" href="namespacelinalg_1_1detail.html#ae27253e1f235523164ab348ddd5fbe5b" title=" " alt="" coords="318,63,426,106"/>
<area shape="poly" title=" " alt="" coords="267,82,302,82,302,87,267,87"/>
<area shape="poly" title=" " alt="" coords="427,82,477,82,477,87,427,87"/>
<area shape="poly" title=" " alt="" coords="251,177,310,159,312,164,252,182"/>
<area shape="poly" title=" " alt="" coords="266,193,346,187,388,179,429,166,476,139,514,107,518,111,479,143,431,171,390,184,346,193,267,198"/>
<area shape="poly" title=" " alt="" coords="228,206,315,261,334,272,331,276,313,266,226,210"/>
<area shape="poly" title=" " alt="" coords="253,205,480,274,478,280,251,210"/>
<area shape="poly" title=" " alt="" coords="382,280,517,108,521,112,386,283"/>
<area shape="poly" title=" " alt="" coords="431,293,463,293,463,298,431,298"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a49a644f54af36b484886d433da564a1f_icgraph.png" border="0" usemap="#anamespacelinalg_a49a644f54af36b484886d433da564a1f_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a49a644f54af36b484886d433da564a1f_icgraph" id="anamespacelinalg_a49a644f54af36b484886d433da564a1f_icgraph">
<area shape="rect" title="Solve linear system Ax = b." alt="" coords="379,132,469,159"/>
<area shape="rect" href="namespacelinalg.html#a8405b084d692b1fc7f685f40425a0970" title="Solve least squares problem: minimize ||Ax &#45; b||Â²" alt="" coords="217,31,304,57"/>
<area shape="poly" title=" " alt="" coords="397,123,366,97,330,72,304,60,306,55,332,67,369,93,400,119"/>
<area shape="rect" href="tensor__c_8cpp.html#a187bbbf40169a9167f8db3976d81f51a" title=" " alt="" coords="191,81,331,108"/>
<area shape="poly" title=" " alt="" coords="363,129,306,111,307,106,365,124"/>
<area shape="rect" href="tensor__c_8cpp.html#ae8b1c96b8422926b97b2f6305c562ce9" title=" " alt="" coords="197,132,324,159"/>
<area shape="poly" title=" " alt="" coords="363,148,325,148,325,143,363,143"/>
<area shape="rect" href="namespacelinalg.html#a6ff4392ae10b75895ce02443bf3c77d6" title="Compute Moore&#45;Penrose pseudo&#45;inverse using SVD." alt="" coords="219,183,302,209"/>
<area shape="poly" title=" " alt="" coords="365,166,304,186,302,181,363,161"/>
<area shape="rect" href="namespacelinalg.html#a61b846dd17050c602c624ff0a898d617" title=" " alt="" coords="216,233,306,260"/>
<area shape="poly" title=" " alt="" coords="400,171,369,198,332,224,308,235,305,230,330,219,366,194,397,167"/>
<area shape="rect" href="tensor__c_8cpp.html#ac4676f00843bcb11305f402265e7b747" title=" " alt="" coords="5,5,143,32"/>
<area shape="poly" title=" " alt="" coords="201,39,143,31,143,25,202,33"/>
<area shape="rect" href="tensor__c_8cpp.html#ab0ed3244c40a7734ca7af5affd241c6d" title=" " alt="" coords="12,56,136,83"/>
<area shape="poly" title=" " alt="" coords="202,55,137,64,136,58,201,49"/>
<area shape="rect" href="tensor__c_8cpp.html#ad0eab2342bda5d725085476abc7c50b6" title=" " alt="" coords="7,157,141,184"/>
<area shape="poly" title=" " alt="" coords="203,191,141,182,141,177,204,186"/>
<area shape="rect" href="tensor__c_8cpp.html#acf74b6d7b42a82859c1fbec640125775" title=" " alt="" coords="14,208,134,235"/>
<area shape="poly" title=" " alt="" coords="204,206,135,216,134,211,203,201"/>
</map>
</div>

</div>
</div>
<a id="a2e81c90534586128fa4bcae3bb042175" name="a2e81c90534586128fa4bcae3bb042175"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e81c90534586128fa4bcae3bb042175">&#9670;&#160;</a></span>svd_decomp()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">auto linalg::svd_decomp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>A</em></span></td><td>)</td>
          <td>-&gt;std::variant&lt; std::tuple&lt; <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt;, <a class="el" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector</a>&lt; T &gt;, <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &gt;, <a class="el" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaa">TensorError</a> &gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Singular Value Decomposition: A = U * Sigma * V^T. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>Input matrix (m x n) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Tuple of U (m x m), singular values (min(m,n)), V^T (n x n), or error </dd></dl>

<p class="definition">Definition at line <a class="el" href="linalg__advanced_8h_source.html#l01161">1161</a> of file <a class="el" href="linalg__advanced_8h_source.html">linalg_advanced.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1162</span>                                                                          {</div>
<div class="line"><span class="lineno"> 1163</span>    <span class="keyword">auto</span> dims = A.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno"> 1164</span>    <span class="keywordtype">size_t</span> m = dims[0];</div>
<div class="line"><span class="lineno"> 1165</span>    <span class="keywordtype">size_t</span> n = dims[1];</div>
<div class="line"><span class="lineno"> 1166</span>    <span class="keywordtype">size_t</span> min_dim = std::min(m, n);</div>
<div class="line"><span class="lineno"> 1167</span>    </div>
<div class="line"><span class="lineno"> 1168</span><span class="preprocessor">#ifdef USE_LAPACK</span></div>
<div class="line"><span class="lineno"> 1169</span>    <span class="keywordflow">if</span> (!A.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>()) {</div>
<div class="line"><span class="lineno"> 1170</span>        <span class="comment">// Make a column-major copy</span></div>
<div class="line"><span class="lineno"> 1171</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> A_col = <a class="code hl_function" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a>(A);</div>
<div class="line"><span class="lineno"> 1172</span>        <span class="keywordtype">int</span> M = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(m);</div>
<div class="line"><span class="lineno"> 1173</span>        <span class="keywordtype">int</span> N = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(n);</div>
<div class="line"><span class="lineno"> 1174</span>        <span class="keywordtype">int</span> LDA = M;</div>
<div class="line"><span class="lineno"> 1175</span>        <span class="keywordtype">int</span> LDU = M;</div>
<div class="line"><span class="lineno"> 1176</span>        <span class="keywordtype">int</span> LDVT = N;</div>
<div class="line"><span class="lineno"> 1177</span>        <span class="keywordtype">int</span> INFO = 0;</div>
<div class="line"><span class="lineno"> 1178</span>        <span class="keywordtype">char</span> JOBU = <span class="charliteral">&#39;A&#39;</span>;</div>
<div class="line"><span class="lineno"> 1179</span>        <span class="keywordtype">char</span> JOBVT = <span class="charliteral">&#39;A&#39;</span>;</div>
<div class="line"><span class="lineno"> 1180</span>        </div>
<div class="line"><span class="lineno"> 1181</span>        <a class="code hl_typedef" href="linalg_8h.html#a99ba6a0becc538dc0109d3818ca80f3b">Vector&lt;T&gt;</a> S({min_dim}, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1182</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> U_col({m, m}, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1183</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> VT_col({n, n}, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1184</span>        </div>
<div class="line"><span class="lineno"> 1185</span>        T work_size;</div>
<div class="line"><span class="lineno"> 1186</span>        <span class="keywordtype">int</span> LWORK = -1;</div>
<div class="line"><span class="lineno"> 1187</span>        </div>
<div class="line"><span class="lineno"> 1188</span>        <span class="comment">// Query workspace size</span></div>
<div class="line"><span class="lineno"> 1189</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, float&gt;) {</div>
<div class="line"><span class="lineno"> 1190</span>            sgesvd_(&amp;JOBU, &amp;JOBVT, &amp;M, &amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA,</div>
<div class="line"><span class="lineno"> 1191</span>                    S.data_ptr(), U_col.data_ptr(), &amp;LDU, VT_col.data_ptr(), &amp;LDVT,</div>
<div class="line"><span class="lineno"> 1192</span>                    &amp;work_size, &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno"> 1193</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, double&gt;) {</div>
<div class="line"><span class="lineno"> 1194</span>            dgesvd_(&amp;JOBU, &amp;JOBVT, &amp;M, &amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA,</div>
<div class="line"><span class="lineno"> 1195</span>                    S.data_ptr(), U_col.data_ptr(), &amp;LDU, VT_col.data_ptr(), &amp;LDVT,</div>
<div class="line"><span class="lineno"> 1196</span>                    &amp;work_size, &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno"> 1197</span>        }</div>
<div class="line"><span class="lineno"> 1198</span>        </div>
<div class="line"><span class="lineno"> 1199</span>        LWORK = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(work_size);</div>
<div class="line"><span class="lineno"> 1200</span>        std::vector&lt;T&gt; work(LWORK);</div>
<div class="line"><span class="lineno"> 1201</span>        </div>
<div class="line"><span class="lineno"> 1202</span>        <span class="comment">// Compute SVD</span></div>
<div class="line"><span class="lineno"> 1203</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, float&gt;) {</div>
<div class="line"><span class="lineno"> 1204</span>            sgesvd_(&amp;JOBU, &amp;JOBVT, &amp;M, &amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA,</div>
<div class="line"><span class="lineno"> 1205</span>                    S.data_ptr(), U_col.data_ptr(), &amp;LDU, VT_col.data_ptr(), &amp;LDVT,</div>
<div class="line"><span class="lineno"> 1206</span>                    work.data(), &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno"> 1207</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, double&gt;) {</div>
<div class="line"><span class="lineno"> 1208</span>            dgesvd_(&amp;JOBU, &amp;JOBVT, &amp;M, &amp;N, A_col.<a class="code hl_function" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a">data_ptr</a>(), &amp;LDA,</div>
<div class="line"><span class="lineno"> 1209</span>                    S.data_ptr(), U_col.data_ptr(), &amp;LDU, VT_col.data_ptr(), &amp;LDVT,</div>
<div class="line"><span class="lineno"> 1210</span>                    work.data(), &amp;LWORK, &amp;INFO);</div>
<div class="line"><span class="lineno"> 1211</span>        }</div>
<div class="line"><span class="lineno"> 1212</span>        </div>
<div class="line"><span class="lineno"> 1213</span>        <span class="keywordflow">if</span> (INFO != 0) {</div>
<div class="line"><span class="lineno"> 1214</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaaa1df5a085496d7c89611f837bf1d52ef">TensorError::LapackError</a>;</div>
<div class="line"><span class="lineno"> 1215</span>        }</div>
<div class="line"><span class="lineno"> 1216</span>        </div>
<div class="line"><span class="lineno"> 1217</span>        <span class="comment">// Transpose U and VT back to row-major</span></div>
<div class="line"><span class="lineno"> 1218</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> U = <a class="code hl_function" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a>(U_col);</div>
<div class="line"><span class="lineno"> 1219</span>        <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> VT = <a class="code hl_function" href="#af0c07b2c6a745bcb68c10766032cc5e0">transpose</a>(VT_col);</div>
<div class="line"><span class="lineno"> 1220</span>        </div>
<div class="line"><span class="lineno"> 1221</span>        <span class="keywordflow">return</span> std::make_tuple(U, S, VT);</div>
<div class="line"><span class="lineno"> 1222</span>    }</div>
<div class="line"><span class="lineno"> 1223</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1224</span>    </div>
<div class="line"><span class="lineno"> 1225</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="tensor_8h.html#a2db6a67f5b95f95cb23a9d7b28deceaaa997ca4ce119685f40f03a9a8a6c5346e">TensorError::NotImplemented</a>;</div>
<div class="line"><span class="lineno"> 1226</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a2e81c90534586128fa4bcae3bb042175_cgraph.png" border="0" usemap="#anamespacelinalg_a2e81c90534586128fa4bcae3bb042175_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a2e81c90534586128fa4bcae3bb042175_cgraph" id="anamespacelinalg_a2e81c90534586128fa4bcae3bb042175_cgraph">
<area shape="rect" title="Singular Value Decomposition: A = U * Sigma * V^T." alt="" coords="5,81,139,108"/>
<area shape="rect" href="classTensor.html#a3f3c97d177cb960a4423afc3dafc612a" title=" " alt="" coords="187,5,302,32"/>
<area shape="poly" title=" " alt="" coords="103,78,198,36,200,41,106,83"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="365,81,461,108"/>
<area shape="poly" title=" " alt="" coords="139,92,349,92,349,97,139,97"/>
<area shape="rect" href="namespacelinalg.html#af0c07b2c6a745bcb68c10766032cc5e0" title=" " alt="" coords="187,107,303,133"/>
<area shape="poly" title=" " alt="" coords="140,102,172,107,171,112,139,107"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="351,144,475,171"/>
<area shape="poly" title=" " alt="" coords="98,106,139,126,187,143,263,154,336,157,336,163,263,160,186,148,137,131,96,111"/>
<area shape="poly" title=" " alt="" coords="303,109,349,102,350,107,304,114"/>
<area shape="poly" title=" " alt="" coords="304,130,336,138,335,143,303,136"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a2e81c90534586128fa4bcae3bb042175_icgraph.png" border="0" usemap="#anamespacelinalg_a2e81c90534586128fa4bcae3bb042175_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a2e81c90534586128fa4bcae3bb042175_icgraph" id="anamespacelinalg_a2e81c90534586128fa4bcae3bb042175_icgraph">
<area shape="rect" title="Singular Value Decomposition: A = U * Sigma * V^T." alt="" coords="184,31,317,57"/>
<area shape="rect" href="tensor__c_8cpp.html#ab00706f6c290e5385d1181e64825db1c" title=" " alt="" coords="5,5,136,32"/>
<area shape="poly" title=" " alt="" coords="168,35,136,30,136,25,168,30"/>
<area shape="rect" href="tensor__c_8cpp.html#aac85c33a82ff00fe6cfb3284fe926587" title=" " alt="" coords="12,56,129,83"/>
<area shape="poly" title=" " alt="" coords="168,58,130,64,129,58,168,53"/>
</map>
</div>

</div>
</div>
<a id="a42b83ecf931f8079418e5aeff5445040" name="a42b83ecf931f8079418e5aeff5445040"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42b83ecf931f8079418e5aeff5445040">&#9670;&#160;</a></span>trace()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">T linalg::trace </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mat</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute matrix trace (sum of diagonal elements). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mat</td><td>Square matrix </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Trace value, or 0 if matrix is not square </dd></dl>

<p class="definition">Definition at line <a class="el" href="linalg_8h_source.html#l00386">386</a> of file <a class="el" href="linalg_8h_source.html">linalg.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  386</span>                              {</div>
<div class="line"><span class="lineno">  387</span>    <span class="keyword">auto</span> dims = mat.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  388</span>    <span class="keywordflow">if</span> (dims[0] != dims[1]) {</div>
<div class="line"><span class="lineno">  389</span>        <span class="keywordflow">return</span> T(0);</div>
<div class="line"><span class="lineno">  390</span>    }</div>
<div class="line"><span class="lineno">  391</span>    </div>
<div class="line"><span class="lineno">  392</span>    T sum = T(0);</div>
<div class="line"><span class="lineno">  393</span>    <span class="keywordtype">size_t</span> n = dims[0];</div>
<div class="line"><span class="lineno">  394</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i) {</div>
<div class="line"><span class="lineno">  395</span>        sum += mat[{i, i}];</div>
<div class="line"><span class="lineno">  396</span>    }</div>
<div class="line"><span class="lineno">  397</span>    <span class="keywordflow">return</span> sum;</div>
<div class="line"><span class="lineno">  398</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a42b83ecf931f8079418e5aeff5445040_cgraph.png" border="0" usemap="#anamespacelinalg_a42b83ecf931f8079418e5aeff5445040_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a42b83ecf931f8079418e5aeff5445040_cgraph" id="anamespacelinalg_a42b83ecf931f8079418e5aeff5445040_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,94,32"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="142,5,238,32"/>
<area shape="poly" title=" " alt="" coords="94,16,126,16,126,21,94,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_a42b83ecf931f8079418e5aeff5445040_icgraph.png" border="0" usemap="#anamespacelinalg_a42b83ecf931f8079418e5aeff5445040_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_a42b83ecf931f8079418e5aeff5445040_icgraph" id="anamespacelinalg_a42b83ecf931f8079418e5aeff5445040_icgraph">
<area shape="rect" title=" " alt="" coords="192,31,280,57"/>
<area shape="rect" href="tensor__c_8cpp.html#a60fcf5eea34e5212cf98e3a9b7109dc6" title=" " alt="" coords="5,5,144,32"/>
<area shape="poly" title=" " alt="" coords="176,37,144,32,145,27,177,32"/>
<area shape="rect" href="tensor__c_8cpp.html#a7e3c0367076ee68f74b5637882d0fc9a" title=" " alt="" coords="12,56,137,83"/>
<area shape="poly" title=" " alt="" coords="177,56,138,62,137,57,176,51"/>
</map>
</div>

</div>
</div>
<a id="af0c07b2c6a745bcb68c10766032cc5e0" name="af0c07b2c6a745bcb68c10766032cc5e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0c07b2c6a745bcb68c10766032cc5e0">&#9670;&#160;</a></span>transpose()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; linalg::transpose </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix</a>&lt; T &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>mat</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Transpose a matrix. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mat</td><td>Input matrix of shape (m, n) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Transposed matrix of shape (n, m) </dd></dl>

<p class="definition">Definition at line <a class="el" href="linalg_8h_source.html#l00364">364</a> of file <a class="el" href="linalg_8h_source.html">linalg.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  364</span>                                          {</div>
<div class="line"><span class="lineno">  365</span>    <span class="keyword">auto</span> dims = mat.<a class="code hl_function" href="classTensor.html#a03d314303958ffc5644796d8025cd012">dims</a>();</div>
<div class="line"><span class="lineno">  366</span>    <span class="keywordtype">size_t</span> m = dims[0];</div>
<div class="line"><span class="lineno">  367</span>    <span class="keywordtype">size_t</span> n = dims[1];</div>
<div class="line"><span class="lineno">  368</span>    </div>
<div class="line"><span class="lineno">  369</span>    <a class="code hl_typedef" href="linalg_8h.html#aab91b0e1295509532b53ec846e227dcc">Matrix&lt;T&gt;</a> result({n, m}, mat.<a class="code hl_function" href="classTensor.html#a83ae42925e21d2871d755407d7505c10">uses_gpu</a>());</div>
<div class="line"><span class="lineno">  370</span>    </div>
<div class="line"><span class="lineno">  371</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m; ++i) {</div>
<div class="line"><span class="lineno">  372</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j) {</div>
<div class="line"><span class="lineno">  373</span>            result[{j, i}] = mat[{i, j}];</div>
<div class="line"><span class="lineno">  374</span>        }</div>
<div class="line"><span class="lineno">  375</span>    }</div>
<div class="line"><span class="lineno">  376</span>    </div>
<div class="line"><span class="lineno">  377</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  378</span>}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_af0c07b2c6a745bcb68c10766032cc5e0_cgraph.png" border="0" usemap="#anamespacelinalg_af0c07b2c6a745bcb68c10766032cc5e0_cgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_af0c07b2c6a745bcb68c10766032cc5e0_cgraph" id="anamespacelinalg_af0c07b2c6a745bcb68c10766032cc5e0_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,122,57"/>
<area shape="rect" href="classTensor.html#a03d314303958ffc5644796d8025cd012" title=" " alt="" coords="184,5,280,32"/>
<area shape="poly" title=" " alt="" coords="122,33,167,26,168,31,123,38"/>
<area shape="rect" href="classTensor.html#a83ae42925e21d2871d755407d7505c10" title=" " alt="" coords="170,56,294,83"/>
<area shape="poly" title=" " alt="" coords="123,50,155,55,154,60,122,55"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacelinalg_af0c07b2c6a745bcb68c10766032cc5e0_icgraph.png" border="0" usemap="#anamespacelinalg_af0c07b2c6a745bcb68c10766032cc5e0_icgraph" loading="lazy" alt=""/></div>
<map name="anamespacelinalg_af0c07b2c6a745bcb68c10766032cc5e0_icgraph" id="anamespacelinalg_af0c07b2c6a745bcb68c10766032cc5e0_icgraph">
<area shape="rect" title=" " alt="" coords="838,436,954,463"/>
<area shape="rect" href="namespacelinalg.html#a12137fd985ff57d9e9396c8f6919383e" title="Cholesky decomposition: A = L * L^T for symmetric positive definite matrices." alt="" coords="625,56,790,83"/>
<area shape="poly" title=" " alt="" coords="887,421,875,367,855,297,826,220,787,147,758,112,727,85,730,81,762,108,792,144,831,218,860,295,880,366,892,420"/>
<area shape="rect" href="namespacelinalg.html#a7141076f8e6b39635853e8368a13c4ea" title="Compute eigenvalues and eigenvectors for symmetric matrices." alt="" coords="643,157,772,184"/>
<area shape="poly" title=" " alt="" coords="882,422,846,338,819,288,788,242,758,211,727,187,731,182,761,207,792,238,824,286,851,336,887,420"/>
<area shape="rect" href="namespacelinalg.html#abc25aee98d873c690a7d8a88277e7219" title="Compute inverse of a square matrix." alt="" coords="446,208,547,235"/>
<area shape="poly" title=" " alt="" coords="876,424,840,374,815,348,788,325,728,290,663,264,600,245,547,233,548,227,602,240,664,259,730,285,791,320,819,344,844,370,881,421"/>
<area shape="rect" href="namespacelinalg.html#a6b7af062b5a9642d788fcc084335b39c" title=" " alt="" coords="637,563,778,589"/>
<area shape="poly" title=" " alt="" coords="874,476,837,512,791,546,753,565,751,560,788,542,833,508,870,472"/>
<area shape="rect" href="namespacelinalg.html#a8405b084d692b1fc7f685f40425a0970" title="Solve least squares problem: minimize ||Ax &#45; b||Â²" alt="" coords="236,461,323,488"/>
<area shape="poly" title=" " alt="" coords="822,455,324,476,324,470,822,450"/>
<area shape="rect" href="namespacelinalg.html#a299049265c4cb34923444e82e56f381f" title="Compute LU decomposition with partial pivoting: P*A = L*U." alt="" coords="646,335,769,361"/>
<area shape="poly" title=" " alt="" coords="855,431,733,364,735,359,857,426"/>
<area shape="rect" href="namespacelinalg.html#a49a644f54af36b484886d433da564a1f" title="Solve linear system Ax = b." alt="" coords="452,411,542,437"/>
<area shape="poly" title=" " alt="" coords="822,447,542,429,543,424,822,442"/>
<area shape="rect" href="namespacelinalg.html#a6ff4392ae10b75895ce02443bf3c77d6" title="Compute Moore&#45;Penrose pseudo&#45;inverse using SVD." alt="" coords="238,512,321,539"/>
<area shape="poly" title=" " alt="" coords="823,463,790,468,523,501,322,524,321,518,523,496,789,463,822,458"/>
<area shape="rect" href="namespacelinalg.html#a3395139856f5efebaa58f3bc9c4ed3bd" title="QR decomposition: A = QR." alt="" coords="646,613,769,640"/>
<area shape="poly" title=" " alt="" coords="885,478,849,541,823,575,791,603,771,615,768,610,788,599,819,571,845,538,880,475"/>
<area shape="rect" href="namespacelinalg.html#a2e81c90534586128fa4bcae3bb042175" title="Singular Value Decomposition: A = U * Sigma * V^T." alt="" coords="641,664,774,691"/>
<area shape="poly" title=" " alt="" coords="890,478,877,518,857,565,829,613,791,654,772,666,770,661,788,650,825,610,852,562,872,516,885,477"/>
<area shape="rect" href="tensor__c_8cpp.html#ae83aa792d547c4137efbfed451c7357c" title=" " alt="" coords="416,56,577,83"/>
<area shape="poly" title=" " alt="" coords="610,72,578,72,578,67,610,67"/>
<area shape="rect" href="tensor__c_8cpp.html#a255ee6f1fd55dc24865fd759cda653c9" title=" " alt="" coords="422,5,571,32"/>
<area shape="poly" title=" " alt="" coords="633,54,555,35,556,30,635,49"/>
<area shape="rect" href="tensor__c_8cpp.html#a6dd699eaa84717bb6be0a58278bcda75" title=" " alt="" coords="434,157,560,184"/>
<area shape="poly" title=" " alt="" coords="628,173,560,173,560,168,628,168"/>
<area shape="rect" href="tensor__c_8cpp.html#acfaf5261dd34ed1780ef4ccc06fc1cb8" title=" " alt="" coords="440,107,553,133"/>
<area shape="poly" title=" " alt="" coords="633,156,553,136,554,131,635,151"/>
<area shape="rect" href="tensor__c_8cpp.html#a754f7e7480b2f39aaa21596868896d92" title=" " alt="" coords="204,157,355,184"/>
<area shape="poly" title=" " alt="" coords="430,209,339,187,340,182,432,204"/>
<area shape="rect" href="tensor__c_8cpp.html#a95c93d5c49416ca78236c13928cd0037" title=" " alt="" coords="210,107,348,133"/>
<area shape="poly" title=" " alt="" coords="430,206,415,198,399,185,390,172,381,160,367,148,343,136,345,132,369,143,385,156,394,169,403,182,417,194,432,202"/>
<area shape="rect" href="tensor__c_8cpp.html#ac4676f00843bcb11305f402265e7b747" title=" " alt="" coords="5,411,143,437"/>
<area shape="poly" title=" " alt="" coords="220,463,130,440,132,435,221,458"/>
<area shape="rect" href="tensor__c_8cpp.html#ab0ed3244c40a7734ca7af5affd241c6d" title=" " alt="" coords="12,461,136,488"/>
<area shape="poly" title=" " alt="" coords="220,477,137,477,137,472,220,472"/>
<area shape="poly" title=" " alt="" coords="679,326,633,287,576,249,547,237,549,232,579,244,636,282,683,322"/>
<area shape="rect" href="namespacelinalg.html#a397bea6a8d02533eae3c3eb837d0fd7a" title="Compute determinant of a square matrix." alt="" coords="433,259,560,285"/>
<area shape="poly" title=" " alt="" coords="657,331,576,300,543,288,544,283,578,295,659,326"/>
<area shape="rect" href="tensor__c_8cpp.html#a986a2d450dd68de32ba10aca25c9e7ac" title=" " alt="" coords="437,309,556,336"/>
<area shape="poly" title=" " alt="" coords="630,341,557,332,557,327,631,336"/>
<area shape="rect" href="tensor__c_8cpp.html#a1522eabc50b84f6a17d4bcaabffba8ab" title=" " alt="" coords="444,360,550,387"/>
<area shape="poly" title=" " alt="" coords="631,360,551,370,550,364,631,354"/>
<area shape="poly" title=" " alt="" coords="659,370,578,401,543,413,541,408,576,396,657,365"/>
<area shape="rect" href="tensor__c_8cpp.html#a8c7d0e2386ccf7736acfd38fde6b346b" title=" " alt="" coords="191,259,368,285"/>
<area shape="poly" title=" " alt="" coords="418,275,369,275,369,269,418,269"/>
<area shape="rect" href="tensor__c_8cpp.html#a42edf6fc1ead7dfe415d6182180f2852" title=" " alt="" coords="197,208,362,235"/>
<area shape="poly" title=" " alt="" coords="421,257,339,238,340,233,422,252"/>
<area shape="poly" title=" " alt="" coords="437,441,324,467,323,462,436,435"/>
<area shape="rect" href="tensor__c_8cpp.html#a187bbbf40169a9167f8db3976d81f51a" title=" " alt="" coords="209,309,350,336"/>
<area shape="poly" title=" " alt="" coords="436,412,415,401,399,388,390,375,381,362,367,350,343,339,345,334,369,346,385,359,394,372,403,384,417,396,438,407"/>
<area shape="rect" href="tensor__c_8cpp.html#ae8b1c96b8422926b97b2f6305c562ce9" title=" " alt="" coords="216,360,343,387"/>
<area shape="poly" title=" " alt="" coords="436,413,339,390,340,385,437,407"/>
<area shape="poly" title=" " alt="" coords="465,449,420,476,369,502,322,518,321,513,367,498,418,472,462,444"/>
<area shape="rect" href="namespacelinalg.html#a61b846dd17050c602c624ff0a898d617" title=" " alt="" coords="234,411,324,437"/>
<area shape="poly" title=" " alt="" coords="436,427,325,427,325,421,436,421"/>
<area shape="rect" href="tensor__c_8cpp.html#ad0eab2342bda5d725085476abc7c50b6" title=" " alt="" coords="7,512,141,539"/>
<area shape="poly" title=" " alt="" coords="222,528,141,528,141,523,222,523"/>
<area shape="rect" href="tensor__c_8cpp.html#acf74b6d7b42a82859c1fbec640125775" title=" " alt="" coords="14,563,134,589"/>
<area shape="poly" title=" " alt="" coords="223,542,132,565,130,559,222,537"/>
<area shape="rect" href="tensor__c_8cpp.html#aa3a8e0732f21d46808a15b1a2da569ed" title=" " alt="" coords="436,613,557,640"/>
<area shape="poly" title=" " alt="" coords="630,629,557,629,557,624,630,624"/>
<area shape="rect" href="tensor__c_8cpp.html#a3d60bab577de01d53ca9d0ac33219fb7" title=" " alt="" coords="443,563,550,589"/>
<area shape="poly" title=" " alt="" coords="633,612,550,591,552,586,635,607"/>
<area shape="rect" href="tensor__c_8cpp.html#ab00706f6c290e5385d1181e64825db1c" title=" " alt="" coords="432,715,562,741"/>
<area shape="poly" title=" " alt="" coords="635,697,556,717,555,711,633,692"/>
<area shape="rect" href="tensor__c_8cpp.html#aac85c33a82ff00fe6cfb3284fe926587" title=" " alt="" coords="438,664,555,691"/>
<area shape="poly" title=" " alt="" coords="625,680,556,680,556,675,625,675"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="namespacelinalg.html">linalg</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
